
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>vtool package &#8212; wbia-vtool 3.2.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to vtool’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="vtool-package">
<h1>vtool package<a class="headerlink" href="#vtool-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-vtool.__main__">
<span id="vtool-main-module"></span><h2>vtool.__main__ module<a class="headerlink" href="#module-vtool.__main__" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.__main__.main">
<code class="descclassname">vtool.__main__.</code><code class="descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/__main__.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.__main__.main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="vtool-grave-module">
<h2>vtool._grave module<a class="headerlink" href="#vtool-grave-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-vtool._old_matching">
<span id="vtool-old-matching-module"></span><h2>vtool._old_matching module<a class="headerlink" href="#module-vtool._old_matching" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-vtool._pyflann_backend">
<span id="vtool-pyflann-backend-module"></span><h2>vtool._pyflann_backend module<a class="headerlink" href="#module-vtool._pyflann_backend" title="Permalink to this headline">¶</a></h2>
<p>abstract which pyflann implementation is used</p>
<p>from vtool._pyflann_backend import pyflann</p>
<dl class="attribute">
<dt id="vtool._pyflann_backend.FLANN_CLS">
<code class="descclassname">vtool._pyflann_backend.</code><code class="descname">FLANN_CLS</code><a class="headerlink" href="#vtool._pyflann_backend.FLANN_CLS" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">vtool._pyflann_backend._CV2_FLANN_CLS</span></code></p>
</dd></dl>

</div>
<div class="section" id="module-vtool._rhomb_dist">
<span id="vtool-rhomb-dist-module"></span><h2>vtool._rhomb_dist module<a class="headerlink" href="#module-vtool._rhomb_dist" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool._rhomb_dist.RhombicuboctahedronDistanceDemo">
<code class="descclassname">vtool._rhomb_dist.</code><code class="descname">RhombicuboctahedronDistanceDemo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/_rhomb_dist.html#RhombicuboctahedronDistanceDemo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool._rhomb_dist.RhombicuboctahedronDistanceDemo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.blend">
<span id="vtool-blend-module"></span><h2>vtool.blend module<a class="headerlink" href="#module-vtool.blend" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.blend.blend_images">
<code class="descclassname">vtool.blend.</code><code class="descname">blend_images</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>mode='average'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.blend_images" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img1</strong> (<em>np.ndarray</em>) – first image</li>
<li><strong>img2</strong> (<em>np.ndarray</em>) – second image</li>
<li><strong>mode</strong> (<em>str</em>) – can be average, multiply, or overlay</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.blend.blend_images_average">
<code class="descclassname">vtool.blend.</code><code class="descname">blend_images_average</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>alpha=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.blend_images_average" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>alpha</strong> (<em>float</em>) – (default = 0.5)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">imgB</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.blend blend_images_average:0 –show
python -m vtool.blend blend_images_average:1 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_average</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">blend_images_average</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s1">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;alpha=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.blend.blend_images_average_stack">
<code class="descclassname">vtool.blend.</code><code class="descname">blend_images_average_stack</code><span class="sig-paren">(</span><em>images</em>, <em>alpha=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_average_stack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.blend_images_average_stack" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>alpha</strong> (<em>float</em>) – (default = 0.5)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">imgB</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.blend –test-blend_images_average:0 –show
python -m vtool.blend –test-blend_images_average:1 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_average</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.blend.blend_images_mult_average">
<code class="descclassname">vtool.blend.</code><code class="descname">blend_images_mult_average</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>alpha=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_mult_average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.blend_images_mult_average" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>alpha</strong> (<em>float</em>) – (default = 0.5)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">imgB</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.blend –test-blend_images_mult_average:0 –show
python -m vtool.blend –test-blend_images_mult_average:1 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_mult_average</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">blend_images_mult_average</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s1">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;alpha=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.blend.blend_images_multiply">
<code class="descclassname">vtool.blend.</code><code class="descname">blend_images_multiply</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>alpha=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_multiply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.blend_images_multiply" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>alpha</strong> (<em>float</em>) – (default = 0.5)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">imgB</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.blend –test-blend_images_multiply:0 –show
python -m vtool.blend –test-blend_images_multiply:1 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_multiply</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">blend_images_multiply</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s1">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;alpha=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.blend.ensure_alpha_channel">
<code class="descclassname">vtool.blend.</code><code class="descname">ensure_alpha_channel</code><span class="sig-paren">(</span><em>img</em>, <em>alpha=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#ensure_alpha_channel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.ensure_alpha_channel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.blend.ensure_grayscale">
<code class="descclassname">vtool.blend.</code><code class="descname">ensure_grayscale</code><span class="sig-paren">(</span><em>img</em>, <em>colorspace_hint='BGR'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#ensure_grayscale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.ensure_grayscale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.blend.gamma_adjust">
<code class="descclassname">vtool.blend.</code><code class="descname">gamma_adjust</code><span class="sig-paren">(</span><em>img</em>, <em>gamma=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#gamma_adjust"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.gamma_adjust" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.blend –test-gamma_adjust:0 –show</dd>
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">gamma_adjust</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_float01</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">img</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s1">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;gamma=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.blend.gridsearch_addWeighted">
<code class="descclassname">vtool.blend.</code><code class="descname">gridsearch_addWeighted</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#gridsearch_addWeighted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.gridsearch_addWeighted" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/blend.py gridsearch_addWeighted</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.blend.gridsearch_image_function">
<code class="descclassname">vtool.blend.</code><code class="descname">gridsearch_image_function</code><span class="sig-paren">(</span><em>param_info</em>, <em>test_func</em>, <em>args=()</em>, <em>show_func=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#gridsearch_image_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.gridsearch_image_function" title="Permalink to this definition">¶</a></dt>
<dd><p>gridsearch for a function that produces a single image</p>
</dd></dl>

<dl class="function">
<dt id="vtool.blend.overlay_alpha_images">
<code class="descclassname">vtool.blend.</code><code class="descname">overlay_alpha_images</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#overlay_alpha_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.overlay_alpha_images" title="Permalink to this definition">¶</a></dt>
<dd><p>places img1 on top of img2 respecting alpha channels</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/25182421/overlay-numpy-alpha">http://stackoverflow.com/questions/25182421/overlay-numpy-alpha</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.blend.testdata_blend">
<code class="descclassname">vtool.blend.</code><code class="descname">testdata_blend</code><span class="sig-paren">(</span><em>scale=128</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#testdata_blend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.testdata_blend" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.chip">
<span id="vtool-chip-module"></span><h2>vtool.chip module<a class="headerlink" href="#module-vtool.chip" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="vtool.chip.ScaleStrat">
<em class="property">class </em><code class="descclassname">vtool.chip.</code><code class="descname">ScaleStrat</code><a class="reference internal" href="_modules/vtool/chip.html#ScaleStrat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.ScaleStrat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Scaling strategies</p>
<dl class="staticmethod">
<dt id="vtool.chip.ScaleStrat.area">
<em class="property">static </em><code class="descname">area</code><span class="sig-paren">(</span><em>target</em>, <em>orig_wh</em>, <em>tol=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#ScaleStrat.area"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.ScaleStrat.area" title="Permalink to this definition">¶</a></dt>
<dd><p>The area becomes target</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>target</strong> (<em>int</em>) – target size</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="mi">800</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">)),</span> <span class="p">(</span><span class="mi">743</span><span class="p">,</span> <span class="mi">861</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="mi">800</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">190</span><span class="p">)),</span> <span class="p">(</span><span class="mi">861</span><span class="p">,</span> <span class="mi">743</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="vtool.chip.ScaleStrat.maxwh">
<em class="property">static </em><code class="descname">maxwh</code><span class="sig-paren">(</span><em>target</em>, <em>orig_wh</em>, <em>tol=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#ScaleStrat.maxwh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.ScaleStrat.maxwh" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum dimension becomes target</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>target</strong> (<em>int</em>) – target size</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">maxwh</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="p">(</span><span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">)),</span> <span class="p">(</span><span class="mi">691</span><span class="p">,</span> <span class="mi">800</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">maxwh</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">190</span><span class="p">)),</span> <span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">691</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="vtool.chip.ScaleStrat.width">
<em class="property">static </em><code class="descname">width</code><span class="sig-paren">(</span><em>target</em>, <em>orig_wh</em>, <em>tol=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#ScaleStrat.width"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.ScaleStrat.width" title="Permalink to this definition">¶</a></dt>
<dd><p>The width becomes target</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>target</strong> (<em>int</em>) – target size</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="p">(</span><span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">)),</span> <span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">926</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">190</span><span class="p">)),</span> <span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">691</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="vtool.chip.apply_filter_funcs">
<code class="descclassname">vtool.chip.</code><code class="descname">apply_filter_funcs</code><span class="sig-paren">(</span><em>chipBGR</em>, <em>filter_funcs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#apply_filter_funcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.apply_filter_funcs" title="Permalink to this definition">¶</a></dt>
<dd><p>applies a list of preprocessing filters to a chip</p>
<p>DEPRICATE</p>
</dd></dl>

<dl class="function">
<dt id="vtool.chip.compute_chip">
<code class="descclassname">vtool.chip.</code><code class="descname">compute_chip</code><span class="sig-paren">(</span><em>gfpath</em>, <em>bbox</em>, <em>theta</em>, <em>new_size</em>, <em>filter_list=[]</em>, <em>interpolation=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#compute_chip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.compute_chip" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts a chip and applies filters</p>
<p>DEPRICATE</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gfpath</strong> (<em>str</em>) – image file path string</li>
<li><strong>bbox</strong> (<em>tuple</em>) – bounding box in the format (x, y, w, h)</li>
<li><strong>theta</strong> (<em>float</em>) – angle in radians</li>
<li><strong>new_size</strong> (<em>tuple</em>) – must maintain the same aspect ratio or else you will get weirdness</li>
<li><strong>filter_list</strong> (<em>list</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">chipBGR -  cropped image</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.chip –test-compute_chip –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="n">TAU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gfpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filter_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR</span> <span class="o">=</span> <span class="n">compute_chip</span><span class="p">(</span><span class="n">gfpath</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">new_size</span><span class="p">,</span> <span class="n">filter_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">chipBGR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_size</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;did not resize correctly&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">draw_verts</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">gfpath</span><span class="p">),</span> <span class="n">vt</span><span class="o">.</span><span class="n">scaled_verts_from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.chip.extract_chip_from_gpath">
<code class="descclassname">vtool.chip.</code><code class="descname">extract_chip_from_gpath</code><span class="sig-paren">(</span><em>gfpath</em>, <em>bbox</em>, <em>theta</em>, <em>new_size</em>, <em>interpolation=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_from_gpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.extract_chip_from_gpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.chip.extract_chip_from_gpath_into_square">
<code class="descclassname">vtool.chip.</code><code class="descname">extract_chip_from_gpath_into_square</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_from_gpath_into_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.extract_chip_from_gpath_into_square" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.chip.extract_chip_from_img">
<code class="descclassname">vtool.chip.</code><code class="descname">extract_chip_from_img</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>bbox</em>, <em>theta</em>, <em>new_size</em>, <em>interpolation=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_from_img"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.extract_chip_from_img" title="Permalink to this definition">¶</a></dt>
<dd><p>Crops chip from image ; Rotates and scales;</p>
<p>ibs.show_annot_image(aid)[0].pt_save_and_view()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gfpath</strong> (<em>str</em>) – </li>
<li><strong>bbox</strong> (<em>tuple</em>) – xywh</li>
<li><strong>theta</strong> (<em>float</em>) – </li>
<li><strong>new_size</strong> (<em>tuple</em>) – wy</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">chipBGR</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.chip –test-extract_chip_from_img
python -m vtool.chip –test-extract_chip_from_img –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">gtool</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">58</span><span class="p">,</span> <span class="mi">34</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR</span> <span class="o">=</span> <span class="n">extract_chip_from_img</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">new_size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">chipBGR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_size</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;did not resize correctly&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.chip.extract_chip_into_square">
<code class="descclassname">vtool.chip.</code><code class="descname">extract_chip_into_square</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>bbox</em>, <em>theta</em>, <em>target_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_into_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.extract_chip_into_square" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.chip.get_extramargin_measures">
<code class="descclassname">vtool.chip.</code><code class="descname">get_extramargin_measures</code><span class="sig-paren">(</span><em>bbox_gs</em>, <em>new_size</em>, <em>halfoffset_ms=(64</em>, <em>64)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#get_extramargin_measures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.get_extramargin_measures" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a detection chip with a bit of spatial context so the detection
algorithm doesn’t clip boundaries</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>mbbox_gs, margin_size -</dt>
<dd>margin bounding box in image size,
size of entire margined chip,</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.chip –test-get_extramargin_measures –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gfpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox_gs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="o">.</span><span class="mi">15</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">halfoffset_ms</span> <span class="o">=</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mbbox_gs</span><span class="p">,</span> <span class="n">margin_size</span> <span class="o">=</span> <span class="n">get_extramargin_measures</span><span class="p">(</span><span class="n">bbox_gs</span><span class="p">,</span> <span class="n">new_size</span><span class="p">,</span> <span class="n">halfoffset_ms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">testshow_extramargin_info</span><span class="p">(</span><span class="n">gfpath</span><span class="p">,</span> <span class="n">bbox_gs</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">new_size</span><span class="p">,</span> <span class="n">halfoffset_ms</span><span class="p">,</span> <span class="n">mbbox_gs</span><span class="p">,</span> <span class="n">margin_size</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.chip.get_image_to_chip_transform">
<code class="descclassname">vtool.chip.</code><code class="descname">get_image_to_chip_transform</code><span class="sig-paren">(</span><em>bbox</em>, <em>chipsz</em>, <em>theta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#get_image_to_chip_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.get_image_to_chip_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>transforms image space into chipspace</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>- bounding box of chip in image space</strong> (<em>bbox</em>) – </li>
<li><strong>- size of the chip</strong> (<em>chipsz</em>) – </li>
<li><strong>- rotation of the bounding box</strong> (<em>theta</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Sympy:</dt>
<dd><p class="first"># <a class="reference external" href="https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA">https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</a>
from vtool.patch import *  # NOQA
import sympy
import sympy.abc
theta = sympy.abc.theta</p>
<p>x, y, w, h, target_area  = sympy.symbols(‘x y w h, a’)
gx, gy  = sympy.symbols(‘gx, gy’)</p>
<p>round = sympy.floor  # hack</p>
<p>ht = sympy.sqrt(target_area * h / w)
wt = w * ht / h
<a href="#id27"><span class="problematic" id="id28">cw_</span></a>, <a href="#id29"><span class="problematic" id="id30">ch_</span></a> = round(wt), round(ht)</p>
<p>from vtool import ltool
T1 = ltool.translation_mat3x3(tx1, ty1, dtype=None)
S  = ltool.scale_mat3x3(sx, sy, dtype=None)
R  = ltool.rotation_mat3x3(-theta, sympy.sin, sympy.cos)
T2 = ltool.translation_mat3x3(tx2, ty2, dtype=None)</p>
<dl class="docutils">
<dt>def add_matmul_hold_prop(mat):</dt>
<dd><p class="first">#import functools
mat = sympy.Matrix(mat)
def matmul_hold(other, hold=False):</p>
<blockquote>
<div>new = sympy.MatMul(mat, other, hold=hold)
add_matmul_hold_prop(new)
return new</div></blockquote>
<p class="last">setattr(mat, ‘matmul_hold’, matmul_hold)
return mat</p>
</dd>
</dl>
<p>T1 = add_matmul_hold_prop(T1)
T2 = add_matmul_hold_prop(T2)
R = add_matmul_hold_prop(R)
S = add_matmul_hold_prop(S)</p>
<p class="last">C = T2.multiply(R.multiply(S.multiply(T1)))
sympy.simplify(C)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.chip.get_scaled_size_with_dlen">
<code class="descclassname">vtool.chip.</code><code class="descname">get_scaled_size_with_dlen</code><span class="sig-paren">(</span><em>target_dlen</em>, <em>w</em>, <em>h</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#get_scaled_size_with_dlen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.get_scaled_size_with_dlen" title="Permalink to this definition">¶</a></dt>
<dd><p>returns new_size which scales (w, h) as close to target_dlen as possible
and maintains aspect ratio</p>
</dd></dl>

<dl class="function">
<dt id="vtool.chip.gridsearch_chipextract">
<code class="descclassname">vtool.chip.</code><code class="descname">gridsearch_chipextract</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#gridsearch_chipextract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.gridsearch_chipextract" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/chip.py gridsearch_chipextract –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_chipextract</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.chip.testshow_extramargin_info">
<code class="descclassname">vtool.chip.</code><code class="descname">testshow_extramargin_info</code><span class="sig-paren">(</span><em>gfpath</em>, <em>bbox_gs</em>, <em>theta</em>, <em>new_size</em>, <em>halfoffset_ms</em>, <em>mbbox_gs</em>, <em>margin_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#testshow_extramargin_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.testshow_extramargin_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.clustering2">
<span id="vtool-clustering2-module"></span><h2>vtool.clustering2 module<a class="headerlink" href="#module-vtool.clustering2" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="vtool.clustering2.AnnoyWraper">
<em class="property">class </em><code class="descclassname">vtool.clustering2.</code><code class="descname">AnnoyWraper</code><a class="reference internal" href="_modules/vtool/clustering2.html#AnnoyWraper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.AnnoyWraper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>flann-like interface to annnoy</p>
<dl class="method">
<dt id="vtool.clustering2.AnnoyWraper.build_annoy">
<code class="descname">build_annoy</code><span class="sig-paren">(</span><em>centroids</em>, <em>trees=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#AnnoyWraper.build_annoy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.AnnoyWraper.build_annoy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.clustering2.AnnoyWraper.nn">
<code class="descname">nn</code><span class="sig-paren">(</span><em>data_vecs</em>, <em>query_vecs</em>, <em>num</em>, <em>trees=3</em>, <em>checks=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#AnnoyWraper.nn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.AnnoyWraper.nn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.clustering2.AnnoyWraper.query_annoy">
<code class="descname">query_annoy</code><span class="sig-paren">(</span><em>query_vecs</em>, <em>num</em>, <em>checks=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#AnnoyWraper.query_annoy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.AnnoyWraper.query_annoy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.apply_grouping">
<code class="descclassname">vtool.clustering2.</code><code class="descname">apply_grouping</code><span class="sig-paren">(</span><em>items</em>, <em>groupxs</em>, <em>axis=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.apply_grouping" title="Permalink to this definition">¶</a></dt>
<dd><p>applies grouping from group_indicies
apply_grouping</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>items</strong> (<em>ndarray</em>) – </li>
<li><strong>groupxs</strong> (<em>list of ndarrays</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">grouped items</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of ndarrays</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>group_indices
invert_apply_grouping</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.clustering2 –test-apply_grouping</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_items</span> <span class="o">=</span> <span class="n">apply_grouping</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">grouped_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[array([8, 5, 6]), array([1, 5, 8, 7]), array([5, 3, 0, 9])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.apply_grouping_">
<code class="descclassname">vtool.clustering2.</code><code class="descname">apply_grouping_</code><span class="sig-paren">(</span><em>items</em>, <em>groupxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.apply_grouping_" title="Permalink to this definition">¶</a></dt>
<dd><p>non-optimized version</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.apply_grouping_iter">
<code class="descclassname">vtool.clustering2.</code><code class="descname">apply_grouping_iter</code><span class="sig-paren">(</span><em>items</em>, <em>groupxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping_iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.apply_grouping_iter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.apply_grouping_iter2">
<code class="descclassname">vtool.clustering2.</code><code class="descname">apply_grouping_iter2</code><span class="sig-paren">(</span><em>items</em>, <em>groupxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping_iter2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.apply_grouping_iter2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.apply_jagged_grouping">
<code class="descclassname">vtool.clustering2.</code><code class="descname">apply_jagged_grouping</code><span class="sig-paren">(</span><em>unflat_items</em>, <em>groupxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_jagged_grouping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.apply_jagged_grouping" title="Permalink to this definition">¶</a></dt>
<dd><p>takes unflat_list and flat group indices. Returns the unflat grouping</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.example_binary">
<code class="descclassname">vtool.clustering2.</code><code class="descname">example_binary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#example_binary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.example_binary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.find_duplicate_items">
<code class="descclassname">vtool.clustering2.</code><code class="descname">find_duplicate_items</code><span class="sig-paren">(</span><em>item_arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#find_duplicate_items"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.find_duplicate_items" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>item_arr</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">duplicate_items</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">?</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.clustering2 –test-find_duplicate_items</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/21888406/getting-the-indexes-to-the-duplicate-columns-of-a-numpy-array">http://stackoverflow.com/questions/21888406/getting-the-indexes-to-the-duplicate-columns-of-a-numpy-array</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">duplicate_items</span> <span class="o">=</span> <span class="n">find_duplicate_items</span><span class="p">(</span><span class="n">item_arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">duplicate_items</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="n">six</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">find_duplicate_items</span><span class="p">(</span><span class="n">item_arr</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">duplicate_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[9, 67, 87, 88]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.group_indices">
<code class="descclassname">vtool.clustering2.</code><code class="descname">group_indices</code><span class="sig-paren">(</span><em>idx2_groupid</em>, <em>assume_sorted=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#group_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.group_indices" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>idx2_groupid</strong> (<em>ndarray</em>) – numpy array of group ids (must be numeric)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(keys, groupxs)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple (ndarray, list of ndarrays)</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/clustering2.py group_indices
xdoctest -m ~/code/vtool/vtool/clustering2.py group_indices:0
xdoctest -m ~/code/vtool/vtool/clustering2.py group_indices:1</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([1, 2, 3], dtype=np.int64),</span>
<span class="go">[</span>
<span class="go">    np.array([1, 3, 5], dtype=np.int64),</span>
<span class="go">    np.array([0, 2, 4, 6], dtype=np.int64),</span>
<span class="go">    np.array([ 7,  8,  9, 10], dtype=np.int64),</span>
<span class="go">],</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mi">24</span><span class="p">],</span> <span class="p">[</span> <span class="mi">129</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">24</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span><span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">822</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span><span class="mi">24</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2d arrays must be flattened before coming into this function so</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># information is on the last axis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([ 24, 129, 659, 822], dtype=np.int64),</span>
<span class="go">[</span>
<span class="go">    np.array([ 0,  4, 10], dtype=np.int64),</span>
<span class="go">    np.array([1], dtype=np.int64),</span>
<span class="go">    np.array([2, 3, 5, 6, 8, 9], dtype=np.int64),</span>
<span class="go">    np.array([7], dtype=np.int64),</span>
<span class="go">],</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([False,  True], dtype=np.bool),</span>
<span class="go">[</span>
<span class="go">    np.array([2, 4, 5], dtype=np.int64),</span>
<span class="go">    np.array([0, 1, 3, 6], dtype=np.int64),</span>
<span class="go">],</span>
</pre></div>
</div>
</dd>
<dt>Time:</dt>
<dd><div class="first highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">extract_timeit_setup</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">group_indices</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;groupxs =&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">setup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="go">        [sortx[lx:rx] for lx, rx in ut.itertwo(idxs)]</span>
<span class="go">        [sortx[lx:rx] for lx, rx in zip(idxs, idxs[1:])]</span>
<span class="go">        #[sortx[lx:rx] for lx, rx in ut.iter_window(idxs)]</span>
<span class="go">        #[sortx[slice(*_)] for _ in ut.itertwo(idxs)]</span>
<span class="go">        #[sortx[slice(lr, lx)] for lr, lx in ut.itertwo(idxs)]</span>
<span class="go">        #np.split(sortx, idxs[1:-1])</span>
<span class="go">        #np.hsplit(sortx, idxs[1:-1])</span>
<span class="go">        np.array_split(sortx, idxs[1:-1])</span>
<span class="go">        &#39;&#39;&#39;).split(&#39;\n&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stmt_list</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">passed</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="go">        np.diff(groupids_sorted)</span>
<span class="go">        np.ediff1d(groupids_sorted)</span>
<span class="go">        np.subtract(groupids_sorted[1:], groupids_sorted[:-1])</span>
<span class="go">        &#39;&#39;&#39;).split(&#39;\n&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stmt_list</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">passed</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Timeit:</dt>
<dd>import numba
group_indices_numba = numba.jit(group_indices)
group_indices_numba(idx2_groupid)</dd>
<dt>SeeAlso:</dt>
<dd>apply_grouping</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4651683/">http://stackoverflow.com/questions/4651683/</a>
numpy-grouping-using-itertools-groupby-performance</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.groupby">
<code class="descclassname">vtool.clustering2.</code><code class="descname">groupby</code><span class="sig-paren">(</span><em>items</em>, <em>idx2_groupid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupby"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.groupby" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">items</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span> <span class="o">=</span> <span class="n">idx2_groupid</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.groupby_dict">
<code class="descclassname">vtool.clustering2.</code><code class="descname">groupby_dict</code><span class="sig-paren">(</span><em>items</em>, <em>idx2_groupid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupby_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.groupby_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.groupby_gen">
<code class="descclassname">vtool.clustering2.</code><code class="descname">groupby_gen</code><span class="sig-paren">(</span><em>items</em>, <em>idx2_groupid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupby_gen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.groupby_gen" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">items</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.groupedzip">
<code class="descclassname">vtool.clustering2.</code><code class="descname">groupedzip</code><span class="sig-paren">(</span><em>id_list</em>, <em>datas_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupedzip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.groupedzip" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for grouping multiple lists of data (stored in <code class="docutils literal notranslate"><span class="pre">datas_list</span></code>)
using <code class="docutils literal notranslate"><span class="pre">id_list</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>id_list</strong> (<em>list</em>) – </li>
<li><strong>datas_list</strong> (<em>list</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">_iter</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">iterator</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.clustering2 –test-groupedzip</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">id_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datas_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupxs</span><span class="p">,</span> <span class="n">grouped_iter</span> <span class="o">=</span> <span class="n">groupedzip</span><span class="p">(</span><span class="n">id_list</span><span class="p">,</span> <span class="n">datas_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_tuples</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">grouped_iter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">groupxs</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">grouped_tuples</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[</span>
<span class="go">    ([&#39;a&#39;, &#39;c&#39;, &#39;e&#39;], [&#39;A&#39;, &#39;C&#39;, &#39;E&#39;]),</span>
<span class="go">    ([&#39;b&#39;, &#39;d&#39;, &#39;f&#39;], [&#39;B&#39;, &#39;D&#39;, &#39;F&#39;]),</span>
<span class="go">    ([&#39;g&#39;], [&#39;G&#39;]),</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.invert_apply_grouping">
<code class="descclassname">vtool.clustering2.</code><code class="descname">invert_apply_grouping</code><span class="sig-paren">(</span><em>grouped_items</em>, <em>groupxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#invert_apply_grouping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.invert_apply_grouping" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grouped_items</strong> (<em>list</em>) – of lists</li>
<li><strong>groupxs</strong> (<em>list</em>) – of lists</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">items</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.clustering2 –test-invert_apply_grouping</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_items</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span> <span class="o">=</span> <span class="n">invert_apply_grouping</span><span class="p">(</span><span class="n">grouped_items</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">items</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1, 8, 5, 5, 8, 6, 7, 5, 3, 0, 9]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_items</span><span class="p">,</span> <span class="n">groupxs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">invert_apply_grouping</span><span class="p">(</span><span class="n">grouped_items</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.invert_apply_grouping2">
<code class="descclassname">vtool.clustering2.</code><code class="descname">invert_apply_grouping2</code><span class="sig-paren">(</span><em>grouped_items</em>, <em>groupxs</em>, <em>dtype=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#invert_apply_grouping2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.invert_apply_grouping2" title="Permalink to this definition">¶</a></dt>
<dd><p>use only when ungrouping will be complete</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.invert_apply_grouping3">
<code class="descclassname">vtool.clustering2.</code><code class="descname">invert_apply_grouping3</code><span class="sig-paren">(</span><em>grouped_items</em>, <em>groupxs</em>, <em>maxval</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#invert_apply_grouping3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.invert_apply_grouping3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.jagged_group">
<code class="descclassname">vtool.clustering2.</code><code class="descname">jagged_group</code><span class="sig-paren">(</span><em>groupids_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#jagged_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.jagged_group" title="Permalink to this definition">¶</a></dt>
<dd><p>flattens and returns group indexes into the flattened list</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.plot_centroids">
<code class="descclassname">vtool.clustering2.</code><code class="descname">plot_centroids</code><span class="sig-paren">(</span><em>data</em>, <em>centroids</em>, <em>num_pca_dims=3</em>, <em>whiten=False</em>, <em>labels='centroids'</em>, <em>fnum=1</em>, <em>prefix=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#plot_centroids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.plot_centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots centroids and datapoints. Plots accurately up to 3 dimensions.
If there are more than 3 dimensions, PCA is used to recude the dimenionality
to the &lt;num_pca_dims&gt; principal components</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.sorted_indices_ranges">
<code class="descclassname">vtool.clustering2.</code><code class="descname">sorted_indices_ranges</code><span class="sig-paren">(</span><em>groupids_sorted</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#sorted_indices_ranges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.sorted_indices_ranges" title="Permalink to this definition">¶</a></dt>
<dd><p>Like group sorted indices but returns a list of slices</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.tune_flann2">
<code class="descclassname">vtool.clustering2.</code><code class="descname">tune_flann2</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#tune_flann2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.tune_flann2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.uniform_sample_hypersphere">
<code class="descclassname">vtool.clustering2.</code><code class="descname">uniform_sample_hypersphere</code><span class="sig-paren">(</span><em>num</em>, <em>ndim=2</em>, <em>only_quadrent_1=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#uniform_sample_hypersphere"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.uniform_sample_hypersphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Not quite done yet</p>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Regular_polytope">https://en.wikipedia.org/wiki/Regular_polytope</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Platonic_solid#Higher_dimensions">https://en.wikipedia.org/wiki/Platonic_solid#Higher_dimensions</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Cross-polytope">https://en.wikipedia.org/wiki/Cross-polytope</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>num</strong> – </li>
<li><strong>ndim</strong> (<em>int</em>) – (default = 2)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.clustering2 –test-uniform_sampe_hypersphere</dd>
<dt>Ignore:</dt>
<dd>#pip install polytope
sudo pip install cvxopt  –no-deps</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndim</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pts</span> <span class="o">=</span> <span class="n">uniform_sampe_hypersphere</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">ndim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;gx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">elif</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1">#pt.plot_surface3d(pts.T[0], pts.T[1], pts.T[2])</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fig</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">doclf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">docla</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">df2</span><span class="o">.</span><span class="n">dark_background</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.unsupervised_multicut_labeling">
<code class="descclassname">vtool.clustering2.</code><code class="descname">unsupervised_multicut_labeling</code><span class="sig-paren">(</span><em>cost_matrix</em>, <em>thresh=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#unsupervised_multicut_labeling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.unsupervised_multicut_labeling" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Notes</p>
<p>requires CPLEX</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.clustering2 unsupervised_multicut_labeling –show</dd>
</dl>
<p>Ignore:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># synthetic data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#np.random.rand(size, size)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">45</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#size = 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">443284320</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encounter_lbls</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separation</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separation</span> <span class="o">=</span> <span class="mf">1.10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">encounter_lbls</span><span class="p">,</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_match</span> <span class="o">=</span> <span class="n">grid1</span><span class="o">.</span><span class="n">T</span> <span class="o">==</span> <span class="n">grid1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">good_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">is_match</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bad_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">s_match</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix_</span><span class="p">[</span><span class="n">good_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">good_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="n">separation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix_</span><span class="p">[</span><span class="n">bad_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bad_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">-</span> <span class="n">separation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">false_val</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">-</span> <span class="n">separation</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">true_val</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span> <span class="o">+</span> <span class="n">separation</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">diag_indices_from</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="p">)]</span> <span class="o">=</span> <span class="n">true_val</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#cost_matrix_[np.diag_indices_from(cost_matrix_)] = np.inf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix</span> <span class="o">=</span> <span class="p">(</span><span class="n">cost_matrix_</span> <span class="o">-</span> <span class="n">false_val</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">true_val</span> <span class="o">-</span> <span class="n">false_val</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">cost_matrix</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">unsupervised_multicut_labeling</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">find_group_differences</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">list</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">group_items</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">encounter_lbls</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">list</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">group_items</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;diff = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">diff</span><span class="p">,))</span>
</pre></div>
</div>
<p>#gm, = ut.exec_func_src(vt.unsupervised_multicut_labeling,
#key_list=[‘gm’], sentinal=’inf = opengm’)
#parameter = opengm.InfParam()
#%timeit opengm.inference.Multicut(gm, parameter=parameter).infer()</p>
</div></blockquote>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">443284320</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">make_test_costmatrix</span><span class="p">(</span><span class="n">name_labels</span><span class="p">,</span> <span class="n">view_labels</span><span class="p">,</span> <span class="n">separation</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">is_same</span> <span class="o">=</span> <span class="n">name_labels</span> <span class="o">==</span> <span class="n">name_labels</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">is_comp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">view_labels</span> <span class="o">-</span> <span class="n">view_labels</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">good_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">is_same</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">bad_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">is_same</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">name_labels</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_labels</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span><span class="p">[</span><span class="n">good_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">good_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="n">separation</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span><span class="p">[</span><span class="n">bad_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bad_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">-</span> <span class="n">separation</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span> <span class="o">=</span> <span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">cost_matrix_</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">false_val</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">-</span> <span class="n">separation</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">true_val</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span> <span class="o">+</span> <span class="n">separation</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">diag_indices_from</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="p">)]</span> <span class="o">=</span> <span class="n">true_val</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix</span> <span class="o">=</span> <span class="p">(</span><span class="n">cost_matrix_</span> <span class="o">-</span> <span class="n">false_val</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">true_val</span> <span class="o">-</span> <span class="n">false_val</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">cost_matrix</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">is_comp</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">cost_matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#cost_matrix = make_test_costmatrix(name_labels, view_labels, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix</span> <span class="o">=</span> <span class="n">make_test_costmatrix</span><span class="p">(</span><span class="n">name_labels</span><span class="p">,</span> <span class="n">view_labels</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">multicut_value</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">name_labels</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">grid1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">name_labels</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">name_labels</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">isdiff</span> <span class="o">=</span> <span class="n">grid1</span><span class="o">.</span><span class="n">T</span> <span class="o">!=</span> <span class="n">grid1</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cut_value</span> <span class="o">=</span> <span class="n">cost_matrix</span><span class="p">[</span><span class="n">isdiff</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">cut_value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">name_labels</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">nx_from_matrix</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">floatfmt1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">map_vals</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;w=</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">floatfmt2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">map_vals</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;l=</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lens</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">map_vals</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">floatfmt1</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#labels = floatfmt2(lens)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span><span class="o">.</span><span class="n">set_edge_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#nx.set_edge_attributes(graph, name=&#39;len&#39;, values=lens)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;shape&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;ellipse&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encounter_lbls_str</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">name_labels</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node_name_lbls</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">encounter_lbls_str</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mcut_labels</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">unsupervised_multicut_labeling</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="n">vt</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">find_group_differences</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">list</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">group_items</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">name_labels</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">list</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">group_items</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">mcut_labels</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;diff = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">diff</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">node_name_lbls</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node_mcut_lbls</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">mcut_labels</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mcut_label&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">node_mcut_lbls</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mc_val(name) &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">multicut_value</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">name_labels</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mc_val(mcut) &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">multicut_value</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">mcut_labels</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">color_nodes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;mcut_label&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># remove noncomparable edges</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_comp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">view_labels</span> <span class="o">-</span> <span class="n">view_labels</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noncomp_edges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">is_comp</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="o">.</span><span class="n">remove_edges_from</span><span class="p">(</span><span class="n">noncomp_edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layoutkw</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;sep&#39;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;prog&#39;</span><span class="p">:</span> <span class="s1">&#39;neato&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;overlap&#39;</span><span class="p">:</span> <span class="s1">&#39;false&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;splines&#39;</span><span class="p">:</span> <span class="s1">&#39;spline&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_nx</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">layoutkw</span><span class="o">=</span><span class="n">layoutkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.confusion">
<span id="vtool-confusion-module"></span><h2>vtool.confusion module<a class="headerlink" href="#module-vtool.confusion" title="Permalink to this headline">¶</a></h2>
<p>Module for – Confusion matrix, contingency, error matrix,</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Confusion_matrix">http://en.wikipedia.org/wiki/Confusion_matrix</a></p>
<dl class="class">
<dt id="vtool.confusion.ConfusionMetrics">
<em class="property">class </em><code class="descclassname">vtool.confusion.</code><code class="descname">ConfusionMetrics</code><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ubelt.util_mixins.NiceRepr</span></code></p>
<p>Can compute average percision using the PASCAL definition</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://www.flinders.edu.au/science_engineering/fms/School-CSEM/publications/tech_reps-research_artfcts/TRRA_2007.pdf">http://www.flinders.edu.au/science_engineering/fms/School-CSEM/publications/tech_reps-research_artfcts/TRRA_2007.pdf</a>
<a class="reference external" href="http://www.alta.asn.au/events/altss_w2003_proc/altss/courses/powers/Bookmaker-all/200302-ICCS-Bookmaker.pdfcs">http://www.alta.asn.au/events/altss_w2003_proc/altss/courses/powers/Bookmaker-all/200302-ICCS-Bookmaker.pdfcs</a>
<a class="reference external" href="http://www.cs.bris.ac.uk/Publications/Papers/1000704.pdf">http://www.cs.bris.ac.uk/Publications/Papers/1000704.pdf</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Information_retrieval">http://en.wikipedia.org/wiki/Information_retrieval</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Precision_and_recall">http://en.wikipedia.org/wiki/Precision_and_recall</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Confusion_matrix">https://en.wikipedia.org/wiki/Confusion_matrix</a>
<a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_curve.html#sklearn.metrics.roc_curve">http://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_curve.html#sklearn.metrics.roc_curve</a></p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>sklearn.metrics.ranking._binary_clf_curve</dd>
</dl>
<p class="rubric">Notes</p>
<p>From oxford:
Precision is defined as the ratio of retrieved positive images to the</p>
<blockquote>
<div>total number retrieved.</div></blockquote>
<dl class="docutils">
<dt>Recall is defined as the ratio of the number of retrieved positive</dt>
<dd>images to the total number of positive images in the corpus.</dd>
<dt>Ignore:</dt>
<dd>varname_list = ‘tp, fp, fn, tn, fpr, tpr, tpa’.split(‘, ‘)
lines = [‘self.{varname} = {varname}’.format(varname=varname) for varname in varname_list]
print(ut.indent(‘n’.join(lines)))</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.confusion ConfusionMetrics –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">=</span> <span class="n">confusions</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">n_pos</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">n_tp</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">n_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">n_neg</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">n_tn</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">n_fp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">rp</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">rn</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">pp</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">pn</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">fpr</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">tnr</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">fnr</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">tpr</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tpr</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">tp</span> <span class="o">/</span> <span class="n">c</span><span class="o">.</span><span class="n">rp</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tpa</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">tp</span> <span class="o">/</span> <span class="n">c</span><span class="o">.</span><span class="n">pp</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">jacc</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">tp</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tp</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">fn</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">fp</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">mcc</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">mk</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="n">bm</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">c</span><span class="o">.</span><span class="n">acc</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tpr</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">fpr</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">c</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ppv</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">recall</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="n">prev</span> <span class="o">/</span> <span class="n">c</span><span class="o">.</span><span class="n">bias</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">c</span><span class="o">.</span><span class="n">wracc</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tpr</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">fpr</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span><span class="o">.</span><span class="n">draw_roc_curve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.acc">
<code class="descname">acc</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.acc" title="Permalink to this definition">¶</a></dt>
<dd><p>accuracy</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.aliases">
<code class="descname">aliases</code><em class="property"> = {'acc': {'accuracy', 'rand_accuracy', 'tea', 'ter'}, 'bm': {'bookmaker_informedness', &quot;deltaP'&quot;, 'informedness', 'r_R'}, 'cn': {'cost_neg'}, 'cp': {'cost_pos'}, 'cs': {'class_odds', 'skew'}, 'cv': {'cost_ratio'}, 'fn': {'false_neg', 'miss', 'type2_error'}, 'fnr': {'false_neg_rate', 'miss_rate'}, 'fp': {'false_alarm', 'false_pos', 'type1_error'}, 'fpr': {'fallout', 'false_pos_rate'}, 'jacc': {'jaccard_coefficient'}, 'mcc': {'matthews_correlation_coefficient'}, 'mk': {'deltaP', 'markedness', 'r_P'}, 'n_fn': {'n_false_neg', 'n_miss'}, 'n_fp': {'n_false_alarm', 'n_false_pos'}, 'n_tn': {'n_reject', 'n_true_neg'}, 'n_tp': {'n_hit', 'n_true_pos'}, 'pn': {'pred_neg'}, 'pp': {'bias', 'pred_pos'}, 'rn': {'real_neg'}, 'rp': {'prev', 'prevalence', 'real_pos'}, 'tn': {'reject', 'true_neg'}, 'tna': {'inv_precision', 'neg_predict_value', 'npv', 'true_neg_acc'}, 'tnr': {'inv_recall, specificity', 'true_neg_rate'}, 'tp': {'hit', 'true_pos'}, 'tpa': {'pos_predict_value', 'ppv', 'precision', 'true_pos_acc'}, 'tpr': {'hit_rate', 'recall', 'sensitivity', 'true_pos_rate'}, 'wracc': {'weighted_relative_accuracy'}}</em><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.aliases" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.auc">
<code class="descname">auc</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.auc" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>The AUC is a standard measure used to evaluate a binary classifier and</dt>
<dd>represents the probability that a random correct case will
receive a higher score than a random incorrect case.</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic#Area_under_the_curve">https://en.wikipedia.org/wiki/Receiver_operating_characteristic#Area_under_the_curve</a></p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.auc_trap">
<code class="descname">auc_trap</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.auc_trap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.bm">
<code class="descname">bm</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.bm" title="Permalink to this definition">¶</a></dt>
<dd><p>bookmaker informedness</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.c">
<code class="descname">c</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.cs">
<code class="descname">cs</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.cs" title="Permalink to this definition">¶</a></dt>
<dd><p>class ratio</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.cv">
<code class="descname">cv</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.cv" title="Permalink to this definition">¶</a></dt>
<dd><p>ratio of cost of making a mistake</p>
</dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.draw_precision_recall_curve">
<code class="descname">draw_precision_recall_curve</code><span class="sig-paren">(</span><em>nSamples=11</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.draw_precision_recall_curve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.draw_precision_recall_curve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.draw_roc_curve">
<code class="descname">draw_roc_curve</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.draw_roc_curve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.draw_roc_curve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>scores</em>, <em>labels</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.fn">
<code class="descname">fn</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.fn" title="Permalink to this definition">¶</a></dt>
<dd><p>false negative probability</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.fnr">
<code class="descname">fnr</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.fnr" title="Permalink to this definition">¶</a></dt>
<dd><p>miss rate, false negative rate</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.fp">
<code class="descname">fp</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.fp" title="Permalink to this definition">¶</a></dt>
<dd><p>false positive probability</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.fpr">
<code class="descname">fpr</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.fpr" title="Permalink to this definition">¶</a></dt>
<dd><p>fallout, false positive rate</p>
</dd></dl>

<dl class="classmethod">
<dt id="vtool.confusion.ConfusionMetrics.from_tp_and_tn_scores">
<em class="property">classmethod </em><code class="descname">from_tp_and_tn_scores</code><span class="sig-paren">(</span><em>tp_scores</em>, <em>tn_scores</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.from_tp_and_tn_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.from_tp_and_tn_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.get_ave_precision">
<code class="descname">get_ave_precision</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_ave_precision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_ave_precision" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.get_fpr_at_recall">
<code class="descname">get_fpr_at_recall</code><span class="sig-paren">(</span><em>target_recall</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_fpr_at_recall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_fpr_at_recall" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.get_index_at_metric">
<code class="descname">get_index_at_metric</code><span class="sig-paren">(</span><em>at_metric</em>, <em>at_value</em>, <em>subindex=False</em>, <em>tiebreaker='maxthresh'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_index_at_metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_index_at_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the index that is closet to the metric at a given value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tiebreaker</strong> (<em>str</em>) – either ‘minimize’ or ‘maximize’
if ‘maximize’, then a larger threshold is considered better
when resolving ambiguities. Otherwise a smaller thresh is
better.</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Doctest:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pat1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pat2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pat3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pat4</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pats</span> <span class="o">=</span> <span class="p">[</span><span class="n">pat1</span><span class="p">,</span> <span class="n">pat2</span><span class="p">,</span> <span class="n">pat3</span><span class="p">,</span> <span class="n">pat4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">itertools</span> <span class="k">as</span> <span class="nn">it</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create places of ambiguitiy and unambiguity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">flatten</span><span class="p">([[</span><span class="nb">next</span><span class="p">(</span><span class="n">s</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">pat</span><span class="p">)</span> <span class="k">for</span> <span class="n">pat</span> <span class="ow">in</span> <span class="n">pats</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">flatten</span><span class="p">([</span><span class="n">pat</span> <span class="k">for</span> <span class="n">pat</span> <span class="ow">in</span> <span class="n">pats</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">at_metric</span> <span class="o">=</span> <span class="s1">&#39;n_false_pos&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">at_value</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subindex</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index_at_metric</span><span class="p">(</span><span class="n">at_metric</span><span class="p">,</span> <span class="n">at_value</span><span class="p">,</span> <span class="n">subindex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tiebreaker</span><span class="o">=</span><span class="s1">&#39;minthresh&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index_at_metric</span><span class="p">(</span><span class="n">at_metric</span><span class="p">,</span> <span class="n">at_value</span><span class="p">,</span> <span class="n">subindex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tiebreaker</span><span class="o">=</span> <span class="s1">&#39;maxthresh&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">idx1</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">idx2</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.get_metric_at_index">
<code class="descname">get_metric_at_index</code><span class="sig-paren">(</span><em>metric</em>, <em>subindex</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_metric_at_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_metric_at_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.get_metric_at_metric">
<code class="descname">get_metric_at_metric</code><span class="sig-paren">(</span><em>get_metric</em>, <em>at_metric</em>, <em>at_value</em>, <em>subindex=False</em>, <em>tiebreaker='maxthresh'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_metric_at_metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_metric_at_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the corresponding value of <cite>get_metric</cite> at a specific value of
<cite>at_metric</cite>.</p>
<p>get_metric = ‘fpr’
at_metric = ‘tpr’
at_value = .25
self.rrr()</p>
<p>self.get_metric_at_metric(‘fpr’, ‘tpr’, .25)
self.get_metric_at_metric(‘n_false_pos’, ‘tpr’, .25)
self.get_metric_at_metric(‘n_true_pos’, ‘tpr’, .25)</p>
<p>get_metric = ‘n_true_pos’
at_metric = ‘n_false_pos’
at_value = 0
subindex = False</p>
</dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.get_metric_at_thresh">
<code class="descname">get_metric_at_thresh</code><span class="sig-paren">(</span><em>metric</em>, <em>thresh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_metric_at_thresh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_metric_at_thresh" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>metric</strong> (<em>str</em>) – name of a metric</li>
<li><strong>thresh</strong> (<em>float</em>) – desired threshold</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">value - metric value</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.confusion –exec-get_metric_at_threshold</dd>
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">cfms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;fpr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;tpr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metric_at_thresh</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(None, None) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">((</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.get_recall_at_fpr">
<code class="descname">get_recall_at_fpr</code><span class="sig-paren">(</span><em>target_fpr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_recall_at_fpr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_recall_at_fpr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.get_thresh_at_metric">
<code class="descname">get_thresh_at_metric</code><span class="sig-paren">(</span><em>metric</em>, <em>value</em>, <em>maximize=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_thresh_at_metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_thresh_at_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets a threshold for a binary classifier using a target metric and value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>metric</strong> (<em>str</em>) – name of metric like tpr or fpr</li>
<li><strong>value</strong> (<em>float</em>) – corresponding numeric value</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">thresh</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.confusion get_thresh_at_metric
python -m vtool.confusion –exec-interact_roc_factory –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;tpr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="o">.</span><span class="mi">85</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_thresh_at_metric</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">value</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;thresh = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">thresh</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">thresh = 22.5</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd>metric = ‘fpr’
value = 1e-4
self = cfms
maximize = False</dd>
</dl>
<p>interpolate_replbounds(metric_values, self.thresholds, 0, maximize=maximize)
interpolate_replbounds(metric_values, self.thresholds, 1e-4, maximize=maximize)
interpolate_replbounds(metric_values, self.thresholds, 1e-3, maximize=maximize)
interpolate_replbounds(metric_values, self.thresholds, 1e-2, maximize=maximize)
interpolate_replbounds(metric_values, self.thresholds, 1e-2, maximize=maximize)</p>
</dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.get_thresh_at_metric_max">
<code class="descname">get_thresh_at_metric_max</code><span class="sig-paren">(</span><em>metric</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_thresh_at_metric_max"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_thresh_at_metric_max" title="Permalink to this definition">¶</a></dt>
<dd><p>metric = ‘mcc’
metric = ‘fnr’</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.inv_aliases">
<code class="descname">inv_aliases</code><em class="property"> = {'acc': 'acc', 'accuracy': 'acc', 'bias': 'pp', 'bm': 'bm', 'bookmaker_informedness': 'bm', 'class_odds': 'cs', 'cn': 'cn', 'cost_neg': 'cn', 'cost_pos': 'cp', 'cost_ratio': 'cv', 'cp': 'cp', 'cs': 'cs', 'cv': 'cv', 'deltaP': 'mk', &quot;deltaP'&quot;: 'bm', 'fallout': 'fpr', 'false_alarm': 'fp', 'false_neg': 'fn', 'false_neg_rate': 'fnr', 'false_pos': 'fp', 'false_pos_rate': 'fpr', 'fn': 'fn', 'fnr': 'fnr', 'fp': 'fp', 'fpr': 'fpr', 'hit': 'tp', 'hit_rate': 'tpr', 'informedness': 'bm', 'inv_precision': 'tna', 'inv_recall, specificity': 'tnr', 'jacc': 'jacc', 'jaccard_coefficient': 'jacc', 'markedness': 'mk', 'matthews_correlation_coefficient': 'mcc', 'mcc': 'mcc', 'miss': 'fn', 'miss_rate': 'fnr', 'mk': 'mk', 'n_false_alarm': 'n_fp', 'n_false_neg': 'n_fn', 'n_false_pos': 'n_fp', 'n_fn': 'n_fn', 'n_fp': 'n_fp', 'n_hit': 'n_tp', 'n_miss': 'n_fn', 'n_reject': 'n_tn', 'n_tn': 'n_tn', 'n_tp': 'n_tp', 'n_true_neg': 'n_tn', 'n_true_pos': 'n_tp', 'neg_predict_value': 'tna', 'npv': 'tna', 'pn': 'pn', 'pos_predict_value': 'tpa', 'pp': 'pp', 'ppv': 'tpa', 'precision': 'tpa', 'pred_neg': 'pn', 'pred_pos': 'pp', 'prev': 'rp', 'prevalence': 'rp', 'r_P': 'mk', 'r_R': 'bm', 'rand_accuracy': 'acc', 'real_neg': 'rn', 'real_pos': 'rp', 'recall': 'tpr', 'reject': 'tn', 'rn': 'rn', 'rp': 'rp', 'sensitivity': 'tpr', 'skew': 'cs', 'tea': 'acc', 'ter': 'acc', 'tn': 'tn', 'tna': 'tna', 'tnr': 'tnr', 'tp': 'tp', 'tpa': 'tpa', 'tpr': 'tpr', 'true_neg': 'tn', 'true_neg_acc': 'tna', 'true_neg_rate': 'tnr', 'true_pos': 'tp', 'true_pos_acc': 'tpa', 'true_pos_rate': 'tpr', 'type1_error': 'fp', 'type2_error': 'fn', 'weighted_relative_accuracy': 'wracc', 'wracc': 'wracc'}</em><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.inv_aliases" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.jacc">
<code class="descname">jacc</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.jacc" title="Permalink to this definition">¶</a></dt>
<dd><p>jaccard coefficient</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.mcc">
<code class="descname">mcc</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.mcc" title="Permalink to this definition">¶</a></dt>
<dd><p>matthews correlation coefficient</p>
<dl class="docutils">
<dt>Also true that:</dt>
<dd>mcc == np.sqrt(self.bm * self.mk)</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.minimizing_metrics">
<code class="descname">minimizing_metrics</code><em class="property"> = {'fn', 'fnr', 'fp', 'fpr'}</em><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.minimizing_metrics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.mk">
<code class="descname">mk</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.mk" title="Permalink to this definition">¶</a></dt>
<dd><p>markedness</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.paper_alias">
<code class="descname">paper_alias</code><em class="property"> = [['dtp', 'determinant'], ['lr', 'liklihood-ratio'], ['nlr', 'negative-liklihood-ratio'], ['bmg', 'bookmarkG', 'bookmark_geometric_mean', 'mcc?'], ['evenness_R', 'PrevG2'], ['evenness_P', 'BiasG2'], ['rh', 'real_harmonic_mean'], ['ph', 'pred_harminic_mean']]</em><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.paper_alias" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.paper_relations">
<code class="descname">paper_relations</code><em class="property"> = {'BMG': ['dtp / evenness_G'], 'BiasG2': ['bias * 1 - bias'], 'IBias': ['1 - Bias'], 'N': ['A + B + C + D'], 'bm': ['dtp / (prev * (1 - prev))'], 'deltap': ['dtp - dtn', '2 * dp'], 'dp': ['tp - etp', 'dtp', '-dtn', '-(tn - etn)'], 'dtp': ['A * D - B * C'], 'etn': ['rn * pn', 'expected_true_negatives'], 'etp': ['rp * pp', 'expected_true_positives'], 'kappa': ['deltap / (deltap + (fp + fn) / 2)'], 'lr': ['tpr / (1 - tnr)'], 'mk': ['dtp / (bias * (1 - bias))', 'dtp / biasG ** 2'], 'nlr': ['tnr / (1 - tpr)'], 'ph': ['2 * pp * pn / (pp + pn)', 'pred_harminic_mean'], 'rh': ['2 * rp * rn / (rp + rn)', 'real_harmonic_mean']}</em><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.paper_relations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.plot_metrics">
<code class="descname">plot_metrics</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.plot_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.plot_metrics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.plot_vs">
<code class="descname">plot_vs</code><span class="sig-paren">(</span><em>x_metric</em>, <em>y_metric</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.plot_vs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.plot_vs" title="Permalink to this definition">¶</a></dt>
<dd><p>x_metric = ‘thresholds’
y_metric = ‘fpr’</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.pn">
<code class="descname">pn</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.pn" title="Permalink to this definition">¶</a></dt>
<dd><p>predicted negative probability</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.pp">
<code class="descname">pp</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.pp" title="Permalink to this definition">¶</a></dt>
<dd><p>predicted positive probability</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.rn">
<code class="descname">rn</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.rn" title="Permalink to this definition">¶</a></dt>
<dd><p>real negative probability</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.rp">
<code class="descname">rp</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.rp" title="Permalink to this definition">¶</a></dt>
<dd><p>real positive probability</p>
</dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.show_mcc">
<code class="descname">show_mcc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.show_mcc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.show_mcc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.sqrd_error">
<code class="descname">sqrd_error</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.sqrd_error" title="Permalink to this definition">¶</a></dt>
<dd><p>squared error</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.thresh">
<code class="descname">thresh</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.thresh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.tn">
<code class="descname">tn</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.tn" title="Permalink to this definition">¶</a></dt>
<dd><p>true negative probability</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.tna">
<code class="descname">tna</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.tna" title="Permalink to this definition">¶</a></dt>
<dd><p>negative predictive value, inverse precision</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.tnr">
<code class="descname">tnr</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.tnr" title="Permalink to this definition">¶</a></dt>
<dd><p>true negative rate, inverse recall</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.tp">
<code class="descname">tp</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.tp" title="Permalink to this definition">¶</a></dt>
<dd><p>true positive probability</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.tpa">
<code class="descname">tpa</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.tpa" title="Permalink to this definition">¶</a></dt>
<dd><p>miss rate, false negative rate</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.tpr">
<code class="descname">tpr</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.tpr" title="Permalink to this definition">¶</a></dt>
<dd><p>sensitivity, recall, hit rate, tpr</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.wracc">
<code class="descname">wracc</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.wracc" title="Permalink to this definition">¶</a></dt>
<dd><p>weighted relative accuracy</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="vtool.confusion.draw_precision_recall_curve">
<code class="descclassname">vtool.confusion.</code><code class="descname">draw_precision_recall_curve</code><span class="sig-paren">(</span><em>recall_domain</em>, <em>p_interp</em>, <em>title_pref=None</em>, <em>fnum=1</em>, <em>pnum=None</em>, <em>color=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#draw_precision_recall_curve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.draw_precision_recall_curve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.confusion.draw_roc_curve">
<code class="descclassname">vtool.confusion.</code><code class="descname">draw_roc_curve</code><span class="sig-paren">(</span><em>fpr</em>, <em>tpr</em>, <em>fnum=None</em>, <em>pnum=None</em>, <em>marker=''</em>, <em>target_tpr=None</em>, <em>target_fpr=None</em>, <em>thresholds=None</em>, <em>color=None</em>, <em>name=None</em>, <em>label=None</em>, <em>show_operating_point=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#draw_roc_curve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.draw_roc_curve" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fpr</strong> – </li>
<li><strong>tpr</strong> – </li>
<li><strong>fnum</strong> (<em>int</em>) – figure number(default = None)</li>
<li><strong>pnum</strong> (<em>tuple</em>) – plot number(default = None)</li>
<li><strong>marker</strong> (<em>str</em>) – (default = ‘-x’)</li>
<li><strong>target_tpr</strong> (<em>None</em>) – (default = None)</li>
<li><strong>target_fpr</strong> (<em>None</em>) – (default = None)</li>
<li><strong>thresholds</strong> (<em>None</em>) – (default = None)</li>
<li><strong>color</strong> (<em>None</em>) – (default = None)</li>
<li><strong>show_operating_point</strong> (<em>bool</em>) – (default = False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.confusion –exec-draw_roc_curve –show –lightbg</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpr</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">fpr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tpr</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">tpr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresholds</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">thresholds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fnum</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pnum</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_tpr</span> <span class="o">=</span> <span class="o">.</span><span class="mi">85</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_fpr</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_operating_point</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_roc_curve</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">target_tpr</span><span class="p">,</span> <span class="n">target_fpr</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">thresholds</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">show_operating_point</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.confusion.interact_roc_factory">
<code class="descclassname">vtool.confusion.</code><code class="descname">interact_roc_factory</code><span class="sig-paren">(</span><em>confusions</em>, <em>target_tpr=None</em>, <em>show_operating_point=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#interact_roc_factory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.interact_roc_factory" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>confusions</strong> (<em>Confusions</em>) – </td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.confusion –exec-interact_roc_factory –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;scores = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">make_csv_table</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="p">[</span><span class="n">confusions</span><span class="o">.</span><span class="n">fpr</span><span class="p">,</span> <span class="n">confusions</span><span class="o">.</span><span class="n">tpr</span><span class="p">,</span> <span class="n">confusions</span><span class="o">.</span><span class="n">thresholds</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="p">[</span><span class="s1">&#39;fpr&#39;</span><span class="p">,</span> <span class="s1">&#39;tpr&#39;</span><span class="p">,</span> <span class="s1">&#39;thresh&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ROCInteraction</span> <span class="o">=</span> <span class="n">interact_roc_factory</span><span class="p">(</span><span class="n">confusions</span><span class="p">,</span> <span class="n">target_tpr</span><span class="o">=.</span><span class="mi">4</span><span class="p">,</span> <span class="n">show_operating_point</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">ROCInteraction</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span><span class="o">.</span><span class="n">show_page</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.confusion.interpolate_precision_recall">
<code class="descclassname">vtool.confusion.</code><code class="descname">interpolate_precision_recall</code><span class="sig-paren">(</span><em>precision</em>, <em>recall</em>, <em>nSamples=11</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#interpolate_precision_recall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.interpolate_precision_recall" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates precision as a function of recall p_{interp}(r)</p>
<p>Reduce wiggles in average precision curve by taking interpolated values
along a uniform sample.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Information_retrieval#Average_precision">http://en.wikipedia.org/wiki/Information_retrieval#Average_precision</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Information_retrieval#Mean_Average_precision">http://en.wikipedia.org/wiki/Information_retrieval#Mean_Average_precision</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.confusion –test-interpolate_precision_recall –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nSamples</span> <span class="o">=</span> <span class="mi">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">precision</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">precision</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recall</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">recall</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recall_domain</span><span class="p">,</span> <span class="n">p_interp</span> <span class="o">=</span> <span class="n">interpolate_precision_recall</span><span class="p">(</span><span class="n">confusions</span><span class="o">.</span><span class="n">precision</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">nSamples</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">p_interp</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_precision_recall_curve</span><span class="p">(</span><span class="n">recall_domain</span><span class="p">,</span> <span class="n">p_interp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([ 1. ,  1. ,  1. ,  1. ,  1. ,  1. ,  1. ,  0.9,  0.9,  0.8,  0.6], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.confusion.interpolate_replbounds">
<code class="descclassname">vtool.confusion.</code><code class="descname">interpolate_replbounds</code><span class="sig-paren">(</span><em>xdata</em>, <em>ydata</em>, <em>pt</em>, <em>maximize=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#interpolate_replbounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.interpolate_replbounds" title="Permalink to this definition">¶</a></dt>
<dd><p>xdata = np.array([.1, .2, .3, .4, .5])
ydata = np.array([.1, .2, .3, .4, .5])
pt = .35</p>
<dl class="docutils">
<dt>FIXME:</dt>
<dd>if duplicate xdata is given bad things happen.</dd>
<dt>BUG:</dt>
<dd>in scipy.interpolate.interp1d
If there is a duplicate xdata, then assume_sorted=False will
sort ydata by xdata, but xdata should retain its initial ordering
in places of ambuguity. Currently it does not.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xdata</strong> (<em>ndarray</em>) – </li>
<li><strong>ydata</strong> (<em>ndarray</em>) – </li>
<li><strong>pt</strong> (<em>ndarray</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">interp_vals</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.confusion –exec-interpolate_replbounds</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tpr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#xdata = self.fpr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#ydata = self.thresholds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt = 0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="n">interpolate_replbounds</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">maximize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;thresh = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">thresh</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="n">interpolate_replbounds</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">maximize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;thresh = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">thresh</span><span class="p">,))</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.7</span><span class="p">,</span>  <span class="mf">0.8</span><span class="p">,</span>  <span class="mf">0.8</span><span class="p">,</span>  <span class="mf">0.9</span><span class="p">,</span>  <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">34</span><span class="p">,</span>    <span class="mi">26</span><span class="p">,</span>   <span class="mi">23</span><span class="p">,</span>   <span class="mi">22</span><span class="p">,</span>   <span class="mi">19</span><span class="p">,</span>  <span class="mi">17</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">85</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interp_vals</span> <span class="o">=</span> <span class="n">interpolate_replbounds</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;interp_vals = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">interp_vals</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">interp_vals = [ 22.5  17.   34. ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.confusion.nan_to_num">
<code class="descclassname">vtool.confusion.</code><code class="descname">nan_to_num</code><span class="sig-paren">(</span><em>arr</em>, <em>num</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#nan_to_num"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.nan_to_num" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.confusion.testdata_scores_labels">
<code class="descclassname">vtool.confusion.</code><code class="descname">testdata_scores_labels</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#testdata_scores_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.testdata_scores_labels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.coverage_grid">
<span id="vtool-coverage-grid-module"></span><h2>vtool.coverage_grid module<a class="headerlink" href="#module-vtool.coverage_grid" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.coverage_grid.compute_subbin_to_bins_dist">
<code class="descclassname">vtool.coverage_grid.</code><code class="descname">compute_subbin_to_bins_dist</code><span class="sig-paren">(</span><em>neighbor_bin_centers</em>, <em>subbin_xy_arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#compute_subbin_to_bins_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.compute_subbin_to_bins_dist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.get_coverage_grid_gridsearch_configs">
<code class="descclassname">vtool.coverage_grid.</code><code class="descname">get_coverage_grid_gridsearch_configs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#get_coverage_grid_gridsearch_configs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.get_coverage_grid_gridsearch_configs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.get_subbin_xy_neighbors">
<code class="descclassname">vtool.coverage_grid.</code><code class="descname">get_subbin_xy_neighbors</code><span class="sig-paren">(</span><em>subbin_index00</em>, <em>grid_steps</em>, <em>num_cols</em>, <em>num_rows</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#get_subbin_xy_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.get_subbin_xy_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate all neighbor of a bin
subbin_index00 = left and up subbin index</p>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.gridsearch_coverage_grid">
<code class="descclassname">vtool.coverage_grid.</code><code class="descname">gridsearch_coverage_grid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#gridsearch_coverage_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.gridsearch_coverage_grid" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.coverage_grid –test-gridsearch_coverage_grid –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_grid</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_coverage_grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.gridsearch_coverage_grid_mask">
<code class="descclassname">vtool.coverage_grid.</code><code class="descname">gridsearch_coverage_grid_mask</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#gridsearch_coverage_grid_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.gridsearch_coverage_grid_mask" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.coverage_grid –test-gridsearch_coverage_grid_mask –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_grid</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_coverage_grid_mask</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.make_grid_coverage_mask">
<code class="descclassname">vtool.coverage_grid.</code><code class="descname">make_grid_coverage_mask</code><span class="sig-paren">(</span><em>kpts</em>, <em>chipsize</em>, <em>weights</em>, <em>pxl_per_bin=4</em>, <em>grid_steps=1</em>, <em>resize=False</em>, <em>out=None</em>, <em>grid_sigma=1.6</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#make_grid_coverage_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.make_grid_coverage_mask" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoint</li>
<li><strong>chipsize</strong> (<em>tuple</em>) – width, height</li>
<li><strong>weights</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=1</em><em>]</em>) – </li>
<li><strong>pxl_per_bin</strong> (<em>float</em>) – </li>
<li><strong>grid_steps</strong> (<em>int</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">weightgrid</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.coverage_grid –test-make_grid_coverage_mask –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_grid</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">coverage_kpts</span><span class="o">.</span><span class="n">testdata_coverage</span><span class="p">(</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pxl_per_bin</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid_steps</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weightgrid</span> <span class="o">=</span> <span class="n">make_grid_coverage_mask</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">pxl_per_bin</span><span class="p">,</span> <span class="n">grid_steps</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify result</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">weightgrid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">weightgrid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.show_coverage_grid">
<code class="descclassname">vtool.coverage_grid.</code><code class="descname">show_coverage_grid</code><span class="sig-paren">(</span><em>num_rows</em>, <em>num_cols</em>, <em>subbin_xy_arr</em>, <em>neighbor_bin_centers</em>, <em>neighbor_bin_weights</em>, <em>neighbor_bin_indices</em>, <em>fnum=None</em>, <em>pnum=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#show_coverage_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.show_coverage_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>visualizes the voting scheme on the grid. (not a mask, and no max)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.sparse_grid_coverage">
<code class="descclassname">vtool.coverage_grid.</code><code class="descname">sparse_grid_coverage</code><span class="sig-paren">(</span><em>kpts</em>, <em>chipsize</em>, <em>weights</em>, <em>pxl_per_bin=0.3</em>, <em>grid_steps=1</em>, <em>grid_sigma=1.6</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#sparse_grid_coverage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.sparse_grid_coverage" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoint</li>
<li><strong>chipsize</strong> (<em>tuple</em>) – </li>
<li><strong>weights</strong> (<em>ndarray</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.coverage_grid –test-sparse_grid_coverage –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_grid</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">coverage_kpts</span><span class="o">.</span><span class="n">testdata_coverage</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">chipsize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">50</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pxl_per_bin</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid_steps</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid_sigma</span> <span class="o">=</span> <span class="mf">1.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coverage_gridtup</span> <span class="o">=</span> <span class="n">sparse_grid_coverage</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">pxl_per_bin</span><span class="p">,</span> <span class="n">grid_steps</span><span class="p">,</span> <span class="n">grid_sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_coverage_grid</span><span class="p">(</span><span class="o">*</span><span class="n">coverage_gridtup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.weighted_gaussian_falloff">
<code class="descclassname">vtool.coverage_grid.</code><code class="descname">weighted_gaussian_falloff</code><span class="sig-paren">(</span><em>neighbor_subbin_sqrddist_arr</em>, <em>weights</em>, <em>grid_sigma</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#weighted_gaussian_falloff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.weighted_gaussian_falloff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.coverage_kpts">
<span id="vtool-coverage-kpts-module"></span><h2>vtool.coverage_kpts module<a class="headerlink" href="#module-vtool.coverage_kpts" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.coverage_kpts.get_coverage_kpts_gridsearch_configs">
<code class="descclassname">vtool.coverage_kpts.</code><code class="descname">get_coverage_kpts_gridsearch_configs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#get_coverage_kpts_gridsearch_configs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.get_coverage_kpts_gridsearch_configs" title="Permalink to this definition">¶</a></dt>
<dd><p>testing function</p>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.get_gaussian_weight_patch">
<code class="descclassname">vtool.coverage_kpts.</code><code class="descname">get_gaussian_weight_patch</code><span class="sig-paren">(</span><em>gauss_shape=(19</em>, <em>19)</em>, <em>gauss_sigma_frac=0.3</em>, <em>gauss_norm_01=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#get_gaussian_weight_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.get_gaussian_weight_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>2d gaussian image useful for plotting</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">patch</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.coverage_kpts –test-get_gaussian_weight_patch</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">get_gaussian_weight_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">patch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.gridsearch_kpts_coverage_mask">
<code class="descclassname">vtool.coverage_kpts.</code><code class="descname">gridsearch_kpts_coverage_mask</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#gridsearch_kpts_coverage_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.gridsearch_kpts_coverage_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>testing function</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.coverage_kpts –test-gridsearch_kpts_coverage_mask –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_kpts_coverage_mask</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.make_heatmask">
<code class="descclassname">vtool.coverage_kpts.</code><code class="descname">make_heatmask</code><span class="sig-paren">(</span><em>mask</em>, <em>cmap='plasma'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#make_heatmask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.make_heatmask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.make_kpts_coverage_mask">
<code class="descclassname">vtool.coverage_kpts.</code><code class="descname">make_kpts_coverage_mask</code><span class="sig-paren">(</span><em>kpts</em>, <em>chipsize</em>, <em>weights=None</em>, <em>return_patch=False</em>, <em>patch=None</em>, <em>resize=False</em>, <em>out=None</em>, <em>cov_blur_on=True</em>, <em>cov_disk_hack=None</em>, <em>cov_blur_ksize=(17</em>, <em>17)</em>, <em>cov_blur_sigma=5.0</em>, <em>cov_gauss_shape=(19</em>, <em>19)</em>, <em>cov_gauss_sigma_frac=0.3</em>, <em>cov_scale_factor=0.2</em>, <em>cov_agg_mode='max'</em>, <em>cov_remove_shape=False</em>, <em>cov_remove_scale=False</em>, <em>cov_size_penalty_on=True</em>, <em>cov_size_penalty_power=0.5</em>, <em>cov_size_penalty_frac=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#make_kpts_coverage_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.make_kpts_coverage_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a intensity image denoting which pixels are covered by the input
keypoints</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em><em>[</em><em>ndims=2</em><em>]</em>) – keypoints</li>
<li><strong>chipsize</strong> (<em>tuple</em>) – width height of the underlying image</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dstimg, patch</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple (ndarray, ndarray)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:plottool)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyhesaff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyhesaff</span><span class="o">.</span><span class="n">detect_feats</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[::</span><span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipsize</span> <span class="o">=</span> <span class="n">chip</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dstimg</span><span class="p">,</span> <span class="n">patch</span> <span class="o">=</span> <span class="n">make_kpts_coverage_mask</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_patch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cov_size_penalty_on</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cov_blur_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># show results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">dstimg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_coverage_map</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">patch</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.make_kpts_heatmask">
<code class="descclassname">vtool.coverage_kpts.</code><code class="descname">make_kpts_heatmask</code><span class="sig-paren">(</span><em>kpts</em>, <em>chipsize</em>, <em>cmap='plasma'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#make_kpts_heatmask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.make_kpts_heatmask" title="Permalink to this definition">¶</a></dt>
<dd><p>makes a heatmap overlay for keypoints</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.coverage_kpts make_kpts_heatmask –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:plottool)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyhesaff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyhesaff</span><span class="o">.</span><span class="n">detect_feats</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipsize</span> <span class="o">=</span> <span class="n">chip</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">heatmask</span> <span class="o">=</span> <span class="n">make_kpts_heatmask</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">heatmask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">chip</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">qtensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img3</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">overlay_alpha_images</span><span class="p">(</span><span class="n">heatmask</span><span class="p">,</span> <span class="n">chip</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.imshow(heatmask)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_kpts2(kpts)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.show_coverage_map">
<code class="descclassname">vtool.coverage_kpts.</code><code class="descname">show_coverage_map</code><span class="sig-paren">(</span><em>chip</em>, <em>mask</em>, <em>patch</em>, <em>kpts</em>, <em>fnum=None</em>, <em>ell_alpha=0.6</em>, <em>show_mask_kpts=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#show_coverage_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.show_coverage_map" title="Permalink to this definition">¶</a></dt>
<dd><p>testing function</p>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.testdata_coverage">
<code class="descclassname">vtool.coverage_kpts.</code><code class="descname">testdata_coverage</code><span class="sig-paren">(</span><em>fname=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#testdata_coverage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.testdata_coverage" title="Permalink to this definition">¶</a></dt>
<dd><p>testing function</p>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.warp_patch_onto_kpts">
<code class="descclassname">vtool.coverage_kpts.</code><code class="descname">warp_patch_onto_kpts</code><span class="sig-paren">(</span><em>kpts</em>, <em>patch</em>, <em>chipshape</em>, <em>weights=None</em>, <em>out=None</em>, <em>cov_scale_factor=0.2</em>, <em>cov_agg_mode='max'</em>, <em>cov_remove_shape=False</em>, <em>cov_remove_scale=False</em>, <em>cov_size_penalty_on=True</em>, <em>cov_size_penalty_power=0.5</em>, <em>cov_size_penalty_frac=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#warp_patch_onto_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.warp_patch_onto_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Overlays the source image onto a destination image in each keypoint location</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>patch</strong> (<em>ndarray</em>) – patch to warp (like gaussian)</li>
<li><strong>chipshape</strong> (<em>tuple</em>) – </li>
<li><strong>weights</strong> (<em>ndarray</em>) – score for every keypoint</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd>cov_scale_factor (float):</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mask</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.coverage_kpts –test-warp_patch_onto_kpts
python -m vtool.coverage_kpts –test-warp_patch_onto_kpts –show
python -m vtool.coverage_kpts –test-warp_patch_onto_kpts –show –hole
python -m vtool.coverage_kpts –test-warp_patch_onto_kpts –show –square
python -m vtool.coverage_kpts –test-warp_patch_onto_kpts –show –square –hole</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyhesaff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span>    <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyhesaff</span><span class="o">.</span><span class="n">detect_feats</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[::</span><span class="mi">15</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipshape</span> <span class="o">=</span> <span class="n">chip</span><span class="o">.</span><span class="n">shape</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cov_scale_factor</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">srcshape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius</span> <span class="o">=</span> <span class="n">srcshape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="n">radius</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SQUARE</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">argflag</span><span class="p">(</span><span class="s1">&#39;--square&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">HOLE</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">argflag</span><span class="p">(</span><span class="s1">&#39;--hole&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">SQUARE</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">patch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">srcshape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">patch</span> <span class="o">=</span> <span class="n">ptool</span><span class="o">.</span><span class="n">gaussian_patch</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">srcshape</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span> <span class="c1">#, norm_01=False)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">patch</span> <span class="o">=</span> <span class="n">patch</span> <span class="o">/</span> <span class="n">patch</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">HOLE</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">patch</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">patch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">patch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dstimg</span> <span class="o">=</span> <span class="n">warp_patch_onto_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">patch</span><span class="p">,</span> <span class="n">chipshape</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">cov_scale_factor</span><span class="o">=</span><span class="n">cov_scale_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dstimg stats </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_stats_str</span><span class="p">(</span><span class="n">dstimg</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;patch stats </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_stats_str</span><span class="p">(</span><span class="n">patch</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print(patch.sum())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">inbounds</span><span class="p">(</span><span class="n">dstimg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">eq</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># show results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">dstimg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_coverage_map</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">patch</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.warped_patch_generator">
<code class="descclassname">vtool.coverage_kpts.</code><code class="descname">warped_patch_generator</code><span class="sig-paren">(</span><em>patch</em>, <em>dsize</em>, <em>affmat_list</em>, <em>weight_list</em>, <em>cov_size_penalty_on=True</em>, <em>cov_size_penalty_power=0.5</em>, <em>cov_size_penalty_frac=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#warped_patch_generator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.warped_patch_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>generator that warps the patches (like gaussian) onto an image with dsize
using constant memory.</p>
<p>output must be used or copied on every iteration otherwise the next output
will clobber the previous</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html#warpaffine">http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html#warpaffine</a></p>
</dd></dl>

</div>
<div class="section" id="module-vtool.demodata">
<span id="vtool-demodata-module"></span><h2>vtool.demodata module<a class="headerlink" href="#module-vtool.demodata" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.demodata.dummy_img">
<code class="descclassname">vtool.demodata.</code><code class="descname">dummy_img</code><span class="sig-paren">(</span><em>w</em>, <em>h</em>, <em>intensity=200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#dummy_img"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.dummy_img" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a demodata test image</p>
</dd></dl>

<dl class="function">
<dt id="vtool.demodata.dummy_seed">
<code class="descclassname">vtool.demodata.</code><code class="descname">dummy_seed</code><span class="sig-paren">(</span><em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#dummy_seed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.dummy_seed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.demodata.force_kpts_feasibility">
<code class="descclassname">vtool.demodata.</code><code class="descname">force_kpts_feasibility</code><span class="sig-paren">(</span><em>kpts</em>, <em>xys_nonneg=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#force_kpts_feasibility"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.force_kpts_feasibility" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.demodata.get_dummy_dpts">
<code class="descclassname">vtool.demodata.</code><code class="descname">get_dummy_dpts</code><span class="sig-paren">(</span><em>num</em>, <em>dtype=&lt;class 'numpy.uint8'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_dpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.get_dummy_dpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Random SIFTish keypoints</p>
</dd></dl>

<dl class="function">
<dt id="vtool.demodata.get_dummy_invV_mats">
<code class="descclassname">vtool.demodata.</code><code class="descname">get_dummy_invV_mats</code><span class="sig-paren">(</span><em>dtype=&lt;class 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_invV_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.get_dummy_invV_mats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.demodata.get_dummy_kpts">
<code class="descclassname">vtool.demodata.</code><code class="descname">get_dummy_kpts</code><span class="sig-paren">(</span><em>num=1</em>, <em>dtype=&lt;class 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.get_dummy_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Some testing data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>num</strong> (<em>int</em>) – number of times to duplicate</li>
<li><strong>dtype</strong> (<em>type</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">kpts -  keypoints</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[float32_t, ndim=2][ndims=2]</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/demodata.py get_dummy_kpts</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">get_dummy_kpts</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.demodata.get_dummy_kpts_pair">
<code class="descclassname">vtool.demodata.</code><code class="descname">get_dummy_kpts_pair</code><span class="sig-paren">(</span><em>wh_stride=(30</em>, <em>30)</em>, <em>wh_num=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_kpts_pair"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.get_dummy_kpts_pair" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.demodata.get_dummy_matching_kpts">
<code class="descclassname">vtool.demodata.</code><code class="descname">get_dummy_matching_kpts</code><span class="sig-paren">(</span><em>dtype=&lt;class 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_matching_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.get_dummy_matching_kpts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.demodata.get_dummy_xy">
<code class="descclassname">vtool.demodata.</code><code class="descname">get_dummy_xy</code><span class="sig-paren">(</span><em>seed=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_xy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.get_dummy_xy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.demodata.get_kpts_dummy_img">
<code class="descclassname">vtool.demodata.</code><code class="descname">get_kpts_dummy_img</code><span class="sig-paren">(</span><em>kpts</em>, <em>sf=1.0</em>, <em>intensity=200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_kpts_dummy_img"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.get_kpts_dummy_img" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>sf</strong> (<em>float</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">img</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sf</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span>  <span class="n">get_kpts_dummy_img</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">sf</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.demodata.get_testdata_kpts">
<code class="descclassname">vtool.demodata.</code><code class="descname">get_testdata_kpts</code><span class="sig-paren">(</span><em>fname=None</em>, <em>with_vecs=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_testdata_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.get_testdata_kpts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.demodata.make_dummy_fm">
<code class="descclassname">vtool.demodata.</code><code class="descname">make_dummy_fm</code><span class="sig-paren">(</span><em>nKpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#make_dummy_fm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.make_dummy_fm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.demodata.perterb_kpts">
<code class="descclassname">vtool.demodata.</code><code class="descname">perterb_kpts</code><span class="sig-paren">(</span><em>kpts</em>, <em>xy_std=None</em>, <em>invV_std=None</em>, <em>ori_std=None</em>, <em>damping=None</em>, <em>seed=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#perterb_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.perterb_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds normally distributed pertibations to keypoints</p>
</dd></dl>

<dl class="function">
<dt id="vtool.demodata.perterbed_grid_kpts">
<code class="descclassname">vtool.demodata.</code><code class="descname">perterbed_grid_kpts</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#perterbed_grid_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.perterbed_grid_kpts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.demodata.testdata_binary_scores">
<code class="descclassname">vtool.demodata.</code><code class="descname">testdata_binary_scores</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_binary_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.testdata_binary_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.demodata.testdata_dummy_matches">
<code class="descclassname">vtool.demodata.</code><code class="descname">testdata_dummy_matches</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_dummy_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.testdata_dummy_matches" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">matches_testtup</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.demodata –test-testdata_dummy_matches –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matches_testtup</span> <span class="o">=</span> <span class="n">testdata_dummy_matches</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">)</span> <span class="o">=</span> <span class="n">matches_testtup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_chipmatch2</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_figtitle</span><span class="p">(</span><span class="s1">&#39;Dummy matches&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.demodata.testdata_dummy_sift">
<code class="descclassname">vtool.demodata.</code><code class="descname">testdata_dummy_sift</code><span class="sig-paren">(</span><em>nPts=10</em>, <em>asint=True</em>, <em>rng=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_dummy_sift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.testdata_dummy_sift" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a demodata sift descriptor that has the uint8 * 512 hack
like hesaff returns</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nPts</strong> (<em>int</em>) – (default = 10)</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.demodata –test-testdata_dummy_sift</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nPts</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sift</span> <span class="o">=</span> <span class="n">testdata_dummy_sift</span><span class="p">(</span><span class="n">nPts</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">vt</span><span class="o">.</span><span class="n">check_sift_validity</span><span class="p">(</span><span class="n">sift</span><span class="p">),</span> <span class="s1">&#39;bad SIFT properties&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#assert np.allclose(((sift / 512) ** 2).sum(axis=1), 1, rtol=.01), &#39;bad SIFT property&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#assert np.all(sift / 512 &lt; .2), &#39;bad SIFT property&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.demodata.testdata_nonmonotonic">
<code class="descclassname">vtool.demodata.</code><code class="descname">testdata_nonmonotonic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_nonmonotonic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.testdata_nonmonotonic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.demodata.testdata_ratio_matches">
<code class="descclassname">vtool.demodata.</code><code class="descname">testdata_ratio_matches</code><span class="sig-paren">(</span><em>fname1='easy1.png'</em>, <em>fname2='easy2.png'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_ratio_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata.testdata_ratio_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs simple ratio-test matching between two images.
Technically this is not demodata data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fname1</strong> (<em>str</em>) – </li>
<li><strong>fname2</strong> (<em>str</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">matches_testtup</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd><p class="first">python -m vtool.demodata –test-testdata_ratio_matches
python -m vtool.demodata –test-testdata_ratio_matches –help
python -m vtool.demodata –test-testdata_ratio_matches –show
python -m vtool.demodata –test-testdata_ratio_matches –show –ratio_thresh=1.1 –rotation_invariance</p>
<p class="last">python -m vtool.demodata –test-testdata_ratio_matches –show –ratio_thresh=.625 –rotation_invariance –fname1 easy1.png –fname2 easy3.png
python -m vtool.demodata –test-testdata_ratio_matches –show –ratio_thresh=.625 –no-rotation_invariance –fname1 easy1.png –fname2 easy3.png</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname1&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname2&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;easy2.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_extract_features_default_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span><span class="p">[</span><span class="s1">&#39;ratio_thresh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">625</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">argparse_dict</span><span class="p">(</span><span class="n">default_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matches_testtup</span> <span class="o">=</span> <span class="n">testdata_ratio_matches</span><span class="p">(</span><span class="n">fname1</span><span class="p">,</span> <span class="n">fname2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm_RAT</span><span class="p">,</span> <span class="n">fs_RAT</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">)</span> <span class="o">=</span> <span class="n">matches_testtup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_chipmatch2</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm_RAT</span><span class="p">,</span> <span class="n">fs_RAT</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_matches</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fm_RAT</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">fs_RAT</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Simple matches using the Lowe</span><span class="se">\&#39;</span><span class="s1">s ratio test&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">title</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> num_matches=</span><span class="si">%r</span><span class="s1">, score_sum=</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">num_matches</span><span class="p">,</span> <span class="n">score_sum</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_figtitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.depricated">
<span id="vtool-depricated-module"></span><h2>vtool.depricated module<a class="headerlink" href="#module-vtool.depricated" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="vtool.depricated.ThumbnailCacheContext">
<em class="property">class </em><code class="descclassname">vtool.depricated.</code><code class="descname">ThumbnailCacheContext</code><span class="sig-paren">(</span><em>uuid_list</em>, <em>asrgb=True</em>, <em>thumb_size=64</em>, <em>thumb_dpath=None</em>, <em>appname='vtool'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/depricated.html#ThumbnailCacheContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.depricated.ThumbnailCacheContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Lazy computation of of images as thumbnails.</p>
<p>DEPRICATED</p>
<p>Just pass a list of uuids corresponding to the images. Then compute images
flagged as dirty and give them back to the context.  thumbs_list will be
populated on contex exit</p>
<dl class="method">
<dt id="vtool.depricated.ThumbnailCacheContext.filter_dirty_items">
<code class="descname">filter_dirty_items</code><span class="sig-paren">(</span><em>list_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/depricated.html#ThumbnailCacheContext.filter_dirty_items"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.depricated.ThumbnailCacheContext.filter_dirty_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns only items marked by the context as dirty</p>
</dd></dl>

<dl class="method">
<dt id="vtool.depricated.ThumbnailCacheContext.save_dirty_thumbs_from_images">
<code class="descname">save_dirty_thumbs_from_images</code><span class="sig-paren">(</span><em>img_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/depricated.html#ThumbnailCacheContext.save_dirty_thumbs_from_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.depricated.ThumbnailCacheContext.save_dirty_thumbs_from_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass in any images marked by the context as dirty here</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-vtool.distance">
<span id="vtool-distance-module"></span><h2>vtool.distance module<a class="headerlink" href="#module-vtool.distance" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.distance.L1">
<code class="descclassname">vtool.distance.</code><code class="descname">L1</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em>, <em>dtype=&lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.L1" title="Permalink to this definition">¶</a></dt>
<dd><p>returns L1 (aka manhatten or grid) distance between two histograms</p>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.L2">
<code class="descclassname">vtool.distance.</code><code class="descname">L2</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.L2" title="Permalink to this definition">¶</a></dt>
<dd><p>returns L2 (aka euclidean or standard) distance between two histograms</p>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.L2_root_sift">
<code class="descclassname">vtool.distance.</code><code class="descname">L2_root_sift</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2_root_sift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.L2_root_sift" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalized Root-SIFT L2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hist1</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</li>
<li><strong>hist2</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">euclidean distance between 0-1 normalized sift descriptors</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.L2_sift">
<code class="descclassname">vtool.distance.</code><code class="descname">L2_sift</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2_sift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.L2_sift" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalized SIFT L2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hist1</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</li>
<li><strong>hist2</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">euclidean distance between 0-1 normalized sift descriptors</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance –test-L2_sift</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sift1</span><span class="p">,</span> <span class="n">sift2</span><span class="p">,</span> <span class="n">sift3</span><span class="p">,</span> <span class="n">sift4</span><span class="p">,</span> <span class="n">sift5</span> <span class="o">=</span> <span class="n">testdata_sift2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2_dist</span> <span class="o">=</span> <span class="n">L2_sift</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dist</span> <span class="o">=</span> <span class="n">L2_sift</span><span class="p">(</span><span class="n">sift4</span><span class="p">,</span> <span class="n">sift5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">max_dist</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">l2_dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.L2_sift_sqrd">
<code class="descclassname">vtool.distance.</code><code class="descname">L2_sift_sqrd</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2_sift_sqrd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.L2_sift_sqrd" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalized SIFT L2**2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hist1</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</li>
<li><strong>hist2</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">squared euclidean distance between 0-1 normalized sift descriptors</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.L2_sqrd">
<code class="descclassname">vtool.distance.</code><code class="descname">L2_sqrd</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em>, <em>dtype=&lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2_sqrd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.L2_sqrd" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the squared L2 distance</p>
<dl class="docutils">
<dt># FIXME:</dt>
<dd>if hist1.shape = (0,) and hist.shape = (0,) then result=0.0</dd>
<dt>SeeAlso:</dt>
<dd>L2</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">exec_funckw</span><span class="p">(</span><span class="n">L2_sqrd</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2dist</span> <span class="o">=</span> <span class="n">L2_sqrd</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">l2dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.bar_L2_sift">
<code class="descclassname">vtool.distance.</code><code class="descname">bar_L2_sift</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#bar_L2_sift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.bar_L2_sift" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalized SIFT L2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>hist1</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</li>
<li><strong>hist2</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance –test-bar_L2_sift</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">barl2_dist</span> <span class="o">=</span> <span class="n">bar_L2_sift</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">barl2_dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.bar_cos_sift">
<code class="descclassname">vtool.distance.</code><code class="descname">bar_cos_sift</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#bar_cos_sift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.bar_cos_sift" title="Permalink to this definition">¶</a></dt>
<dd><p>1 - cos dist</p>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.closest_point">
<code class="descclassname">vtool.distance.</code><code class="descname">closest_point</code><span class="sig-paren">(</span><em>pt</em>, <em>pt_arr</em>, <em>distfunc=&lt;function L2_sqrd&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#closest_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.closest_point" title="Permalink to this definition">¶</a></dt>
<dd><p>finds the nearest point(s) in pts to (x, y)
pt = np.array([1])
pt_arr = np.array([1.1, 2, .95, 20])[:, None]
distfunc = vt.L2_sqrd</p>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.compute_distances">
<code class="descclassname">vtool.distance.</code><code class="descname">compute_distances</code><span class="sig-paren">(</span><em>hist1, hist2, dist_list=['L1', 'L2']</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#compute_distances"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.compute_distances" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hist1</strong> (<em>ndarray</em>) – </li>
<li><strong>hist2</strong> (<em>ndarray</em>) – </li>
<li><strong>dist_list</strong> (<em>list</em>) – (default = [‘L1’, ‘L2’])</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dist_dict</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance –test-compute_distances</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">,</span> <span class="s1">&#39;L2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_dict</span> <span class="o">=</span> <span class="n">compute_distances</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">,</span> <span class="n">dist_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">dist_dict</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.cos_sift">
<code class="descclassname">vtool.distance.</code><code class="descname">cos_sift</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#cos_sift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.cos_sift" title="Permalink to this definition">¶</a></dt>
<dd><p>cos dist</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance –test-cos_sift</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2_dist</span> <span class="o">=</span> <span class="n">cos_sift</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.cosine_dist">
<code class="descclassname">vtool.distance.</code><code class="descname">cosine_dist</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#cosine_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.cosine_dist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.distance.cyclic_distance">
<code class="descclassname">vtool.distance.</code><code class="descname">cyclic_distance</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em>, <em>modulo</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#cyclic_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.cyclic_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>returns an unsigned distance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr1</strong> (<em>ndarray</em>) – </li>
<li><strong>arr2</strong> (<em>ndarray</em>) – </li>
<li><strong>modulo</strong> (<em>float</em><em> or </em><em>int</em>) – </li>
<li><strong>out</strong> (<em>ndarray</em>) – (default = None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">arr_dist</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance cyclic_distance</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modulo</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># doesnt matter what offset is</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">modulo</span> <span class="o">+</span> <span class="n">offset</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">arr1</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_dist</span> <span class="o">=</span> <span class="n">cyclic_distance</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="n">modulo</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;arr_dist =</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_dist</span><span class="p">),))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.det_distance">
<code class="descclassname">vtool.distance.</code><code class="descname">det_distance</code><span class="sig-paren">(</span><em>det1</em>, <em>det2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#det_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.det_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns how far off determinants are from one another</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaledist</span> <span class="o">=</span> <span class="n">det_distance</span><span class="p">(</span><span class="n">det1</span><span class="p">,</span> <span class="n">det2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">scaledist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.emd">
<code class="descclassname">vtool.distance.</code><code class="descname">emd</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em>, <em>cost_matrix='sift'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#emd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.emd" title="Permalink to this definition">¶</a></dt>
<dd><p>earth mover’s distance by robjects(lpSovle::lp.transport)
require: lpsolve55-5.5.0.9.win32-py2.7.exe</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance –test-emd</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emd_dists</span> <span class="o">=</span> <span class="n">emd</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">emd_dists</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.haversine">
<code class="descclassname">vtool.distance.</code><code class="descname">haversine</code><span class="sig-paren">(</span><em>latlon1</em>, <em>latlon2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#haversine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.haversine" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the great circle distance between two points
on the earth (specified in decimal degrees)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>latlon1</strong> (<em>ndarray</em>) – </li>
<li><strong>latlon2</strong> (<em>ndarray</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>en.wikipedia.org/wiki/Haversine_formula
gis.stackexchange.com/questions/81551/matching-gps-tracks
stackoverflow.com/questions/4913349/haversine-distance-gps-points</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance –exec-haversine</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.spatial.distance</span> <span class="k">as</span> <span class="nn">spdist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">functools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gpsarr_track_list_</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="o">-</span><span class="mf">80.21895315</span><span class="p">,</span> <span class="o">-</span><span class="mf">158.81099213</span><span class="p">],</span>
<span class="gp">... </span>             <span class="p">[</span> <span class="o">-</span><span class="mf">12.08338926</span><span class="p">,</span>   <span class="mf">67.50368014</span><span class="p">],</span>
<span class="gp">... </span>             <span class="p">[</span> <span class="o">-</span><span class="mf">11.08338926</span><span class="p">,</span>   <span class="mf">67.50368014</span><span class="p">],</span>
<span class="gp">... </span>             <span class="p">[</span> <span class="o">-</span><span class="mf">11.08338926</span><span class="p">,</span>   <span class="mf">67.50368014</span><span class="p">],]</span>
<span class="gp">... </span>   <span class="p">),</span>
<span class="gp">... </span>   <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>   <span class="mf">9.77816711</span><span class="p">,</span>  <span class="o">-</span><span class="mf">17.27471498</span><span class="p">],</span>
<span class="gp">... </span>             <span class="p">[</span> <span class="o">-</span><span class="mf">51.67678814</span><span class="p">,</span> <span class="o">-</span><span class="mf">158.91065495</span><span class="p">],])</span>
<span class="gp">... </span>   <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latlon1</span> <span class="o">=</span> <span class="n">gpsarr_track_list_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latlon2</span> <span class="o">=</span> <span class="n">gpsarr_track_list_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kilometers</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">haversine</span><span class="p">(</span><span class="n">latlon1</span><span class="p">,</span> <span class="n">latlon2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">haversin_pdist</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">spdist</span><span class="o">.</span><span class="n">pdist</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">vt</span><span class="o">.</span><span class="n">haversine</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_vector_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">haversin_pdist</span><span class="p">,</span> <span class="n">gpsarr_track_list_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_matrix_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">spdist</span><span class="o">.</span><span class="n">squareform</span><span class="p">,</span> <span class="n">dist_vector_list</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.hist_isect">
<code class="descclassname">vtool.distance.</code><code class="descname">hist_isect</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#hist_isect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.hist_isect" title="Permalink to this definition">¶</a></dt>
<dd><p>returns histogram intersection distance between two histograms</p>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.nearest_point">
<code class="descclassname">vtool.distance.</code><code class="descname">nearest_point</code><span class="sig-paren">(</span><em>x, y, pts, conflict_mode='next', __next_counter=[0]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#nearest_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.nearest_point" title="Permalink to this definition">¶</a></dt>
<dd><p>finds the nearest point(s) in pts to (x, y)</p>
<p>TODO: depricate</p>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.ori_distance">
<code class="descclassname">vtool.distance.</code><code class="descname">ori_distance</code><span class="sig-paren">(</span><em>ori1</em>, <em>ori2</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#ori_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.ori_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the unsigned distance between two angles</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/1878907/the-smallest-difference-between-2-angles">http://stackoverflow.com/questions/1878907/the-smallest-difference-between-2-angles</a></p>
<dl class="docutils">
<dt>Timeit:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#xdoctest: +SKIP</span>
</pre></div>
</div>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.3</span><span class="p">,</span>  <span class="mf">7.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">3.1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">6.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_</span> <span class="o">=</span> <span class="n">ori_distance</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">ori2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">dist_</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.pdist_argsort">
<code class="descclassname">vtool.distance.</code><code class="descname">pdist_argsort</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#pdist_argsort"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.pdist_argsort" title="Permalink to this definition">¶</a></dt>
<dd><p>Sorts 2d indicies by their distnace matrix output from scipy.spatial.distance
x = np.array([  3.05555556e-03,   1.47619797e+04,   1.47619828e+04])</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>ndarray</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">sortx_2d</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance –test-pdist_argsort</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">21695.78</span><span class="p">,</span> <span class="mf">10943.76</span><span class="p">,</span> <span class="mf">10941.44</span><span class="p">,</span> <span class="mf">25867.64</span><span class="p">,</span> <span class="mf">10752.03</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="mf">10754.35</span><span class="p">,</span> <span class="mf">4171.86</span><span class="p">,</span> <span class="mf">2.32</span><span class="p">,</span> <span class="mf">14923.89</span><span class="p">,</span> <span class="mf">14926.2</span> <span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>             <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sortx_2d</span> <span class="o">=</span> <span class="n">pdist_argsort</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;sortx_2d = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sortx_2d</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">sortx_2d = [(2, 3), (1, 4), (1, 2), (1, 3), (0, 3), (0, 2), (2, 4), (3, 4), (0, 1), (0, 4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.pdist_indicies">
<code class="descclassname">vtool.distance.</code><code class="descname">pdist_indicies</code><span class="sig-paren">(</span><em>num</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#pdist_indicies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.pdist_indicies" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.distance.safe_pdist">
<code class="descclassname">vtool.distance.</code><code class="descname">safe_pdist</code><span class="sig-paren">(</span><em>arr</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#safe_pdist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.safe_pdist" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Kwargs:</dt>
<dd>metric = ut.absdiff</dd>
<dt>SeeAlso:</dt>
<dd>scipy.spatial.distance.pdist</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.signed_cyclic_distance">
<code class="descclassname">vtool.distance.</code><code class="descname">signed_cyclic_distance</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em>, <em>modulo</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#signed_cyclic_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.signed_cyclic_distance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.distance.signed_ori_distance">
<code class="descclassname">vtool.distance.</code><code class="descname">signed_ori_distance</code><span class="sig-paren">(</span><em>ori1</em>, <em>ori2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#signed_ori_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.signed_ori_distance" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ori1</strong> (<em>ndarray</em>) – </li>
<li><strong>ori2</strong> (<em>ndarray</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">ori_dist</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance –exec-signed_ori_distance</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="o">.</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_dist</span> <span class="o">=</span> <span class="n">signed_ori_distance</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">ori2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;ori_dist = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">ori_dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">),))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.testdata_hist">
<code class="descclassname">vtool.distance.</code><code class="descname">testdata_hist</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#testdata_hist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.testdata_hist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.distance.testdata_sift2">
<code class="descclassname">vtool.distance.</code><code class="descname">testdata_sift2</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#testdata_sift2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.testdata_sift2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.distance.understanding_pseudomax_props">
<code class="descclassname">vtool.distance.</code><code class="descname">understanding_pseudomax_props</code><span class="sig-paren">(</span><em>mode=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#understanding_pseudomax_props"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.understanding_pseudomax_props" title="Permalink to this definition">¶</a></dt>
<dd><p>Function showing some properties of distances between normalized pseudomax vectors</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance –test-understanding_pseudomax_props</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;+---&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mode = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mode</span><span class="p">,))</span>
<span class="gp">... </span>    <span class="n">result</span> <span class="o">=</span> <span class="n">understanding_pseudomax_props</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;L___&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.wrapped_distance">
<code class="descclassname">vtool.distance.</code><code class="descname">wrapped_distance</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em>, <em>base</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#wrapped_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.wrapped_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>base = TAU corresponds to ori diff</p>
</dd></dl>

</div>
<div class="section" id="module-vtool.ellipse">
<span id="vtool-ellipse-module"></span><h2>vtool.ellipse module<a class="headerlink" href="#module-vtool.ellipse" title="Permalink to this headline">¶</a></h2>
<p>OLD MODULE, needs reimplemenetation of select features and deprication</p>
<p>This module should handle all things elliptical</p>
<dl class="function">
<dt id="vtool.ellipse.adaptive_scale">
<code class="descclassname">vtool.ellipse.</code><code class="descname">adaptive_scale</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>kpts</em>, <em>nScales=4</em>, <em>low=-0.5</em>, <em>high=0.5</em>, <em>nSamples=16</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#adaptive_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.adaptive_scale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.check_kpts_in_bounds">
<code class="descclassname">vtool.ellipse.</code><code class="descname">check_kpts_in_bounds</code><span class="sig-paren">(</span><em>kpts_</em>, <em>width</em>, <em>height</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#check_kpts_in_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.check_kpts_in_bounds" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.circular_distance">
<code class="descclassname">vtool.ellipse.</code><code class="descname">circular_distance</code><span class="sig-paren">(</span><em>arr=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#circular_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.circular_distance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.expand_kpts">
<code class="descclassname">vtool.ellipse.</code><code class="descname">expand_kpts</code><span class="sig-paren">(</span><em>kpts</em>, <em>scales</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#expand_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.expand_kpts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.expand_scales">
<code class="descclassname">vtool.ellipse.</code><code class="descname">expand_scales</code><span class="sig-paren">(</span><em>kpts</em>, <em>nScales</em>, <em>low</em>, <em>high</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#expand_scales"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.expand_scales" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.expand_subscales">
<code class="descclassname">vtool.ellipse.</code><code class="descname">expand_subscales</code><span class="sig-paren">(</span><em>kpts</em>, <em>subscale_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#expand_subscales"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.expand_subscales" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.extrema_neighbors">
<code class="descclassname">vtool.ellipse.</code><code class="descname">extrema_neighbors</code><span class="sig-paren">(</span><em>extrema_list</em>, <em>nBins</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#extrema_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.extrema_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.find_maxima">
<code class="descclassname">vtool.ellipse.</code><code class="descname">find_maxima</code><span class="sig-paren">(</span><em>y_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#find_maxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.find_maxima" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.find_maxima_with_neighbors">
<code class="descclassname">vtool.ellipse.</code><code class="descname">find_maxima_with_neighbors</code><span class="sig-paren">(</span><em>scalar_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#find_maxima_with_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.find_maxima_with_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.gradient_magnitude">
<code class="descclassname">vtool.ellipse.</code><code class="descname">gradient_magnitude</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#gradient_magnitude"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.gradient_magnitude" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.homogenous_circle_pts">
<code class="descclassname">vtool.ellipse.</code><code class="descname">homogenous_circle_pts</code><span class="sig-paren">(</span><em>nSamples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#homogenous_circle_pts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.homogenous_circle_pts" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a list of homogenous circle points</p>
</dd></dl>

<dl class="function">
<dt id="vtool.ellipse.interpolate_between">
<code class="descclassname">vtool.ellipse.</code><code class="descname">interpolate_between</code><span class="sig-paren">(</span><em>peak_list</em>, <em>nScales</em>, <em>high</em>, <em>low</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_between"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.interpolate_between" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.interpolate_maxima">
<code class="descclassname">vtool.ellipse.</code><code class="descname">interpolate_maxima</code><span class="sig-paren">(</span><em>scalar_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_maxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.interpolate_maxima" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.interpolate_peaks">
<code class="descclassname">vtool.ellipse.</code><code class="descname">interpolate_peaks</code><span class="sig-paren">(</span><em>x_data_list</em>, <em>y_data_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.interpolate_peaks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.interpolate_peaks2">
<code class="descclassname">vtool.ellipse.</code><code class="descname">interpolate_peaks2</code><span class="sig-paren">(</span><em>x_data_list</em>, <em>y_data_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_peaks2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.interpolate_peaks2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.kpts_matrices">
<code class="descclassname">vtool.ellipse.</code><code class="descname">kpts_matrices</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#kpts_matrices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.kpts_matrices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.sample_ell_border_pts">
<code class="descclassname">vtool.ellipse.</code><code class="descname">sample_ell_border_pts</code><span class="sig-paren">(</span><em>expanded_kpts</em>, <em>nSamples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#sample_ell_border_pts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.sample_ell_border_pts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.sample_ell_border_vals">
<code class="descclassname">vtool.ellipse.</code><code class="descname">sample_ell_border_vals</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>expanded_kpts</em>, <em>nKp</em>, <em>nScales</em>, <em>nSamples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#sample_ell_border_vals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.sample_ell_border_vals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.sample_uniform">
<code class="descclassname">vtool.ellipse.</code><code class="descname">sample_uniform</code><span class="sig-paren">(</span><em>kpts</em>, <em>nSamples=128</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#sample_uniform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.sample_uniform" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>SeeAlso:</dt>
<dd>python -m pyhesaff.tests.test_ellipse –test-in_depth_ellipse –show</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.ellipse.subscale_peaks">
<code class="descclassname">vtool.ellipse.</code><code class="descname">subscale_peaks</code><span class="sig-paren">(</span><em>border_vals_sum</em>, <em>kpts</em>, <em>nScales</em>, <em>low</em>, <em>high</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#subscale_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.subscale_peaks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.exif">
<span id="vtool-exif-module"></span><h2>vtool.exif module<a class="headerlink" href="#module-vtool.exif" title="Permalink to this headline">¶</a></h2>
<p class="rubric">References</p>
<p><a class="reference external" href="http://www.exiv2.org/tags.html">http://www.exiv2.org/tags.html</a></p>
<dl class="function">
<dt id="vtool.exif.check_exif_keys">
<code class="descclassname">vtool.exif.</code><code class="descname">check_exif_keys</code><span class="sig-paren">(</span><em>pil_img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#check_exif_keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.check_exif_keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.convert_degrees">
<code class="descclassname">vtool.exif.</code><code class="descname">convert_degrees</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#convert_degrees"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.convert_degrees" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to convert the GPS coordinates stored in the EXIF to degress in float format</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Geographic_coordinate_conversion">http://en.wikipedia.org/wiki/Geographic_coordinate_conversion</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.get_exif_dict">
<code class="descclassname">vtool.exif.</code><code class="descname">get_exif_dict</code><span class="sig-paren">(</span><em>pil_img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exif_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_exif_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns exif dictionary by TAGID</p>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.get_exif_dict2">
<code class="descclassname">vtool.exif.</code><code class="descname">get_exif_dict2</code><span class="sig-paren">(</span><em>pil_img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exif_dict2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_exif_dict2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns exif dictionary by TAG (less efficient)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.get_exif_tagids">
<code class="descclassname">vtool.exif.</code><code class="descname">get_exif_tagids</code><span class="sig-paren">(</span><em>tag_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exif_tagids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_exif_tagids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.get_exist">
<code class="descclassname">vtool.exif.</code><code class="descname">get_exist</code><span class="sig-paren">(</span><em>data</em>, <em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_exist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.get_lat_lon">
<code class="descclassname">vtool.exif.</code><code class="descname">get_lat_lon</code><span class="sig-paren">(</span><em>exif_dict</em>, <em>default=(-1</em>, <em>-1)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_lat_lon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_lat_lon" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the latitude and longitude, if available, from the provided
exif_data2 (obtained through exif_data2 above)</p>
<p class="rubric">Notes</p>
<p>Might need to downgrade to Pillow 2.9.0 to solve a bug with getting GPS
<a class="reference external" href="https://github.com/python-pillow/Pillow/issues/1477">https://github.com/python-pillow/Pillow/issues/1477</a></p>
<p>python -c “from PIL import Image; print(Image.PILLOW_VERSION)”</p>
<p>pip uninstall Pillow
pip install Pillow==2.9</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.exif –test-get_lat_lon</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exif_dict</span> <span class="o">=</span> <span class="n">get_exif_dict</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latlon</span> <span class="o">=</span> <span class="n">get_lat_lon</span><span class="p">(</span><span class="n">exif_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">latlon</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.get_orientation">
<code class="descclassname">vtool.exif.</code><code class="descname">get_orientation</code><span class="sig-paren">(</span><em>exif_dict</em>, <em>default=0</em>, <em>on_error='warn'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_orientation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_orientation" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the image orientation, if available, from the provided
exif_data2 (obtained through exif_data2 above)</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.exif –test-get_orientation</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="k">import</span> <span class="n">join</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://wildbookiarepository.azureedge.net/models/orientation.zip&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">images_path</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_zipped_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">image_filename</span> <span class="o">=</span> <span class="s1">&#39;orientation_</span><span class="si">%05d</span><span class="s1">.JPG&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">images_path</span><span class="p">,</span> <span class="n">image_filename</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">exif_dict</span> <span class="o">=</span> <span class="n">get_exif_dict</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">orient</span> <span class="o">=</span> <span class="n">get_orientation</span><span class="p">(</span><span class="n">exif_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">orient</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1, 6, 8]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.get_orientation_str">
<code class="descclassname">vtool.exif.</code><code class="descname">get_orientation_str</code><span class="sig-paren">(</span><em>exif_dict</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_orientation_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_orientation_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the image orientation strings, if available, from the provided
exif_data2 (obtained through exif_data2 above)</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.exif –test-get_orientation_str</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="k">import</span> <span class="n">join</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://wildbookiarepository.azureedge.net/models/orientation.zip&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">images_path</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_zipped_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">image_filename</span> <span class="o">=</span> <span class="s1">&#39;orientation_</span><span class="si">%05d</span><span class="s1">.JPG&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">images_path</span><span class="p">,</span> <span class="n">image_filename</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">exif_dict</span> <span class="o">=</span> <span class="n">get_exif_dict</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">orient_str</span> <span class="o">=</span> <span class="n">get_orientation_str</span><span class="p">(</span><span class="n">exif_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">orient_str</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[&#39;Normal&#39;, &#39;90 Clockwise&#39;, &#39;90 Counter-Clockwise&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.get_unixtime">
<code class="descclassname">vtool.exif.</code><code class="descname">get_unixtime</code><span class="sig-paren">(</span><em>exif_dict</em>, <em>default=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_unixtime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_unixtime" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: Exif.Image.TimeZoneOffset</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exif_dict</span> <span class="o">=</span> <span class="n">get_exif_dict</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.get_unixtime_gps">
<code class="descclassname">vtool.exif.</code><code class="descname">get_unixtime_gps</code><span class="sig-paren">(</span><em>exif_dict</em>, <em>default=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_unixtime_gps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_unixtime_gps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.make_exif_dict_human_readable">
<code class="descclassname">vtool.exif.</code><code class="descname">make_exif_dict_human_readable</code><span class="sig-paren">(</span><em>exif_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#make_exif_dict_human_readable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.make_exif_dict_human_readable" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.parse_exif_unixtime">
<code class="descclassname">vtool.exif.</code><code class="descname">parse_exif_unixtime</code><span class="sig-paren">(</span><em>image_fpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#parse_exif_unixtime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.parse_exif_unixtime" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_fpath</strong> (<em>str</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">unixtime</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.exif –test-parse_exif_unixtime</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unixtime</span> <span class="o">=</span> <span class="n">parse_exif_unixtime</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">unixtime</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.parse_exif_unixtime_gps">
<code class="descclassname">vtool.exif.</code><code class="descname">parse_exif_unixtime_gps</code><span class="sig-paren">(</span><em>image_fpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#parse_exif_unixtime_gps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.parse_exif_unixtime_gps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.read_all_exif_tags">
<code class="descclassname">vtool.exif.</code><code class="descname">read_all_exif_tags</code><span class="sig-paren">(</span><em>pil_img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_all_exif_tags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.read_all_exif_tags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.read_exif">
<code class="descclassname">vtool.exif.</code><code class="descname">read_exif</code><span class="sig-paren">(</span><em>fpath</em>, <em>tag=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_exif"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.read_exif" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.read_exif_tags">
<code class="descclassname">vtool.exif.</code><code class="descname">read_exif_tags</code><span class="sig-paren">(</span><em>pil_img</em>, <em>exif_tagid_list</em>, <em>default_list=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_exif_tags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.read_exif_tags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.read_one_exif_tag">
<code class="descclassname">vtool.exif.</code><code class="descname">read_one_exif_tag</code><span class="sig-paren">(</span><em>pil_img</em>, <em>tag</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_one_exif_tag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.read_one_exif_tag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.features">
<span id="vtool-features-module"></span><h2>vtool.features module<a class="headerlink" href="#module-vtool.features" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.features.detect_opencv_keypoints">
<code class="descclassname">vtool.features.</code><code class="descname">detect_opencv_keypoints</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#detect_opencv_keypoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.features.detect_opencv_keypoints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.features.extract_feature_from_patch">
<code class="descclassname">vtool.features.</code><code class="descname">extract_feature_from_patch</code><span class="sig-paren">(</span><em>patch</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#extract_feature_from_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.features.extract_feature_from_patch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.features.extract_features">
<code class="descclassname">vtool.features.</code><code class="descname">extract_features</code><span class="sig-paren">(</span><em>img_or_fpath</em>, <em>feat_type='hesaff+sift'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#extract_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.features.extract_features" title="Permalink to this definition">¶</a></dt>
<dd><p>calls pyhesaff’s main driver function for detecting hessian affine keypoints.
extra parameters can be passed to the hessian affine detector by using
kwargs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img_or_fpath</strong> (<em>str</em>) – image file path on disk</li>
<li><strong>use_adaptive_scale</strong> (<em>bool</em>) – </li>
<li><strong>nogravity_hack</strong> (<em>bool</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(kpts, vecs)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.features –test-extract_features
python -m vtool.features –test-extract_features –show
python -m vtool.features –test-extract_features –feat-type=hesaff+siam128 –show
python -m vtool.features –test-extract_features –feat-type=hesaff+siam128 –show
python -m vtool.features –test-extract_features –feat-type=hesaff+siam128 –show –no-affine-invariance</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.features</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;lena.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat_type</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">argval</span><span class="p">(</span><span class="s1">&#39;--feat_type&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;hesaff+sift&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyhesaff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">parse_dict_from_argv</span><span class="p">(</span><span class="n">pyhesaff</span><span class="o">.</span><span class="n">get_hesaff_default_params</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#(kpts, vecs) = extract_features(img_fpath)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">extract_features</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">feat_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Show keypoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.figure(fnum=1, doclf=True, docla=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.imshow(imgBGR)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_kpts2(kpts, ori=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">interact_keypoints</span><span class="o">.</span><span class="n">ishow_keypoints</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ell_alpha</span><span class="o">=.</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;distinct&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.features.get_extract_features_default_params">
<code class="descclassname">vtool.features.</code><code class="descname">get_extract_features_default_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#get_extract_features_default_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.features.get_extract_features_default_params" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.features –test-get_extract_features_default_params</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.features</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_dict</span> <span class="o">=</span> <span class="n">get_extract_features_default_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">param_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.features.test_mser">
<code class="descclassname">vtool.features.</code><code class="descname">test_mser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#test_mser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.features.test_mser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.fontdemo">
<span id="vtool-fontdemo-module"></span><h2>vtool.fontdemo module<a class="headerlink" href="#module-vtool.fontdemo" title="Permalink to this headline">¶</a></h2>
<p class="rubric">References</p>
<p><a class="reference external" href="https://dbader.org/blog/monochrome-font-rendering-with-freetype-and-python">https://dbader.org/blog/monochrome-font-rendering-with-freetype-and-python</a>
<a class="reference external" href="https://gist.github.com/dbader/5488053#file-fontdemo-py-L244">https://gist.github.com/dbader/5488053#file-fontdemo-py-L244</a></p>
<dl class="class">
<dt id="vtool.fontdemo.Bitmap">
<em class="property">class </em><code class="descclassname">vtool.fontdemo.</code><code class="descname">Bitmap</code><span class="sig-paren">(</span><em>width</em>, <em>height</em>, <em>pixels=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Bitmap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.fontdemo.Bitmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A 2D bitmap image represented as a list of byte values. Each byte indicates the state
of a single pixel in the bitmap. A value of 0 indicates that the pixel is <cite>off</cite>
and any other value indicates that it is <cite>on</cite>.</p>
<dl class="method">
<dt id="vtool.fontdemo.Bitmap.bitblt">
<code class="descname">bitblt</code><span class="sig-paren">(</span><em>src</em>, <em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Bitmap.bitblt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.fontdemo.Bitmap.bitblt" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy all pixels from <cite>src</cite> into this bitmap</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="vtool.fontdemo.Font">
<em class="property">class </em><code class="descclassname">vtool.fontdemo.</code><code class="descname">Font</code><span class="sig-paren">(</span><em>filename</em>, <em>size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Font"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.fontdemo.Font" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="vtool.fontdemo.Font.glyph_for_character">
<code class="descname">glyph_for_character</code><span class="sig-paren">(</span><em>char</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Font.glyph_for_character"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.fontdemo.Font.glyph_for_character" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.fontdemo.Font.kerning_offset">
<code class="descname">kerning_offset</code><span class="sig-paren">(</span><em>previous_char</em>, <em>char</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Font.kerning_offset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.fontdemo.Font.kerning_offset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.fontdemo.Font.render_character">
<code class="descname">render_character</code><span class="sig-paren">(</span><em>char</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Font.render_character"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.fontdemo.Font.render_character" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.fontdemo.Font.render_text">
<code class="descname">render_text</code><span class="sig-paren">(</span><em>text</em>, <em>width=None</em>, <em>height=None</em>, <em>baseline=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Font.render_text"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.fontdemo.Font.render_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Render the given <cite>text</cite> into a Bitmap and return it.  If <cite>width</cite>,
<cite>height</cite>, and <cite>baseline</cite> are not specified they are computed using the
<a href="#id1"><span class="problematic" id="id2">`</span></a>text_dimensions’ method.</p>
</dd></dl>

<dl class="method">
<dt id="vtool.fontdemo.Font.text_dimensions">
<code class="descname">text_dimensions</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Font.text_dimensions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.fontdemo.Font.text_dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return (width, height, baseline) of <cite>text</cite> rendered in the current
font.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="vtool.fontdemo.Glyph">
<em class="property">class </em><code class="descclassname">vtool.fontdemo.</code><code class="descname">Glyph</code><span class="sig-paren">(</span><em>pixels</em>, <em>width</em>, <em>height</em>, <em>top</em>, <em>advance_width</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Glyph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.fontdemo.Glyph" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="staticmethod">
<dt id="vtool.fontdemo.Glyph.from_glyphslot">
<em class="property">static </em><code class="descname">from_glyphslot</code><span class="sig-paren">(</span><em>slot</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Glyph.from_glyphslot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.fontdemo.Glyph.from_glyphslot" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct and return a Glyph object from a FreeType GlyphSlot.</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.fontdemo.Glyph.height">
<code class="descname">height</code><a class="headerlink" href="#vtool.fontdemo.Glyph.height" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="vtool.fontdemo.Glyph.unpack_mono_bitmap">
<em class="property">static </em><code class="descname">unpack_mono_bitmap</code><span class="sig-paren">(</span><em>bitmap</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Glyph.unpack_mono_bitmap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.fontdemo.Glyph.unpack_mono_bitmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpack a freetype FT_LOAD_TARGET_MONO glyph bitmap into a bytearray where each
pixel is represented by a single byte.</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.fontdemo.Glyph.width">
<code class="descname">width</code><a class="headerlink" href="#vtool.fontdemo.Glyph.width" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="vtool.fontdemo.font_demo">
<code class="descclassname">vtool.fontdemo.</code><code class="descname">font_demo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#font_demo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.fontdemo.font_demo" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.fontdemo font_demo –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.fontdemo</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">font_demo</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.fontdemo.get_text_test_img">
<code class="descclassname">vtool.fontdemo.</code><code class="descname">get_text_test_img</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#get_text_test_img"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.fontdemo.get_text_test_img" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>text</strong> (<em>str</em>) – </td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.fontdemo get_text_test_img –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.fontdemo</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A012&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text_img</span> <span class="o">=</span> <span class="n">get_text_test_img</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;text_img = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">text_img</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">text_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.geometry">
<span id="vtool-geometry-module"></span><h2>vtool.geometry module<a class="headerlink" href="#module-vtool.geometry" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.geometry.bbox_center">
<code class="descclassname">vtool.geometry.</code><code class="descname">bbox_center</code><span class="sig-paren">(</span><em>bbox</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_center"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.bbox_center" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.geometry.bbox_from_center_wh">
<code class="descclassname">vtool.geometry.</code><code class="descname">bbox_from_center_wh</code><span class="sig-paren">(</span><em>center_xy</em>, <em>wh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_from_center_wh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.bbox_from_center_wh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.geometry.bbox_from_extent">
<code class="descclassname">vtool.geometry.</code><code class="descname">bbox_from_extent</code><span class="sig-paren">(</span><em>extent</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_from_extent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.bbox_from_extent" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>extent</strong> (<em>ndarray</em>) – tl_x, br_x, tl_y, br_y</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">tl_x, tl_y, w, h</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bbox (ndarray)</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="n">bbox_from_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;bbox = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">bbox = [0, 0, 10, 10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.bbox_from_verts">
<code class="descclassname">vtool.geometry.</code><code class="descname">bbox_from_verts</code><span class="sig-paren">(</span><em>verts</em>, <em>castint=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_from_verts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.bbox_from_verts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.geometry.bbox_from_xywh">
<code class="descclassname">vtool.geometry.</code><code class="descname">bbox_from_xywh</code><span class="sig-paren">(</span><em>xy, wh, xy_rel_pos=[0, 0]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_from_xywh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.bbox_from_xywh" title="Permalink to this definition">¶</a></dt>
<dd><p>need to specify xy_rel_pos if xy is not in tl already</p>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.bboxes_from_vert_list">
<code class="descclassname">vtool.geometry.</code><code class="descname">bboxes_from_vert_list</code><span class="sig-paren">(</span><em>verts_list</em>, <em>castint=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bboxes_from_vert_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.bboxes_from_vert_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the bounding polygon inside a rectangle</p>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.closest_point_on_bbox">
<code class="descclassname">vtool.geometry.</code><code class="descname">closest_point_on_bbox</code><span class="sig-paren">(</span><em>p</em>, <em>bbox</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#closest_point_on_bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.closest_point_on_bbox" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">21</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">closest_point_on_bbox</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_list</span><span class="p">]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.closest_point_on_line">
<code class="descclassname">vtool.geometry.</code><code class="descname">closest_point_on_line</code><span class="sig-paren">(</span><em>p</em>, <em>e1</em>, <em>e2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#closest_point_on_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.closest_point_on_line" title="Permalink to this definition">¶</a></dt>
<dd><p>e1 and e2 define two points on the line.
Does not clip to the segment.</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.geometry closest_point_on_line –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">21.83012702</span><span class="p">,</span>  <span class="mf">13.16987298</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">16.83012702</span><span class="p">,</span>  <span class="mf">21.83012702</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span>  <span class="mf">8.16987298</span><span class="p">,</span>  <span class="mf">16.83012702</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">13.16987298</span><span class="p">,</span>   <span class="mf">8.16987298</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">21.83012702</span><span class="p">,</span>  <span class="mf">13.16987298</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_list</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">close_pts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_list</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">closest_point_on_line</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span> <span class="k">for</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">itertwo</span><span class="p">(</span><span class="n">verts</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">L2_sqrd</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">new_pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">new_pt</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">close_pts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidates</span><span class="p">[</span><span class="n">dists</span><span class="o">.</span><span class="n">argmin</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">close_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">close_pts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original point&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">close_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">close_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;closest point on shape&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">p_list</span><span class="p">,</span> <span class="n">close_pts</span><span class="p">)):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.closest_point_on_line_segment">
<code class="descclassname">vtool.geometry.</code><code class="descname">closest_point_on_line_segment</code><span class="sig-paren">(</span><em>p</em>, <em>e1</em>, <em>e2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#closest_point_on_line_segment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.closest_point_on_line_segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the closet point from p on line segment (e1, e2)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>p</strong> (<em>ndarray</em>) – and xy point</li>
<li><strong>e1</strong> (<em>ndarray</em>) – the first xy endpoint of the segment</li>
<li><strong>e2</strong> (<em>ndarray</em>) – the second xy endpoint of the segment</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">pt_on_seg - the closest xy point on (e1, e2) from p</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line">http://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line</a>
<a class="reference external" href="http://stackoverflow.com/questions/849211/shortest-distance-between-a-point-and-a-line-segment">http://stackoverflow.com/questions/849211/shortest-distance-between-a-point-and-a-line-segment</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.geometry –exec-closest_point_on_line_segment –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#bbox = np.array([10, 10, 10, 10], dtype=np.float)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#verts_ = np.array(vt.verts_from_bbox(bbox, close=True))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#R = vt.rotation_around_bbox_mat3x3(vt.TAU / 3, bbox)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#verts = vt.transform_points_with_homography(R, verts_.T).T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">21.83012702</span><span class="p">,</span>  <span class="mf">13.16987298</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">16.83012702</span><span class="p">,</span>  <span class="mf">21.83012702</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span>  <span class="mf">8.16987298</span><span class="p">,</span>  <span class="mf">16.83012702</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">13.16987298</span><span class="p">,</span>   <span class="mf">8.16987298</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">21.83012702</span><span class="p">,</span>  <span class="mf">13.16987298</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_list</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">close_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">closest_point_on_vert_segments</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">verts</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original point&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">close_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">close_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;closest point on shape&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">p_list</span><span class="p">,</span> <span class="n">close_pts</span><span class="p">)):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.closest_point_on_vert_segments">
<code class="descclassname">vtool.geometry.</code><code class="descname">closest_point_on_vert_segments</code><span class="sig-paren">(</span><em>p</em>, <em>verts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#closest_point_on_vert_segments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.closest_point_on_vert_segments" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.geometry.cvt_bbox_xywh_to_pt1pt2">
<code class="descclassname">vtool.geometry.</code><code class="descname">cvt_bbox_xywh_to_pt1pt2</code><span class="sig-paren">(</span><em>xywh</em>, <em>sx=1.0</em>, <em>sy=1.0</em>, <em>round_=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#cvt_bbox_xywh_to_pt1pt2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.cvt_bbox_xywh_to_pt1pt2" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts bbox to thumb format with a scale factor</p>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.distance_to_lineseg">
<code class="descclassname">vtool.geometry.</code><code class="descname">distance_to_lineseg</code><span class="sig-paren">(</span><em>p</em>, <em>e1</em>, <em>e2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#distance_to_lineseg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.distance_to_lineseg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.geometry.draw_border">
<code class="descclassname">vtool.geometry.</code><code class="descname">draw_border</code><span class="sig-paren">(</span><em>img_in</em>, <em>color=(0</em>, <em>128</em>, <em>255)</em>, <em>thickness=2</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#draw_border"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.draw_border" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img_in</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>color</strong> (<em>tuple</em>) – in bgr</li>
<li><strong>thickness</strong> (<em>int</em>) – </li>
<li><strong>out</strong> (<em>None</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.geometry –test-draw_border –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_in</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:plottool)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">draw_border</span><span class="p">(</span><span class="n">img_in</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.draw_verts">
<code class="descclassname">vtool.geometry.</code><code class="descname">draw_verts</code><span class="sig-paren">(</span><em>img_in</em>, <em>verts</em>, <em>color=(0</em>, <em>128</em>, <em>255)</em>, <em>thickness=2</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#draw_verts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.draw_verts" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img_in</strong> – </li>
<li><strong>verts</strong> – </li>
<li><strong>color</strong> (<em>tuple</em>) – </li>
<li><strong>thickness</strong> (<em>int</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">img -  image data</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[uint8_t, ndim=2]</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.geometry –test-draw_verts –show
python -m vtool.geometry –test-draw_verts:0 –show
python -m vtool.geometry –test-draw_verts:1 –show</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/core/doc/drawing_functions.html#line">http://docs.opencv.org/modules/core/doc/drawing_functions.html#line</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_in</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">draw_verts</span><span class="p">(</span><span class="n">img_in</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_in</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">img</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">img</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">img_in</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_in</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">img_in</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">draw_verts</span><span class="p">(</span><span class="n">img_in</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_in</span> <span class="ow">is</span> <span class="n">img</span><span class="p">,</span> <span class="s1">&#39;should be in place&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">out</span> <span class="ow">is</span> <span class="n">img</span><span class="p">,</span> <span class="s1">&#39;should be in place&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<p>out = img_in = np.zeros((500, 500, 3), dtype=np.uint8)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.extent_from_bbox">
<code class="descclassname">vtool.geometry.</code><code class="descname">extent_from_bbox</code><span class="sig-paren">(</span><em>bbox</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#extent_from_bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.extent_from_bbox" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>bbox</strong> (<em>ndarray</em>) – tl_x, tl_y, w, h</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">tl_x, br_x, tl_y, br_y</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">extent (ndarray)</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/geometry.py extent_from_bbox</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">extent_from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;extent = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">extent = [0, 10, 0, 10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.extent_from_verts">
<code class="descclassname">vtool.geometry.</code><code class="descname">extent_from_verts</code><span class="sig-paren">(</span><em>verts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#extent_from_verts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.extent_from_verts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.geometry.get_pointset_extent_wh">
<code class="descclassname">vtool.geometry.</code><code class="descname">get_pointset_extent_wh</code><span class="sig-paren">(</span><em>pts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#get_pointset_extent_wh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.get_pointset_extent_wh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.geometry.get_pointset_extents">
<code class="descclassname">vtool.geometry.</code><code class="descname">get_pointset_extents</code><span class="sig-paren">(</span><em>pts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#get_pointset_extents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.get_pointset_extents" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.geometry.point_inside_bbox">
<code class="descclassname">vtool.geometry.</code><code class="descname">point_inside_bbox</code><span class="sig-paren">(</span><em>point</em>, <em>bbox</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#point_inside_bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.point_inside_bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Flags points that are strictly inside a bounding box.
Points on the boundary are not considered inside.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>point</strong> (<em>ndarray</em>) – one or more points to test (2xN)</li>
<li><strong>bbox</strong> (<em>tuple</em>) – a bounding box in  (x, y, w, h) format</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">True if the point is in the bbox</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool or ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.geometry point_inside_bbox –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flag</span> <span class="o">=</span> <span class="n">point_inside_bbox</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flag</span> <span class="o">=</span> <span class="n">flag</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;flag = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flag</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">verts_from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">flag</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">flag</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">~</span><span class="n">flag</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">~</span><span class="n">flag</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">flag = np.array([0, 0, 0, 0, 0, 0, 0, 0, 1, 0])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.scale_bbox">
<code class="descclassname">vtool.geometry.</code><code class="descname">scale_bbox</code><span class="sig-paren">(</span><em>bbox</em>, <em>sx</em>, <em>sy=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#scale_bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.scale_bbox" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.geometry.scale_extents">
<code class="descclassname">vtool.geometry.</code><code class="descname">scale_extents</code><span class="sig-paren">(</span><em>extents</em>, <em>sx</em>, <em>sy=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#scale_extents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.scale_extents" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>extent</strong> (<em>ndarray</em>) – tl_x, br_x, tl_y, br_y</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.scaled_verts_from_bbox">
<code class="descclassname">vtool.geometry.</code><code class="descname">scaled_verts_from_bbox</code><span class="sig-paren">(</span><em>bbox</em>, <em>theta</em>, <em>sx</em>, <em>sy</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#scaled_verts_from_bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.scaled_verts_from_bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Helps with drawing scaled bbounding boxes on thumbnails</p>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.scaled_verts_from_bbox_gen">
<code class="descclassname">vtool.geometry.</code><code class="descname">scaled_verts_from_bbox_gen</code><span class="sig-paren">(</span><em>bbox_list</em>, <em>theta_list</em>, <em>sx=1</em>, <em>sy=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#scaled_verts_from_bbox_gen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.scaled_verts_from_bbox_gen" title="Permalink to this definition">¶</a></dt>
<dd><p>Helps with drawing scaled bbounding boxes on thumbnails</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>bbox_list</strong> (<em>list</em>) – bboxes in x,y,w,h format</li>
<li><strong>theta_list</strong> (<em>list</em>) – rotation of bounding boxes</li>
<li><strong>sx</strong> (<em>float</em>) – x scale factor</li>
<li><strong>sy</strong> (<em>float</em>) – y scale factor</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Yeilds:</dt>
<dd>new_verts - vertices of scaled bounding box for every input</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-scaled_verts_from_bbox_gen</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sy</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_verts_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scaled_verts_from_bbox_gen</span><span class="p">(</span><span class="n">bbox_list</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_verts_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[[5, 5], [55, 5], [55, 55], [5, 55], [5, 5]]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.union_extents">
<code class="descclassname">vtool.geometry.</code><code class="descname">union_extents</code><span class="sig-paren">(</span><em>extents</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#union_extents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.union_extents" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.geometry.verts_from_bbox">
<code class="descclassname">vtool.geometry.</code><code class="descname">verts_from_bbox</code><span class="sig-paren">(</span><em>bbox</em>, <em>close=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#verts_from_bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.verts_from_bbox" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bbox</strong> (<em>tuple</em>) – bounding box in the format (x, y, w, h)</li>
<li><strong>close</strong> (<em>bool</em>) – (default = False)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">verts</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.geometry –test-verts_from_bbox</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">close</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="n">verts_from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">close</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;verts = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">verts</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">verts = ((10, 10), (60, 10), (60, 60), (10, 60))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.verts_list_from_bboxes_list">
<code class="descclassname">vtool.geometry.</code><code class="descname">verts_list_from_bboxes_list</code><span class="sig-paren">(</span><em>bboxes_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#verts_list_from_bboxes_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.verts_list_from_bboxes_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a four-vertex polygon from the bounding rectangle</p>
</dd></dl>

</div>
<div class="section" id="module-vtool.histogram">
<span id="vtool-histogram-module"></span><h2>vtool.histogram module<a class="headerlink" href="#module-vtool.histogram" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.histogram.argsubextrema2">
<code class="descclassname">vtool.histogram.</code><code class="descname">argsubextrema2</code><span class="sig-paren">(</span><em>op</em>, <em>ydata</em>, <em>xdata=None</em>, <em>thresh_factor=None</em>, <em>normalize_x=True</em>, <em>flat=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubextrema2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.argsubextrema2" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines approximate maxima values to subindex accuracy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ydata</strong> (<em>ndarray</em>) – ydata, histogram frequencies</li>
<li><strong>xdata</strong> (<em>ndarray</em>) – xdata, histogram labels</li>
<li><strong>thresh_factor</strong> (<em>float</em>) – cutoff point for labeing a value as a maxima</li>
<li><strong>flat</strong> (<em>bool</em>) – if True allows for flat extrema to be found.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(submaxima_x, submaxima_y)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram argsubmaxima
python -m vtool.histogram argsubmaxima –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh_factor</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">op</span> <span class="o">=</span> <span class="s1">&#39;min&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">argsubextrema2</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="p">,</span> <span class="n">thresh_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_hist_subbin_maxima</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Doctest:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh_factor</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">op</span> <span class="o">=</span> <span class="s1">&#39;max&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh_factor</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">argsubextrema2</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">thresh_factor</span><span class="o">=</span><span class="n">thresh_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">qtensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">doclf</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.argsubmax">
<code class="descclassname">vtool.histogram.</code><code class="descname">argsubmax</code><span class="sig-paren">(</span><em>ydata</em>, <em>xdata=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.argsubmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a single submaximum value to subindex accuracy.
If xdata is not specified, submax_x is a fractional index.
Otherwise, submax_x is sub-xdata (essentially doing the index interpolation
for you)</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span>  <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="p">[</span><span class="mi">00</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span>  <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">argsubmax</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">argsubmax</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="n">xdata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">([</span><span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">],</span> <span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(2.1667, 2.0208),</span>
<span class="go">(21.6667, 2.0208),</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span><span class="o">=</span><span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argsubmax</span><span class="p">(</span><span class="n">hist_</span><span class="p">)</span>
<span class="go">(4.0, 4.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.argsubmax2">
<code class="descclassname">vtool.histogram.</code><code class="descname">argsubmax2</code><span class="sig-paren">(</span><em>ydata</em>, <em>xdata=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmax2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.argsubmax2" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a single submaximum value to subindex accuracy.
If xdata is not specified, submax_x is a fractional index.
This version always normalizes x-coordinates.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span>  <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="p">[</span><span class="mi">00</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span>  <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">argsubmax</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">argsubmax</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="n">xdata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">([</span><span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">],</span> <span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(2.1667, 2.0208),</span>
<span class="go">(21.6667, 2.0208),</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh_factor</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argsubmax</span><span class="p">(</span><span class="n">hist_</span><span class="p">)</span>
<span class="go">(4.0, 4.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.argsubmaxima">
<code class="descclassname">vtool.histogram.</code><code class="descname">argsubmaxima</code><span class="sig-paren">(</span><em>hist</em>, <em>centers=None</em>, <em>maxima_thresh=None</em>, <em>_debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmaxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.argsubmaxima" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines approximate maxima values to subindex accuracy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hist</strong> (<em>ndarray</em>) – ydata, histogram frequencies</li>
<li><strong>centers</strong> (<em>ndarray</em>) – xdata, histogram labels</li>
<li><strong>maxima_thresh</strong> (<em>float</em>) – cutoff point for labeing a value as a maxima</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(submaxima_x, submaxima_y)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram argsubmaxima
python -m vtool.histogram argsubmaxima –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">argsubmaxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_hist_subbin_maxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">(array([ 3.0318792]), array([ 37.19208239]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.argsubmaxima2">
<code class="descclassname">vtool.histogram.</code><code class="descname">argsubmaxima2</code><span class="sig-paren">(</span><em>ydata</em>, <em>xdata=None</em>, <em>thresh_factor=None</em>, <em>normalize_x=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmaxima2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.argsubmaxima2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.histogram.argsubmin2">
<code class="descclassname">vtool.histogram.</code><code class="descname">argsubmin2</code><span class="sig-paren">(</span><em>ydata</em>, <em>xdata=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmin2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.argsubmin2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.histogram.argsubminima2">
<code class="descclassname">vtool.histogram.</code><code class="descname">argsubminima2</code><span class="sig-paren">(</span><em>ydata</em>, <em>xdata=None</em>, <em>thresh_factor=None</em>, <em>normalize_x=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubminima2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.argsubminima2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.histogram.get_histinfo_str">
<code class="descclassname">vtool.histogram.</code><code class="descname">get_histinfo_str</code><span class="sig-paren">(</span><em>hist</em>, <em>edges</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#get_histinfo_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.get_histinfo_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.histogram.hist_argmaxima">
<code class="descclassname">vtool.histogram.</code><code class="descname">hist_argmaxima</code><span class="sig-paren">(</span><em>hist</em>, <em>centers=None</em>, <em>maxima_thresh=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#hist_argmaxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.hist_argmaxima" title="Permalink to this definition">¶</a></dt>
<dd><p>must take positive only values</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram hist_argmaxima</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>    <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_x</span><span class="p">,</span> <span class="n">maxima_y</span><span class="p">,</span> <span class="n">argmaxima</span> <span class="o">=</span> <span class="n">hist_argmaxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">maxima_x</span><span class="p">,</span> <span class="n">maxima_y</span><span class="p">,</span> <span class="n">argmaxima</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.hist_argmaxima2">
<code class="descclassname">vtool.histogram.</code><code class="descname">hist_argmaxima2</code><span class="sig-paren">(</span><em>hist</em>, <em>maxima_thresh=0.8</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#hist_argmaxima2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.hist_argmaxima2" title="Permalink to this definition">¶</a></dt>
<dd><p>must take positive only values</p>
<dl class="docutils">
<dt>Setup:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
</pre></div>
</div>
</dd>
<dt>GridSearch:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argmaxima</span> <span class="o">=</span> <span class="n">hist_argmaxima2</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">argmaxima</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.hist_edges_to_centers">
<code class="descclassname">vtool.histogram.</code><code class="descname">hist_edges_to_centers</code><span class="sig-paren">(</span><em>edges</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#hist_edges_to_centers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.hist_edges_to_centers" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.79</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">1.57</span><span class="p">,</span> <span class="mf">2.36</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.93</span><span class="p">,</span> <span class="mf">4.71</span><span class="p">,</span> <span class="mf">5.50</span><span class="p">,</span> <span class="mf">6.28</span><span class="p">,</span> <span class="mf">7.07</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">hist_edges_to_centers</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[-0.395  0.395  1.18   1.965  2.75   3.535  4.32   5.105  5.89   6.675]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.interpolate_submaxima">
<code class="descclassname">vtool.histogram.</code><code class="descname">interpolate_submaxima</code><span class="sig-paren">(</span><em>argmaxima</em>, <em>hist_</em>, <em>centers=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#interpolate_submaxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.interpolate_submaxima" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>argmaxima</strong> (<em>ndarray</em>) – indicies into ydata / centers that are argmaxima</li>
<li><strong>hist</strong> (<em>ndarray</em>) – ydata, histogram frequencies</li>
<li><strong>centers</strong> (<em>ndarray</em>) – xdata, histogram labels</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>FIXME:</dt>
<dd>what happens when argmaxima[i] == len(<a href="#id31"><span class="problematic" id="id32">hist_</span></a>)</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram –test-interpolate_submaxima –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argmaxima</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>    <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span> <span class="o">=</span> <span class="n">interpolate_submaxima</span><span class="p">(</span><span class="n">argmaxima</span><span class="p">,</span> <span class="n">hist_</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">interpolate_submaxima</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                           <span class="n">key_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x123&#39;</span><span class="p">,</span> <span class="s1">&#39;y123&#39;</span><span class="p">,</span> <span class="s1">&#39;coeff_list&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x123</span><span class="p">,</span> <span class="n">y123</span><span class="p">,</span> <span class="n">coeff_list</span> <span class="o">=</span> <span class="n">locals_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ensure_fnum</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">hist_</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">centers</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">hist_</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;argmaxima&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;interp maxima&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Extract parabola points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x123</span><span class="p">,</span> <span class="n">y123</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;maxima neighbors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xpoints</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">)</span> <span class="ow">in</span> <span class="n">x123</span><span class="o">.</span><span class="n">T</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ypoints</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">x_pts</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_pts</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">coeff_list</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw Submax Parabola</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x_pts</span><span class="p">,</span> <span class="n">y_pts</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">ypoints</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_pts</span><span class="p">,</span> <span class="n">y_pts</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([ 0.15,  3.03,  5.11], dtype=np.float64),</span>
<span class="go">np.array([  9.2 ,  37.19,   0.  ], dtype=np.float64),</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argmaxima</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.interpolated_histogram">
<code class="descclassname">vtool.histogram.</code><code class="descname">interpolated_histogram</code><span class="sig-paren">(</span><em>data</em>, <em>weights</em>, <em>range_</em>, <em>bins</em>, <em>interpolation_wrap=True</em>, <em>_debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#interpolated_histogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.interpolated_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Follows np.histogram, but does interpolation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<em>ndarray</em>) – </li>
<li><strong>weights</strong> (<em>ndarray</em>) – </li>
<li><strong>range</strong> (<em>tuple</em>) – range from 0 to 1</li>
<li><strong>bins</strong> (<em>int</em>) – </li>
<li><strong>interpolation_wrap</strong> (<em>bool</em>) – (default = True)</li>
<li><strong>_debug</strong> (<em>bool</em>) – (default = False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram –test-interpolated_histogram</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">3.5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">range_</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interpolation_wrap</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">interpolated_histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">range_</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">interpolation_wrap</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">hist</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">1E-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">hist</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">edges</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_histinfo_str</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">3.5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">range_</span> <span class="o">=</span> <span class="p">(</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interpolation_wrap</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">interpolated_histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">range_</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">interpolation_wrap</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">hist</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">1E-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">hist</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">edges</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_histinfo_str</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.linear_interpolation">
<code class="descclassname">vtool.histogram.</code><code class="descname">linear_interpolation</code><span class="sig-paren">(</span><em>arr</em>, <em>subindices</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#linear_interpolation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.linear_interpolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Does linear interpolation to lookup subindex values</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subindices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subvalues</span> <span class="o">=</span> <span class="n">linear_interpolation</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">subindices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">subindices</span><span class="p">,</span> <span class="n">subvalues</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="mf">2.3</span><span class="p">,</span> <span class="n">linear_interpolation</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.maxima_neighbors">
<code class="descclassname">vtool.histogram.</code><code class="descname">maxima_neighbors</code><span class="sig-paren">(</span><em>argmaxima</em>, <em>hist_</em>, <em>centers=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#maxima_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.maxima_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.histogram.maximum_parabola_point">
<code class="descclassname">vtool.histogram.</code><code class="descname">maximum_parabola_point</code><span class="sig-paren">(</span><em>A</em>, <em>B</em>, <em>C</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#maximum_parabola_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.maximum_parabola_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum x point is where the derivative is 0</p>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.show_hist_submaxima">
<code class="descclassname">vtool.histogram.</code><code class="descname">show_hist_submaxima</code><span class="sig-paren">(</span><em>hist_</em>, <em>edges=None</em>, <em>centers=None</em>, <em>maxima_thresh=0.8</em>, <em>pnum=(1</em>, <em>1</em>, <em>1)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#show_hist_submaxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.show_hist_submaxima" title="Permalink to this definition">¶</a></dt>
<dd><p>For C++ to show data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>hist</strong> – </li>
<li><strong>edges</strong> (<em>None</em>) – </li>
<li><strong>centers</strong> (<em>None</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram –test-show_hist_submaxima –show
python -m pyhesaff._pyhesaff –test-test_rot_invar –show
python -m vtool.histogram –test-show_hist_submaxima –dpath figures –save ~/latex/crall-candidacy-2015/figures/show_hist_submaxima.jpg</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--hist&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--edges&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--maxima_thresh&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=.</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_hist_submaxima</span><span class="p">(</span><span class="n">hist_</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.show_ori_image">
<code class="descclassname">vtool.histogram.</code><code class="descname">show_ori_image</code><span class="sig-paren">(</span><em>gori</em>, <em>weights</em>, <em>patch</em>, <em>gradx=None</em>, <em>grady=None</em>, <em>gauss=None</em>, <em>fnum=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#show_ori_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.show_ori_image" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m pyhesaff._pyhesaff –test-test_rot_invar –show –nocpp</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.show_ori_image_ondisk">
<code class="descclassname">vtool.histogram.</code><code class="descname">show_ori_image_ondisk</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#show_ori_image_ondisk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.show_ori_image_ondisk" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd><p class="first">python -m vtool.histogram –test-show_ori_image_ondisk –show</p>
<p>python -m vtool.histogram –test-show_ori_image_ondisk –show –patch_img_fpath patches/KP_0_PATCH.png –ori_img_fpath patches/KP_0_orientations01.png –weights_img_fpath patches/KP_0_WEIGHTS.png –grady_img_fpath patches/KP_0_ygradient.png –gradx_img_fpath patches/KP_0_xgradient.png –title cpp_show_ori_ondisk</p>
<p class="last">python -m pyhesaff._pyhesaff –test-test_rot_invar –show –rebuild-hesaff –no-rmbuild</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">show_ori_image_ondisk</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.subbin_bounds">
<code class="descclassname">vtool.histogram.</code><code class="descname">subbin_bounds</code><span class="sig-paren">(</span><em>z</em>, <em>radius</em>, <em>low</em>, <em>high</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#subbin_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.subbin_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets quantized bounds of a sub-bin/pixel point and a radius.
Useful for cropping using subpixel points</p>
<dl class="docutils">
<dt>Illustration::</dt>
<dd><p class="first">(the bin edges are pipes)
(the bin centers are pluses)</p>
<p>Input = {‘z’: 1.5, ‘radius’:5.666, ‘low’:0, ‘high’:7}
Output = {‘z1’:0, ‘z2’: 7, ‘offst’: 5.66}</p>
<div class="line-block">
<div class="line">|   |   |   |   |   |   |   |</div>
</div>
<dl class="last docutils">
<dt><a href="#id23"><span class="problematic" id="id24">|_+_|_+_|_+_|_+_|_+_|_+_|_+_|_+_|</span></a></dt>
<dd><p class="first">^     ^                     ^
z1    z                     z2</p>
<blockquote>
<div>,.___.___.___.___.___.   &lt; radius (5.333)</div></blockquote>
<dl class="docutils">
<dt>.—.-,                        &lt; z_offset1 (1.6666)</dt>
<dd>,_.___.___.___.___.___.  &lt; z_offset2 (5.666)</dd>
</dl>
<p class="last">.—.-,                        &lt; z_offset1 (1.6666)</p>
</dd>
</dl>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>z</strong> (<em>float</em>) – center of a circle a 1d pixel array</li>
<li><strong>radius</strong> (<em>float</em>) – radius of the circle</li>
<li><strong>low</strong> (<em>int</em>) – minimum index of 1d pixel array</li>
<li><strong>high</strong> (<em>int</em>) – maximum index of 1d pixel array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>(iz1, iz2, z_offst) - quantized_bounds and subbin_offset</dt>
<dd><p class="first last">iz1 - low radius endpoint
iz2 - high radius endpoint
z_offst - subpixel offset
#Returns: quantized_bounds=(iz1, iz2), subbin_offset</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram –test-subbin_bounds</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius</span> <span class="o">=</span> <span class="mf">5.666</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">low</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">high</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">iz1</span><span class="p">,</span> <span class="n">iz2</span><span class="p">,</span> <span class="n">z_offst</span><span class="p">)</span> <span class="o">=</span> <span class="n">subbin_bounds</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">iz1</span><span class="p">,</span> <span class="n">iz2</span><span class="p">,</span> <span class="n">z_offst</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(0, 7, 1.5)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.wrap_histogram">
<code class="descclassname">vtool.histogram.</code><code class="descname">wrap_histogram</code><span class="sig-paren">(</span><em>hist_</em>, <em>edges_</em>, <em>_debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#wrap_histogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.wrap_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulates the first and last histogram bin being being adjacent to one another
by replicating those bins at the last and first positions respectively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hist</strong> (<em>ndarray</em>) – </li>
<li><strong>edges</strong> (<em>ndarray</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(hist_wrap, edge_wrap)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram –test-wrap_histogram</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">8.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">34.32</span><span class="p">,</span> <span class="mf">29.45</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.78539816</span><span class="p">,</span>  <span class="mf">1.57079633</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="mf">2.35619449</span><span class="p">,</span>  <span class="mf">3.14159265</span><span class="p">,</span>  <span class="mf">3.92699081</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="mf">4.71238898</span><span class="p">,</span>  <span class="mf">5.49778714</span><span class="p">,</span>  <span class="mf">6.2831853</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">hist_wrap</span><span class="p">,</span> <span class="n">edge_wrap</span><span class="p">)</span> <span class="o">=</span> <span class="n">wrap_histogram</span><span class="p">(</span><span class="n">hist_</span><span class="p">,</span> <span class="n">edges_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">hist_wrap</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">edge_wrap</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[6.73, 8.00, 0.00, 0.00, 34.32, 29.45, 0.00, 0.00, 6.73, 8.00],</span>
<span class="go">[-0.79, 0.00, 0.79, 1.57, 2.36, 3.14, 3.93, 4.71, 5.50, 6.28, 7.07],</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.image">
<span id="vtool-image-module"></span><h2>vtool.image module<a class="headerlink" href="#module-vtool.image" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.image.affine_warp_around_center">
<code class="descclassname">vtool.image.</code><code class="descname">affine_warp_around_center</code><span class="sig-paren">(</span><em>img</em>, <em>sx=1</em>, <em>sy=1</em>, <em>theta=0</em>, <em>shear=0</em>, <em>tx=0</em>, <em>ty=0</em>, <em>dsize=None</em>, <em>borderMode=0</em>, <em>flags=4</em>, <em>out=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#affine_warp_around_center"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.affine_warp_around_center" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-affine_warp_around_center –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shear</span> <span class="o">=</span> <span class="o">.</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ty</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sy</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">borderMode</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_CONSTANT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">INTER_LANCZOS4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_warped</span> <span class="o">=</span> <span class="n">affine_warp_around_center</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">sx</span><span class="o">=</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="o">=</span><span class="n">sy</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">theta</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="o">=</span><span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="o">=</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="o">=</span><span class="n">ty</span><span class="p">,</span> <span class="n">dsize</span><span class="o">=</span><span class="n">dsize</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">borderMode</span><span class="o">=</span><span class="n">borderMode</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span> <span class="n">borderValue</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">img_warped</span> <span class="o">*</span> <span class="mf">255.0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.clipwhite">
<code class="descclassname">vtool.image.</code><code class="descname">clipwhite</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#clipwhite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.clipwhite" title="Permalink to this definition">¶</a></dt>
<dd><p>Strips white borders off an image</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.clipwhite_ondisk">
<code class="descclassname">vtool.image.</code><code class="descname">clipwhite_ondisk</code><span class="sig-paren">(</span><em>fpath_in</em>, <em>fpath_out=None</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#clipwhite_ondisk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.clipwhite_ondisk" title="Permalink to this definition">¶</a></dt>
<dd><p>Strips white borders off an image on disk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fpath_in</strong> (<em>str</em>) – </li>
<li><strong>fpath_out</strong> (<em>None</em>) – (default = None)</li>
<li><strong>verbose</strong> (<em>bool</em>) – verbosity flag(default = True)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">fpath_out</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">str</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image clipwhite_ondisk</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.image.combine_offset_lists">
<code class="descclassname">vtool.image.</code><code class="descname">combine_offset_lists</code><span class="sig-paren">(</span><em>offsets_list</em>, <em>sfs_list</em>, <em>offset_tups</em>, <em>sf_tups</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#combine_offset_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.combine_offset_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper for stacking</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.convert_colorspace">
<code class="descclassname">vtool.image.</code><code class="descname">convert_colorspace</code><span class="sig-paren">(</span><em>img</em>, <em>colorspace</em>, <em>src_colorspace='BGR'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#convert_colorspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.convert_colorspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts colorspace of img.
Convinience function around cv2.cvtColor</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>colorspace</strong> (<em>str</em>) – RGB, LAB, etc</li>
<li><strong>src_colorspace</strong> (<em>unicode</em>) – (default = u’BGR’)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">img -  image data</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[uint8_t, ndim=2]</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image convert_colorspace –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;zebra.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://itsnasb.com/wp-content/uploads/2013/03/lisa-frank-logo1.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_float</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_float01</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">colorspace</span> <span class="o">=</span> <span class="s1">&#39;LAB&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">src_colorspace</span> <span class="o">=</span> <span class="s1">&#39;BGR&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgLAB</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgL</span> <span class="o">=</span> <span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillL</span> <span class="o">=</span> <span class="n">imgL</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillAB</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">is_float</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">else</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgAB_LAB</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">fillL</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgA_LAB</span>  <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="n">fillL</span><span class="p">,</span> <span class="n">fillAB</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB_LAB</span>  <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="n">fillL</span><span class="p">,</span> <span class="n">fillAB</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgAB_BGR</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">imgAB_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgA_BGR</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">imgA_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB_BGR</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">imgB_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#imgAB_HSV = convert_colorspace(convert_colorspace(imgAB_LAB, &#39;LAB&#39;, &#39;BGR&#39;), &#39;BGR&#39;, &#39;HSV&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgAB_HSV</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="s1">&#39;HSV&#39;</span><span class="p">,</span> <span class="s1">&#39;BGR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgAB_HSV</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">6</span> <span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">is_float</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">else</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgCOLOR_BRG</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">imgAB_HSV</span><span class="p">,</span> <span class="s1">&#39;BGR&#39;</span><span class="p">,</span> <span class="s1">&#39;HSV&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;L (lightness)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A (grayscale)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B (grayscale)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgCOLOR_BRG</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Hue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgAB_BGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A+B (color overlay)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgA_BGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A (Red-Green)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB_BGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B (Blue-Yellow)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgblind_LAB</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">fillAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgblind_BRG</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">rgblind_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">byblind_LAB</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">fillAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">byblind_BGR</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">byblind_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">byblind_BGR</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;colorblind B-Y&#39;</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rgblind_BRG</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;colorblind R-G&#39;</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.convert_image_list_colorspace">
<code class="descclassname">vtool.image.</code><code class="descname">convert_image_list_colorspace</code><span class="sig-paren">(</span><em>image_list</em>, <em>colorspace</em>, <em>src_colorspace='BGR'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#convert_image_list_colorspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.convert_image_list_colorspace" title="Permalink to this definition">¶</a></dt>
<dd><p>converts a list of images from &lt;src_colorspace&gt; to &lt;colorspace&gt;</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.crop_out_imgfill">
<code class="descclassname">vtool.image.</code><code class="descname">crop_out_imgfill</code><span class="sig-paren">(</span><em>img</em>, <em>fillval=None</em>, <em>thresh=0</em>, <em>channel=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#crop_out_imgfill"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.crop_out_imgfill" title="Permalink to this definition">¶</a></dt>
<dd><p>Crops image to remove fillval</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>fillval</strong> (<em>None</em>) – (default = None)</li>
<li><strong>thresh</strong> (<em>int</em>) – (default = 0)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">cropped_img</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –exec-crop_out_imgfill</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_stripe_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="n">img</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_GRAY2RGB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_img</span> <span class="o">=</span> <span class="n">crop_out_imgfill</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">fillval</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_img2</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">cropped_img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_RGB2GRAY</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;cropped_img2 = </span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cropped_img2</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_stripe_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="n">img</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillval</span> <span class="o">=</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_img</span> <span class="o">=</span> <span class="n">crop_out_imgfill</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">fillval</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;cropped_img = </span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cropped_img</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.cvt_BGR2L">
<code class="descclassname">vtool.image.</code><code class="descname">cvt_BGR2L</code><span class="sig-paren">(</span><em>imgBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#cvt_BGR2L"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.cvt_BGR2L" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.cvt_BGR2RGB">
<code class="descclassname">vtool.image.</code><code class="descname">cvt_BGR2RGB</code><span class="sig-paren">(</span><em>imgBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#cvt_BGR2RGB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.cvt_BGR2RGB" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.draw_text">
<code class="descclassname">vtool.image.</code><code class="descname">draw_text</code><span class="sig-paren">(</span><em>img, text, org, textcolor_rgb=[0, 0, 0], fontScale=1, thickness=2, fontFace=0, lineType=16, bottomLeftOrigin=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#draw_text"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.draw_text" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-draw_text:0 –show
python -m vtool.image –test-draw_text:1 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">font_names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cv2</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;FONT_H&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;opencv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">400</span><span class="p">,</span> <span class="mi">1024</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fontScale</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CV_AA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">font_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">font_names</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">font_name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fontFace</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">font_name</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">count</span> <span class="o">*</span> <span class="mi">45</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;opencv - &#39;</span> <span class="o">+</span> <span class="n">font_name</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">draw_text</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">org</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">fontFace</span><span class="o">=</span><span class="n">fontFace</span><span class="p">,</span> <span class="n">textcolor_rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="n">fontScale</span><span class="o">=</span><span class="n">fontScale</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">font_names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cv2</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;FONT_H&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;opencv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">400</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span> <span class="p">:</span><span class="mi">512</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">200</span><span class="p">:,</span> <span class="mi">512</span><span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fontScale</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CV_AA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">font_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">font_names</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">font_name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fontFace</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">font_name</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">count</span> <span class="o">*</span> <span class="mi">45</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;opencv - &#39;</span> <span class="o">+</span> <span class="n">font_name</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">draw_text</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">org</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">fontFace</span><span class="o">=</span><span class="n">fontFace</span><span class="p">,</span> <span class="n">textcolor_rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="n">fontScale</span><span class="o">=</span><span class="n">fontScale</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<p>where each of the font IDs can be combined with FONT_ITALIC to get the slanted letters.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.embed_channels">
<code class="descclassname">vtool.image.</code><code class="descname">embed_channels</code><span class="sig-paren">(</span><em>img</em>, <em>input_channels=(0</em>, <em>)</em>, <em>nchannels=3</em>, <em>fill=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#embed_channels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.embed_channels" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>input_channels</strong> (<em>tuple</em>) – (default = (0,))</li>
<li><strong>nchannels</strong> (<em>int</em>) – (default = 3)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image embed_channels –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Embed a (N,M,2) image into an (N,M,3) image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_channels</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nchannels</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newimg</span> <span class="o">=</span> <span class="n">embed_channels</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">input_channels</span><span class="p">,</span> <span class="n">nchannels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">newimg</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">newimg</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">input_channels</span><span class="p">]</span> <span class="o">==</span> <span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.embed_in_square_image">
<code class="descclassname">vtool.image.</code><code class="descname">embed_in_square_image</code><span class="sig-paren">(</span><em>img</em>, <em>target_size</em>, <em>img_origin=(0.5</em>, <em>0.5)</em>, <em>target_origin=(0.5</em>, <em>0.5)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#embed_in_square_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.embed_in_square_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Embeds an image in the center of an empty image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>target_size</strong> (<em>tuple</em>) – </li>
<li><strong>offset</strong> (<em>tuple</em>) – position of</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">img_sqare</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image embed_in_square_image –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_size</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">))</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_origin</span> <span class="o">=</span> <span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_origin</span> <span class="o">=</span> <span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_square</span> <span class="o">=</span> <span class="n">embed_in_square_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">target_size</span><span class="p">,</span> <span class="n">img_origin</span><span class="p">,</span> <span class="n">target_origin</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_square</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="n">img</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img_square</span><span class="p">)</span> <span class="o">==</span> <span class="n">target_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_origin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_origin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_square2</span> <span class="o">=</span> <span class="n">embed_in_square_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">target_size</span><span class="p">,</span> <span class="n">img_origin</span><span class="p">,</span> <span class="n">target_origin</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_square</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="n">img</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img_square</span><span class="p">)</span> <span class="o">==</span> <span class="n">target_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_square</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_square2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.ensure_3channel">
<code class="descclassname">vtool.image.</code><code class="descname">ensure_3channel</code><span class="sig-paren">(</span><em>patch</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#ensure_3channel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.ensure_3channel" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRICATE IN FAVOR OF atleast_3channels?</p>
<p>Ensures that there are 3 channels in the image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>patch</strong> (<em>ndarray</em><em>[</em><em>N</em><em>, </em><em>M</em><em>, </em><em>..</em><em>]</em>) – the image</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">[N, M, 3]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –exec-ensure_3channel –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch1</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;astro.png&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">:</span><span class="mi">512</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span> <span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;ada.jpg&#39;</span><span class="p">))[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch3</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;jeff.png&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">:</span><span class="mi">390</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">400</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res1</span> <span class="o">=</span> <span class="n">ensure_3channel</span><span class="p">(</span><span class="n">patch1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res2</span> <span class="o">=</span> <span class="n">ensure_3channel</span><span class="p">(</span><span class="n">patch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res3</span> <span class="o">=</span> <span class="n">ensure_3channel</span><span class="p">(</span><span class="n">patch3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">patch1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;failed test1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">patch2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;failed test2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">patch3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;failed test3&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.ensure_4channel">
<code class="descclassname">vtool.image.</code><code class="descname">ensure_4channel</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#ensure_4channel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.ensure_4channel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.filterflags_valid_images">
<code class="descclassname">vtool.image.</code><code class="descname">filterflags_valid_images</code><span class="sig-paren">(</span><em>gpaths</em>, <em>valid_formats=None</em>, <em>invalid_formats=None</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#filterflags_valid_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.filterflags_valid_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Flags images with a format that disagrees with its extension</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gpaths</strong> (<em>list</em>) – list of image paths</li>
<li><strong>valid_formats</strong> (<em>None</em>) – (default = None)</li>
<li><strong>invalid_formats</strong> (<em>None</em>) – (default = None)</li>
<li><strong>verbose</strong> (<em>bool</em>) – verbosity flag(default = True)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">isvalid_flags</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image filterflags_valid_images –show</dd>
</dl>
<p class="rubric">Notes</p>
<p>An MPO (Multi Picture Object) file is a stereoscopic image and contains
two JPG images side-by-side, and allows them to be viewed as a single
3D image.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gpaths</span> <span class="o">=</span> <span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;astro.png&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">filterflags_valid_images</span><span class="p">(</span><span class="n">gpaths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.find_pixel_value_index">
<code class="descclassname">vtool.image.</code><code class="descname">find_pixel_value_index</code><span class="sig-paren">(</span><em>img</em>, <em>pixel</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#find_pixel_value_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.find_pixel_value_index" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>pixel</strong> (<em>ndarray</em><em> or </em><em>scalar</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –test-find_pixel_value_index</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/21407815/get-column-row-index-from-numpy-array-that-meets-a-boolean-condition">http://stackoverflow.com/questions/21407815/get-column-row-index-from-numpy-array-that-meets-a-boolean-condition</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pixel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">find_pixel_value_index</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pixel</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[0 0]</span>
<span class="go"> [1 1]</span>
<span class="go"> [2 0]</span>
<span class="go"> [2 3]</span>
<span class="go"> [5 5]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.get_num_channels">
<code class="descclassname">vtool.image.</code><code class="descname">get_num_channels</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_num_channels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.get_num_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of color channels</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.get_pixel_dist">
<code class="descclassname">vtool.image.</code><code class="descname">get_pixel_dist</code><span class="sig-paren">(</span><em>img</em>, <em>pixel</em>, <em>channel=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_pixel_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.get_pixel_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>pixel = fillval
isfill = mask2d</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.get_round_scaled_dsize">
<code class="descclassname">vtool.image.</code><code class="descname">get_round_scaled_dsize</code><span class="sig-paren">(</span><em>dsize</em>, <em>scale</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_round_scaled_dsize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.get_round_scaled_dsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an integer size and scale that best approximates
the floating point scale on the original size</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dsize</strong> (<em>tuple</em>) – original width height</li>
<li><strong>scale</strong> (<em>float</em><em> or </em><em>tuple</em>) – desired floating point scale factor</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.image.get_scale_factor">
<code class="descclassname">vtool.image.</code><code class="descname">get_scale_factor</code><span class="sig-paren">(</span><em>src_img</em>, <em>dst_img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_scale_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.get_scale_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>returns scale factor from one image to the next</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.get_size">
<code class="descclassname">vtool.image.</code><code class="descname">get_size</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.get_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the image size in (width, height)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.imread">
<code class="descclassname">vtool.image.</code><code class="descname">imread</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>grayscale=False</em>, <em>orient=False</em>, <em>flags=None</em>, <em>force_pil=None</em>, <em>delete_if_corrupted=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imread"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.imread" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around the opencv imread function. Handles remote uris.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img_fpath</strong> (<em>str</em>) – file path string</li>
<li><strong>grayscale</strong> (<em>bool</em>) – (default = False)</li>
<li><strong>orient</strong> (<em>bool</em>) – (default = False)</li>
<li><strong>flags</strong> (<em>None</em>) – opencv flags (default = None)</li>
<li><strong>force_pil</strong> (<em>bool</em>) – (default = None)</li>
<li><strong>delete_if_corrupted</strong> (<em>bool</em>) – (default = False)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">imgBGR</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-imread
python -m vtool.image –test-imread:1
python -m vtool.image –test-imread:2</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/core/doc/utility_and_system_functions_and_macros.html#error">http://docs.opencv.org/modules/core/doc/utility_and_system_functions_and_macros.html#error</a>
<a class="reference external" href="http://stackoverflow.com/questions/23572241/cv2-threshold-error-210">http://stackoverflow.com/questions/23572241/cv2-threshold-error-210</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR1</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR2</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR3</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">imgBGR1</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">imgBGR2</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># assert np.all(imgBGR1 == imgBGR3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR3</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_url</span> <span class="o">=</span> <span class="s1">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="n">img_url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR1</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR2</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#imgBGR2 = imread(img_fpath, force_pil=False, flags=cv2.IMREAD_UNCHANGED)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;imgBGR.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">imgBGR1</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;imgBGR2.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">imgBGR2</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">imgBGR1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff_pxls</span> <span class="o">=</span> <span class="n">imgBGR1</span> <span class="o">!=</span> <span class="n">imgBGR2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_diff_pxls</span> <span class="o">=</span> <span class="n">diff_pxls</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;num_diff_pxls=</span><span class="si">%r</span><span class="s1">/</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">num_diff_pxls</span><span class="p">,</span> <span class="n">diff_pxls</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">num_diff_pxls</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diffMag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">imgBGR2</span> <span class="o">/</span> <span class="mf">255.</span> <span class="o">-</span> <span class="n">imgBGR1</span> <span class="o">/</span> <span class="mf">255.</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">diffMag</span> <span class="o">/</span> <span class="n">diffMag</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">(2736, 3648, 3)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://www.sherv.net/cm/emo/funny/2/big-dancing-banana-smiley-emoticon.gif&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_if_corrupted</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grayscale</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="n">grayscale</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.imread_remote_s3">
<code class="descclassname">vtool.image.</code><code class="descname">imread_remote_s3</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imread_remote_s3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.imread_remote_s3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.imread_remote_url">
<code class="descclassname">vtool.image.</code><code class="descname">imread_remote_url</code><span class="sig-paren">(</span><em>img_url</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imread_remote_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.imread_remote_url" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.imwrite">
<code class="descclassname">vtool.image.</code><code class="descname">imwrite</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>imgBGR</em>, <em>fallback=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imwrite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.imwrite" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/highgui/doc/reading_and_writing_images_and_video.html">http://docs.opencv.org/modules/highgui/doc/reading_and_writing_images_and_video.html</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img_fpath</strong> (<em>str</em>) – file path string</li>
<li><strong>imgBGR</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data in opencv format (blue, green, red)</li>
<li><strong>fallback</strong> (<em>bool</em>) – (default = False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –exec-imwrite</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;zebra.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_dpath</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">ensure_app_cache_dir</span><span class="p">(</span><span class="s1">&#39;vtool&#39;</span><span class="p">,</span> <span class="s1">&#39;testwrite&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">unixjoin</span><span class="p">(</span><span class="n">img_dpath</span><span class="p">,</span> <span class="s1">&#39;zebra.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fallback</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imwrite</span><span class="p">(</span><span class="n">img_fpath2</span><span class="p">,</span> <span class="n">imgBGR</span><span class="p">,</span> <span class="n">fallback</span><span class="o">=</span><span class="n">fallback</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">imgBGR2</span> <span class="o">==</span> <span class="n">imgBGR</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.imwrite_fallback">
<code class="descclassname">vtool.image.</code><code class="descname">imwrite_fallback</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>imgBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imwrite_fallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.imwrite_fallback" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.infer_vert">
<code class="descclassname">vtool.image.</code><code class="descname">infer_vert</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>vert</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#infer_vert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.infer_vert" title="Permalink to this definition">¶</a></dt>
<dd><p>which is the better stack dimension</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.make_channels_comparable">
<code class="descclassname">vtool.image.</code><code class="descname">make_channels_comparable</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#make_channels_comparable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.make_channels_comparable" title="Permalink to this definition">¶</a></dt>
<dd><p>Broadcasts image arrays so they can have elementwise operations applied</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image make_channels_comparable</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_basis</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">wh_basis</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">shape_basis</span> <span class="o">=</span> <span class="p">[(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Test all permutations of shap inputs</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">shape1</span><span class="p">,</span> <span class="n">shape2</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">shape_basis</span><span class="p">,</span> <span class="n">shape_basis</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*    input shapes: </span><span class="si">%r</span><span class="s1">, </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">shape1</span><span class="p">,</span> <span class="n">shape2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">img1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">img2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">make_channels_comparable</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;... output shapes: </span><span class="si">%r</span><span class="s1">, </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">img2</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">elem</span> <span class="o">=</span> <span class="p">(</span><span class="n">img1</span> <span class="o">+</span> <span class="n">img2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;... elem(+) shape: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">assert</span> <span class="n">elem</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">img1</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="s1">&#39;outputs should have same size&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">assert</span> <span class="n">img1</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">img2</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="s1">&#39;new imgs should have same size&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.make_white_transparent">
<code class="descclassname">vtool.image.</code><code class="descname">make_white_transparent</code><span class="sig-paren">(</span><em>imgBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#make_white_transparent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.make_white_transparent" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>imgBGR</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data (blue, green, red)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">imgBGRA</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image make_white_transparent –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fpath&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGRA</span> <span class="o">=</span> <span class="n">make_white_transparent</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;imgBGRA = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">imgBGRA</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.montage">
<code class="descclassname">vtool.image.</code><code class="descname">montage</code><span class="sig-paren">(</span><em>img_list</em>, <em>dsize</em>, <em>rng=&lt;module 'numpy.random' from '/Users/jason.parham/virtualenv/wildme3/lib/python3.6/site-packages/numpy/random/__init__.py'&gt;</em>, <em>method='random'</em>, <em>return_debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#montage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.montage" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a montage / collage from a set of images</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –exec-montage:0 –show
python -m vtool.image –exec-montage:1</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list0</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list1</span> <span class="o">=</span> <span class="p">[</span><span class="n">resize_to_maxdims</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">img_list0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">flatten</span><span class="p">([</span><span class="n">img_list1</span><span class="p">]</span> <span class="o">*</span> <span class="n">num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="mi">700</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;unused&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#method = &#39;random&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dst</span><span class="p">,</span> <span class="n">debug_info</span> <span class="o">=</span> <span class="n">montage</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">dsize</span><span class="p">,</span> <span class="n">rng</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="n">return_debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">place_img</span> <span class="o">=</span> <span class="n">debug_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;place_img_&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">place_img</span> <span class="o">/</span> <span class="n">place_img</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="k">import</span> <span class="n">join</span><span class="p">,</span> <span class="n">expanduser</span><span class="p">,</span> <span class="n">abspath</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s1">&#39;GZC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gid_list0</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_gids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6000</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">try</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">gid</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">gid_list0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">image</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_images</span><span class="p">(</span><span class="n">gid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">image</span> <span class="o">=</span> <span class="n">resize_to_maxdims</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">img_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">19200</span><span class="p">,</span> <span class="mi">10800</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dst</span> <span class="o">=</span> <span class="n">montage</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">dsize</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filepath</span> <span class="o">=</span> <span class="n">abspath</span><span class="p">(</span><span class="n">expanduser</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">,</span> <span class="s1">&#39;Desktop&#39;</span><span class="p">,</span> <span class="s1">&#39;montage.jpg&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Writing to: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imwrite</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.open_image_size">
<code class="descclassname">vtool.image.</code><code class="descname">open_image_size</code><span class="sig-paren">(</span><em>image_fpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#open_image_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.open_image_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets image size from an image on disk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_fpath</strong> (<em>str</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">size (width, height)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-open_image_size</dd>
<dt>Doctest:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;patsy.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="n">open_image_size</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;size = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">size = (800, 441)</span>
</pre></div>
</div>
</dd>
<dt>Ignore:</dt>
<dd><p class="first"># Confirm that Image.open is a lazy load
import vtool as vt
import utool as ut
import timeit
setup = ut.codeblock(</p>
<blockquote>
<div>‘’’
from PIL import Image
import utool as ut
import vtool as vt
image_fpath = ut.grab_test_imgpath(‘patsy.jpg’)
‘’‘</div></blockquote>
<p class="last">)
t1 = timeit.timeit(‘Image.open(image_fpath)’, setup, number=100)
t2 = timeit.timeit(‘Image.open(image_fpath).size’, setup, number=100)
t3 = timeit.timeit(‘vt.open_image_size(image_fpath)’, setup, number=100)
t4 = timeit.timeit(‘vt.imread(image_fpath).shape’, setup, number=100)
t5 = timeit.timeit(‘Image.open(image_fpath).getdata()’, setup, number=100)
print(‘t1 = %r’ % (t1,))
print(‘t2 = %r’ % (t2,))
print(‘t3 = %r’ % (t3,))
print(‘t4 = %r’ % (t4,))
print(‘t5 = %r’ % (t5,))
assert t2 &lt; t5
assert t3 &lt; t4</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.image.pad_image">
<code class="descclassname">vtool.image.</code><code class="descname">pad_image</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>pad_</em>, <em>value=0</em>, <em>borderType=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#pad_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.pad_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.pad_image_ondisk">
<code class="descclassname">vtool.image.</code><code class="descname">pad_image_ondisk</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>pad_</em>, <em>out_fpath=None</em>, <em>value=0</em>, <em>borderType=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#pad_image_ondisk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.pad_image_ondisk" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">out_fpath -  file path string</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image pad_image_ondisk</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fpath&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pad_</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">borderType</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath</span> <span class="o">=</span> <span class="n">pad_image_ondisk</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">pad_</span><span class="p">,</span> <span class="n">out_fpath</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">borderType</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;out_fpath = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">out_fpath</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.padded_resize">
<code class="descclassname">vtool.image.</code><code class="descname">padded_resize</code><span class="sig-paren">(</span><em>img</em>, <em>target_size=(64</em>, <em>64)</em>, <em>interpolation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#padded_resize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.padded_resize" title="Permalink to this definition">¶</a></dt>
<dd><p>makes the image resize to the target size and pads the rest of the area with a fill value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>target_size</strong> (<em>tuple</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-padded_resize –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgA</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;ada.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgC</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">),</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#target_size = (64, 64)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img3_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">padded_resize</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">target_size</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="p">[</span><span class="n">imgA</span><span class="p">,</span> <span class="n">imgB</span><span class="p">,</span> <span class="n">imgC</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">ut</span><span class="o">.</span><span class="n">allsame</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img3</span><span class="p">)</span> <span class="k">for</span> <span class="n">img3</span> <span class="ow">in</span> <span class="n">img3_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pnum_</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">make_pnum_nextgen</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.perlin_noise">
<code class="descclassname">vtool.image.</code><code class="descname">perlin_noise</code><span class="sig-paren">(</span><em>size</em>, <em>scale=32.0</em>, <em>rng=&lt;module 'numpy.random' from '/Users/jason.parham/virtualenv/wildme3/lib/python3.6/site-packages/numpy/random/__init__.py'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#perlin_noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.perlin_noise" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://www.siafoo.net/snippet/229">http://www.siafoo.net/snippet/229</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image perlin_noise –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#size = (64, 64)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#scale = 32.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span> <span class="o">=</span> <span class="mf">64.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">perlin_noise</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.rectify_to_float01">
<code class="descclassname">vtool.image.</code><code class="descname">rectify_to_float01</code><span class="sig-paren">(</span><em>img</em>, <em>dtype=&lt;class 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rectify_to_float01"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.rectify_to_float01" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that an image is encoded using a float properly</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.rectify_to_square">
<code class="descclassname">vtool.image.</code><code class="descname">rectify_to_square</code><span class="sig-paren">(</span><em>img</em>, <em>extreme='max'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rectify_to_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.rectify_to_square" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.rectify_to_uint8">
<code class="descclassname">vtool.image.</code><code class="descname">rectify_to_uint8</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rectify_to_uint8"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.rectify_to_uint8" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that an image is encoded in uint8 properly</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.resize">
<code class="descclassname">vtool.image.</code><code class="descname">resize</code><span class="sig-paren">(</span><em>img</em>, <em>dsize</em>, <em>interpolation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.resize_image_by_scale">
<code class="descclassname">vtool.image.</code><code class="descname">resize_image_by_scale</code><span class="sig-paren">(</span><em>img</em>, <em>scale</em>, <em>interpolation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_image_by_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize_image_by_scale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.resize_mask">
<code class="descclassname">vtool.image.</code><code class="descname">resize_mask</code><span class="sig-paren">(</span><em>mask</em>, <em>chip</em>, <em>interpolation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.resize_thumb">
<code class="descclassname">vtool.image.</code><code class="descname">resize_thumb</code><span class="sig-paren">(</span><em>img</em>, <em>max_dsize=(64</em>, <em>64)</em>, <em>interpolation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_thumb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize_thumb" title="Permalink to this definition">¶</a></dt>
<dd><p>Resize an image such that its max width or height is:</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-resize_thumb –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">resize_thumb</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;img.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;img2.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img2</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.resize_to_maxdims">
<code class="descclassname">vtool.image.</code><code class="descname">resize_to_maxdims</code><span class="sig-paren">(</span><em>img</em>, <em>max_dsize=(64</em>, <em>64)</em>, <em>interpolation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_to_maxdims"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize_to_maxdims" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>max_dsize</strong> (<em>tuple</em>) – </li>
<li><strong>interpolation</strong> (<em>long</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-resize_to_maxdims –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">resize_to_maxdims</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;img.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;img2.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img2</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.resize_to_maxdims_ondisk">
<code class="descclassname">vtool.image.</code><code class="descname">resize_to_maxdims_ondisk</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>max_dsize</em>, <em>out_fpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_to_maxdims_ondisk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize_to_maxdims_ondisk" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img_fpath</strong> (<em>str</em>) – file path string</li>
<li><strong>max_dsize</strong> – </li>
<li><strong>out_fpath</strong> (<em>str</em>) – file path string(default = None)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormA.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormB.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormC.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormD.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormE.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormF.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormG.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormH.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormI.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormJ.png –dsize=417,None</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fpath&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--dsize&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resize_to_maxdims_ondisk</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">,</span> <span class="n">out_fpath</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.resized_clamped_thumb_dims">
<code class="descclassname">vtool.image.</code><code class="descname">resized_clamped_thumb_dims</code><span class="sig-paren">(</span><em>img_size</em>, <em>max_dsize</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resized_clamped_thumb_dims"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resized_clamped_thumb_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.resized_dims_and_ratio">
<code class="descclassname">vtool.image.</code><code class="descname">resized_dims_and_ratio</code><span class="sig-paren">(</span><em>img_size</em>, <em>max_dsize</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resized_dims_and_ratio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resized_dims_and_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>returns resized dimensions to get <code class="docutils literal notranslate"><span class="pre">img_size</span></code> to fit into <code class="docutils literal notranslate"><span class="pre">max_dsize</span></code></p>
<dl class="docutils">
<dt>FIXME:</dt>
<dd>Should specifying a None force the use of the original dim?</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img_size</strong> (<em>tuple</em>) – </li>
<li><strong>max_dsize</strong> (<em>tuple</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(dsize, ratio)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image resized_dims_and_ratio –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">=</span> <span class="n">resized_dims_and_ratio</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(dsize, ratio) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(dsize, ratio) = ((150, 75), 0.75)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">=</span> <span class="n">resized_dims_and_ratio</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(dsize, ratio) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(dsize, ratio) = ((2000, 1000), 10.0)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">=</span> <span class="n">resized_dims_and_ratio</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(dsize, ratio) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(dsize, ratio) = ((200, 100), 1.0)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">=</span> <span class="n">resized_dims_and_ratio</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(dsize, ratio) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(dsize, ratio) = ((200, 100), 1.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.rotate_image">
<code class="descclassname">vtool.image.</code><code class="descname">rotate_image</code><span class="sig-paren">(</span><em>img</em>, <em>theta</em>, <em>border_mode=None</em>, <em>interpolation=None</em>, <em>dsize=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rotate_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.rotate_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates an image around its center</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>theta</strong> – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-rotate_image</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_test_patch</span><span class="p">(</span><span class="s1">&#39;star2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">16.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR</span> <span class="o">=</span> <span class="n">rotate_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--show&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ut</span><span class="o">.</span><span class="n">inIPython</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span>  <span class="o">*</span> <span class="mi">255</span><span class="p">,</span>  <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.rotate_image_ondisk">
<code class="descclassname">vtool.image.</code><code class="descname">rotate_image_ondisk</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>theta</em>, <em>out_fpath=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rotate_image_ondisk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.rotate_image_ondisk" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates an image on disk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img_fpath</strong> – </li>
<li><strong>theta</strong> – </li>
<li><strong>out_fpath</strong> (<em>None</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-rotate_image_ondisk</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;star.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath_</span> <span class="o">=</span> <span class="n">rotate_image_ondisk</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">out_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">out_fpath_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--show&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ut</span><span class="o">.</span><span class="n">inIPython</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">out_fpath_</span><span class="p">,</span>  <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.shear">
<code class="descclassname">vtool.image.</code><code class="descname">shear</code><span class="sig-paren">(</span><em>img</em>, <em>x_shear</em>, <em>y_shear</em>, <em>dsize=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#shear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.shear" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>x_shear</strong> – </li>
<li><strong>y_shear</strong> – </li>
<li><strong>dsize</strong> (<em>tuple</em>) – width, height</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-shear –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_shear</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_shear</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgSh</span> <span class="o">=</span> <span class="n">shear</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">x_shear</span><span class="p">,</span> <span class="n">y_shear</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgSh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.stack_image_list">
<code class="descclassname">vtool.image.</code><code class="descname">stack_image_list</code><span class="sig-paren">(</span><em>img_list</em>, <em>return_offset=False</em>, <em>return_sf=False</em>, <em>return_info=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_image_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.stack_image_list" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-stack_image_list –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_offset</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modifysize</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_sf</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">modifysize</span><span class="o">=</span><span class="n">modifysize</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="n">vert</span><span class="p">,</span> <span class="n">use_larger</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span><span class="p">,</span> <span class="n">offset_list</span><span class="p">,</span> <span class="n">sf_list</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">return_offset</span><span class="o">=</span><span class="n">return_offset</span><span class="p">,</span> <span class="n">return_sf</span><span class="o">=</span><span class="n">return_sf</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">offset_list</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">img_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list_</span> <span class="o">=</span> <span class="n">wh_list</span> <span class="o">*</span> <span class="n">sf_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">offset</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">offset_list</span><span class="p">,</span> <span class="n">wh_list_</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">distinct_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">offset_list</span><span class="p">))):</span>
<span class="gp">... </span>   <span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#wh1 = img1.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#wh2 = img2.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_bbox((0, 0) + wh1, bbox_color=(1, 0, 0))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_bbox((woff, hoff) + wh2, bbox_color=(0, 1, 0))</span>
<span class="go">np.array([[   0.  ,   76.96,  141.08,  181.87,  246.  ],</span>
<span class="go">          [   0.  ,    0.  ,    0.  ,    0.  ,    0.  ]], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.stack_image_list_special">
<code class="descclassname">vtool.image.</code><code class="descname">stack_image_list_special</code><span class="sig-paren">(</span><em>img1</em>, <em>img_list</em>, <em>num=1</em>, <em>vert=True</em>, <em>use_larger=True</em>, <em>initial_sf=None</em>, <em>interpolation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_image_list_special"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.stack_image_list_special" title="Permalink to this definition">¶</a></dt>
<dd><p># TODO: add initial scale down factor?</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-stack_image_list_special –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list_</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">img_list_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="n">img_list_</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_offset</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_larger</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_bot</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_sf</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_sf</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span><span class="p">,</span> <span class="n">offset_list</span><span class="p">,</span> <span class="n">sf_list</span> <span class="o">=</span> <span class="n">stack_image_list_special</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img_list</span><span class="p">,</span> <span class="n">num_bot</span><span class="p">,</span> <span class="n">vert</span><span class="p">,</span> <span class="n">use_larger</span><span class="p">,</span> <span class="n">initial_sf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img1</span><span class="p">)]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">,</span> <span class="n">img_list</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list_</span> <span class="o">=</span> <span class="n">wh_list</span> <span class="o">*</span> <span class="n">sf_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;imgB.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">imgB</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">offset</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">offset_list</span><span class="p">,</span> <span class="n">wh_list_</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">distinct_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">offset_list</span><span class="p">))):</span>
<span class="gp">... </span>   <span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.stack_image_recurse">
<code class="descclassname">vtool.image.</code><code class="descname">stack_image_recurse</code><span class="sig-paren">(</span><em>img_list1</em>, <em>img_list2=None</em>, <em>vert=True</em>, <em>modifysize=False</em>, <em>return_offsets=False</em>, <em>interpolation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_image_recurse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.stack_image_recurse" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: return offsets as well</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img_list1</strong> (<em>list</em>) – </li>
<li><strong>img_list2</strong> (<em>list</em>) – </li>
<li><strong>vert</strong> (<em>bool</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">None</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-stack_image_recurse –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;astro.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img3</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;ada.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img4</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;jeff.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img5</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;star.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list1</span> <span class="o">=</span> <span class="p">[</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">img3</span><span class="p">,</span> <span class="n">img4</span><span class="p">,</span> <span class="n">img5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list2</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">stack_image_recurse</span><span class="p">(</span><span class="n">img_list1</span><span class="p">,</span> <span class="n">img_list2</span><span class="p">,</span> <span class="n">vert</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#wh1 = img1.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#wh2 = img2.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_bbox((0, 0) + wh1, bbox_color=(1, 0, 0))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_bbox((woff, hoff) + wh2, bbox_color=(0, 1, 0))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.stack_images">
<code class="descclassname">vtool.image.</code><code class="descname">stack_images</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>vert=None</em>, <em>modifysize=False</em>, <em>return_sf=False</em>, <em>use_larger=True</em>, <em>interpolation=None</em>, <em>white_background=False</em>, <em>overlap=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.stack_images" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-stack_images –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;astro.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modifysize</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_sf</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#(imgB, woff, hoff) = stack_images(img1, img2, vert, modifysize, return_sf=return_sf)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">overlap</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span><span class="p">,</span> <span class="n">offset2</span><span class="p">,</span> <span class="n">sf_tup</span> <span class="o">=</span> <span class="n">stack_images</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">vert</span><span class="p">,</span> <span class="n">modifysize</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">return_sf</span><span class="o">=</span><span class="n">return_sf</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span> <span class="o">=</span> <span class="n">offset2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">imgB</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img1</span><span class="p">),</span> <span class="n">sf_tup</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img2</span><span class="p">),</span> <span class="n">sf_tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wh1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh1</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">woff</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">hoff</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh2</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">((662, 512, 3), (0.0, 0.0), (0, 150))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.stack_multi_images">
<code class="descclassname">vtool.image.</code><code class="descname">stack_multi_images</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>offset_list1</em>, <em>sf_list1</em>, <em>offset_list2</em>, <em>sf_list2</em>, <em>vert=True</em>, <em>use_larger=False</em>, <em>modifysize=True</em>, <em>interpolation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_multi_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.stack_multi_images" title="Permalink to this definition">¶</a></dt>
<dd><p>combines images that are already stacked</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.stack_multi_images2">
<code class="descclassname">vtool.image.</code><code class="descname">stack_multi_images2</code><span class="sig-paren">(</span><em>multiimg_list</em>, <em>offsets_list</em>, <em>sfs_list</em>, <em>vert=True</em>, <em>modifysize=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_multi_images2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.stack_multi_images2" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>multiimg_list</strong> (<em>list</em>) – </li>
<li><strong>offset_lists</strong> – </li>
<li><strong>sfs_list</strong> – </li>
<li><strong>vert</strong> (<em>bool</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(stacked_img, stacked_img, stacked_sfs)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-stack_multi_images2 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_stack1</span><span class="p">,</span> <span class="n">offset_list1</span><span class="p">,</span> <span class="n">sf_list1</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">vert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">modifysize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_stack2</span><span class="p">,</span> <span class="n">offset_list2</span><span class="p">,</span> <span class="n">sf_list2</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">modifysize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_stack3</span><span class="p">,</span> <span class="n">offset_list3</span><span class="p">,</span> <span class="n">sf_list3</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">modifysize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multiimg_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">img_stack1</span><span class="p">,</span> <span class="n">img_stack2</span><span class="p">,</span> <span class="n">img_stack3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offsets_list</span>  <span class="o">=</span> <span class="p">[</span><span class="n">offset_list1</span><span class="p">,</span> <span class="n">offset_list2</span><span class="p">,</span> <span class="n">offset_list3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sfs_list</span>      <span class="o">=</span> <span class="p">[</span><span class="n">sf_list1</span><span class="p">,</span> <span class="n">sf_list2</span><span class="p">,</span> <span class="n">sf_list3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">stack_multi_images2</span><span class="p">(</span><span class="n">multiimg_list</span><span class="p">,</span> <span class="n">offsets_list</span><span class="p">,</span> <span class="n">sfs_list</span><span class="p">,</span> <span class="n">vert</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">stacked_img</span><span class="p">,</span> <span class="n">stacked_offsets</span><span class="p">,</span> <span class="n">stacked_sfs</span><span class="p">)</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">remove_doublspaces</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">stacked_offsets</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">10000</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; ,&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">stacked_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">img_list</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">img_list</span> <span class="o">+</span> <span class="n">img_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list_</span> <span class="o">=</span> <span class="n">wh_list</span> <span class="o">*</span> <span class="n">stacked_sfs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">offset</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">stacked_offsets</span><span class="p">,</span> <span class="n">wh_list_</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">distinct_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stacked_offsets</span><span class="p">))):</span>
<span class="gp">... </span>   <span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([[ 0., 0., 0., 0., 0., 512., 512., 512., 512., 512., 1024., 1024., 1024., 1024., 1024. ],</span>
<span class="go"> [ 0., 512.12, 1024.25, 1827., 2339., 0., 427., 939., 1742., 2254., 0., 373.18, 1137.45, 2073.38, 2670.47]], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.stack_square_images">
<code class="descclassname">vtool.image.</code><code class="descname">stack_square_images</code><span class="sig-paren">(</span><em>img_list</em>, <em>return_info=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_square_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.stack_square_images" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>img_list</strong> (<em>list</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-stack_square_images</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">stack_square_images</span><span class="p">(</span><span class="n">img_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.subpixel_values">
<code class="descclassname">vtool.image.</code><code class="descname">subpixel_values</code><span class="sig-paren">(</span><em>img</em>, <em>pts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#subpixel_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.subpixel_values" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p>stackoverflow.com/uestions/12729228/simple-efficient-binlinear-interpolation-of-images-in-numpy-and-python</p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>cv2.getRectSubPix(image, patchSize, center[, patch[, patchType]])</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.image.testdata_imglist">
<code class="descclassname">vtool.image.</code><code class="descname">testdata_imglist</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#testdata_imglist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.testdata_imglist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.warpAffine">
<code class="descclassname">vtool.image.</code><code class="descname">warpAffine</code><span class="sig-paren">(</span><em>img</em>, <em>Aff</em>, <em>dsize</em>, <em>assume_float01=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#warpAffine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.warpAffine" title="Permalink to this definition">¶</a></dt>
<dd><p>dsize = (width, height) of return image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>Aff</strong> (<em>ndarray</em>) – affine matrix</li>
<li><strong>dsize</strong> (<em>tuple</em>) – width, height</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">warped_img</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-warpAffine –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rotation_mat3x3</span><span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warped_img</span> <span class="o">=</span> <span class="n">warpAffine</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">Aff</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">warped_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Timeit:</dt>
<dd><p class="first">import skimage.transform
%timeit cv2.warpAffine(img, Aff[0:2], tuple(dsize), <a href="#id3"><span class="problematic" id="id4">**</span></a>CV2_WARP_KWARGS)
100 loops, best of 3: 7.95 ms per loop
skimage.transform.AffineTransform
tf = skimage.transform.AffineTransform(rotation=TAU / 8)
<a href="#id33"><span class="problematic" id="id34">Aff_</span></a> = tf.params
out = skimage.transform._warps_cy._warp_fast(img[:, :, 0], <a href="#id35"><span class="problematic" id="id36">Aff_</span></a>, output_shape=dsize, mode=’constant’, order=1)
%timeit skimage.transform._warps_cy._warp_fast(img[:, :, 0], <a href="#id37"><span class="problematic" id="id38">Aff_</span></a>, output_shape=dsize, mode=’constant’, order=1)
100 loops, best of 3: 5.74 ms per loop
%timeit cv2.warpAffine(img[:, :, 0], Aff[0:2], tuple(dsize), <a href="#id5"><span class="problematic" id="id6">**</span></a>CV2_WARP_KWARGS)
100 loops, best of 3: 5.13 ms per loop</p>
<p class="last">CONCLUSION, cv2 transforms are better</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.image.warpHomog">
<code class="descclassname">vtool.image.</code><code class="descname">warpHomog</code><span class="sig-paren">(</span><em>img</em>, <em>Homog</em>, <em>dsize</em>, <em>assume_float01=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#warpHomog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.warpHomog" title="Permalink to this definition">¶</a></dt>
<dd><p>dsize = (width, height) of return image</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Homog</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warped_img</span> <span class="o">=</span> <span class="n">warpHomog</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">Homog</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.image_filters">
<span id="vtool-image-filters-module"></span><h2>vtool.image_filters module<a class="headerlink" href="#module-vtool.image_filters" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="vtool.image_filters.IntensityPreproc">
<em class="property">class </em><code class="descclassname">vtool.image_filters.</code><code class="descname">IntensityPreproc</code><a class="reference internal" href="_modules/vtool/image_filters.html#IntensityPreproc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.IntensityPreproc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Prefered over old methods</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image_filters IntensityPreproc –show</dd>
<dt>Doctest:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image_filters</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://i.imgur.com/qVWQaex.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filter_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;medianblur&#39;</span><span class="p">,</span> <span class="p">{}),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;adapteq&#39;</span><span class="p">,</span> <span class="p">{}),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">IntensityPreproc</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">,</span> <span class="n">filter_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chipBGR2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="vtool.image_filters.IntensityPreproc.adapteq">
<code class="descname">adapteq</code><span class="sig-paren">(</span><em>intensity</em>, <em>tileGridSize=(8</em>, <em>8)</em>, <em>clipLimit=2.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#IntensityPreproc.adapteq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.IntensityPreproc.adapteq" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.image_filters.IntensityPreproc.histeq">
<code class="descname">histeq</code><span class="sig-paren">(</span><em>intensity</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#IntensityPreproc.histeq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.IntensityPreproc.histeq" title="Permalink to this definition">¶</a></dt>
<dd><p>Histogram equalization of a grayscale image.</p>
</dd></dl>

<dl class="method">
<dt id="vtool.image_filters.IntensityPreproc.medianblur">
<code class="descname">medianblur</code><span class="sig-paren">(</span><em>intensity</em>, <em>noise_thresh=50</em>, <em>ksize1=3</em>, <em>ksize2=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#IntensityPreproc.medianblur"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.IntensityPreproc.medianblur" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.image_filters.IntensityPreproc.preprocess">
<code class="descname">preprocess</code><span class="sig-paren">(</span><em>chipBGR</em>, <em>filter_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#IntensityPreproc.preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.IntensityPreproc.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>filter_list is a list of (name, config) tuples for preforming filter ops</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="vtool.image_filters.adapteq_fn">
<code class="descclassname">vtool.image_filters.</code><code class="descname">adapteq_fn</code><span class="sig-paren">(</span><em>chipBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#adapteq_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.adapteq_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>adaptive histogram equalization with CLAHE</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image_filters</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://i.imgur.com/qVWQaex.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip2</span> <span class="o">=</span> <span class="n">adapteq_fn</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chip2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image_filters.clean_mask">
<code class="descclassname">vtool.image_filters.</code><code class="descname">clean_mask</code><span class="sig-paren">(</span><em>mask</em>, <em>num_dilate=3</em>, <em>num_erode=3</em>, <em>window_frac=0.025</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#clean_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.clean_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean the mask
(num_erode, num_dilate) = (1, 1)
(w, h) = (10, 10)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image_filters.grabcut_fn">
<code class="descclassname">vtool.image_filters.</code><code class="descname">grabcut_fn</code><span class="sig-paren">(</span><em>chipBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#grabcut_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.grabcut_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>naively segments a chip</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image_filters.histeq_fn">
<code class="descclassname">vtool.image_filters.</code><code class="descname">histeq_fn</code><span class="sig-paren">(</span><em>chipBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#histeq_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.histeq_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Histogram equalization of a grayscale image.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image_filters.manta_matcher_filters">
<code class="descclassname">vtool.image_filters.</code><code class="descname">manta_matcher_filters</code><span class="sig-paren">(</span><em>chipBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#manta_matcher_filters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.manta_matcher_filters" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://onlinelibrary.wiley.com/doi/10.1002/ece3.587/full">http://onlinelibrary.wiley.com/doi/10.1002/ece3.587/full</a></p>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia.core_annots</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s1">&#39;Mantas&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://i.imgur.com/qVWQaex.jpg&#39;</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.image_filters.medianfilter_fn">
<code class="descclassname">vtool.image_filters.</code><code class="descname">medianfilter_fn</code><span class="sig-paren">(</span><em>chipBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#medianfilter_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.medianfilter_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>median filtering</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image_filters</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://i.imgur.com/qVWQaex.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip2</span> <span class="o">=</span> <span class="n">adapteq_fn</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chip2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.image_shared">
<span id="vtool-image-shared-module"></span><h2>vtool.image_shared module<a class="headerlink" href="#module-vtool.image_shared" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.image_shared.open_pil_image">
<code class="descclassname">vtool.image_shared.</code><code class="descname">open_pil_image</code><span class="sig-paren">(</span><em>image_fpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_shared.html#open_pil_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_shared.open_pil_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image_shared.print_image_checks">
<code class="descclassname">vtool.image_shared.</code><code class="descname">print_image_checks</code><span class="sig-paren">(</span><em>img_fpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_shared.html#print_image_checks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_shared.print_image_checks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.inspect_matches">
<span id="vtool-inspect-matches-module"></span><h2>vtool.inspect_matches module<a class="headerlink" href="#module-vtool.inspect_matches" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="vtool.inspect_matches.MatchInspector">
<em class="property">class </em><code class="descclassname">vtool.inspect_matches.</code><code class="descname">MatchInspector</code><span class="sig-paren">(</span><em>parent=None</em>, <em>orientation=None</em>, <em>verticalSizePolicy=None</em>, <em>horizontalSizePolicy=None</em>, <em>verticalStretch=None</em>, <em>horizontalStretch=None</em>, <em>spacing=None</em>, <em>margin=None</em>, <em>name=None</em>, <em>ori=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">wbia.guitool.guitool_components.GuitoolWidget</span></code></p>
<dl class="docutils">
<dt>A widget that contains</dt>
<dd><ol class="first last arabic simple">
<li>a viewport that displays an annotation pair with matches overlayed.</li>
<li>a control panel for tuning matching parameters</li>
<li>a text area displaying information about the match vector</li>
</ol>
</dd>
<dt>CommandLine:</dt>
<dd><p class="first">python -m vtool.inspect_matches MatchInspector:0 –show
python -m vtool.inspect_matches MatchInspector:1 –show</p>
<p class="last">python -m vtool.inspect_matches MatchInspector:1 –db GZ_Master1 –aids=1041,1045 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.inspect_matches</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">ensure_qapp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">qtensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot1</span> <span class="o">=</span> <span class="n">lazy_test_annot</span><span class="p">(</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot2</span> <span class="o">=</span> <span class="n">lazy_test_annot</span><span class="p">(</span><span class="s1">&#39;easy2.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">PairwiseMatch</span><span class="p">(</span><span class="n">annot1</span><span class="p">,</span> <span class="n">annot2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">MatchInspector</span><span class="p">(</span><span class="n">match</span><span class="o">=</span><span class="n">match</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#self.update()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">qtapp_loop</span><span class="p">(</span><span class="n">qwin</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.inspect_matches</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">ensure_qapp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">qtensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s1">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aids</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">argval</span><span class="p">(</span><span class="s1">&#39;--aids&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;aids = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">aids</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annots</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">annots</span><span class="p">(</span><span class="n">aids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot1</span> <span class="o">=</span> <span class="n">annots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_make_lazy_dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot2</span> <span class="o">=</span> <span class="n">annots</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">_make_lazy_dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="n">MatchDisplayConfig</span><span class="p">()</span><span class="o">.</span><span class="n">asdict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">argparse_dict</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">PairwiseMatch</span><span class="p">(</span><span class="n">annot1</span><span class="p">,</span> <span class="n">annot2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">MatchInspector</span><span class="p">(</span><span class="n">match</span><span class="o">=</span><span class="n">match</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#self.update()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">qtapp_loop</span><span class="p">(</span><span class="n">qwin</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="vtool.inspect_matches.MatchInspector.closeEvent">
<code class="descname">closeEvent</code><span class="sig-paren">(</span><em>self</em>, <em>QCloseEvent</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.closeEvent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.closeEvent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.inspect_matches.MatchInspector.draw_pair">
<code class="descname">draw_pair</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.draw_pair"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.draw_pair" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.inspect_matches.MatchInspector.draw_vsone">
<code class="descname">draw_vsone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.draw_vsone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.draw_vsone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.inspect_matches.MatchInspector.embed">
<code class="descname">embed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.embed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.embed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.inspect_matches.MatchInspector.execContextMenu">
<code class="descname">execContextMenu</code><span class="sig-paren">(</span><em>qpoint</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.execContextMenu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.execContextMenu" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.inspect_matches.MatchInspector.execute_vsone">
<code class="descname">execute_vsone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.execute_vsone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.execute_vsone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.inspect_matches.MatchInspector.first_show">
<code class="descname">first_show</code><span class="sig-paren">(</span><em>state=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.first_show"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.first_show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.inspect_matches.MatchInspector.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>match=None</em>, <em>on_context=None</em>, <em>autoupdate=True</em>, <em>info_text=None</em>, <em>cfgdict=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.initialize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.inspect_matches.MatchInspector.on_cfg_changed">
<code class="descname">on_cfg_changed</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.on_cfg_changed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.on_cfg_changed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.inspect_matches.MatchInspector.on_chip_cfg_changed">
<code class="descname">on_chip_cfg_changed</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.on_chip_cfg_changed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.on_chip_cfg_changed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.inspect_matches.MatchInspector.on_feat_cfg_changed">
<code class="descname">on_feat_cfg_changed</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.on_feat_cfg_changed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.on_feat_cfg_changed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.inspect_matches.MatchInspector.screenshot">
<code class="descname">screenshot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.screenshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.screenshot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.inspect_matches.MatchInspector.set_match">
<code class="descname">set_match</code><span class="sig-paren">(</span><em>match=None</em>, <em>on_context=None</em>, <em>info_text=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.set_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.set_match" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.inspect_matches.MatchInspector.showEvent">
<code class="descname">showEvent</code><span class="sig-paren">(</span><em>self</em>, <em>QShowEvent</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.showEvent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.showEvent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.inspect_matches.MatchInspector.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.update" title="Permalink to this definition">¶</a></dt>
<dd><p>update(self, QRect)
update(self, QRegion)
update(self, int, int, int, int)</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="vtool.inspect_matches.lazy_test_annot">
<code class="descclassname">vtool.inspect_matches.</code><code class="descname">lazy_test_annot</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#lazy_test_annot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.lazy_test_annot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.inspect_matches.make_match_interaction">
<code class="descclassname">vtool.inspect_matches.</code><code class="descname">make_match_interaction</code><span class="sig-paren">(</span><em>matches</em>, <em>metadata</em>, <em>type_='RAT+SV'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#make_match_interaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.make_match_interaction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.inspect_matches.show_matching_dict">
<code class="descclassname">vtool.inspect_matches.</code><code class="descname">show_matching_dict</code><span class="sig-paren">(</span><em>matches</em>, <em>metadata</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#show_matching_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_matches.show_matching_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.keypoint">
<span id="vtool-keypoint-module"></span><h2>vtool.keypoint module<a class="headerlink" href="#module-vtool.keypoint" title="Permalink to this headline">¶</a></h2>
<p>Keypoints are stored in the invA format by default.
Unfortunately many places in the code reference this as A instead of invA
because I was confused when I first started writing this.</p>
<p>to rectify this I am changing terminology.</p>
<dl class="docutils">
<dt>Variables:</dt>
<dd><dl class="first last docutils">
<dt>invV <span class="classifier-delimiter">:</span> <span class="classifier">maps from ucircle onto an ellipse (perdoch.invA)</span></dt>
<dd>V : maps from ellipse to ucircle      (perdoch.A)
Z : the conic matrix                  (perdoch.E)</dd>
</dl>
</dd>
<dt>Representation:</dt>
<dd><dl class="first last docutils">
<dt>kpts (ndarray) <span class="classifier-delimiter">:</span> <span class="classifier">[x, y, iv11, iv21, iv22, ori]</span></dt>
<dd>a flat on disk representation of the keypoint</dd>
<dt>invV (ndarray): [(iv11, iv12, x),</dt>
<dd><blockquote class="first">
<div>(iv21, iv22, y),
(   0,    0, 1),]</div></blockquote>
<p class="last">a more conceptually useful representation mapp;ing a
unit circle onto an ellipse (without any rotation)</p>
</dd>
<dt>invVR (ndarray): [(iv11, iv12, x),</dt>
<dd><blockquote class="first">
<div>(iv21, iv22, y),
(   0,    0, 1),].dot(R)</div></blockquote>
<p class="last">same as invV but it is rotated before warping a unit circle
into an ellipse.</p>
</dd>
</dl>
</dd>
<dt>Sympy:</dt>
<dd><div class="first highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="k">import</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori</span> <span class="o">=</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">iv11</span><span class="p">,</span> <span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span> <span class="n">patch_size</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y iv11 iv21 iv22 S&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;sx, sy, w1, w2, tx, ty&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">iv11</span><span class="p">,</span> <span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span> <span class="n">ori</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kp</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_invV_mats</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">with_trans</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">kp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">(</span><span class="s1">&#39;invV = &#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">invV</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span><span class="n">iv11</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>   <span class="n">x</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span><span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span>   <span class="n">y</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">rotation_mat3x3</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">sin</span><span class="o">=</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="o">=</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trans</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>   <span class="n">x</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span>   <span class="n">y</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Hypoth</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>    <span class="n">sx</span><span class="p">,</span>    <span class="n">w1</span><span class="p">,</span>   <span class="n">tx</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>    <span class="n">w2</span><span class="p">,</span>    <span class="n">sy</span><span class="p">,</span>   <span class="n">ty</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>     <span class="mi">0</span><span class="p">,</span>     <span class="mi">0</span><span class="p">,</span>    <span class="mi">1</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyz</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_2x2</span> <span class="o">=</span> <span class="n">invV</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Hypoth_2x2</span> <span class="o">=</span> <span class="n">Hypoth</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_t</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">Hypoth</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">invV</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyz_t</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">Hypoth</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">xyz</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_2x2_t</span> <span class="o">=</span> <span class="n">Hypoth_2x2</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">invV_2x2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">----&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invV_t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;xyz_t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invV_2x2_t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--- CHECKING 3x3 ---&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">check_expr_eq</span><span class="p">(</span><span class="n">invV_t</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">xyz_t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--- CHECKING 2x2 ---&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">check_expr_eq</span><span class="p">(</span><span class="n">invV_t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">invV_2x2_t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># CHeck with rotation component as well (probably ok)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_2x2</span> <span class="o">=</span> <span class="n">invVR</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_t</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">Hypoth</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">invVR</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_2x2_t</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">Hypoth_2x2</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">invVR_2x2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">----&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invVR_t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">----&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invVR_2x2_t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--- CHECKING ROTATION + TRANSLATION 3x3 ---&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">check_expr_eq</span><span class="p">(</span><span class="n">invVR_t</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">xyz_t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--- CHECKING ROTATION 2x2 ---&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">check_expr_eq</span><span class="p">(</span><span class="n">invVR_t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">invVR_2x2_t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">####</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">####</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">####</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Checking orientation property</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[[</span><span class="n">ivr11</span><span class="p">,</span> <span class="n">ivr12</span><span class="p">,</span> <span class="n">ivr13</span><span class="p">],</span> <span class="p">[</span><span class="n">ivr21</span><span class="p">,</span> <span class="n">ivr22</span><span class="p">,</span> <span class="n">ivr23</span><span class="p">],</span> <span class="p">[</span><span class="n">ivr31</span><span class="p">,</span> <span class="n">ivr32</span><span class="p">,</span> <span class="n">ivr33</span><span class="p">],]</span> <span class="o">=</span> <span class="n">invVR</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">ivr12</span><span class="p">,</span> <span class="n">ivr11</span><span class="p">)</span>  <span class="c1"># outputs from -TAU/2 to TAU/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">ori</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">iv11</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>
</pre></div>
</div>
<p>#_oris = np.arctan2(_iv12s, _iv11s)  # outputs from -TAU/2 to TAU/2
&gt;&gt;&gt; # xdoctest: +SKIP
&gt;&gt;&gt; # OLD STUFF
&gt;&gt;&gt; #
&gt;&gt;&gt; print(ub.hzcat(‘V = ‘, repr(V)))
V = Matrix([</p>
<blockquote>
<div>[          1/iv11,     0,                -1.0*x/iv11],
[-iv21/(iv11*iv22), 1/iv22, -1.0*(y - iv21*x/iv11)/iv22],
[               0,     0,                        1.0]])</div></blockquote>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">(</span><span class="s1">&#39;V = &#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">invV</span><span class="o">.</span><span class="n">inv</span><span class="p">()))))</span>
<span class="go">V = Matrix([</span>
<span class="go">    [          1/iv11,     0,                       -1.0*x/iv11],</span>
<span class="go">    [-iv21/(iv11*iv22), 1/iv22, 1.0*(-iv11*y + iv21*x)/(iv11*iv22)],</span>
<span class="go">    [               0,     0,                               1.0]])</span>
</pre></div>
</div>
</dd>
<dt>Efficiency Notes:</dt>
<dd><p class="first">single index indexing is very fast</p>
<p>slicing seems to be very fast.</p>
<p class="last">fancy indexing with __getitem__ is very slow
using np.take is a better idea, but its a bit harder
to use with multidimensional arrays (nope use axis=x)</p>
</dd>
</dl>
<dl class="function">
<dt id="vtool.keypoint.augment_2x2_with_translation">
<code class="descclassname">vtool.keypoint.</code><code class="descname">augment_2x2_with_translation</code><span class="sig-paren">(</span><em>kpts</em>, <em>_mat2x2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#augment_2x2_with_translation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.augment_2x2_with_translation" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function to augment shape matrix with a translation component.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.cast_split">
<code class="descclassname">vtool.keypoint.</code><code class="descname">cast_split</code><span class="sig-paren">(</span><em>kpts</em>, <em>dtype=&lt;class 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#cast_split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.cast_split" title="Permalink to this definition">¶</a></dt>
<dd><p>breakup keypoints into location, shape, and orientation</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.convert_kptsZ_to_kpts">
<code class="descclassname">vtool.keypoint.</code><code class="descname">convert_kptsZ_to_kpts</code><span class="sig-paren">(</span><em>kpts_Z</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#convert_kptsZ_to_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.convert_kptsZ_to_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert keypoints in Z format to invV format</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.decompose_Z_to_RV_mats2x2">
<code class="descclassname">vtool.keypoint.</code><code class="descname">decompose_Z_to_RV_mats2x2</code><span class="sig-paren">(</span><em>Z_mats2x2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#decompose_Z_to_RV_mats2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.decompose_Z_to_RV_mats2x2" title="Permalink to this definition">¶</a></dt>
<dd><p>A, B, C = [0.016682, 0.001693, 0.014927]
#A, B, C = [0.010141, -1.1e-05, 0.02863]
Z = np.array([[A, B], [B, C]])</p>
<p>A, B, C = 0.010141, -1.1e-05, 0.02863</p>
<dl class="docutils">
<dt>Ignore:</dt>
<dd># Working on figuring relationship between us and VGG
A, B, _, C = Z_mats2x2[0].ravel()
X, Y = 0, 0
theta = np.linspace(0, np.pi * 2)
circle_xy = np.vstack([np.cos(theta), np.sin(theta)])
invV = invV_mats[0, 0:2, 0:2]
x, y = invV.dot(circle_xy)
V = np.linalg.inv(invV)
E = V.T.dot(V)
[[A, B], [_, C]] = E
[[<a href="#id39"><span class="problematic" id="id40">A_</span></a>, <a href="#id41"><span class="problematic" id="id42">B_</span></a>], [_, <a href="#id43"><span class="problematic" id="id44">C_</span></a>]] = E
print(A*(x-X) ** 2 + 2*B*(x-X)*(y-Y) + C*(y-Y) ** 2)</dd>
<dt>Z_mats2x2 = np.array([</dt>
<dd>[[ .016682, .001693],
[ .001693, .014927]],
[[ .01662, .001693],
[ .001693, .014927]],
[[ .016682, .00193],
[ .00193, .01492]],
])</dd>
</dl>
<p>import scipy.linalg
%timeit np.array([scipy.linalg.sqrtm(Z) for Z in Z_mats2x2])
%timeit decompose_Z_to_VR_mats2x2(Z_mats2x2)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.decompose_Z_to_V_2x2">
<code class="descclassname">vtool.keypoint.</code><code class="descname">decompose_Z_to_V_2x2</code><span class="sig-paren">(</span><em>Z_2x2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#decompose_Z_to_V_2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.decompose_Z_to_V_2x2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.keypoint.decompose_Z_to_invV_2x2">
<code class="descclassname">vtool.keypoint.</code><code class="descname">decompose_Z_to_invV_2x2</code><span class="sig-paren">(</span><em>Z_2x2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#decompose_Z_to_invV_2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.decompose_Z_to_invV_2x2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.keypoint.decompose_Z_to_invV_mats2x2">
<code class="descclassname">vtool.keypoint.</code><code class="descname">decompose_Z_to_invV_mats2x2</code><span class="sig-paren">(</span><em>Z_mats2x2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#decompose_Z_to_invV_mats2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.decompose_Z_to_invV_mats2x2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.keypoint.flatten_invV_mats_to_kpts">
<code class="descclassname">vtool.keypoint.</code><code class="descname">flatten_invV_mats_to_kpts</code><span class="sig-paren">(</span><em>invV_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#flatten_invV_mats_to_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.flatten_invV_mats_to_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>flattens invV matrices into kpts format</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_RV_mats2x2">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_RV_mats2x2</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_RV_mats2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_RV_mats2x2" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">sequence of matrices that transform an ellipse to unit circle</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">V_mats (ndarray)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_RV_mats_3x3">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_RV_mats_3x3</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_RV_mats_3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_RV_mats_3x3" title="Permalink to this definition">¶</a></dt>
<dd><p>prefered over get_invV_mats</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">sequence of matrices that transform an ellipse to unit circle</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">V_mats (ndarray)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_V_mats">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_V_mats</code><span class="sig-paren">(</span><em>kpts</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_V_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_V_mats" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">sequence of matrices that transform an ellipse to unit circle</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">V_mats (ndarray)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_Z_mats">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_Z_mats</code><span class="sig-paren">(</span><em>V_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_Z_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_Z_mats" title="Permalink to this definition">¶</a></dt>
<dd><p>transform into conic matrix Z
Z = (V.T).dot(V)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Z is a conic representation of an ellipse</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">Z_mats (ndarray)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_even_point_sample">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_even_point_sample</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_even_point_sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_even_point_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>gets even points sample along the boundary of the ellipse</p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>pyhesaff.tests.test_ellipse</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ell_border_pts_list</span> <span class="o">=</span> <span class="n">get_even_point_sample</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">ell_border_pts_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;even sample points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_grid_kpts">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_grid_kpts</code><span class="sig-paren">(</span><em>wh=(300</em>, <em>300)</em>, <em>wh_stride=None</em>, <em>scale=20</em>, <em>wh_num=None</em>, <em>dtype=&lt;class 'numpy.float32'&gt;</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_grid_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_grid_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a regular grid of keypoints</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>wh</strong> (<em>tuple</em>) – (default = (300, 300))</li>
<li><strong>wh_stride</strong> (<em>tuple</em>) – stride of keypoints (defaults to (50, 50))</li>
<li><strong>scale</strong> (<em>int</em>) – (default = 20)</li>
<li><strong>wh_num</strong> (<em>tuple</em>) – desired number of keypoints in x and y direction.
(incompatible with stride).</li>
<li><strong>dtype</strong> (<em>type</em>) – (default = &lt;type ‘numpy.float32’&gt;)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">kpts -  keypoints</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[float32_t, ndim=2]</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint get_grid_kpts –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh</span> <span class="o">=</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_stride</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_num</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">get_grid_kpts</span><span class="p">(</span><span class="n">wh</span><span class="p">,</span> <span class="n">wh_num</span><span class="o">=</span><span class="n">wh_num</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">wh_num</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;kpts = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">kpts</span><span class="o">.</span><span class="n">shape</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVR_mats2x2">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invVR_mats2x2</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats2x2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keypoint shape+rotation matrix (from unit circle to ellipse)
Ignores translation component</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em><em>[</em><em>ndims=2</em><em>]</em>) – keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">invVR_mats</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint –test-get_invVR_mats2x2</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats2x2</span> <span class="o">=</span> <span class="n">get_invVR_mats2x2</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invVR_mats2x2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats2x2</span> <span class="o">=</span> <span class="n">get_invVR_mats2x2</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">invVR_mats2x2</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVR_mats3x3">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invVR_mats3x3</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats3x3" title="Permalink to this definition">¶</a></dt>
<dd><p>NEWER FUNCTION</p>
<p>Returns full keypoint transform matricies from a unit circle to an
ellipse that has been rotated, scaled, skewed, and translated. Into
the image keypoint position.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">invVR_mats</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray[float32_t, ndim=3]</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats3x3</span> <span class="o">=</span> <span class="n">get_invVR_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invVR_mats3x3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[ 1.,  0., 10.],</span>
<span class="go">        [ 2.,  3., 20.],</span>
<span class="go">        [ 0.,  0.,  1.]],</span>
<span class="go">       [[ 0., -1., 30.],</span>
<span class="go">        [ 3., -2., 40.],</span>
<span class="go">        [ 0.,  0.,  1.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVR_mats_oris">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invVR_mats_oris</code><span class="sig-paren">(</span><em>invVR_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_oris"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats_oris" title="Permalink to this definition">¶</a></dt>
<dd><p>extracts orientation from matrix encoding, this is a bit tricker
can use -arctan2 or (0, 0) and (0, 1), but then have to normalize</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">get_invVR_mats_oris</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Sympy:</dt>
<dd><div class="first highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># BEST PROOF SO FAR OF EXTRACTION FROM ARBITRARY COMPOMENTS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symkw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#x, y, v21  = sympy.symbols(&#39;x, y, v21&#39;, **symkw)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#v11, v22    = sympy.symbols(&#39;v11, v22&#39;, positive=True, **symkw)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">v21</span>  <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, y, c&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v11</span><span class="p">,</span> <span class="n">v22</span>    <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a, d&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span>       <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symtau</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sympy</span><span class="o">.</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Forward rotation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">keypoint_terms</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">v11</span><span class="p">,</span> <span class="n">v21</span><span class="p">,</span> <span class="n">v22</span><span class="p">,</span> <span class="n">theta</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Ell to ucircle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">v11</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">v21</span><span class="p">,</span> <span class="n">v22</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Backwards rotation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">),</span> <span class="o">-</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">),</span> <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span>               <span class="mi">0</span><span class="p">,</span>                 <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Backwards translation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>  <span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="o">-</span><span class="n">x</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>  <span class="o">-</span><span class="n">y</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Scale is the inverse square root determinant of the shape matrix.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">V</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Inverse of components</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invT</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">inv_</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">inv_</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">inv_</span><span class="p">()</span>  <span class="c1"># TODO: figure out how to make -theta say inside sin and cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># -----------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Build the B matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RVT_held_full</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RVT_full</span> <span class="o">=</span> <span class="n">RVT_held_full</span><span class="o">.</span><span class="n">as_mutable</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Build the inv(B) matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invTVR_held_full</span> <span class="o">=</span> <span class="n">invT</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">invV</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">invR</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invTVR_full</span> <span class="o">=</span> <span class="n">invTVR_held_full</span><span class="o">.</span><span class="n">as_mutable</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Build the invTVR_full in arbitrary terms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iv11</span><span class="p">,</span> <span class="n">iv12</span><span class="p">,</span> <span class="n">iv13</span><span class="p">,</span> <span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span> <span class="n">iv23</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;iv11, iv12, iv13, iv21, iv22, iv23&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arb_symbols</span> <span class="o">=</span> <span class="p">[</span><span class="n">iv11</span><span class="p">,</span> <span class="n">iv12</span><span class="p">,</span> <span class="n">iv13</span><span class="p">,</span> <span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span> <span class="n">iv23</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_arb</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>  <span class="n">iv11</span><span class="p">,</span> <span class="n">iv12</span><span class="p">,</span> <span class="n">iv13</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>  <span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span> <span class="n">iv23</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>   <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set set terms equal to the construction from the inverse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arb_expr1</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">invVR_arb</span><span class="p">,</span> <span class="n">invTVR_full</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arb_assign</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">arb_expr1</span><span class="p">,</span> <span class="n">arb_symbols</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Solve for keypoint varibles in terms of the arbitrary invVR_arb mat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solutions</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">arb_expr1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solutions</span><span class="p">[</span><span class="n">theta</span><span class="p">]</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">arb_expr1</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Solutions for scale is not well defined, but can be taken through the determ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#solutions_ad = sympy.solve(arb_expr1, v11, v22)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#solutions_scale = sympy.solve(arb_expr1, scale)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#solutions = sympy.solve(arb_expr1, *keypoint_terms)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Print review info (ell to ucirc)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Keypoint review (RVT):&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indenter</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">Indenter</span><span class="p">(</span><span class="s1">&#39;[RVT] &#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="o">=</span> <span class="n">indenter</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Translate keypoint to origin&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warp from ellipse to unit circle shape:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Orientation normalize by -theta radians&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;These can be combined as such:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;RVT_held_full&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This simplifies to a matrix which tranlates, scales, skews, and rotates an ellipse into a unit circle&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(B) = RVT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;RVT_full&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="o">=</span> <span class="n">indenter</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Print review info (ucirc to ell)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Now backwards:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unorient&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indenter</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">Indenter</span><span class="p">(</span><span class="s1">&#39;[invTVR] &#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="o">=</span> <span class="n">indenter</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warp from unit circle to ellipse&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invV&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Translate to point in annot space&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;These can be combined as such:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invTVR_held_full&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This simplifies to a matrix which rotates, skews, scales, and translates a unit circle into an ellipse&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inv(B) = inv(T) inv(V) inv(R)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invTVR_full&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="o">=</span> <span class="n">indenter</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now we will solve for keypoint componts given an arbitrary shape matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Given an arbitrary invVRT shape matrix&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invVR_arb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The keypoint components can be extracte as such&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The position is easy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Scale is not found through symbolic manipulation but can be taken through linear algebra properites&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Orientation is a bit more involved&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">solutions</span><span class="p">,</span> <span class="n">sorted_</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># PROOVE ORIENTATION EQUATION IS CORRECT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#ivr11 must be positive for this to work</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_arb</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">sympy</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">iv12</span><span class="p">,</span> <span class="n">iv11</span><span class="p">))</span> <span class="o">%</span> <span class="p">(</span><span class="n">symtau</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_arb_nomod</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">iv12</span><span class="p">,</span> <span class="n">iv11</span><span class="p">)</span>  <span class="c1"># outputs from -TAU/2 to TAU/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_arb</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">invVR_arb</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> CLAIM:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Scale is be computed as:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;scale_arb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;scale_arb.subs(arb_assign)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;scale_arb.subs(arb_assign)&#39;</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> CLAIM:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Orientation is be computed as:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;ori_arb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;ori_arb.subs(arb_assign)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;ori_arb.subs(arb_assign)&#39;</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_subs</span> <span class="o">=</span> <span class="n">ori_arb</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">arb_assign</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Consider only the arctan2 part&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># hack aroung resolve atan2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_arb_nomod</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">iv12</span><span class="p">,</span> <span class="n">iv11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.assumptions.refine</span> <span class="k">import</span> <span class="n">refine_atan2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># There are 3 cases we need to wory about for atan2(y, x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Case where x is positive</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atan2_case1</span> <span class="o">=</span> <span class="n">refine_atan2</span><span class="p">(</span><span class="n">ori_arb_nomod</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="n">sympy</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">iv12</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">positive</span><span class="p">(</span><span class="n">iv11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Case where x is negative and y is non-negative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atan2_case2</span> <span class="o">=</span> <span class="n">refine_atan2</span><span class="p">(</span><span class="n">ori_arb_nomod</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">sympy</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">negative</span><span class="p">(</span><span class="n">iv11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">positive</span><span class="p">(</span><span class="n">iv12</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Case where x is negative and y is negative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atan2_case3</span> <span class="o">=</span> <span class="n">refine_atan2</span><span class="p">(</span><span class="n">ori_arb_nomod</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">sympy</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">negative</span><span class="p">(</span><span class="n">iv11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">negative</span><span class="p">(</span><span class="n">iv12</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atan2_case_strs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;QI, QIV&#39;</span><span class="p">,</span> <span class="s1">&#39;QII&#39;</span><span class="p">,</span> <span class="s1">&#39;QIII&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_ranges</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span> <span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span> <span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atan2_case_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">atan2_case1</span><span class="p">,</span> <span class="n">atan2_case2</span><span class="p">,</span> <span class="n">atan2_case3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">caseno</span><span class="p">,</span> <span class="n">atan2_case</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">atan2_case_list</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">----</span><span class="se">\n</span><span class="s1">caseno = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">caseno</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Quadrent: </span><span class="si">%r</span><span class="s1">&#39;</span>  <span class="o">%</span> <span class="p">(</span><span class="n">atan2_case_strs</span><span class="p">[</span><span class="n">caseno</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;theta_ranges: </span><span class="si">%r</span><span class="s1">&#39;</span>  <span class="o">%</span> <span class="p">(</span><span class="n">theta_ranges</span><span class="p">[</span><span class="n">caseno</span><span class="p">],))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">atan2_case_subs</span> <span class="o">=</span> <span class="n">atan2_case</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">arb_assign</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;atan2_case_subs&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">atan2_case_subs</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">atan2_case_subs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">atan2_case_subs</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">atan2_case_subs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;atan2_case_subs&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ori_arb_case</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">atan2_case</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">symtau</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ori_arb_case_subs</span> <span class="o">=</span> <span class="n">ori_arb_case</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">arb_assign</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ori_arb_case_subs</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">ori_arb_case_subs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ori_arb_case_subs</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">ori_arb_case_subs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;ori_arb_case_subs&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
</pre></div>
</div>
<p>nptheta = np.linspace(0, 2 * np.pi, 32, endpoint=False)</p>
<p>mapping = np.arctan(np.tan(nptheta))
print(ub.repr2(zip(nptheta / (2 * np.pi), nptheta, mapping, nptheta == mapping), precision=3))
print(ub.repr2(zip(nptheta / (2 * np.pi), nptheta, mapping  % (np.pi * 2), nptheta == mapping % (np.pi * 2)), precision=3))</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># NUMPY CHECKS</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nptheta_special</span> <span class="o">=</span> <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nptheta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="n">nptheta_special</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Case 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#\modfn{\paren{-\atan{\tan{(-\theta)}}} }{\TAU}           &amp;\text{if } \cos{(-\theta )} &gt; 0 \\</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">nptheta</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case1_theta</span>  <span class="o">=</span> <span class="n">nptheta</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case1_result</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="o">-</span><span class="n">case1_theta</span><span class="p">))</span> <span class="o">%</span> <span class="n">TAU</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case1_theta</span> <span class="o">==</span> <span class="n">case1_result</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">case1_theta</span><span class="p">,</span> <span class="n">case1_result</span><span class="p">,</span> <span class="n">vt</span><span class="o">.</span><span class="n">ori_distance</span><span class="p">(</span><span class="n">case1_theta</span><span class="p">,</span> <span class="n">case1_result</span><span class="p">)</span> <span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Case 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#\modfn{\paren{-\atan{\tan{(-\theta)}} - \pi }}{\TAU}     &amp;\text{if } \cos{(-\theta )} &lt; 0 \AND \sin{(-\theta )} \ge 0 \\</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">nptheta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">nptheta</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case2_theta</span> <span class="o">=</span>  <span class="n">nptheta</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case2_result</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="o">-</span><span class="n">case2_theta</span><span class="p">))</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">%</span> <span class="n">TAU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">case2_theta</span><span class="p">,</span> <span class="n">case2_result</span><span class="p">,</span> <span class="n">vt</span><span class="o">.</span><span class="n">ori_distance</span><span class="p">(</span><span class="n">case2_theta</span><span class="p">,</span> <span class="n">case2_result</span><span class="p">)</span> <span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Case 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#\modfn{\paren{-\atan{\tan{(-\theta)}} + \pi }}{\TAU} &amp;\text{if } \cos{(-\theta )} &lt; 0 \AND \sin{(-\theta )} &lt; 0 \\</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">nptheta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">nptheta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case3_theta</span> <span class="o">=</span>  <span class="n">nptheta</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case3_result</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="o">-</span><span class="n">case3_theta</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">%</span> <span class="n">TAU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">case3_theta</span><span class="p">,</span> <span class="n">case3_result</span><span class="p">,</span> <span class="n">vt</span><span class="o">.</span><span class="n">ori_distance</span><span class="p">(</span><span class="n">case3_theta</span><span class="p">,</span> <span class="n">case3_result</span><span class="p">)),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Case 4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#\modfn{\paren{-\frac{\pi}{2} }}{\TAU}                &amp;\text{if } \cos{(-\theta )} = 0 \AND \sin{(-\theta )} &gt; 0 \\</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># There are 2 locations with cos(-theta) = 0 and sing(-theta) &gt; 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># case4_theta = [ 3 * TAU / 4,   -TAU / 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosine0_theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="n">TAU</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span><span class="p">])</span> <span class="c1"># positions with cosine = 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">cosine0_theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">cosine0_theta</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case4_theta</span> <span class="o">=</span>  <span class="n">cosine0_theta</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;case4_theta = </span><span class="si">%r</span><span class="s1"> =? </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">case4_theta</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">%</span> <span class="n">TAU</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Case 5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># There are 2 locations with cos(-theta) = 0 and sing(-theta) &lt; 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># case4_theta = [ -3 * TAU / 4,   TAU / 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#\modfn{\paren{\frac{\pi}{2} }}{\TAU}                &amp;\text{if } \cos{(-\theta )} = 0 \AND \sin{(-\theta )} &lt; 0 \\</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">cosine0_theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">cosine0_theta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case5_theta</span> <span class="o">=</span>  <span class="n">cosine0_theta</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;case5_theta = </span><span class="si">%r</span><span class="s1"> =? </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">case5_theta</span><span class="p">,</span> <span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">%</span> <span class="n">TAU</span><span class="p">))</span>
</pre></div>
</div>
<p># numpy check</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># LATEX PART</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invTVR_held_full</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invTVR_full</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">refine</span><span class="p">,</span> <span class="n">atan2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.assumptions.refine</span> <span class="k">import</span> <span class="n">refine_atan2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="k">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">refine_atan2</span><span class="p">(</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="n">Q</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">Q</span><span class="o">.</span><span class="n">positive</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">refine_atan2</span><span class="p">(</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="n">Q</span><span class="o">.</span><span class="n">negative</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">Q</span><span class="o">.</span><span class="n">negative</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">refine_atan2</span><span class="p">(</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="n">Q</span><span class="o">.</span><span class="n">positive</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">Q</span><span class="o">.</span><span class="n">negative</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="go">atan(y/x)</span>
<span class="go">atan(y/x) - pi</span>
<span class="go">atan(y/x) + pi</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">negtheta</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;negtheta&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_subs2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">ori_subs</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ori_subs3</span> <span class="o">=</span> <span class="n">ori_subs2</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">theta</span><span class="p">:</span><span class="o">-</span><span class="n">negtheta</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_subs4</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">ori_subs3</span><span class="p">)</span>
<span class="go">Out[45]: Mod(-atan2(sin(negtheta)/a, cos(negtheta)/a), 2*pi)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>SimpleError:</dt>
<dd><p class="first">import sympy
from sympy.assumptions.refine import refine_atan2
symkw = dict(real=True, finite=True)
a = sympy.symbols(‘a’, positive=True, <a href="#id7"><span class="problematic" id="id8">**</span></a>symkw)
theta  = sympy.symbols(‘theta’, <a href="#id9"><span class="problematic" id="id10">**</span></a>symkw)</p>
<p>iv11, iv12  = sympy.symbols(‘iv11, iv12’, <a href="#id11"><span class="problematic" id="id12">**</span></a>symkw)
arb_assign = {</p>
<blockquote>
<div>iv12: -sympy.sin(theta)/a,
iv11: sympy.cos(theta)/a,</div></blockquote>
<p>}</p>
<p>ori_subs_nomod = sympy.atan2(-sympy.sin(theta)/a, sympy.cos(theta)/a)
atan2_case1 = refine_atan2(ori_subs_nomod,</p>
<blockquote>
<div>sympy.Q.real(arb_assign[iv12]) &amp; sympy.Q.positive(arb_assign[iv11])</div></blockquote>
<p class="last">)</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ori_subs3</span> <span class="o">=</span> <span class="n">ori_subs2</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">theta</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_subs3</span> <span class="o">=</span> <span class="n">ori_subs2</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">simultanious</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">for sym in ori_subs2.free_symbols:</span>
<span class="go">    print(&#39;%r.assumptions0 = %s&#39; % (sym, ub.repr2(sym.assumptions0),))</span>
</pre></div>
</div>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#invTVR = sympy.simplify(RVT_full.inv())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invTVR_full</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Sympy:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># First orient a unit circle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symkw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span>       <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">iv21</span>  <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y iv21&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">v21</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;vx, vy, v21&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iv11</span><span class="p">,</span> <span class="n">iv22</span>  <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;iv11 iv12&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v11</span><span class="p">,</span> <span class="n">v22</span>    <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;v11 v22&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Forward rotation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="o">-</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span>              <span class="mi">0</span><span class="p">,</span>          <span class="mi">0</span><span class="p">,</span>      <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Warps a unit circle at (0, 0) onto an ellipse at (x, y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">iv11</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="n">x</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span>  <span class="n">y</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">v11</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">vx</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">v21</span><span class="p">,</span> <span class="n">v22</span><span class="p">,</span> <span class="n">vy</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="go">veq = sympy.Eq(invVR, VR.inv())</span>
<span class="go">print(&#39;iv11 = &#39; + str(sympy.solve(veq, iv11)))</span>
<span class="go">print(&#39;iv21 = &#39; + str(sympy.solve(veq, iv21)))</span>
<span class="go">print(&#39;iv22 = &#39; + str(sympy.solve(veq, iv22)))</span>
<span class="go">print(&#39;x = &#39; + str(sympy.solve(veq, x)))</span>
<span class="go">print(&#39;y = &#39; + str(sympy.solve(veq, y)))</span>
<span class="go">inveq = sympy.Eq(V, invV.inv())</span>
<span class="go">print(&#39;v11 = &#39; + str(sympy.solve(inveq, v11)))</span>
<span class="go">print(&#39;v12 = &#39; + str(sympy.solve(inveq, v21)))</span>
<span class="go">print(&#39;v22 = &#39; + str(sympy.solve(inveq, v22)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">eval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">invVR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">invVR</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">rrrr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invV</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">other_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">other_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invVR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Sympy:</dt>
<dd><div class="first highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Show orientation property</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># First orient a unit circle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">iv21</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y g&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">v21</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;vx, vy, c&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iv11</span><span class="p">,</span> <span class="n">iv22</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;e h&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v11</span><span class="p">,</span> <span class="n">v22</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a d&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Forward rotation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="o">-</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span>              <span class="mi">0</span><span class="p">,</span>          <span class="mi">0</span><span class="p">,</span>      <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Warps a unit circle at (0, 0) onto an ellipse at (x, y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">iv11</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="n">x</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span>  <span class="n">y</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">v11</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">vx</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">v21</span><span class="p">,</span> <span class="n">v22</span><span class="p">,</span> <span class="n">vy</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="go">veq = sympy.Eq(invVR, VR.inv())</span>
<span class="go">print(&#39;iv11 = &#39; + str(sympy.solve(veq, iv11)))</span>
<span class="go">print(&#39;iv21 = &#39; + str(sympy.solve(veq, iv21)))</span>
<span class="go">print(&#39;iv22 = &#39; + str(sympy.solve(veq, iv22)))</span>
<span class="go">print(&#39;x = &#39; + str(sympy.solve(veq, x)))</span>
<span class="go">print(&#39;y = &#39; + str(sympy.solve(veq, y)))</span>
<span class="go">inveq = sympy.Eq(V, invV.inv())</span>
<span class="go">print(&#39;v11 = &#39; + str(sympy.solve(inveq, v11)))</span>
<span class="go">print(&#39;v12 = &#39; + str(sympy.solve(inveq, v21)))</span>
<span class="go">print(&#39;v22 = &#39; + str(sympy.solve(inveq, v22)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">eval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">invVR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">invVR</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">rrrr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invV</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">other_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">other_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invVR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="go">Matrix([</span>
<span class="go">[                 iv11*cos(theta),                  -iv11*sin(theta),  x],</span>
<span class="go">[iv21*cos(theta) + iv22*sin(theta), -iv21*sin(theta) + iv22*cos(theta),  y],</span>
<span class="go">[                               0,                                 0, 1.0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">invVR</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now extract the orientation from any invVR formated matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[[</span><span class="n">ivr11</span><span class="p">,</span> <span class="n">ivr12</span><span class="p">,</span> <span class="n">ivr13</span><span class="p">],</span> <span class="p">[</span><span class="n">ivr21</span><span class="p">,</span> <span class="n">ivr22</span><span class="p">,</span> <span class="n">ivr23</span><span class="p">],</span> <span class="p">[</span><span class="n">ivr31</span><span class="p">,</span> <span class="n">ivr32</span><span class="p">,</span> <span class="n">ivr33</span><span class="p">],]</span> <span class="o">=</span> <span class="n">invVR</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># tan = sin / cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symtau</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sympy</span><span class="o">.</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#ivr11 must be positive for this to work</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">sympy</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">ivr12</span><span class="p">,</span> <span class="n">ivr11</span><span class="p">))</span> <span class="o">%</span> <span class="p">(</span><span class="n">symtau</span><span class="p">)</span>  <span class="c1"># outputs from -TAU/2 to TAU/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Check Equality with a domain</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1</span> <span class="o">=</span> <span class="n">ori</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr2</span> <span class="o">=</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="p">{</span><span class="n">theta</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">truth_list</span><span class="p">,</span> <span class="n">results_list</span><span class="p">,</span> <span class="n">input_list</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">symbolic_randcheck</span><span class="p">(</span><span class="n">ori</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">truth_list</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">results_list</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">input_list</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">difference</span> <span class="o">=</span> <span class="n">results_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">results_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;diff = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">difference</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ori diff = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">ori_distance</span><span class="p">(</span><span class="n">results_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">results_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</pre></div>
</div>
<p class="last">truth_list, results_list, input_list =
check_random_points(sympy.sin(theta) / sympy.cos(theta),
sympy.tan(theta))
_oris = (-trig.atan2(_iv12s, _iv11s)) % TAU
ori.evalf(subs=dict(iv11=1, theta=3), verbose=True)
sympy.trigsimp(sympy.simplify(sympy.trigsimp(z)))
ori = np.arctan2(_iv12s, _iv11s)
z = ori.subs(dict(iv11=1, theta=1))</p>
</dd>
<dt>Timeit:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;&#39;&#39;</span>
<span class="go">        import numpy as np</span>
<span class="go">        np.random.seed(0)</span>
<span class="go">        invVR_mats = np.random.rand(10000, 2, 2).astype(np.float64)</span>
<span class="go">        &#39;&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;&#39;&#39;</span>
<span class="go">        invVR_mats[:, 0, 1]</span>
<span class="go">        invVR_mats.T[1, 0]</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">util_dev</span><span class="o">.</span><span class="n">rrr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">util_dev</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1E3</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVR_mats_shape">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invVR_mats_shape</code><span class="sig-paren">(</span><em>invVR_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts keypoint shape components</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">get_invVR_mats_shape</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">pibujdiaimwcnmomserkcytyyikahjmp</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p>TODO
(a.ravel()[(cols + (rows * a.shape[1]).reshape((-1,1))).ravel()]).reshape(rows.size, cols.size)
<a class="reference external" href="http://stackoverflow.com/questions/14386822/fast-numpy-fancy-indexing">http://stackoverflow.com/questions/14386822/fast-numpy-fancy-indexing</a>
# So, this doesn’t work
# Try this instead
<a class="reference external" href="http://docs.cython.org/src/userguide/memoryviews.html#memoryviews">http://docs.cython.org/src/userguide/memoryviews.html#memoryviews</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVR_mats_sqrd_scale">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invVR_mats_sqrd_scale</code><span class="sig-paren">(</span><em>invVR_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_sqrd_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats_sqrd_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the squared scale of the invVR keyponts</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det_arr</span> <span class="o">=</span> <span class="n">get_invVR_mats_sqrd_scale</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">det_arr</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([-0.16, -0.09, -0.34, 0.59, -0.2 , 0.18, 0.06], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVR_mats_xys">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invVR_mats_xys</code><span class="sig-paren">(</span><em>invVR_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_xys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats_xys" title="Permalink to this definition">¶</a></dt>
<dd><p>extracts locations
extracts xys from matrix encoding, Its just the (0, 2), and (1, 2) components</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>invVR_mats</strong> (<em>ndarray</em>) – list of matrices mapping ucircles to ellipses</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the xy location</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Timeit:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;&#39;&#39;</span>
<span class="go">        import numpy as np</span>
<span class="go">        np.random.seed(0)</span>
<span class="go">        invVR_mats = np.random.rand(1000, 3, 3).astype(np.float64)</span>
<span class="go">        &#39;&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;&#39;&#39;</span>
<span class="go">        invVR_mats[:, 0:2, 2].T</span>
<span class="go">        invVR_mats.T[2, 0:2]</span>
<span class="go">        invVR_mats.T.take(2, axis=0).take([0, 1], axis=0)</span>
<span class="go">        invVR_mats.T.take(2, axis=0)[0:2]</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">util_dev</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1E5</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invV_mats">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invV_mats</code><span class="sig-paren">(</span><em>kpts</em>, <em>with_trans=False</em>, <em>with_ori=False</em>, <em>ashomog=False</em>, <em>ascontiguous=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invV_mats" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: DEPRICATE. too many conditionals</p>
<p>packs keypoint shapes into affine invV matrixes
(default is just the 2x2 shape. But translation, orientation,
homogonous, and contiguous flags can be set.)</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">with_trans</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">with_ori</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ashomog</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascontiguous</span><span class="o">=</span><span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">innVR_mats</span> <span class="o">=</span> <span class="n">get_invV_mats</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">with_trans</span><span class="p">,</span> <span class="n">with_ori</span><span class="p">,</span> <span class="n">ashomog</span><span class="p">,</span> <span class="n">ascontiguous</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">innVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[ 1.,  0., 10.],</span>
<span class="go">        [ 2.,  3., 20.],</span>
<span class="go">        [ 0.,  0.,  1.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invV_mats2x2">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invV_mats2x2</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_mats2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invV_mats2x2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keypoint shape (from unit circle to ellipse)
Ignores translation and rotation component</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">invV_mats</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray[float32_t, ndim=3]</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint –test-get_invV_mats2x2</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_mats2x2</span> <span class="o">=</span> <span class="n">get_invV_mats2x2</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invV_mats2x2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invV_mats3x3">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invV_mats3x3</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_mats3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invV_mats3x3" title="Permalink to this definition">¶</a></dt>
<dd><p>NEWER FUNCTION</p>
<p>Returns full keypoint transform matricies from a unit circle to an
ellipse that has been scaled, skewed, and translated. Into
the image keypoint position.</p>
<p>DOES NOT INCLUDE ROTATION</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">invVR_mats -  keypoint shape and rotations (possibly translation)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray[float32_t, ndim=3]</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_arrs3x3</span> <span class="o">=</span> <span class="n">get_invV_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invV_arrs3x3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVs">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invVs</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVs" title="Permalink to this definition">¶</a></dt>
<dd><p>Keypoint shapes (oriented with the gravity vector)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_kpts_dlen_sqrd">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_kpts_dlen_sqrd</code><span class="sig-paren">(</span><em>kpts</em>, <em>outer=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_dlen_sqrd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_kpts_dlen_sqrd" title="Permalink to this definition">¶</a></dt>
<dd><p>returns diagonal length squared of keypoint extent</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>outer</strong> (<em>bool</em>) – loose if False tight if True</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dlen_sqrd</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dlen_sqrd</span> <span class="o">=</span> <span class="n">get_kpts_dlen_sqrd</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">dlen_sqrd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">3735.01</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_kpts_eccentricity">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_kpts_eccentricity</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_eccentricity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_kpts_eccentricity" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>SeeAlso:</dt>
<dd>pyhesaff.tests.test_ellipse</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Eccentricity_(mathematics">https://en.wikipedia.org/wiki/Eccentricity_(mathematics</a>)</p>
<dl class="docutils">
<dt>Ascii:</dt>
<dd><p class="first">Connic marix is
Z_mat = np.array(((‘    A’, ‘B / 2’, ‘D / 2’),</p>
<blockquote>
<div>(‘B / 2’, ‘    C’, ‘E / 2’),
(‘D / 2’, ‘E / 2’, ‘    F’)))</div></blockquote>
<p>The eccentricity is determined by:
[A, B, C, D] = kpts_mat</p>
<blockquote>
<div>(2 * np.sqrt((A - C) ** 2 + B ** 2))</div></blockquote>
<dl class="docutils">
<dt>ecc = ———————————————–</dt>
<dd>(nu * (A + C) + np.sqrt((A - C) ** 2 + B ** 2))</dd>
</dl>
<p>nu = 1 if det(Z) &gt; 0, -1 if det(Z) &lt; 0, and 0 if det(Z) == 0</p>
<p class="last">(nu is always 1 for ellipses.)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For an ellipse/hyperbola the eccentricity is
sqrt(1 - (b ** 2 / a ** 2))</p>
<p>Eccentricity is undefined for parabolas</p>
<p>where a is the lenth of the semi-major axis and b is the length of the
semi minor axis. The length of the semi-major axis is 2 time the
largest eigenvalue.  And the length of the semi-minor axis is 2 times
the smallest eigenvalue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>offset</strong> (<em>tuple</em>) – (default = (0.0, 0.0))</li>
<li><strong>scale_factor</strong> (<em>float</em>) – (default = 1.0)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint –exec-get_kpts_eccentricity –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts_</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kpts_</span><span class="p">,</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ecc</span> <span class="o">=</span> <span class="n">get_kpts_eccentricity</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;ecc = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">ecc</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">colors</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">scores_to_color</span><span class="p">(</span><span class="n">ecc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_axis_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ecc</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">ecc = np.array([ 0.96, 0.99, 0.87, 0.91, 0.55, 0.  ])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_kpts_image_extent">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_kpts_image_extent</code><span class="sig-paren">(</span><em>kpts</em>, <em>outer=False</em>, <em>only_xy=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_image_extent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_kpts_image_extent" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the width and height of keypoint bounding box
This combines xy and shape information
Does not take into account if keypoint extent goes under (0, 0)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em><em>[</em><em>ndims=2</em><em>]</em>) – keypoints</li>
<li><strong>outer</strong> – uses outer rectangle if True. Set to false for a
tighter extent.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(minx, maxx, miny, maxy)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">outer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">extent</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_axis_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([ 14.78, 48.05,  0.32, 51.58])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_kpts_strs">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_kpts_strs</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_strs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_kpts_strs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_kpts_wh">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_kpts_wh</code><span class="sig-paren">(</span><em>kpts</em>, <em>outer=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_wh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_kpts_wh" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the width / height diameter of a keypoint
ie the diameter of the xaxis and yaxis of the keypoint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em><em>[</em><em>ndims=2</em><em>]</em>) – keypoints</li>
<li><strong>outer</strong> (<em>bool</em>) – if True returns wh of bounding box.
This is useful because extracting a patch needs a rectangle.
If false it returns the otherwise gets the extent of the ellipse.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(2xN) column1 is X extent and column2 is Y extent</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><p class="first"># Determine formula for min/maxing x and y
import sympy
x, y = sympy.symbols(‘x, y’, real=True)
a, d = sympy.symbols(‘a, d’, real=True, positive=True)
c = sympy.symbols(‘c’, real=True)
theta = sympy.symbols(‘theta’, real=True, nonnegative=True)
xeqn = sympy.Eq(x, a * sympy.cos(theta))
yeqn = sympy.Eq(y, c * sympy.sin(theta) + v * d)
dxdt = sympy.solve(sympy.diff(xeqn, theta), 0)
dydt = sympy.solve(sympy.diff(yeqn, theta), 0)</p>
<p># Ugg, cant get sympy to do trig derivative, do it manually
dxdt = -a * sin(theta)
dydt = d * cos(theta) - c * sin(theta)
critical_thetas = solve(Eq(dxdt, 0), theta)
critical_thetas += solve(Eq(dydt, 0), theta)
[a, _, c, d] = invV.ravel()
critical_thetas = [</p>
<blockquote>
<div>0, np.pi,
-2 * np.arctan((c + np.sqrt(c ** 2 + d ** 2)) / d),
-2 * np.arctan((c - np.sqrt(c ** 2 + d ** 2)) / d),</div></blockquote>
<p>]
critical_uvs = np.vstack([np.cos(critical_thetas),</p>
<blockquote>
<div>np.sin(critical_thetas)])</div></blockquote>
<p class="last">critical_xys = invV.dot(critical_uvs)</p>
</dd>
<dt>SeeAlso:</dt>
<dd>get_kpts_major_minor</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span> <span class="o">*</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span> <span class="o">*</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyexnts</span> <span class="o">=</span> <span class="n">get_kpts_wh</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">xyexnts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">scale_extents</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_axis_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radii</span> <span class="o">=</span> <span class="n">xyexnts</span> <span class="o">/</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">horiz_pts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">xs</span> <span class="o">-</span> <span class="n">radii</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ys</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">horiz_pts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">xs</span> <span class="o">+</span> <span class="n">radii</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ys</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert_pts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xs</span><span class="p">,</span> <span class="p">(</span><span class="n">ys</span> <span class="o">-</span> <span class="n">radii</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert_pts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xs</span><span class="p">,</span> <span class="p">(</span><span class="n">ys</span> <span class="o">+</span> <span class="n">radii</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments2</span><span class="p">(</span><span class="n">horiz_pts1</span><span class="p">,</span> <span class="n">horiz_pts2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments2</span><span class="p">(</span><span class="n">vert_pts1</span><span class="p">,</span> <span class="n">vert_pts2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([[10.43315411, 58.5216589 ],</span>
<span class="go">          [ 4.71017647, 58.5216589 ],</span>
<span class="go">          [24.43314171, 45.09558868],</span>
<span class="go">          [26.71114159, 63.47679138],</span>
<span class="go">          [32.10540009, 30.28536987]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_match_spatial_squared_error">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_match_spatial_squared_error</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>H</em>, <em>fx2_to_fx1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_match_spatial_squared_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_match_spatial_squared_error" title="Permalink to this definition">¶</a></dt>
<dd><p>transforms img2 to img2 and finds squared spatial error</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts1</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>kpts2</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>H</strong> (<em>ndarray</em><em>[</em><em>float64_t</em><em>, </em><em>ndim=2</em><em>]</em>) – homography/perspective matrix mapping image 1 to image 2 space</li>
<li><strong>fx2_to_fx1</strong> (<em>ndarray</em>) – has shape (nMatch, K)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">fx2_to_xyerr_sqrd has shape (nMatch, K)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">129.83</span><span class="p">,</span>  <span class="mf">46.97</span><span class="p">,</span>  <span class="mf">15.84</span><span class="p">,</span>   <span class="mf">4.66</span><span class="p">,</span>   <span class="mf">7.24</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">137.88</span><span class="p">,</span>  <span class="mf">49.87</span><span class="p">,</span>  <span class="mf">20.09</span><span class="p">,</span>   <span class="mf">5.76</span><span class="p">,</span>   <span class="mf">6.2</span> <span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">115.95</span><span class="p">,</span>  <span class="mf">53.13</span><span class="p">,</span>  <span class="mf">12.96</span><span class="p">,</span>   <span class="mf">1.73</span><span class="p">,</span>   <span class="mf">8.77</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">324.88</span><span class="p">,</span> <span class="mf">172.58</span><span class="p">,</span> <span class="mf">127.69</span><span class="p">,</span>  <span class="mf">41.29</span><span class="p">,</span>  <span class="mf">50.5</span> <span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">285.44</span><span class="p">,</span> <span class="mf">254.61</span><span class="p">,</span> <span class="mf">136.06</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.77</span><span class="p">,</span>  <span class="mf">76.69</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">367.72</span><span class="p">,</span> <span class="mf">140.81</span><span class="p">,</span> <span class="mf">172.13</span><span class="p">,</span>  <span class="mf">12.99</span><span class="p">,</span>  <span class="mf">96.15</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">318.93</span><span class="p">,</span>  <span class="mf">11.98</span><span class="p">,</span>  <span class="mf">12.11</span><span class="p">,</span>   <span class="mf">0.38</span><span class="p">,</span>   <span class="mf">8.04</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">509.47</span><span class="p">,</span>  <span class="mf">12.53</span><span class="p">,</span>  <span class="mf">22.4</span> <span class="p">,</span>   <span class="mf">1.31</span><span class="p">,</span>   <span class="mf">5.04</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">514.03</span><span class="p">,</span>  <span class="mf">13.04</span><span class="p">,</span>  <span class="mf">19.25</span><span class="p">,</span>   <span class="mf">1.74</span><span class="p">,</span>   <span class="mf">4.72</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">490.19</span><span class="p">,</span> <span class="mf">185.49</span><span class="p">,</span>  <span class="mf">95.67</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.84</span><span class="p">,</span>  <span class="mf">88.23</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">316.97</span><span class="p">,</span> <span class="mf">206.07</span><span class="p">,</span>  <span class="mf">90.87</span><span class="p">,</span>   <span class="mf">0.07</span><span class="p">,</span>  <span class="mf">80.45</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">366.07</span><span class="p">,</span> <span class="mf">140.05</span><span class="p">,</span> <span class="mf">161.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">47.01</span><span class="p">,</span>  <span class="mf">85.62</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="o">-</span><span class="mf">0.70098</span><span class="p">,</span>  <span class="mf">0.12273</span><span class="p">,</span>  <span class="mf">5.18734</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mf">0.12444</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.63474</span><span class="p">,</span> <span class="mf">14.13995</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mf">0.00004</span><span class="p">,</span>  <span class="mf">0.00025</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.64873</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr_sqrd</span> <span class="o">=</span> <span class="n">get_match_spatial_squared_error</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">fx2_to_fx1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fx2_to_xyerr_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fx2_to_xyerr</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">6.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">,</span>  <span class="mf">15.84</span><span class="p">,</span>   <span class="mf">4.66</span><span class="p">,</span>   <span class="mf">7.24</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">9.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>  <span class="mf">20.09</span><span class="p">,</span>   <span class="mf">5.76</span><span class="p">,</span>   <span class="mf">6.2</span> <span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">12.96</span><span class="p">,</span>   <span class="mf">1.73</span><span class="p">,</span>   <span class="mf">8.77</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">12.11</span><span class="p">,</span>   <span class="mf">0.38</span><span class="p">,</span>   <span class="mf">8.04</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">5.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">22.4</span> <span class="p">,</span>   <span class="mf">1.31</span><span class="p">,</span>   <span class="mf">5.04</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">6.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">19.25</span><span class="p">,</span>   <span class="mf">1.74</span><span class="p">,</span>   <span class="mf">4.72</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr_sqrd</span> <span class="o">=</span> <span class="n">get_match_spatial_squared_error</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">fx2_to_fx1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fx2_to_xyerr_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fx2_to_xyerr</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_ori_mats">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_ori_mats</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_ori_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_ori_mats" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns keypoint orientation matrixes</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_ori_strs">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_ori_strs</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_ori_strs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_ori_strs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_oris">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_oris</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_oris"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_oris" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts keypoint orientations for kpts array</p>
<p>(in isotropic guassian space relative to the gravity vector)
(in simpler words: the orientation is is taken from keypoints warped to the unit circle)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray</em>) – (N x 6) [x, y, a, c, d, theta]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(ndarray) theta</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_scales">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_scales</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_scales"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_scales" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets average scale (does not take into account elliptical shape</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_shape_strs">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_shape_strs</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_shape_strs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_shape_strs" title="Permalink to this definition">¶</a></dt>
<dd><p>strings debugging and output</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_sqrd_scales">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_sqrd_scales</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_sqrd_scales"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_sqrd_scales" title="Permalink to this definition">¶</a></dt>
<dd><p>gets average squared scale (does not take into account elliptical shape</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_scales_sqrd</span> <span class="o">=</span> <span class="n">get_sqrd_scales</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_scales_sqrd</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_scales_sqrd</span> <span class="o">=</span> <span class="n">get_sqrd_scales</span><span class="p">([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_scales_sqrd</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_transforms_from_patch_image_kpts">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_transforms_from_patch_image_kpts</code><span class="sig-paren">(</span><em>kpts</em>, <em>patch_shape</em>, <em>scale_factor=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_transforms_from_patch_image_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_transforms_from_patch_image_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Given some patch (like a gaussian patch) transforms a patch to be overlayed
on top of each keypoint in the image (adjusted for a scale factor)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>patch_shape</strong> – </li>
<li><strong>scale_factor</strong> (<em>float</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a list of 3x3 tranformation matricies for each keypoint</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">M_list</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_factor</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M_list</span> <span class="o">=</span> <span class="n">get_transforms_from_patch_image_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">patch_shape</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">M_list</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_uneven_point_sample">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_uneven_point_sample</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_uneven_point_sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_uneven_point_sample" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>for each keypoint returns an uneven sample of points along the ellipical</dt>
<dd>boundries.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>pyhesaff.tests.test_ellipse
python -m pyhesaff.tests.test_ellipse –test-in_depth_ellipse –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ellipse_pts1</span> <span class="o">=</span> <span class="n">get_uneven_point_sample</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">ellipse_pts1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;uneven sample points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_xy_strs">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_xy_strs</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_xy_strs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_xy_strs" title="Permalink to this definition">¶</a></dt>
<dd><p>strings debugging and output</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_xys">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_xys</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_xys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_xys" title="Permalink to this definition">¶</a></dt>
<dd><p>Keypoint locations in chip space</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.invert_invV_mats">
<code class="descclassname">vtool.keypoint.</code><code class="descname">invert_invV_mats</code><span class="sig-paren">(</span><em>invV_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#invert_invV_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.invert_invV_mats" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>invV_mats</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=3</em><em>]</em>) – keypoint shapes (possibly translation)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">V_mats</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray[float32_t, ndim=3]</td>
</tr>
</tbody>
</table>
<p># Ignore:
#     &gt;&gt;&gt; from vtool.keypoint import *
#     &gt;&gt;&gt; invV_mats  = np.array([[[ 18.00372824,   1.86434161,  32.        ],
#     &gt;&gt;&gt;                         [ -0.61356842,  16.02202028,  27.2       ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]],
#     &gt;&gt;&gt; #
#     &gt;&gt;&gt;                         [[ 17.41989015,   2.51145917,  61.        ],
#     &gt;&gt;&gt;                         [ -2.94649591,  24.02540959,  22.9       ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]],
#     &gt;&gt;&gt; #
#     &gt;&gt;&gt;                         [[ 20.38098025,   0.88070646,  93.1       ],
#     &gt;&gt;&gt;                         [ -0.93778675,  24.78261982,  23.6       ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]],
#     &gt;&gt;&gt; #
#     &gt;&gt;&gt;                         [[ 16.25114793,  -5.93213207, 120.        ],
#     &gt;&gt;&gt;                         [  4.71295477,  21.80597527,  29.5       ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]],
#     &gt;&gt;&gt; #
#     &gt;&gt;&gt;                         [[ 19.60863253, -11.43641248, 147.        ],
#     &gt;&gt;&gt;                         [  8.45128003,  10.69925072,  42.        ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]]])
#     &gt;&gt;&gt; ut.hash_data(invV_mats)
#     hcnoknyxgeecfyfrygblbvdeezmiulws
#     &gt;&gt;&gt; V_mats = npl.inv(invV_mats)
#     &gt;&gt;&gt; ut.hash_data(V_mats)
#     yooneahjgcifojzpovddeyhtkkyypldd</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_mats</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_invVR_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V_mats</span> <span class="o">=</span> <span class="n">invert_invV_mats</span><span class="p">(</span><span class="n">invV_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">matrix_multiply</span><span class="p">(</span><span class="n">invV_mats</span><span class="p">,</span> <span class="n">V_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This should give us identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.kp_cpp_infostr">
<code class="descclassname">vtool.keypoint.</code><code class="descname">kp_cpp_infostr</code><span class="sig-paren">(</span><em>kp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#kp_cpp_infostr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.kp_cpp_infostr" title="Permalink to this definition">¶</a></dt>
<dd><p>mirrors c++ debug code</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.kpts_docrepr">
<code class="descclassname">vtool.keypoint.</code><code class="descname">kpts_docrepr</code><span class="sig-paren">(</span><em>arr</em>, <em>name='arr'</em>, <em>indent=True</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#kpts_docrepr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.kpts_docrepr" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_docrepr</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.kpts_repr">
<code class="descclassname">vtool.keypoint.</code><code class="descname">kpts_repr</code><span class="sig-paren">(</span><em>arr</em>, <em>precision=2</em>, <em>suppress_small=True</em>, <em>linebreak=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#kpts_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.kpts_repr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.keypoint.offset_kpts">
<code class="descclassname">vtool.keypoint.</code><code class="descname">offset_kpts</code><span class="sig-paren">(</span><em>kpts</em>, <em>offset=(0.0</em>, <em>0.0)</em>, <em>scale_factor=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#offset_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.offset_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Transfoms keypoints by a scale factor and a translation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>offset</strong> (<em>tuple</em>) – </li>
<li><strong>scale_factor</strong> (<em>float</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">kpts -  keypoints</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[float32_t, ndim=2]</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_factor</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts_</span> <span class="o">=</span> <span class="n">offset_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results (hack + 0. to fix negative 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">((</span><span class="n">kpts</span><span class="p">,</span> <span class="n">kpts_</span> <span class="o">+</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ORANGE</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts_</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">LIGHT_BLUE</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">union_extents</span><span class="p">([</span><span class="n">extent1</span><span class="p">,</span> <span class="n">extent2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_axis_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([[20.  , 25.  ,  5.22, -5.11, 24.15,  0.  ],</span>
<span class="go">          [29.  , 25.  ,  2.36, -5.11, 24.15,  0.  ],</span>
<span class="go">          [30.  , 30.  , 12.22, 12.02, 10.53,  0.  ],</span>
<span class="go">          [31.  , 29.  , 13.36, 17.63, 14.1 ,  0.  ],</span>
<span class="go">          [32.  , 31.  , 16.05,  3.41, 11.74,  0.  ]], dtype=np.float64),</span>
<span class="go">np.array([[30.  , 12.5 ,  7.82, -2.56, 12.07,  0.  ],</span>
<span class="go">          [43.5 , 12.5 ,  3.53, -2.56, 12.07,  0.  ],</span>
<span class="go">          [45.  , 15.  , 18.32,  6.01,  5.26,  0.  ],</span>
<span class="go">          [46.5 , 14.5 , 20.03,  8.82,  7.05,  0.  ],</span>
<span class="go">          [48.  , 15.5 , 24.08,  1.7 ,  5.87,  0.  ]], dtype=np.float64),</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.rectify_invV_mats_are_up">
<code class="descclassname">vtool.keypoint.</code><code class="descname">rectify_invV_mats_are_up</code><span class="sig-paren">(</span><em>invVR_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#rectify_invV_mats_are_up"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.rectify_invV_mats_are_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Useful if invVR_mats is no longer lower triangular
rotates affine shape matrixes into downward (lower triangular) position</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint –exec-rectify_invV_mats_are_up –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Shrink x and y scales a bit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">3</span>  <span class="c1"># increase skew</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set random orientation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">get_invVR_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats2</span><span class="p">,</span> <span class="n">oris</span> <span class="o">=</span> <span class="n">rectify_invV_mats_are_up</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span> <span class="o">=</span> <span class="n">flatten_invV_mats_to_kpts</span><span class="p">(</span><span class="n">invVR_mats2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Scale down in y a bit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_kpts</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">kpts</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">]),</span> <span class="n">ori</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">eig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>             <span class="n">ori_color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Redraw oriented to show difference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">eig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ori_color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p>pt.figure(doclf=True, fnum=pt.ensure_fnum(None))
ax = pt.gca()
#ax.invert_yaxis()
#pt.draw_kpts2(kpts, color=’blue’, ell_linewidth=3, ori=1, eig=True, ori_color=’green’, rect=True)
pt.draw_kpts2(kpts2, color=’red’, ell_linewidth=2, ori=1, eig=True, ori_color=’green’, rect=True)
extents = np.array(vt.get_kpts_image_extent(np.vstack([kpts, kpts2])))
pt.set_axis_extent(extent, ax)
pt.dark_background()
ut.show_if_requested()</p>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">rectify_invV_mats_are_up</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
<span class="go">nbgarvieipbyfihtrhmeouosgehswvcr</span>
</pre></div>
</div>
</dd>
<dt>Ignore:</dt>
<dd><p class="first">_invRs_2x2 = invVR_mats[:, 0:2, 0:2][0:1]
A = _invRs_2x2[0]
Q, R = np.linalg.qr(A)</p>
<p>invVR_mats2, oris = rectify_invV_mats_are_up(_invRs_2x2[0:1])
L2, ori2 = invVR_mats2[0], oris[0]
Q2 = vt.rotation_mat2x2(ori2)</p>
<p>np.linalg.det(Q)</p>
<p>vecs = np.random.rand(2, 4)
Q2.dot(vecs)
Q.dot(vecs)</p>
<p class="last">np.linalg.cholesky(_invR_2x2)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.transform_kpts">
<code class="descclassname">vtool.keypoint.</code><code class="descname">transform_kpts</code><span class="sig-paren">(</span><em>kpts</em>, <em>M</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#transform_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.transform_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>returns M.dot(kpts_mat)
Currently, only works if M is affine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>M</strong> (<em>ndarray</em>) – affine transform matrix</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a href="#id45"><span class="problematic" id="id46">kpts_</span></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">transform_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-0. &#39;</span><span class="p">,</span> <span class="s1">&#39; 0. &#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.transform_kpts_to_imgspace">
<code class="descclassname">vtool.keypoint.</code><code class="descname">transform_kpts_to_imgspace</code><span class="sig-paren">(</span><em>kpts</em>, <em>bbox</em>, <em>bbox_theta</em>, <em>chipsz</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#transform_kpts_to_imgspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.transform_kpts_to_imgspace" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Transforms keypoints so they are plotable in imagespace</dt>
<dd>kpts   - xyacdo keypoints
bbox   - chip bounding boxes in image space
theta  - chip rotationsinvC
chipsz - chip extent (in keypoint / chip space)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.transform_kpts_xys">
<code class="descclassname">vtool.keypoint.</code><code class="descname">transform_kpts_xys</code><span class="sig-paren">(</span><em>H</em>, <em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#transform_kpts_xys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.transform_kpts_xys" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>H</strong> (<em>ndarray</em><em>[</em><em>float64_t</em><em>, </em><em>ndim=2</em><em>]</em>) – homography/perspective matrix</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">xy_t</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">3.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>  <span class="mf">5.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>  <span class="mf">6.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_t</span> <span class="o">=</span> <span class="n">transform_kpts_xys</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.linalg">
<span id="vtool-linalg-module"></span><h2>vtool.linalg module<a class="headerlink" href="#module-vtool.linalg" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>TODO: Look at this file</dt>
<dd><a class="reference external" href="http://www.lfd.uci.edu/~gohlke/code/transformations.py.html">http://www.lfd.uci.edu/~gohlke/code/transformations.py.html</a></dd>
</dl>
<p># Sympy:
#     &gt;&gt;&gt; # <a class="reference external" href="https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA">https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</a>
#     &gt;&gt;&gt; import vtool as vt
#     &gt;&gt;&gt; import sympy
#     &gt;&gt;&gt; from sympy.abc import theta
#     &gt;&gt;&gt; x, y, a, c, d, sx, sy  = sympy.symbols(‘x y a c d, sx, sy’)
#     &gt;&gt;&gt; R = vt.sympy_mat(vt.rotation_mat3x3(theta, sin=sympy.sin, cos=sympy.cos))
#     &gt;&gt;&gt; vt.evalprint(‘R’)
#     &gt;&gt;&gt; #evalprint(‘R.inv()’)
#     &gt;&gt;&gt; vt.evalprint(‘sympy.simplify(R.inv())’)
#     &gt;&gt;&gt; #evalprint(‘sympy.simplify(R.inv().subs(theta, 4))’)
#     &gt;&gt;&gt; #print(‘——-‘)
#     &gt;&gt;&gt; #invR = sympy_mat(vt.rotation_mat3x3(-theta, sin=sympy.sin, cos=sympy.cos))
#     &gt;&gt;&gt; #evalprint(‘invR’)
#     &gt;&gt;&gt; #evalprint(‘invR.inv()’)
#     &gt;&gt;&gt; #evalprint(‘sympy.simplify(invR)’)
#     &gt;&gt;&gt; #evalprint(‘sympy.simplify(invR.subs(theta, 4))’)
#     &gt;&gt;&gt; print(‘——-‘)
#     &gt;&gt;&gt; T = vt.sympy_mat(vt.translation_mat3x3(x, y, None))
#     &gt;&gt;&gt; vt.evalprint(‘T’)
#     &gt;&gt;&gt; vt.evalprint(‘T.inv()’)
#     &gt;&gt;&gt; print(‘——-‘)
#     &gt;&gt;&gt; S = vt.sympy_mat(vt.scale_mat3x3(sx, sy, dtype=None))
#     &gt;&gt;&gt; vt.evalprint(‘S’)
#     &gt;&gt;&gt; vt.evalprint(‘S.inv()’)
#     &gt;&gt;&gt; print(‘——-‘)
#     &gt;&gt;&gt; print(‘LaTeX’)
#     &gt;&gt;&gt; print(ut.align(‘\n’.join(sympy.latex(R).split(r’')).replace(‘{matrix}’, ‘{matrix}n’), ‘&amp;’)</p>
<dl class="function">
<dt id="vtool.linalg.add_homogenous_coordinate">
<code class="descclassname">vtool.linalg.</code><code class="descname">add_homogenous_coordinate</code><span class="sig-paren">(</span><em>_xys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#add_homogenous_coordinate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.add_homogenous_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.linalg –test-add_homogenous_coordinate</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xyzs</span> <span class="o">=</span> <span class="n">add_homogenous_coordinate</span><span class="p">(</span><span class="n">_xys</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">_xys</span> <span class="o">==</span> <span class="n">remove_homogenous_coordinate</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.affine_around_mat3x3">
<code class="descclassname">vtool.linalg.</code><code class="descname">affine_around_mat3x3</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>sx=1.0</em>, <em>sy=1.0</em>, <em>theta=0.0</em>, <em>shear=0.0</em>, <em>tx=0.0</em>, <em>ty=0.0</em>, <em>x2=None</em>, <em>y2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#affine_around_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.affine_around_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes an affine transform around center point (x, y).
Equivalent to translation.dot(affine).dot(inv(translation))</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>float</em>) – center x location in input space</li>
<li><strong>y</strong> (<em>float</em>) – center y location in input space</li>
<li><strong>sx</strong> (<em>float</em>) – x scale factor (default = 1)</li>
<li><strong>sy</strong> (<em>float</em>) – y scale factor (default = 1)</li>
<li><strong>theta</strong> (<em>float</em>) – counter-clockwise rotation angle in radians(default = 0)</li>
<li><strong>shear</strong> (<em>float</em>) – counter-clockwise shear angle in radians(default = 0)</li>
<li><strong>tx</strong> (<em>float</em>) – x-translation (default = 0)</li>
<li><strong>ty</strong> (<em>float</em>) – y-translation (default = 0)</li>
<li><strong>x2</strong> (<em>float</em><em>, </em><em>optional</em>) – center y location in output space (default = x)</li>
<li><strong>y2</strong> (<em>float</em><em>, </em><em>optional</em>) – center y location in output space (default = y)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.linalg affine_around_mat3x3 –show</dd>
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/linalg.py affine_around_mat3x3</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orig_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">verts_from_bbox</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">bbox_center</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">bbox_from_verts</span><span class="p">(</span><span class="n">orig_pts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shear</span> <span class="o">=</span> <span class="o">.</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff</span> <span class="o">=</span> <span class="n">affine_around_mat3x3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                           <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trans_pts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">transform_points_with_homography</span><span class="p">(</span><span class="n">Aff</span><span class="p">,</span> <span class="n">orig_pts</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoc: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;bx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">orig_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">orig_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trans_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trans_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;transformed&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Demo of affine_around_mat3x3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p># Timeit:
#     &gt;&gt;&gt; from vtool.linalg import *  # NOQA
#     &gt;&gt;&gt; x, y, sx, sy, theta, shear, tx, ty, x2, y2 = (
#     &gt;&gt;&gt;     256.0, 256.0, 1.5, 1.0, 0.78, 0.2, 0, 100, 500.0, 500.0)
#     &gt;&gt;&gt; for timer in ub.Timerit(1000, ‘old’):  # 19.0697 µs
#     &gt;&gt;&gt;     with timer:
#     &gt;&gt;&gt;         <a href="#id47"><span class="problematic" id="id48">tr1_</span></a> = translation_mat3x3(-x, -y)
#     &gt;&gt;&gt;         <a href="#id49"><span class="problematic" id="id50">Aff_</span></a> = affine_mat3x3(sx, sy, theta, shear, tx, ty)
#     &gt;&gt;&gt;         <a href="#id51"><span class="problematic" id="id52">tr2_</span></a> = translation_mat3x3(x2, y2)
#     &gt;&gt;&gt;         Aff1 = <a href="#id53"><span class="problematic" id="id54">tr2_</span></a>.dot(<a href="#id55"><span class="problematic" id="id56">Aff_</span></a>).dot(<a href="#id57"><span class="problematic" id="id58">tr1_</span></a>)
#     &gt;&gt;&gt; for timer in ub.Timerit(1000, ‘new’):  # 11.0242 µs
#     &gt;&gt;&gt;     with timer:
#     &gt;&gt;&gt;         Aff2 = affine_around_mat3x3(x, y, sx, sy, theta, shear,
#     &gt;&gt;&gt;                                     tx, ty, x2, y2)
#     &gt;&gt;&gt; assert np.all(np.isclose(Aff2, Aff1))</p>
<p># Sympy:
#     &gt;&gt;&gt; from vtool.linalg import *  # NOQA
#     &gt;&gt;&gt; import vtool as vt
#     &gt;&gt;&gt; import sympy
#     &gt;&gt;&gt; # Shows the symbolic construction of the code
#     &gt;&gt;&gt; # <a class="reference external" href="https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA">https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</a>
#     &gt;&gt;&gt; from sympy.abc import theta
#     &gt;&gt;&gt; x, y, sx, sy, theta, shear, tx, ty, x2, y2 = sympy.symbols(
#     &gt;&gt;&gt;     ‘x, y, sx, sy, theta, shear, tx, ty, x2, y2’)
#     &gt;&gt;&gt; theta = sx = sy = tx = ty = 0
#     &gt;&gt;&gt; # move to center xy, apply affine transform, move center xy2
#     &gt;&gt;&gt; <a href="#id59"><span class="problematic" id="id60">tr1_</span></a> = translation_mat3x3(-x, -y, dtype=None)
#     &gt;&gt;&gt; <a href="#id61"><span class="problematic" id="id62">Aff_</span></a> = affine_mat3x3(sx, sy, theta, shear, tx, ty, trig=sympy)
#     &gt;&gt;&gt; <a href="#id63"><span class="problematic" id="id64">tr2_</span></a> = translation_mat3x3(x2, y2, dtype=None)
#     &gt;&gt;&gt; # combine transformations
#     &gt;&gt;&gt; Aff = vt.sympy_mat(<a href="#id65"><span class="problematic" id="id66">tr2_</span></a>.dot(<a href="#id67"><span class="problematic" id="id68">Aff_</span></a>).dot(<a href="#id69"><span class="problematic" id="id70">tr1_</span></a>))
#     &gt;&gt;&gt; vt.evalprint(‘Aff’)
#     &gt;&gt;&gt; print(‘——-‘)
#     &gt;&gt;&gt; print(‘Numpy’)
#     &gt;&gt;&gt; vt.sympy_numpy_repr(Aff)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.affine_mat3x3">
<code class="descclassname">vtool.linalg.</code><code class="descname">affine_mat3x3</code><span class="sig-paren">(</span><em>sx=1</em>, <em>sy=1</em>, <em>theta=0</em>, <em>shear=0</em>, <em>tx=0</em>, <em>ty=0</em>, <em>trig=&lt;module 'numpy' from '/Users/jason.parham/virtualenv/wildme3/lib/python3.6/site-packages/numpy/__init__.py'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#affine_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.affine_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sx</strong> (<em>float</em>) – x scale factor (default = 1)</li>
<li><strong>sy</strong> (<em>float</em>) – y scale factor (default = 1)</li>
<li><strong>theta</strong> (<em>float</em>) – rotation angle (radians) in counterclockwise direction</li>
<li><strong>shear</strong> (<em>float</em>) – shear angle (radians) in counterclockwise directions</li>
<li><strong>tx</strong> (<em>float</em>) – x-translation (default = 0)</li>
<li><strong>ty</strong> (<em>float</em>) – y-translation (default = 0)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://github.com/scikit-image/scikit-image/blob/master/skimage/transform/_geometric.py">https://github.com/scikit-image/scikit-image/blob/master/skimage/transform/_geometric.py</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.det_ltri">
<code class="descclassname">vtool.linalg.</code><code class="descname">det_ltri</code><span class="sig-paren">(</span><em>ltri</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#det_ltri"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.det_ltri" title="Permalink to this definition">¶</a></dt>
<dd><p>Lower triangular determinant</p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.dot_ltri">
<code class="descclassname">vtool.linalg.</code><code class="descname">dot_ltri</code><span class="sig-paren">(</span><em>ltri1</em>, <em>ltri2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#dot_ltri"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.dot_ltri" title="Permalink to this definition">¶</a></dt>
<dd><p>Lower triangular dot product</p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.gauss2d_pdf">
<code class="descclassname">vtool.linalg.</code><code class="descname">gauss2d_pdf</code><span class="sig-paren">(</span><em>x_</em>, <em>y_</em>, <em>sigma=None</em>, <em>mu=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#gauss2d_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.gauss2d_pdf" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Input: x and y coordinate of a 2D gaussian</dt>
<dd>sigma, mu - covariance and mean vector</dd>
</dl>
<p>Output: The probability density at that point</p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.inv_ltri">
<code class="descclassname">vtool.linalg.</code><code class="descname">inv_ltri</code><span class="sig-paren">(</span><em>ltri</em>, <em>det</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#inv_ltri"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.inv_ltri" title="Permalink to this definition">¶</a></dt>
<dd><p>Lower triangular inverse</p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.normalize">
<code class="descclassname">vtool.linalg.</code><code class="descname">normalize</code><span class="sig-paren">(</span><em>arr</em>, <em>ord=None</em>, <em>axis=None</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all row vectors normalized by their magnitude.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arr</strong> (<em>ndarray</em>) – row vectors to normalize</li>
<li><strong>ord</strong> (<em>int</em>) – type of norm to use (defaults to 2-norm)
{non-zero int, inf, -inf}</li>
<li><strong>axis</strong> (<em>int</em>) – axis to normalize</li>
<li><strong>out</strong> (<em>ndarray</em>) – preallocated output</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>np.linalg.norm</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_normed</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;arr_normed = &#39;</span><span class="p">,</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_normed</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="n">arr_normed</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.6</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_normed</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;arr_normed = &#39;</span><span class="p">,</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_normed</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="n">arr_normed</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ord_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.6</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normed</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">ord</span><span class="p">,</span> <span class="n">normalize</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="nb">ord</span><span class="p">))</span> <span class="k">for</span> <span class="nb">ord</span> <span class="ow">in</span> <span class="n">ord_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">normed</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.normalize_rows">
<code class="descclassname">vtool.linalg.</code><code class="descname">normalize_rows</code><span class="sig-paren">(</span><em>arr</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#normalize_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.normalize_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRICATE</p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.random_affine_args">
<code class="descclassname">vtool.linalg.</code><code class="descname">random_affine_args</code><span class="sig-paren">(</span><em>zoom_pdf=None</em>, <em>tx_pdf=None</em>, <em>ty_pdf=None</em>, <em>shear_pdf=None</em>, <em>theta_pdf=None</em>, <em>enable_flip=False</em>, <em>enable_stretch=False</em>, <em>default_distribution='uniform'</em>, <em>scalar_anchor='reflect'</em>, <em>txy_pdf=None</em>, <em>rng=&lt;module 'numpy.random' from '/Users/jason.parham/virtualenv/wildme3/lib/python3.6/site-packages/numpy/random/__init__.py'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#random_affine_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.random_affine_args" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: allow for a pdf of ranges for each dimension</p>
<p>If pdfs are tuples it is interpreted as a default (uniform) distribution between the
two points. A single scalar is a default distribution between -scalar and
scalar.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>zoom_range</strong> (<em>tuple</em>) – (default = (1.0, 1.0))</li>
<li><strong>tx_range</strong> (<em>tuple</em>) – (default = (0.0, 0.0))</li>
<li><strong>ty_range</strong> (<em>tuple</em>) – (default = (0.0, 0.0))</li>
<li><strong>shear_range</strong> (<em>tuple</em>) – (default = (0, 0))</li>
<li><strong>theta_range</strong> (<em>tuple</em>) – (default = (0, 0))</li>
<li><strong>enable_flip</strong> (<em>bool</em>) – (default = False)</li>
<li><strong>enable_stretch</strong> (<em>bool</em>) – (default = False)</li>
<li><strong>rng</strong> (<em>module</em>) – random number generator(default = numpy.random)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">affine_args</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/linalg.py random_affine_args</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zoom_range</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.9090909090909091</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_pdf</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ty_pdf</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shear_pdf</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_pdf</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enable_flip</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enable_stretch</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">affine_args</span> <span class="o">=</span> <span class="n">random_affine_args</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">zoom_range</span><span class="p">,</span> <span class="n">tx_pdf</span><span class="p">,</span> <span class="n">ty_pdf</span><span class="p">,</span> <span class="n">shear_pdf</span><span class="p">,</span> <span class="n">theta_pdf</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">enable_flip</span><span class="p">,</span> <span class="n">enable_stretch</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;affine_args = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">affine_args</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">)</span> <span class="o">=</span> <span class="n">affine_args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">affine_mat3x3</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">Aff</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[ 1.009, -0.   ,  1.695],</span>
<span class="go">          [ 0.   ,  1.042,  2.584],</span>
<span class="go">          [ 0.   ,  0.   ,  1.   ]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.random_affine_transform">
<code class="descclassname">vtool.linalg.</code><code class="descname">random_affine_transform</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#random_affine_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.random_affine_transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.remove_homogenous_coordinate">
<code class="descclassname">vtool.linalg.</code><code class="descname">remove_homogenous_coordinate</code><span class="sig-paren">(</span><em>_xyzs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#remove_homogenous_coordinate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.remove_homogenous_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>normalizes 3d homogonous coordinates into 2d coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>_xyzs</strong> (<em>ndarray</em>) – of shape (3, N)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">_xys of shape (2, N)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.linalg –test-remove_homogenous_coordinate</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xyzs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">2.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">2.</span><span class="p">,</span>   <span class="mf">2.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">1.2</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xys</span> <span class="o">=</span> <span class="n">remove_homogenous_coordinate</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_xys</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xyzs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">140.</span><span class="p">,</span>  <span class="mf">167.</span><span class="p">,</span>  <span class="mf">185.</span><span class="p">,</span>  <span class="mf">185.</span><span class="p">,</span>  <span class="mf">194.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">121.</span><span class="p">,</span>  <span class="mf">139.</span><span class="p">,</span>  <span class="mf">156.</span><span class="p">,</span>  <span class="mf">155.</span><span class="p">,</span>  <span class="mf">163.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">47.</span><span class="p">,</span>   <span class="mf">56.</span><span class="p">,</span>   <span class="mf">62.</span><span class="p">,</span>   <span class="mf">62.</span><span class="p">,</span>   <span class="mf">65.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xys</span> <span class="o">=</span> <span class="n">remove_homogenous_coordinate</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_xys</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.rotation_around_bbox_mat3x3">
<code class="descclassname">vtool.linalg.</code><code class="descname">rotation_around_bbox_mat3x3</code><span class="sig-paren">(</span><em>theta</em>, <em>bbox0</em>, <em>bbox1=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_around_bbox_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.rotation_around_bbox_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.rotation_around_mat3x3">
<code class="descclassname">vtool.linalg.</code><code class="descname">rotation_around_mat3x3</code><span class="sig-paren">(</span><em>theta</em>, <em>x0</em>, <em>y0</em>, <em>x1=None</em>, <em>y1=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_around_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.rotation_around_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.rotation_mat2x2">
<code class="descclassname">vtool.linalg.</code><code class="descname">rotation_mat2x2</code><span class="sig-paren">(</span><em>theta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_mat2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.rotation_mat2x2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.rotation_mat3x3">
<code class="descclassname">vtool.linalg.</code><code class="descname">rotation_mat3x3</code><span class="sig-paren">(</span><em>radians</em>, <em>sin=&lt;ufunc 'sin'&gt;</em>, <em>cos=&lt;ufunc 'cos'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.rotation_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Rotation_matrix">https://en.wikipedia.org/wiki/Rotation_matrix</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.scale_around_mat3x3">
<code class="descclassname">vtool.linalg.</code><code class="descname">scale_around_mat3x3</code><span class="sig-paren">(</span><em>sx</em>, <em>sy</em>, <em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#scale_around_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.scale_around_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.scale_mat3x3">
<code class="descclassname">vtool.linalg.</code><code class="descname">scale_mat3x3</code><span class="sig-paren">(</span><em>sx</em>, <em>sy=None</em>, <em>dtype=&lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#scale_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.scale_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.shear_mat3x3">
<code class="descclassname">vtool.linalg.</code><code class="descname">shear_mat3x3</code><span class="sig-paren">(</span><em>shear_x</em>, <em>shear_y</em>, <em>dtype=&lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#shear_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.shear_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.svd">
<code class="descclassname">vtool.linalg.</code><code class="descname">svd</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#svd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.svd" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>M</strong> (<em>ndarray</em>) – must be either float32 or float64</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(U, s, Vt)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.linalg –test-svd</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">20.5812</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.615</span><span class="p">,</span> <span class="mf">17.1295</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vt</span><span class="p">)</span> <span class="o">=</span> <span class="n">svd</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Timeit::</dt>
<dd>flags = cv2.SVD_FULL_UV
%timeit cv2.SVDecomp(M, flags=flags)
%timeit npl.svd(M)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.transform_around">
<code class="descclassname">vtool.linalg.</code><code class="descname">transform_around</code><span class="sig-paren">(</span><em>M</em>, <em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#transform_around"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.transform_around" title="Permalink to this definition">¶</a></dt>
<dd><p>translates to origin, applies transform and then translates back</p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.transform_points_with_homography">
<code class="descclassname">vtool.linalg.</code><code class="descname">transform_points_with_homography</code><span class="sig-paren">(</span><em>H</em>, <em>_xys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#transform_points_with_homography"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.transform_points_with_homography" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>H</strong> (<em>ndarray</em><em>[</em><em>float64_t</em><em>, </em><em>ndim=2</em><em>]</em>) – homography/perspective matrix</li>
<li><strong>_xys</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – (2 x N) array</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.translation_mat3x3">
<code class="descclassname">vtool.linalg.</code><code class="descname">translation_mat3x3</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>dtype=&lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#translation_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.translation_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.whiten_xy_points">
<code class="descclassname">vtool.linalg.</code><code class="descname">whiten_xy_points</code><span class="sig-paren">(</span><em>xy_m</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#whiten_xy_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.whiten_xy_points" title="Permalink to this definition">¶</a></dt>
<dd><p>whitens points to mean=0, stddev=1 and returns transformation</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool</span> <span class="k">import</span> <span class="n">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_m</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_xy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">whiten_xy_points</span><span class="p">(</span><span class="n">xy_m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_norm</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">tup</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.matching">
<span id="vtool-matching-module"></span><h2>vtool.matching module<a class="headerlink" href="#module-vtool.matching" title="Permalink to this headline">¶</a></h2>
<p>vt
python -m utool.util_inspect check_module_usage –pat=”matching.py”</p>
<dl class="class">
<dt id="vtool.matching.AnnotPairFeatInfo">
<em class="property">class </em><code class="descclassname">vtool.matching.</code><code class="descname">AnnotPairFeatInfo</code><span class="sig-paren">(</span><em>columns=None</em>, <em>importances=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Information class about feature dimensions of PairwiseMatch.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li>Can be used to compute marginal importances over groups of features</li>
</ul>
<p>used in the pairwise one-vs-one scoring algorithm</p>
<ul class="simple">
<li>Can be used to construct an appropriate cfgdict for a new</li>
</ul>
<p>PairwiseMatch.</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.matching AnnotPairFeatInfo</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">({})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">add_global_measures</span><span class="p">([</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;gps&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;aid1&#39;</span><span class="p">,</span> <span class="s1">&#39;aid2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Feat info without bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">make_feature_vector</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">featinfo</span> <span class="o">=</span> <span class="n">AnnotPairFeatInfo</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pairfeat_cfg</span><span class="p">,</span> <span class="n">global_keys</span> <span class="o">=</span> <span class="n">featinfo</span><span class="o">.</span><span class="n">make_pairfeat_cfg</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pairfeat_cfg = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pairfeat_cfg</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;global_keys = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">global_keys</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;delta&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">global_keys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;max&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">global_keys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">cprint</span><span class="p">(</span><span class="n">featinfo</span><span class="o">.</span><span class="n">get_infostr</span><span class="p">(),</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Feat info with bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">make_feature_vector</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">7</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">],</span> <span class="n">bin_key</span><span class="o">=</span><span class="s1">&#39;ratio&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">featinfo</span> <span class="o">=</span> <span class="n">AnnotPairFeatInfo</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pairfeat_cfg</span><span class="p">,</span> <span class="n">global_keys</span> <span class="o">=</span> <span class="n">featinfo</span><span class="o">.</span><span class="n">make_pairfeat_cfg</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pairfeat_cfg = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr4</span><span class="p">(</span><span class="n">pairfeat_cfg</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;global_keys = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">global_keys</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">cprint</span><span class="p">(</span><span class="n">featinfo</span><span class="o">.</span><span class="n">get_infostr</span><span class="p">(),</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="vtool.matching.AnnotPairFeatInfo.binsum_fmt">
<code class="descname">binsum_fmt</code><em class="property"> = '{op}({measure}[{bin_key}&lt;{binval}])'</em><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.binsum_fmt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.dimkey_grammar">
<code class="descname">dimkey_grammar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.dimkey_grammar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.dimkey_grammar" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.matching AnnotPairFeatInfo.dimkey_grammar</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">({})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">add_global_measures</span><span class="p">([</span><span class="s1">&#39;view&#39;</span><span class="p">,</span> <span class="s1">&#39;qual&#39;</span><span class="p">,</span> <span class="s1">&#39;gps&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;aid1&#39;</span><span class="p">,</span> <span class="s1">&#39;aid2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Feat info without bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">make_feature_vector</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">featinfo</span> <span class="o">=</span> <span class="n">AnnotPairFeatInfo</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat_grammar</span> <span class="o">=</span> <span class="n">featinfo</span><span class="o">.</span><span class="n">dimkey_grammar</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">feat_grammar</span><span class="o">.</span><span class="n">parseString</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.feature">
<code class="descname">feature</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.feature"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.feature" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.find">
<code class="descname">find</code><span class="sig-paren">(</span><em>group_id</em>, <em>op</em>, <em>value</em>, <em>hack=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.find"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.find" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>groupid options:</dt>
<dd>measure_type global_measure, local_sorter, local_rank,
local_measure, summary_measure, summary_op, summary_bin,
summary_binval, summary_binkey,</dd>
<dt>Ignore:</dt>
<dd>group_id = ‘summary_op’
op = ‘==’
value = ‘len’</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.get_infostr">
<code class="descname">get_infostr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.get_infostr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.get_infostr" title="Permalink to this definition">¶</a></dt>
<dd><p>Summarizes the types (global, local, summary) of features in X based on
standardized dimension names.</p>
</dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.global_measure">
<code class="descname">global_measure</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.global_measure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.global_measure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.group_counts">
<code class="descname">group_counts</code><span class="sig-paren">(</span><em>item</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.group_counts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.group_counts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.group_importance">
<code class="descname">group_importance</code><span class="sig-paren">(</span><em>item</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.group_importance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.group_importance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.matching.AnnotPairFeatInfo.loc_fmt">
<code class="descname">loc_fmt</code><em class="property"> = 'loc[{sorter},{rank}]({measure})'</em><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.loc_fmt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.local_measure">
<code class="descname">local_measure</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.local_measure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.local_measure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.local_rank">
<code class="descname">local_rank</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.local_rank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.local_rank" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.local_sorter">
<code class="descname">local_sorter</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.local_sorter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.local_sorter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.make_pairfeat_cfg">
<code class="descname">make_pairfeat_cfg</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.make_pairfeat_cfg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.make_pairfeat_cfg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.measure">
<code class="descname">measure</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.measure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.measure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.measure_type">
<code class="descname">measure_type</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.measure_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.measure_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.print_counts">
<code class="descname">print_counts</code><span class="sig-paren">(</span><em>group_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.print_counts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.print_counts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.print_margins">
<code class="descname">print_margins</code><span class="sig-paren">(</span><em>group_id</em>, <em>ignore_trivial=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.print_margins"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.print_margins" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.rrr">
<code class="descname">rrr</code><span class="sig-paren">(</span><em>verbose=True</em>, <em>reload_module=True</em><span class="sig-paren">)</span><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.select_columns">
<code class="descname">select_columns</code><span class="sig-paren">(</span><em>criteria</em>, <em>op='and'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.select_columns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.select_columns" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>criteria</strong> (<em>list</em>) – list of tokens denoting selection constraints
can be one of:
measure_type global_measure, local_sorter, local_rank,
local_measure, summary_measure, summary_op, summary_bin,
summary_binval, summary_binkey,</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">featinfo</span><span class="o">.</span><span class="n">select_columns</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;measure_type&#39;</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;local&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;local_sorter&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;weighted_ratio_score&#39;</span><span class="p">,</span> <span class="s1">&#39;lnbnn_norm_dist&#39;</span><span class="p">]),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">],</span> <span class="n">op</span><span class="o">=</span><span class="s1">&#39;and&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="vtool.matching.AnnotPairFeatInfo.sum_fmt">
<code class="descname">sum_fmt</code><em class="property"> = '{op}({measure})'</em><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.sum_fmt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.summary_binkey">
<code class="descname">summary_binkey</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.summary_binkey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.summary_binkey" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.summary_binval">
<code class="descname">summary_binval</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.summary_binval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.summary_binval" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.summary_measure">
<code class="descname">summary_measure</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.summary_measure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.summary_measure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.AnnotPairFeatInfo.summary_op">
<code class="descname">summary_op</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.summary_op"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.summary_op" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="vtool.matching.AssignTup">
<em class="property">class </em><code class="descclassname">vtool.matching.</code><code class="descname">AssignTup</code><span class="sig-paren">(</span><em>fm</em>, <em>match_dist</em>, <em>norm_fx1</em>, <em>norm_dist</em><span class="sig-paren">)</span><a class="headerlink" href="#vtool.matching.AssignTup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="vtool.matching.AssignTup.fm">
<code class="descname">fm</code><a class="headerlink" href="#vtool.matching.AssignTup.fm" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.matching.AssignTup.match_dist">
<code class="descname">match_dist</code><a class="headerlink" href="#vtool.matching.AssignTup.match_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.matching.AssignTup.norm_dist">
<code class="descname">norm_dist</code><a class="headerlink" href="#vtool.matching.AssignTup.norm_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.matching.AssignTup.norm_fx1">
<code class="descname">norm_fx1</code><a class="headerlink" href="#vtool.matching.AssignTup.norm_fx1" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="vtool.matching.MatchingError">
<em class="property">exception </em><code class="descclassname">vtool.matching.</code><code class="descname">MatchingError</code><a class="reference internal" href="_modules/vtool/matching.html#MatchingError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.MatchingError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="class">
<dt id="vtool.matching.PairwiseMatch">
<em class="property">class </em><code class="descclassname">vtool.matching.</code><code class="descname">PairwiseMatch</code><span class="sig-paren">(</span><em>annot1=None</em>, <em>annot2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ubelt.util_mixins.NiceRepr</span></code></p>
<p>Newest (Sept-16-2016) object oriented one-vs-one matching interface</p>
<p>Creates an object holding two annotations
Then a pipeline of operations can be applied to
generate score and refine the matches</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The annotation dictionaries are required to have certain attributes.</p>
<dl class="last docutils">
<dt>Required annotation attributes:</dt>
<dd>(kpts, vecs) OR rchip OR rchip_fpath</dd>
<dt>Optional annotation attributes:</dt>
<dd>aid, nid, flann, rchip, dlen_sqrd, weight</dd>
</dl>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgL</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy2.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rchip&#39;</span><span class="p">:</span> <span class="n">imgR</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rchip&#39;</span><span class="p">:</span> <span class="n">imgL</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">PairwiseMatch</span><span class="p">(</span><span class="n">annot1</span><span class="p">,</span> <span class="n">annot2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">apply_all</span><span class="p">({</span><span class="s1">&#39;refine_method&#39;</span><span class="p">:</span> <span class="s1">&#39;affine&#39;</span><span class="p">,</span> <span class="s1">&#39;affine_invariance&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;rotation_invariance&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="n">imgR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR_warp</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">warpHomog</span><span class="p">(</span><span class="n">imgR</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">H_12</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">kwplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">autompl</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR_warp</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR_warp</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--gui)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.guitool</span> <span class="k">as</span> <span class="nn">gt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">ensure_qapp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">ishow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgL</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy2.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rchip&#39;</span><span class="p">:</span> <span class="n">imgR</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rchip&#39;</span><span class="p">:</span> <span class="n">imgL</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">PairwiseMatch</span><span class="p">(</span><span class="n">annot1</span><span class="p">,</span> <span class="n">annot2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">apply_all</span><span class="p">({</span><span class="s1">&#39;refine_method&#39;</span><span class="p">:</span> <span class="s1">&#39;affine&#39;</span><span class="p">,</span> <span class="s1">&#39;affine_invariance&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;rotation_invariance&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="n">imgR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR_warp</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">warpHomog</span><span class="p">(</span><span class="n">imgR</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">H_12</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">kwplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">autompl</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR_warp</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR_warp</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--gui)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.guitool</span> <span class="k">as</span> <span class="nn">gt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">ensure_qapp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">ishow</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="vtool.matching.PairwiseMatch.add_global_measures">
<code class="descname">add_global_measures</code><span class="sig-paren">(</span><em>global_keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.add_global_measures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.add_global_measures" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.PairwiseMatch.add_local_measures">
<code class="descname">add_local_measures</code><span class="sig-paren">(</span><em>xy=True</em>, <em>scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.add_local_measures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.add_local_measures" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.PairwiseMatch.apply_all">
<code class="descname">apply_all</code><span class="sig-paren">(</span><em>cfgdict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.apply_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.apply_all" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.PairwiseMatch.apply_ratio_test">
<code class="descname">apply_ratio_test</code><span class="sig-paren">(</span><em>cfgdict={}</em>, <em>inplace=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.apply_ratio_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.apply_ratio_test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.PairwiseMatch.apply_sver">
<code class="descname">apply_sver</code><span class="sig-paren">(</span><em>cfgdict={}</em>, <em>inplace=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.apply_sver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.apply_sver" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;ratio_thresh&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>           <span class="s1">&#39;thresh_bins&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">6</span><span class="p">,</span> <span class="o">.</span><span class="mi">7</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">cfgbase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">apply_ratio_test</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags1</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">apply_sver</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="vtool.matching.PairwiseMatch.assign">
<code class="descname">assign</code><span class="sig-paren">(</span><em>cfgdict={}</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.assign"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.assign" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign feature correspondences between annots</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">({},</span> <span class="n">apply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m1</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">assign</span><span class="p">({</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m2</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">assign</span><span class="p">({</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Grid:</dt>
<dd><p class="first">from vtool.matching import *  # NOQA
grid = {</p>
<blockquote>
<div>‘symmetric’: [True, False],</div></blockquote>
<p>}
for cfgdict in ut.all_dict_combinations(grid):</p>
<blockquote class="last">
<div>match = demodata_match(cfgdict, apply=False)
match.assign()</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="vtool.matching.PairwiseMatch.compress">
<code class="descname">compress</code><span class="sig-paren">(</span><em>flags</em>, <em>inplace=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.compress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.compress" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.PairwiseMatch.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.PairwiseMatch.ishow">
<code class="descname">ishow</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.ishow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.ishow" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.matching ishow –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.guitool</span> <span class="k">as</span> <span class="nn">gt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">ensure_qapp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">(</span><span class="n">use_cache</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">ishow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">disp_config</span><span class="p">[</span><span class="s1">&#39;show_homog&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">qtapp_loop</span><span class="p">(</span><span class="n">qwin</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.matching.PairwiseMatch.make_feature_vector">
<code class="descname">make_feature_vector</code><span class="sig-paren">(</span><em>local_keys=None</em>, <em>global_keys=None</em>, <em>summary_ops=None</em>, <em>sorters='ratio'</em>, <em>indices=3</em>, <em>bin_key=None</em>, <em>bins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.make_feature_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.make_feature_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs the pairwise feature vector that represents a match</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>local_keys</strong> (<em>None</em>) – (default = None)</li>
<li><strong>global_keys</strong> (<em>None</em>) – (default = None)</li>
<li><strong>summary_ops</strong> (<em>None</em>) – (default = None)</li>
<li><strong>sorters</strong> (<em>str</em>) – (default = ‘ratio’)</li>
<li><strong>indices</strong> (<em>int</em>) – (default = 3)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">feat</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.matching make_feature_vector</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">({})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">make_feature_vector</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;feat = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.matching.PairwiseMatch.matched_vecs2">
<code class="descname">matched_vecs2</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.matched_vecs2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.matched_vecs2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.PairwiseMatch.ratio_test_flags">
<code class="descname">ratio_test_flags</code><span class="sig-paren">(</span><em>cfgdict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.ratio_test_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.ratio_test_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.PairwiseMatch.show">
<code class="descname">show</code><span class="sig-paren">(</span><em>ax=None</em>, <em>show_homog=False</em>, <em>show_ori=False</em>, <em>show_ell=True</em>, <em>show_pts=False</em>, <em>show_lines=True</em>, <em>show_rect=False</em>, <em>show_eig=False</em>, <em>show_all_kpts=False</em>, <em>mask_blend=0</em>, <em>ell_alpha=0.6</em>, <em>line_alpha=0.35</em>, <em>modifysize=False</em>, <em>vert=None</em>, <em>overlay=True</em>, <em>heatmask=False</em>, <em>line_lw=1.4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.show"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.matching.PairwiseMatch.sver_flags">
<code class="descname">sver_flags</code><span class="sig-paren">(</span><em>cfgdict={}</em>, <em>return_extra=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.sver_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.sver_flags" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;newsym&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgbase</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;ratio_thresh&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">8</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_union</span><span class="p">(</span><span class="n">cfgbase</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">thresh_bins</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">6</span><span class="p">,</span> <span class="o">.</span><span class="mi">7</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">cfgbase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">apply_ratio_test</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags1</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">sver_flags</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags2</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">sver_flags</span><span class="p">(</span><span class="n">cfgbase</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.matching.PairwiseMatch.take">
<code class="descname">take</code><span class="sig-paren">(</span><em>indicies</em>, <em>inplace=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.take"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.take" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="vtool.matching.assign_symmetric_matches">
<code class="descclassname">vtool.matching.</code><code class="descname">assign_symmetric_matches</code><span class="sig-paren">(</span><em>fx2_to_fx1</em>, <em>fx2_to_dist</em>, <em>fx1_to_fx2</em>, <em>fx1_to_dist</em>, <em>K</em>, <em>Knorm=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#assign_symmetric_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.assign_symmetric_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>import vtool as vt
from vtool.matching import *
K = 2
Knorm = 1
feat1 = np.random.rand(5, 3)
feat2 = np.random.rand(7, 3)</p>
<p># Assign distances
distmat = vt.L2(feat1[:, None], feat2[None, :])</p>
<p># Find nearest K
fx1_to_fx2 = distmat.argsort()[:, 0:K + Knorm]
fx2_to_fx1 = distmat.T.argsort()[:, 0:K + Knorm]
# and order their distances
fx1_to_dist = np.array([distmat[i].take(col) for i, col in enumerate(fx1_to_fx2)])
fx2_to_dist = np.array([distmat.T[j].take(row) for j, row in enumerate(fx2_to_fx1)])</p>
<p># flat_matx1 = fx1_to_fx2 + np.arange(distmat.shape[0])[:, None] * distmat.shape[1]
# fx1_to_dist = distmat.take(flat_matx1).reshape(fx1_to_fx2.shape)</p>
<p>fx21 = pd.DataFrame(fx2_to_fx1)
fx21.columns.name = ‘K’
fx21.index.name = ‘fx1’</p>
<p>fx12 = pd.DataFrame(fx1_to_fx2)
fx12.columns.name = ‘K’
fx12.index.name = ‘fx2’</p>
<p>fx12 = fx12.T[0:K].T.astype(np.float)
fx21 = fx21.T[0:K].T.astype(np.float)</p>
<p>fx12.values[~fx1_to_flags] = np.nan
fx21.values[~fx2_to_flags] = np.nan</p>
<p>print(‘fx12.values =n%r’ % (fx12,))
print(‘<a href="#id71"><span class="problematic" id="id72">fm_</span></a> =n%r’ % (<a href="#id73"><span class="problematic" id="id74">fm_</span></a>,))</p>
<p>print(‘fx21.values =n%r’ % (fx21,))
print(‘fm =n%r’ % (fm,))</p>
<p>unflat_match_idx2 = -np.ones(fx2_to_fx1.shape)
unflat_match_idx2.ravel()[flat_match_idx2] = flat_match_idx2
inv_lookup21 = unflat_match_idx2.T[0:K].T</p>
<p>for fx2 in zip(fx12.values[fx1_to_flags]:</p>
<dl class="docutils">
<dt>for fx1, fx2 in zip(<a href="#id75"><span class="problematic" id="id76">match_fx1_</span></a>, <a href="#id77"><span class="problematic" id="id78">match_fx2_</span></a>):</dt>
<dd>cx = np.where(fx2_to_fx1[fx2][0:K] == fx1)[0][0]
inv_idx = inv_lookup21[fx2][cx]
print(‘inv_idx = %r’ % (inv_idx,))</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.assign_unconstrained_matches">
<code class="descclassname">vtool.matching.</code><code class="descname">assign_unconstrained_matches</code><span class="sig-paren">(</span><em>fx2_to_fx1</em>, <em>fx2_to_dist</em>, <em>K</em>, <em>Knorm=None</em>, <em>fx2_to_flags=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#assign_unconstrained_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.assign_unconstrained_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>assigns vsone matches using results of nearest neighbors.</p>
<dl class="docutils">
<dt>Ignore:</dt>
<dd>fx2_to_dist = np.arange(fx2_to_fx1.size).reshape(fx2_to_fx1.shape)</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.matching –test-assign_unconstrained_matches –show
python -m vtool.matching assign_unconstrained_matches:0
python -m vtool.matching assign_unconstrained_matches:1</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx2_to_dist</span> <span class="o">=</span> <span class="n">empty_neighbors</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Knorm</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flags</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assigntup</span> <span class="o">=</span> <span class="n">assign_unconstrained_matches</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx2_to_dist</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                         <span class="n">Knorm</span><span class="p">,</span> <span class="n">fx2_to_flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="p">,</span> <span class="n">match_dist</span><span class="p">,</span> <span class="n">norm_fx1</span><span class="p">,</span> <span class="n">norm_dist</span> <span class="o">=</span> <span class="n">assigntup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">assigntup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">77</span><span class="p">,</span>   <span class="mi">971</span><span class="p">,</span> <span class="mi">22</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">116</span><span class="p">,</span>   <span class="mi">120</span><span class="p">,</span> <span class="mi">34</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">122</span><span class="p">,</span>   <span class="mi">128</span><span class="p">,</span> <span class="mi">99</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">1075</span><span class="p">,</span>  <span class="mi">692</span><span class="p">,</span> <span class="mi">102</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">530</span><span class="p">,</span>   <span class="mi">45</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span>  <span class="mi">45</span><span class="p">,</span>  <span class="mi">530</span><span class="p">,</span> <span class="mi">77</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.059</span><span class="p">,</span>  <span class="mf">0.238</span><span class="p">,</span> <span class="o">.</span><span class="mi">3</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.021</span><span class="p">,</span>  <span class="mf">0.240</span><span class="p">,</span> <span class="o">.</span><span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.039</span><span class="p">,</span>  <span class="mf">0.247</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.149</span><span class="p">,</span>  <span class="mf">0.151</span><span class="p">,</span> <span class="o">.</span><span class="mi">6</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.226</span><span class="p">,</span>  <span class="mf">0.244</span><span class="p">,</span> <span class="o">.</span><span class="mi">7</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.215</span><span class="p">,</span>  <span class="mf">0.236</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Knorm</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flags</span> <span class="o">=</span> <span class="n">fx2_to_flags</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">K</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assigntup</span> <span class="o">=</span> <span class="n">assign_unconstrained_matches</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx2_to_dist</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                         <span class="n">Knorm</span><span class="p">,</span> <span class="n">fx2_to_flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="p">,</span> <span class="n">match_dist</span><span class="p">,</span> <span class="n">norm_fx1</span><span class="p">,</span> <span class="n">norm_dist</span> <span class="o">=</span> <span class="n">assigntup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">assigntup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">fm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">ub</span><span class="o">.</span><span class="n">allsame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">assigntup</span><span class="p">)))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.asymmetric_correspondence">
<code class="descclassname">vtool.matching.</code><code class="descname">asymmetric_correspondence</code><span class="sig-paren">(</span><em>annot1</em>, <em>annot2</em>, <em>K</em>, <em>Knorm</em>, <em>checks</em>, <em>allow_shrink=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#asymmetric_correspondence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.asymmetric_correspondence" title="Permalink to this definition">¶</a></dt>
<dd><p>Find symmetric feature corresopndences</p>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.csum">
<code class="descclassname">vtool.matching.</code><code class="descname">csum</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#csum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.csum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.matching.demodata_match">
<code class="descclassname">vtool.matching.</code><code class="descname">demodata_match</code><span class="sig-paren">(</span><em>cfgdict={}</em>, <em>apply=True</em>, <em>use_cache=True</em>, <em>recompute=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#demodata_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.demodata_match" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.matching.empty_assign">
<code class="descclassname">vtool.matching.</code><code class="descname">empty_assign</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#empty_assign"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.empty_assign" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.matching.empty_neighbors">
<code class="descclassname">vtool.matching.</code><code class="descname">empty_neighbors</code><span class="sig-paren">(</span><em>num_vecs=0</em>, <em>K=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#empty_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.empty_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.matching.ensure_metadata_dlen_sqrd">
<code class="descclassname">vtool.matching.</code><code class="descname">ensure_metadata_dlen_sqrd</code><span class="sig-paren">(</span><em>annot</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_dlen_sqrd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.ensure_metadata_dlen_sqrd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.matching.ensure_metadata_feats">
<code class="descclassname">vtool.matching.</code><code class="descname">ensure_metadata_feats</code><span class="sig-paren">(</span><em>annot</em>, <em>cfgdict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_feats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.ensure_metadata_feats" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds feature evaluation keys to a lazy dictionary</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>annot</strong> (<em>utool.LazyDict</em>) – </li>
<li><strong>suffix</strong> (<em>str</em>) – (default = ‘’)</li>
<li><strong>cfgdict</strong> (<em>dict</em>) – (default = {})</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.matching –exec-ensure_metadata_feats</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">LazyDict</span><span class="p">({</span><span class="s1">&#39;rchip_fpath&#39;</span><span class="p">:</span> <span class="n">rchip_fpath</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_metadata_feats</span><span class="p">(</span><span class="n">annot</span><span class="p">,</span> <span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">annot</span><span class="o">.</span><span class="n">_stored_results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span><span class="p">[</span><span class="s1">&#39;kpts&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">annot</span><span class="o">.</span><span class="n">_stored_results</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span><span class="p">[</span><span class="s1">&#39;vecs&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">annot</span><span class="o">.</span><span class="n">_stored_results</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.ensure_metadata_flann">
<code class="descclassname">vtool.matching.</code><code class="descname">ensure_metadata_flann</code><span class="sig-paren">(</span><em>annot</em>, <em>cfgdict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_flann"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.ensure_metadata_flann" title="Permalink to this definition">¶</a></dt>
<dd><p>setup lazy flann evaluation</p>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.ensure_metadata_normxy">
<code class="descclassname">vtool.matching.</code><code class="descname">ensure_metadata_normxy</code><span class="sig-paren">(</span><em>annot</em>, <em>cfgdict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_normxy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.ensure_metadata_normxy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.matching.ensure_metadata_vsone">
<code class="descclassname">vtool.matching.</code><code class="descname">ensure_metadata_vsone</code><span class="sig-paren">(</span><em>annot1</em>, <em>annot2</em>, <em>cfgdict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_vsone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.ensure_metadata_vsone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.matching.flag_sym_slow">
<code class="descclassname">vtool.matching.</code><code class="descname">flag_sym_slow</code><span class="sig-paren">(</span><em>fx1_to_fx2</em>, <em>fx2_to_fx1</em>, <em>K</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#flag_sym_slow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.flag_sym_slow" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns flags indicating if the matches in fx1_to_fx2 are reciprocal
with the matches in fx2_to_fx1.</p>
<p>Much slower version of flag_symmetric_matches, but more clear</p>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.flag_symmetric_matches">
<code class="descclassname">vtool.matching.</code><code class="descname">flag_symmetric_matches</code><span class="sig-paren">(</span><em>fx2_to_fx1</em>, <em>fx1_to_fx2</em>, <em>K=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#flag_symmetric_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.flag_symmetric_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns flags indicating if the matches in fx2_to_fx1 are reciprocal
with the matches in fx1_to_fx2.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span> <span class="c1"># 0</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span> <span class="c1"># 1</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span> <span class="c1"># 2</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span> <span class="c1"># 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx1_to_fx2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># 0</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># 1</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># 2</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># 3</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span> <span class="c1"># 4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flagsA</span> <span class="o">=</span> <span class="n">flag_symmetric_matches</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx1_to_fx2</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flagsB</span> <span class="o">=</span> <span class="n">flag_sym_slow</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx1_to_fx2</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">fx2_to_flagsA</span> <span class="o">==</span> <span class="n">fx2_to_flagsB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fx2_to_flagsB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.invsum">
<code class="descclassname">vtool.matching.</code><code class="descname">invsum</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#invsum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.invsum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.matching.normalized_nearest_neighbors">
<code class="descclassname">vtool.matching.</code><code class="descname">normalized_nearest_neighbors</code><span class="sig-paren">(</span><em>flann1</em>, <em>vecs2</em>, <em>K</em>, <em>checks=800</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#normalized_nearest_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.normalized_nearest_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes matches from vecs2 to flann1.</p>
<p>uses flann index to return nearest neighbors with distances normalized
between 0 and 1 using sifts uint8 trick</p>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.symmetric_correspondence">
<code class="descclassname">vtool.matching.</code><code class="descname">symmetric_correspondence</code><span class="sig-paren">(</span><em>annot1</em>, <em>annot2</em>, <em>K</em>, <em>Knorm</em>, <em>checks</em>, <em>allow_shrink=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#symmetric_correspondence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.symmetric_correspondence" title="Permalink to this definition">¶</a></dt>
<dd><p>Find symmetric feature corresopndences</p>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.testdata_annot_metadata">
<code class="descclassname">vtool.matching.</code><code class="descname">testdata_annot_metadata</code><span class="sig-paren">(</span><em>rchip_fpath</em>, <em>cfgdict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#testdata_annot_metadata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.testdata_annot_metadata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.nearest_neighbors">
<span id="vtool-nearest-neighbors-module"></span><h2>vtool.nearest_neighbors module<a class="headerlink" href="#module-vtool.nearest_neighbors" title="Permalink to this headline">¶</a></h2>
<p>Wrapper around flann (with caching)</p>
<p>python -c “import vtool, doctest; print(doctest.testmod(vtool.nearest_neighbors))”</p>
<dl class="class">
<dt id="vtool.nearest_neighbors.AnnoyWrapper">
<em class="property">class </em><code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">AnnoyWrapper</code><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#AnnoyWrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.AnnoyWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Wrapper for annoy to use the FLANN api</p>
<dl class="method">
<dt id="vtool.nearest_neighbors.AnnoyWrapper.build_index">
<code class="descname">build_index</code><span class="sig-paren">(</span><em>dvecs</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#AnnoyWrapper.build_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.AnnoyWrapper.build_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.nearest_neighbors.AnnoyWrapper.nn_index">
<code class="descname">nn_index</code><span class="sig-paren">(</span><em>qvecs</em>, <em>num_neighbs</em>, <em>checks=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#AnnoyWrapper.nn_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.AnnoyWrapper.nn_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.ann_flann_once">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">ann_flann_once</code><span class="sig-paren">(</span><em>dpts</em>, <em>qpts</em>, <em>num_neighbors</em>, <em>flann_params={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#ann_flann_once"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.ann_flann_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the approximate nearest neighbors of qpts in dpts</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/nearest_neighbors.py ann_flann_once:0</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qx2_dx</span><span class="p">,</span> <span class="n">qx2_dist</span> <span class="o">=</span> <span class="n">ann_flann_once</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">qpts</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">qx2_dx</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">qx2_dist</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">    np.array([[3, 3, 3, 3, 0],</span>
<span class="go">              [2, 0, 1, 4, 4]], dtype=np.int32),</span>
<span class="go">    np.array([[1037329., 1235876., 1168550., 1286435., 1075507.],</span>
<span class="go">              [1038324., 1243690., 1304896., 1320598., 1369036.]], dtype=np.float32),</span>
<span class="go">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Test upper bounds on sift descriptors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># SeeAlso distance.understanding_pseudomax_props</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># get points on unit sphere</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nDpts</span> <span class="o">=</span> <span class="mi">5000</span> <span class="c1"># 5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nQpts</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c1"># 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">normalize_rows</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nDpts</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">normalize_rows</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nQpts</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">qpts</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">qmag</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="s1">&#39;not on unit sphere&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dmag</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="s1">&#39;not on unit sphere&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># cast to uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uint8_max</span> <span class="o">=</span> <span class="mi">512</span>  <span class="c1"># hack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uint8_min</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># hack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># 2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">qpts8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">qpts</span> <span class="o">*</span> <span class="n">uint8_max</span><span class="p">),</span> <span class="n">uint8_min</span><span class="p">,</span> <span class="n">uint8_max</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">dpts</span> <span class="o">*</span> <span class="n">uint8_max</span><span class="p">),</span> <span class="n">uint8_min</span><span class="p">,</span> <span class="n">uint8_max</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmag8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">qpts8</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmag8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">dpts8</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qx2_dx</span><span class="p">,</span> <span class="n">qx2_dist</span> <span class="o">=</span> <span class="n">ann_flann_once</span><span class="p">(</span><span class="n">dpts8</span><span class="p">,</span> <span class="n">qpts8</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">biggest_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">qx2_dist</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;biggest_dist = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">biggest_dist</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get actual distance by hand</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hand_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">qpts8</span> <span class="o">-</span> <span class="n">dpts8</span><span class="p">[</span><span class="n">qx2_dx</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Seems like flann returns squared distance. makes sense</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="nb">repr</span><span class="p">((</span><span class="n">qx2_dx</span><span class="p">,</span> <span class="n">qx2_dist</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl class="last docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Build theoretically maximally distant vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="mi">512</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">D</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span> <span class="o">*</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">512</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">qpts</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">dpts</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># FIX TO ACTUALLY BE AT THE RIGHT NORM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="p">(</span><span class="n">dpts</span> <span class="o">*</span> <span class="p">(</span><span class="mi">512</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[:,</span> <span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="p">(</span><span class="n">qpts</span> <span class="o">*</span> <span class="p">(</span><span class="mi">512</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">qpts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[:,</span> <span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">qpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">qpts</span> <span class="o">-</span> <span class="n">dpts</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Because of norm condition another maximally disant pair of vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># is [1, 0, 0, ... 0] and [0, 1, .. 0, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verifythat this gives you same dist.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">512</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">512</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.assign_to_centroids">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">assign_to_centroids</code><span class="sig-paren">(</span><em>dpts</em>, <em>qpts</em>, <em>num_neighbors=1</em>, <em>flann_params={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#assign_to_centroids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.assign_to_centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper for akmeans</p>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.flann_augment">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">flann_augment</code><span class="sig-paren">(</span><em>dpts</em>, <em>new_dpts</em>, <em>cache_dir</em>, <em>cfgstr</em>, <em>new_cfgstr</em>, <em>flann_params</em>, <em>use_cache=True</em>, <em>save=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#flann_augment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.flann_augment" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_dpts</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_nth_prime</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_dpts</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_dpts</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_nth_prime</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_app_resource_dir</span><span class="p">(</span><span class="s1">&#39;vtool&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgstr</span> <span class="o">=</span> <span class="s1">&#39;_testcfg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_cfgstr</span> <span class="o">=</span> <span class="s1">&#39;_new_testcfg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="n">get_kdtree_flann_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.flann_cache">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">flann_cache</code><span class="sig-paren">(</span><em>dpts</em>, <em>cache_dir='default'</em>, <em>cfgstr=''</em>, <em>flann_params={}</em>, <em>use_cache=True</em>, <em>save=True</em>, <em>use_params_hash=True</em>, <em>use_data_hash=True</em>, <em>appname='vtool'</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#flann_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.flann_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to load a cached flann index before doing anything
from vtool.nn</p>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.flann_index_time_experiment">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">flann_index_time_experiment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#flann_index_time_experiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.flann_index_time_experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows a plot of how long it takes to build a flann index for a given number of KD-trees</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.nearest_neighbors –test-flann_index_time_experiment</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">flann_index_time_experiment</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.get_flann_cfgstr">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">get_flann_cfgstr</code><span class="sig-paren">(</span><em>dpts</em>, <em>flann_params</em>, <em>cfgstr=''</em>, <em>use_params_hash=True</em>, <em>use_data_hash=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_flann_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.nearest_neighbors –test-get_flann_cfgstr</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgstr</span> <span class="o">=</span> <span class="s1">&#39;_FEAT(alg=heshes)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="n">get_kdtree_flann_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_flann_cfgstr</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">flann_params</span><span class="p">,</span> <span class="n">cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">_FEAT(alg=heshes)_FLANN(4kdtree)_DPTS((10,128)xxaotseonmfjkzcr)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.get_flann_fpath">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">get_flann_fpath</code><span class="sig-paren">(</span><em>dpts</em>, <em>cache_dir='default'</em>, <em>cfgstr=''</em>, <em>flann_params={}</em>, <em>use_params_hash=True</em>, <em>use_data_hash=True</em>, <em>appname='vtool'</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_flann_fpath" title="Permalink to this definition">¶</a></dt>
<dd><p>returns filepath for flann index</p>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.get_flann_params">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">get_flann_params</code><span class="sig-paren">(</span><em>algorithm='kdtree'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_flann_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns flann params that are relvant tothe algorithm</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf">http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>algorithm</strong> (<em>str</em>) – (default = ‘kdtree’)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">flann_params</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.nearest_neighbors –test-get_flann_params –algo=kdtree
python -m vtool.nearest_neighbors –test-get_flann_params –algo=kmeans</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">algorithm</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--algo&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;kdtree&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="n">get_flann_params</span><span class="p">(</span><span class="n">algorithm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;flann_params = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flann_params</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.get_flann_params_cfgstr">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">get_flann_params_cfgstr</code><span class="sig-paren">(</span><em>flann_params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_params_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_flann_params_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.get_kdtree_flann_params">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">get_kdtree_flann_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_kdtree_flann_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_kdtree_flann_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.invertible_stack">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">invertible_stack</code><span class="sig-paren">(</span><em>vecs_list</em>, <em>label_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#invertible_stack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.invertible_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Stacks descriptors into a flat structure and returns inverse mapping from
flat database descriptor indexes (dx) to annotation ids (label) and feature
indexes (fx). Feature indexes are w.r.t. annotation indexes.</p>
<dl class="docutils">
<dt>Output:</dt>
<dd>idx2_desc - flat descriptor stack
idx2_label  - inverted index into annotations
idx2_fx   - inverted index into features</dd>
</dl>
<p># Example with 2D Descriptors</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DESC_TYPE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label_list</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_vec</span><span class="p">,</span> <span class="n">idx2_label</span><span class="p">,</span> <span class="n">idx2_fx</span> <span class="o">=</span> <span class="n">invertible_stack</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">,</span> <span class="n">label_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">idx2_vec</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
<span class="go">array([[ 0,  0,  5,  2,  1,  5,  2,  1,  3, 42,  2],</span>
<span class="go">       [ 0,  1,  3, 30,  1,  3, 30,  1,  3, 42,  6]], dtype=uint8)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">idx2_label</span><span class="p">))</span>
<span class="go">array([1, 1, 2, 2, 2, 4, 4, 4, 5, 5, 5])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">idx2_fx</span><span class="p">))</span>
<span class="go">array([0, 1, 0, 1, 2, 0, 1, 2, 0, 1, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.test_annoy">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">test_annoy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#test_annoy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.test_annoy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.test_cv2_flann">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">test_cv2_flann</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#test_cv2_flann"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.test_cv2_flann" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Ignore:</dt>
<dd><p class="first">[name for name in dir(cv2) if ‘create’ in name.lower()]
[name for name in dir(cv2) if ‘stereo’ in name.lower()]</p>
<p class="last">ut.grab_zipped_url(‘<a class="reference external" href="https://priithon.googlecode.com/archive/a6117f5e81ec00abcfb037f0f9da2937bb2ea47f.tar.gz">https://priithon.googlecode.com/archive/a6117f5e81ec00abcfb037f0f9da2937bb2ea47f.tar.gz</a>’, download_dir=’.’)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.tune_flann">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">tune_flann</code><span class="sig-paren">(</span><em>dpts</em>, <em>target_precision=0.9</em>, <em>build_weight=0.5</em>, <em>memory_weight=0.0</em>, <em>sample_fraction=0.01</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#tune_flann"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.tune_flann" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_pami2014.pdf">http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_pami2014.pdf</a>
<a class="reference external" href="http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf">http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf</a>
<a class="reference external" href="http://docs.opencv.org/trunk/modules/flann/doc/flann_fast_approximate_nearest_neighbor_search.html">http://docs.opencv.org/trunk/modules/flann/doc/flann_fast_approximate_nearest_neighbor_search.html</a></p>
<dl class="docutils">
<dt>Math::</dt>
<dd><p class="first">cost of an algorithm is:</p>
<dl class="last docutils">
<dt>LaTeX:</dt>
<dd><dl class="first last docutils">
<dt>cost = frac</dt>
<dd>{search + build_weight * build }
{ minoverparams( search + build_weight build)} +
memory_weight * memory</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dpts</strong> (<em>ndarray</em>) – </li>
<li><strong>target_precision</strong> (<em>float</em>) – number between 0 and 1 representing desired
accuracy. Higher values are more accurate.</li>
<li><strong>build_weight</strong> (<em>float</em>) – importance weight given to minimizing build time
relative to search time. This number can range from 0 to infinity.
typically because building is a more complex computation you want
to keep the number relatively low, (less than 1) otherwise you’ll
end up getting a linear search (no build time).</li>
<li><strong>memory_weight</strong> (<em>float</em>) – Importance of memory relative to total speed.
A value less than 1 gives more importance to the time spent and a
value greater than 1 gives more importance to the memory usage.</li>
<li><strong>sample_fraction</strong> (<em>float</em>) – number between 0 and 1 representing the
fraction of the input data to use in the optimization. A higher
number uses more data.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">tuned_params</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.nearest_neighbors –test-tune_flann</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-vtool.numpy_utils">
<span id="vtool-numpy-utils-module"></span><h2>vtool.numpy_utils module<a class="headerlink" href="#module-vtool.numpy_utils" title="Permalink to this headline">¶</a></h2>
<p>These functions might be PR quality for numpy.</p>
<dl class="function">
<dt id="vtool.numpy_utils.atleast_nd">
<code class="descclassname">vtool.numpy_utils.</code><code class="descname">atleast_nd</code><span class="sig-paren">(</span><em>arr</em>, <em>n</em>, <em>tofront=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#atleast_nd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.numpy_utils.atleast_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>View inputs as arrays with at least n dimensions.
TODO: Submit as a PR to numpy</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arr</strong> (<em>array_like</em>) – One array-like object.  Non-array inputs are
converted to arrays.  Arrays that already have n or more
dimensions are preserved.</li>
<li><strong>n</strong> (<em>int</em>) – number of dimensions to ensure</li>
<li><strong>tofront</strong> (<em>bool</em>) – if True new dimensions are added to the front of the
array.  otherwise they are added to the back.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.numpy_utils atleast_nd</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">An array with <code class="docutils literal notranslate"><span class="pre">a.ndim</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>.  Copies are avoided where possible,
and views with three or more dimensions are returned.  For example,
a 1-D array of shape <code class="docutils literal notranslate"><span class="pre">(N,)</span></code> becomes a view of shape
<code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">N,</span> <span class="pre">1)</span></code>, and a 2-D array of shape <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">N)</span></code> becomes a view
of shape <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">N,</span> <span class="pre">1)</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">ensure_shape, np.atleast_1d, np.atleast_2d, np.atleast_3d</p>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[[[</span><span class="mi">1</span><span class="p">]]]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr1_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr2_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result3</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr3_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">,</span> <span class="n">result3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.numpy_utils.ensure_shape">
<code class="descclassname">vtool.numpy_utils.</code><code class="descname">ensure_shape</code><span class="sig-paren">(</span><em>arr</em>, <em>dimshape</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#ensure_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.numpy_utils.ensure_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: Submit as a PR to numpy?</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.numpy_utils.fromiter_nd">
<code class="descclassname">vtool.numpy_utils.</code><code class="descname">fromiter_nd</code><span class="sig-paren">(</span><em>iter_</em>, <em>shape</em>, <em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#fromiter_nd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.numpy_utils.fromiter_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Like np.fromiter but handles iterators that generated
n-dimensional arrays. Slightly faster than np.array.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">np.vstack(<a href="#id79"><span class="problematic" id="id80">list_</span></a>) is still faster than
vt.fromiter_nd(ut.iflatten(<a href="#id81"><span class="problematic" id="id82">list_</span></a>))</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>iter</strong> (<em>iter</em>) – an iterable that generates homogenous ndarrays</li>
<li><strong>shape</strong> (<em>tuple</em>) – the expected output shape</li>
<li><strong>dtype</strong> (<em>dtype</em>) – the numpy datatype of the generated ndarrays</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The iterable must yeild a numpy array. It cannot yeild a Python list.</p>
</div>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.numpy_utils fromiter_nd</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total</span> <span class="o">=</span> <span class="mi">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">fromiter_nd</span><span class="p">(</span><span class="n">iter_</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">shape</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dfxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">qfxs</span><span class="p">,</span> <span class="n">dfxs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qfxs</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">fromiter_nd</span><span class="p">(</span><span class="n">iter_</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">shape</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Timeit:</dt>
<dd><div class="first highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat_dim</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mi">500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_data</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_feat_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_data</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">+</span> <span class="n">mu</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Make a large list of vectors of various sizes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Making random vectors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">feat_dim</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">n_feat_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mega_bytes</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">nbytes</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vecs_list</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mega_bytes = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mega_bytes</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">itertools</span> <span class="k">as</span> <span class="nn">it</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_total</span> <span class="o">=</span> <span class="n">n_feat_list</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_total</span><span class="p">,</span> <span class="n">feat_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">fromiter_nd</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">),</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">target1</span> <span class="o">==</span> <span class="n">target2</span><span class="p">)</span>
</pre></div>
</div>
<p>%timeit np.vstack(vecs_list)
20.4ms
%timeit vt.fromiter_nd(it.chain.from_iterable(vecs_list), shape, dtype)
102ms</p>
<p class="last"><a href="#id83"><span class="problematic" id="id84">iter_</span></a> = it.chain.from_iterable(vecs_list)
%time vt.fromiter_nd(<a href="#id85"><span class="problematic" id="id86">iter_</span></a>, shape, dtype)
%time np.vstack(vecs_list)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.numpy_utils.index_to_boolmask">
<code class="descclassname">vtool.numpy_utils.</code><code class="descname">index_to_boolmask</code><span class="sig-paren">(</span><em>index_list</em>, <em>maxval=None</em>, <em>isflat=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#index_to_boolmask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.numpy_utils.index_to_boolmask" title="Permalink to this definition">¶</a></dt>
<dd><p>transforms a list of indicies into a boolean mask</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>index_list</strong> (<em>ndarray</em>) – </li>
<li><strong>maxval</strong> (<em>None</em>) – (default = None)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd>maxval</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mask</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_numpy index_to_boolmask</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_numpy</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxval</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">index_to_boolmask</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="n">maxval</span><span class="p">,</span> <span class="n">isflat</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mask =</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[1 0 0]</span>
<span class="go"> [0 1 0]</span>
<span class="go"> [0 1 0]]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_numpy</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxval</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">index_to_boolmask</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="n">maxval</span><span class="p">,</span> <span class="n">isflat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mask = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">mask = [1 1 0 0 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.numpy_utils.iter_reduce_ufunc">
<code class="descclassname">vtool.numpy_utils.</code><code class="descname">iter_reduce_ufunc</code><span class="sig-paren">(</span><em>ufunc</em>, <em>arr_iter</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#iter_reduce_ufunc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.numpy_utils.iter_reduce_ufunc" title="Permalink to this definition">¶</a></dt>
<dd><p>constant memory iteration and reduction</p>
<p>applys ufunc from left to right over the input arrays</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">memory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen_memory</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">arr_gen</span><span class="p">(</span><span class="n">arr_list</span><span class="p">,</span> <span class="n">gen_memory</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arr_list</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">gen_memory</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">arr</span>
<span class="gp">... </span>        <span class="k">yield</span> <span class="n">gen_memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gen_memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gen_memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ufunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res1</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">arr_list</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res2</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">arr_list</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res3</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">arr_gen</span><span class="p">(</span><span class="n">arr_list</span><span class="p">,</span> <span class="n">gen_memory</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res1       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res1</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res2       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res2</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res3       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;memory     = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gen_memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gen_memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">res1</span> <span class="o">==</span> <span class="n">res2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">res2</span> <span class="o">==</span> <span class="n">res3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.numpy_utils.multiaxis_reduce">
<code class="descclassname">vtool.numpy_utils.</code><code class="descname">multiaxis_reduce</code><span class="sig-paren">(</span><em>ufunc</em>, <em>arr</em>, <em>startaxis=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#multiaxis_reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.numpy_utils.multiaxis_reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>used to get max/min over all axes after &lt;startaxis&gt;</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.numpy_utils –test-multiaxis_reduce</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ufunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">startaxis</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_</span> <span class="o">=</span> <span class="n">multiaxis_reduce</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">startaxis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">out_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[182 245 236 249]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.numpy_utils.unique_row_indexes">
<code class="descclassname">vtool.numpy_utils.</code><code class="descname">unique_row_indexes</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#unique_row_indexes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.numpy_utils.unique_row_indexes" title="Permalink to this definition">¶</a></dt>
<dd><p>np.unique on rows</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arr</strong> (<em>ndarray</em>) – 2d array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">unique_rowx</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array">http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.numpy_utils –test-unique_row_indexes</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">534</span><span class="p">,</span> <span class="o">.</span><span class="mi">432</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">534</span><span class="p">,</span> <span class="o">.</span><span class="mi">432</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_rowx</span> <span class="o">=</span> <span class="n">unique_row_indexes</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;unique_rowx = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">unique_rowx</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">unique_rowx = np.array([0, 1, 2, 3, 5], dtype=np.int64)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd>%timeit unique_row_indexes(arr)
%timeit compute_unique_data_ids(arr)
%timeit compute_unique_integer_data_ids(arr)</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-vtool.other">
<span id="vtool-other-module"></span><h2>vtool.other module<a class="headerlink" href="#module-vtool.other" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.other.and_lists">
<code class="descclassname">vtool.other.</code><code class="descname">and_lists</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#and_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.and_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Like np.logical_and, but can take more than 2 arguments</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-and_lists</dd>
<dt>SeeAlso:</dt>
<dd>or_lists</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">and_lists</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[False  True False  True]</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg3</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">and_lists</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ensure equal division</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">flags</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">endx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">segments</span> <span class="o">*</span> <span class="p">(</span><span class="n">validx</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="p">(</span><span class="n">segments</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">validx</span><span class="p">[:</span><span class="n">endx</span><span class="p">],</span> <span class="n">segments</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">parts</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[243734, 714397, 1204989, 1729375, 2235191]</span>
</pre></div>
</div>
</dd>
</dl>
<p>%timeit reduce(np.logical_and, args)
%timeit np.logical_and.reduce(args)  # wins with more data</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.argsort_groups">
<code class="descclassname">vtool.other.</code><code class="descname">argsort_groups</code><span class="sig-paren">(</span><em>scores_list</em>, <em>reverse=False</em>, <em>rng=&lt;module 'numpy.random' from '/Users/jason.parham/virtualenv/wildme3/lib/python3.6/site-packages/numpy/random/__init__.py'&gt;</em>, <em>randomize_levels=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#argsort_groups"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.argsort_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Sorts each group normally, but randomizes order of level values.</p>
<p>TODO: move to vtool</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>scores_list</strong> (<em>list</em>) – </li>
<li><strong>reverse</strong> (<em>bool</em>) – (default = True)</li>
<li><strong>rng</strong> (<em>module</em>) – random number generator(default = numpy.random)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m wbia.init.filter_annots –exec-argsort_groups</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idxs_list</span> <span class="o">=</span> <span class="n">argsort_groups</span><span class="p">(</span><span class="n">scores_list</span><span class="p">,</span> <span class="n">reverse</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;idxs_list = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr4</span><span class="p">(</span><span class="n">idxs_list</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.argsort_records">
<code class="descclassname">vtool.other.</code><code class="descname">argsort_records</code><span class="sig-paren">(</span><em>arrays</em>, <em>reverse=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#argsort_records"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.argsort_records" title="Permalink to this definition">¶</a></dt>
<dd><p>Sorts arrays that form records.
Same as lexsort(arrays[::-1]) — ie. rows are reversed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arrays</strong> (<em>ndarray</em>) – array of records</li>
<li><strong>reverse</strong> (<em>bool</em>) – (default = False)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">sortx - sorted indicies</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –exec-argsort_records</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrays</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">],)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sortx</span> <span class="o">=</span> <span class="n">argsort_records</span><span class="p">(</span><span class="n">arrays</span><span class="p">,</span> <span class="n">reverse</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;sortx = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sortx</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lxsrt = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span><span class="n">arrays</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">sortx = [1 2 0 5 4 3 6 7 8]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.assert_zipcompress">
<code class="descclassname">vtool.other.</code><code class="descname">assert_zipcompress</code><span class="sig-paren">(</span><em>arr_list</em>, <em>flags_list</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#assert_zipcompress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.assert_zipcompress" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.asserteq">
<code class="descclassname">vtool.other.</code><code class="descname">asserteq</code><span class="sig-paren">(</span><em>output1</em>, <em>output2</em>, <em>thresh=1e-08</em>, <em>nestpath=None</em>, <em>level=0</em>, <em>lbl1=None</em>, <em>lbl2=None</em>, <em>output_lbl=None</em>, <em>verbose=True</em>, <em>iswarning=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#asserteq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.asserteq" title="Permalink to this definition">¶</a></dt>
<dd><p>recursive equality checks</p>
<p>asserts that output1 and output2 are close to equal.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.atleast_3channels">
<code class="descclassname">vtool.other.</code><code class="descname">atleast_3channels</code><span class="sig-paren">(</span><em>arr</em>, <em>copy=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#atleast_3channels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.atleast_3channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures that there are 3 channels in the image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr</strong> (<em>ndarray</em><em>[</em><em>N</em><em>, </em><em>M</em><em>, </em><em>..</em><em>]</em>) – the image</li>
<li><strong>copy</strong> (<em>bool</em>) – Always copies if True, if False, then copies only when the
size of the array must change.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">with shape (N, M, C), where C in {3, 4}</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other atleast_3channels</dd>
<dt>Doctest:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_3channels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_3channels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_3channels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_3channels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.atleast_nd">
<code class="descclassname">vtool.other.</code><code class="descname">atleast_nd</code><span class="sig-paren">(</span><em>arr</em>, <em>n</em>, <em>tofront=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#atleast_nd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.atleast_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>View inputs as arrays with at least n dimensions.
TODO: Commit to numpy</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arr</strong> (<em>array_like</em>) – One array-like object.  Non-array inputs are
converted to arrays.  Arrays that already have n or more dimensions
are preserved.</li>
<li><strong>n</strong> (<em>int</em>) – </li>
<li><strong>tofront</strong> (<em>bool</em>) – if True new dims are added to the front of the array</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –exec-atleast_nd –show</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">An array with <code class="docutils literal notranslate"><span class="pre">a.ndim</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>.  Copies are avoided where possible,
and views with three or more dimensions are returned.  For example,
a 1-D array of shape <code class="docutils literal notranslate"><span class="pre">(N,)</span></code> becomes a view of shape
<code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">N,</span> <span class="pre">1)</span></code>, and a 2-D array of shape <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">N)</span></code> becomes a view of shape
<code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">N,</span> <span class="pre">1)</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">atleast_1d, atleast_2d, atleast_3d</p>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[[[</span><span class="mi">1</span><span class="p">]]]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr1_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr2_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result3</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr3_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">,</span> <span class="n">result3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.atleast_shape">
<code class="descclassname">vtool.other.</code><code class="descname">atleast_shape</code><span class="sig-paren">(</span><em>arr</em>, <em>dimshape</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#atleast_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.atleast_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures that an array takes a certain shape. The total size of the array
must not change.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr</strong> (<em>ndarray</em>) – array to change the shape of</li>
<li><strong>dimshape</strong> (<em>tuple</em>) – desired shape (Nones can be used to broadcast
dimensions)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a href="#id87"><span class="problematic" id="id88">arr_</span></a> -  the input array, which has been modified inplace.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other ensure_shape</dd>
<dt>Doctest:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(()),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(()),</span> <span class="nb">tuple</span><span class="p">())</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(()),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">atleast_shape</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">atleast_shape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.calc_error_bars_from_sample">
<code class="descclassname">vtool.other.</code><code class="descname">calc_error_bars_from_sample</code><span class="sig-paren">(</span><em>sample_size</em>, <em>num_positive</em>, <em>pop</em>, <em>conf_level=0.95</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#calc_error_bars_from_sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.calc_error_bars_from_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines a error bars of sample</p>
<p class="rubric">References</p>
<p><a class="reference external" href="https://www.qualtrics.com/blog/determining-sample-size/">https://www.qualtrics.com/blog/determining-sample-size/</a>
<a class="reference external" href="http://www.surveysystem.com/sscalc.htm">http://www.surveysystem.com/sscalc.htm</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Sample_size_determination">https://en.wikipedia.org/wiki/Sample_size_determination</a>
<a class="reference external" href="http://www.surveysystem.com/sample-size-formula.htm">http://www.surveysystem.com/sample-size-formula.htm</a>
<a class="reference external" href="http://courses.wcupa.edu/rbove/Berenson/10th%20ed%20CD-ROM%20topics/section8_7.pdf">http://courses.wcupa.edu/rbove/Berenson/10th%20ed%20CD-ROM%20topics/section8_7.pdf</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Standard_normal_table">https://en.wikipedia.org/wiki/Standard_normal_table</a>
<a class="reference external" href="https://www.unc.edu/~rls/s151-2010/class23.pdf">https://www.unc.edu/~rls/s151-2010/class23.pdf</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.calc_sample_from_error_bars">
<code class="descclassname">vtool.other.</code><code class="descname">calc_sample_from_error_bars</code><span class="sig-paren">(</span><em>err_frac</em>, <em>pop</em>, <em>conf_level=0.95</em>, <em>prior=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#calc_sample_from_error_bars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.calc_sample_from_error_bars" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines a reasonable sample size to achieve desired error bars.</p>
<p>import sympy
p, n, N, z = sympy.symbols(‘prior, ss, pop, zval’)
me = sympy.symbols(‘err_frac’)
expr = (z * sympy.sqrt((p * (1 - p) / n) * ((N - n) / (N - 1))))
equation = sympy.Eq(me, expr)
nexpr = sympy.solve(equation, [n])[0]
nexpr = sympy.simplify(nexpr)</p>
<p>import autopep8
print(autopep8.fix_lines([‘ss = ‘ + str(nexpr)], autopep8._get_options({}, False)))</p>
<p>ss = -pop * prior* (zval**2) <em>(prior - 1) / ((err_frac *</em> 2) * pop - (err_frac**2) - prior * (zval**2) * (prior - 1))
ss = pop * prior * zval ** 2 * (prior - 1) / (-err_frac ** 2 * pop + err_frac ** 2 + prior * zval ** 2 * (prior - 1))</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.check_sift_validity">
<code class="descclassname">vtool.other.</code><code class="descname">check_sift_validity</code><span class="sig-paren">(</span><em>sift_uint8</em>, <em>lbl=None</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#check_sift_validity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.check_sift_validity" title="Permalink to this definition">¶</a></dt>
<dd><p>checks if a SIFT descriptor is valid</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.clipnorm">
<code class="descclassname">vtool.other.</code><code class="descname">clipnorm</code><span class="sig-paren">(</span><em>arr</em>, <em>min_</em>, <em>max_</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#clipnorm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.clipnorm" title="Permalink to this definition">¶</a></dt>
<dd><p>normalizes arr to the range 0 to 1 using <a href="#id89"><span class="problematic" id="id90">min_</span></a> and <a href="#id91"><span class="problematic" id="id92">max_</span></a> as clipping bounds</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.colwise_operation">
<code class="descclassname">vtool.other.</code><code class="descname">colwise_operation</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em>, <em>op</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#colwise_operation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.colwise_operation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.compare_implementations">
<code class="descclassname">vtool.other.</code><code class="descname">compare_implementations</code><span class="sig-paren">(</span><em>func1</em>, <em>func2</em>, <em>args</em>, <em>show_output=False</em>, <em>lbl1=''</em>, <em>lbl2=''</em>, <em>output_lbl=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compare_implementations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.compare_implementations" title="Permalink to this definition">¶</a></dt>
<dd><p>tests two different implementations of the same function</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.compare_matrix_columns">
<code class="descclassname">vtool.other.</code><code class="descname">compare_matrix_columns</code><span class="sig-paren">(</span><em>matrix</em>, <em>columns</em>, <em>comp_op=&lt;ufunc 'equal'&gt;</em>, <em>logic_op=&lt;ufunc 'logical_or'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compare_matrix_columns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.compare_matrix_columns" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>REPLACE WITH:</dt>
<dd>qfx2_invalid = logic_op.reduce([comp_op([:, None], qfx2_normnid) for col1 in qfx2_topnid.T])</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.compare_matrix_to_rows">
<code class="descclassname">vtool.other.</code><code class="descname">compare_matrix_to_rows</code><span class="sig-paren">(</span><em>row_matrix</em>, <em>row_list</em>, <em>comp_op=&lt;ufunc 'equal'&gt;</em>, <em>logic_op=&lt;ufunc 'logical_or'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compare_matrix_to_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.compare_matrix_to_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares each row in row_list to each row in row matrix using comp_op
Both must have the same number of columns.
Performs logic_op on the results of each individual row</p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>wbia.algo.hots.nn_weights.mark_name_valid_normalizers</dd>
</dl>
<p>compop   = np.equal
logic_op = np.logical_or</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.componentwise_dot">
<code class="descclassname">vtool.other.</code><code class="descname">componentwise_dot</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#componentwise_dot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.componentwise_dot" title="Permalink to this definition">¶</a></dt>
<dd><p>a dot product is a componentwise multiplication of
two vector and then a sum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr1</strong> (<em>ndarray</em>) – </li>
<li><strong>arr2</strong> (<em>ndarray</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">cosangle</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">arr1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">arr1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosangle</span> <span class="o">=</span> <span class="n">componentwise_dot</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cosangle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ 1.  1.  1.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.compress2">
<code class="descclassname">vtool.other.</code><code class="descname">compress2</code><span class="sig-paren">(</span><em>arr</em>, <em>flag_list</em>, <em>axis=None</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compress2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.compress2" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around numpy compress that makes the signature more similar to take</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.compute_ndarray_unique_rowids_unsafe">
<code class="descclassname">vtool.other.</code><code class="descname">compute_ndarray_unique_rowids_unsafe</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_ndarray_unique_rowids_unsafe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.compute_ndarray_unique_rowids_unsafe" title="Permalink to this definition">¶</a></dt>
<dd><p>arr = np.random.randint(2, size=(10000, 10))
vt.compute_unique_data_ids_(list(map(tuple, arr)))
len(vt.compute_unique_data_ids_(list(map(tuple, arr))))
len(np.unique(vt.compute_unique_data_ids_(list(map(tuple, arr)))))</p>
<p>%timeit vt.compute_unique_data_ids_(list(map(tuple, arr)))
%timeit compute_ndarray_unique_rowids_unsafe(arr)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.compute_unique_arr_dataids">
<code class="descclassname">vtool.other.</code><code class="descname">compute_unique_arr_dataids</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_arr_dataids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.compute_unique_arr_dataids" title="Permalink to this definition">¶</a></dt>
<dd><p>specialized version for speed when arr is an ndarray</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.compute_unique_data_ids">
<code class="descclassname">vtool.other.</code><code class="descname">compute_unique_data_ids</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_data_ids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.compute_unique_data_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>This is actually faster than compute_unique_integer_data_ids it seems</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-compute_unique_data_ids</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">534</span><span class="p">,</span> <span class="o">.</span><span class="mi">432</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">534</span><span class="p">,</span> <span class="o">.</span><span class="mi">432</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataid_list</span> <span class="o">=</span> <span class="n">compute_unique_data_ids</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;dataid_list = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">dataid_list</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">dataid_list = np.array([0, 1, 2, 3, 0, 4, 4, 2, 1], dtype=np.int32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.compute_unique_data_ids_">
<code class="descclassname">vtool.other.</code><code class="descname">compute_unique_data_ids_</code><span class="sig-paren">(</span><em>hashable_rows</em>, <em>iddict_=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_data_ids_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.compute_unique_data_ids_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.compute_unique_integer_data_ids">
<code class="descclassname">vtool.other.</code><code class="descname">compute_unique_integer_data_ids</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_integer_data_ids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.compute_unique_integer_data_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>This is actually slower than compute_unique_data_ids it seems</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">compute_unique_data_ids</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">compute_unique_integer_data_ids</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p>%timeit compute_unique_data_ids(data)
%timeit compute_unique_integer_data_ids(data)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.ensure_rng">
<code class="descclassname">vtool.other.</code><code class="descname">ensure_rng</code><span class="sig-paren">(</span><em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#ensure_rng"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.ensure_rng" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a numpy random number generator given a seed.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.ensure_shape">
<code class="descclassname">vtool.other.</code><code class="descname">ensure_shape</code><span class="sig-paren">(</span><em>arr</em>, <em>dimshape</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#ensure_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.ensure_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures that an array takes a certain shape. The total size of the array
must not change.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr</strong> (<em>ndarray</em>) – array to change the shape of</li>
<li><strong>dimshape</strong> (<em>tuple</em>) – desired shape (Nones can be used to broadcast
dimensions)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a href="#id93"><span class="problematic" id="id94">arr_</span></a> -  the input array, which has been modified inplace.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other ensure_shape</dd>
<dt>Doctest:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dimshape</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">ensure_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">arr2</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3</span> <span class="o">=</span> <span class="n">ensure_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">arr3</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.find_best_undirected_edge_indexes">
<code class="descclassname">vtool.other.</code><code class="descname">find_best_undirected_edge_indexes</code><span class="sig-paren">(</span><em>directed_edges</em>, <em>score_arr=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_best_undirected_edge_indexes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.find_best_undirected_edge_indexes" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>directed_edges</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </li>
<li><strong>score_arr</strong> (<em>ndarray</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">unique_edge_xs</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-find_best_undirected_edge_indexes</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">directed_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_edge_xs</span> <span class="o">=</span> <span class="n">find_best_undirected_edge_indexes</span><span class="p">(</span><span class="n">directed_edges</span><span class="p">,</span> <span class="n">score_arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">unique_edge_xs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[0 3 4 6]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">directed_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_arr</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_edge_xs</span> <span class="o">=</span> <span class="n">find_best_undirected_edge_indexes</span><span class="p">(</span><span class="n">directed_edges</span><span class="p">,</span> <span class="n">score_arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">unique_edge_xs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[0 2 3 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.find_elbow_point">
<code class="descclassname">vtool.other.</code><code class="descname">find_elbow_point</code><span class="sig-paren">(</span><em>curve</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_elbow_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.find_elbow_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the on the curve point furthest from the line defined by the
endpoints of the curve.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>curve</strong> (<em>ndarray</em>) – a monotonic curve</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">tradeoff_idx - this is an elbow point in the curve</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/2018178/trade-off-point-on-curve">http://stackoverflow.com/questions/2018178/trade-off-point-on-curve</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other find_elbow_point –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">curve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tradeoff_idx</span> <span class="o">=</span> <span class="n">find_elbow_point</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;tradeoff_idx = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">tradeoff_idx</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">tradeoff_idx</span> <span class="o">==</span> <span class="mi">76</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">tradeoff_idx</span><span class="p">,</span> <span class="n">curve</span><span class="p">[</span><span class="n">tradeoff_idx</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">curve</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">curve</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_point</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">closest_point_on_line_segment</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dist_point</span><span class="p">,</span> <span class="n">point</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">curve</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;curve&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;tradeoff point&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dist_line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;-xb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">segment</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">segment</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;-xb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.find_first_true_indices">
<code class="descclassname">vtool.other.</code><code class="descname">find_first_true_indices</code><span class="sig-paren">(</span><em>flags_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_first_true_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.find_first_true_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: move to vtool</p>
<p>returns a list of indexes where the index is the first True position
in the corresponding sublist or None if it does not exist</p>
<p>in other words: for each row finds the smallest True column number or None</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>flags_list</strong> (<em>list</em>) – list of lists of booleans</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m utool.util_list –test-find_first_true_indices</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags_list</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">find_first_true_indices</span><span class="p">(</span><span class="n">flags_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">index_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[0, None, 1, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.find_k_true_indicies">
<code class="descclassname">vtool.other.</code><code class="descname">find_k_true_indicies</code><span class="sig-paren">(</span><em>flags_list</em>, <em>k</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_k_true_indicies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.find_k_true_indicies" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses output of either this function or find_first_true_indices
to find the next index of true flags</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>flags_list</strong> (<em>list</em>) – list of lists of booleans</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m utool.util_list –test-find_next_true_indices</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags_list</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">find_k_true_indicies</span><span class="p">(</span><span class="n">flags_list</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[array([2]), None, array([1, 2]), array([0, 1])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.find_next_true_indices">
<code class="descclassname">vtool.other.</code><code class="descname">find_next_true_indices</code><span class="sig-paren">(</span><em>flags_list</em>, <em>offset_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_next_true_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.find_next_true_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses output of either this function or find_first_true_indices
to find the next index of true flags</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>flags_list</strong> (<em>list</em>) – list of lists of booleans</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m utool.util_list –test-find_next_true_indices</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags_list</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset_list</span> <span class="o">=</span> <span class="n">find_first_true_indices</span><span class="p">(</span><span class="n">flags_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">find_next_true_indices</span><span class="p">(</span><span class="n">flags_list</span><span class="p">,</span> <span class="n">offset_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">index_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[2, None, 2, None]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.flag_intersection">
<code class="descclassname">vtool.other.</code><code class="descname">flag_intersection</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#flag_intersection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.flag_intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Flags the rows in <cite>arr1</cite> that contain items in <cite>arr2</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">flags where len(flags) == len(arr1)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">flag_intersection</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;flags = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flags</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">structure_rows</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">flag_intersection</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;flags = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flags</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">flag_intersection</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">flag_intersection</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
</dd>
<dt>Timeit:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="sa">r</span><span class="s1">&#39;&#39;&#39;</span>
<span class="go">        import vtool as vt</span>
<span class="go">        import numpy as np</span>
<span class="go">        rng = np.random.RandomState(0)</span>
<span class="go">        arr1 = rng.randint(0, 100, 100000).reshape(-1, 2)</span>
<span class="go">        arr2 = rng.randint(0, 100, 1000).reshape(-1, 2)</span>
<span class="go">        arr1_, arr2_ = vt.structure_rows(arr1, arr2)</span>
<span class="go">        &#39;&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;&#39;&#39;</span>
<span class="go">        np.array([row in arr2_ for row in arr1_])</span>
<span class="go">        np.logical_or.reduce([arr1_ == row_ for row_ in arr2_]).ravel()</span>
<span class="go">        vt.iter_reduce_ufunc(np.logical_or, (arr1_ == row_ for row_ in arr2_)).ravel()</span>
<span class="go">        &#39;&#39;&#39;).split(&#39;\n&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="o">=</span><span class="n">setup</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.fromiter_nd">
<code class="descclassname">vtool.other.</code><code class="descname">fromiter_nd</code><span class="sig-paren">(</span><em>iter_</em>, <em>shape</em>, <em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#fromiter_nd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.fromiter_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Like np.fromiter but handles iterators that generated
n-dimensional arrays. Slightly faster than np.array.</p>
<p>maybe commit to numpy?</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>iter</strong> (<em>iter</em>) – an iterable that generates homogenous ndarrays</li>
<li><strong>shape</strong> (<em>tuple</em>) – the expected output shape</li>
<li><strong>dtype</strong> (<em>dtype</em>) – the numpy datatype of the generated ndarrays</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The iterable must yeild a numpy array. It cannot yeild a Python list.</p>
</div>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other fromiter_nd –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total</span> <span class="o">=</span> <span class="mi">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">fromiter_nd</span><span class="p">(</span><span class="n">iter_</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">shape</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dfxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">qfxs</span><span class="p">,</span> <span class="n">dfxs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qfxs</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">fromiter_nd</span><span class="p">(</span><span class="n">iter_</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">shape</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.get_covered_mask">
<code class="descclassname">vtool.other.</code><code class="descname">get_covered_mask</code><span class="sig-paren">(</span><em>covered_array</em>, <em>covering_array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_covered_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.get_covered_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.get_crop_slices">
<code class="descclassname">vtool.other.</code><code class="descname">get_crop_slices</code><span class="sig-paren">(</span><em>isfill</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_crop_slices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.get_crop_slices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.get_uncovered_mask">
<code class="descclassname">vtool.other.</code><code class="descname">get_uncovered_mask</code><span class="sig-paren">(</span><em>covered_array</em>, <em>covering_array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_uncovered_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.get_uncovered_mask" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>covered_array</strong> (<em>ndarray</em>) – </li>
<li><strong>covering_array</strong> (<em>ndarray</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">flags</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-get_uncovered_mask</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covering_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">get_uncovered_mask</span><span class="p">(</span><span class="n">covered_array</span><span class="p">,</span> <span class="n">covering_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ True False  True False False]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covering_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">get_uncovered_mask</span><span class="p">(</span><span class="n">covered_array</span><span class="p">,</span> <span class="n">covering_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ True  True  True  True  True]</span>
</pre></div>
</div>
</dd>
<dt>Example3:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
<span class="gp">... </span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covering_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">get_uncovered_mask</span><span class="p">(</span><span class="n">covered_array</span><span class="p">,</span> <span class="n">covering_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flags</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[ True, False,  True],</span>
<span class="go">          [False, False,  True],</span>
<span class="go">          [ True,  True,  True]], dtype=bool)</span>
</pre></div>
</div>
</dd>
<dt>Ignore::</dt>
<dd>covering_array = [1, 2, 3, 4, 5, 6, 7]
%timeit get_uncovered_mask(covered_array, covering_array)
100000 loops, best of 3: 18.6 µs per loop
%timeit get_uncovered_mask2(covered_array, covering_array)
100000 loops, best of 3: 16.9 µs per loop</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.get_undirected_edge_ids">
<code class="descclassname">vtool.other.</code><code class="descname">get_undirected_edge_ids</code><span class="sig-paren">(</span><em>directed_edges</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_undirected_edge_ids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.get_undirected_edge_ids" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>directed_edges</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">edgeid_list</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –exec-get_undirected_edge_ids</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">directed_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edgeid_list</span> <span class="o">=</span> <span class="n">get_undirected_edge_ids</span><span class="p">(</span><span class="n">directed_edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;edgeid_list = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">edgeid_list</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">edgeid_list = [0 0 1 2 3 1 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.grab_webcam_image">
<code class="descclassname">vtool.other.</code><code class="descname">grab_webcam_image</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#grab_webcam_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.grab_webcam_image" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_gui/py_video_display/py_video_display.html">http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_gui/py_video_display/py_video_display.html</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-grab_webcam_image –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">grab_webcam_image</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s1">&#39;webcap.jpg&#39;</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.greedy_setcover">
<code class="descclassname">vtool.other.</code><code class="descname">greedy_setcover</code><span class="sig-paren">(</span><em>universe</em>, <em>subsets</em>, <em>weights=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#greedy_setcover"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.greedy_setcover" title="Permalink to this definition">¶</a></dt>
<dd><p>Copied implmentation of greedy set cover from stack overflow. Needs work.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/7942312/of-greedy-set-cover-faster">http://stackoverflow.com/questions/7942312/of-greedy-set-cover-faster</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">universe</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subsets</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="nb">set</span><span class="p">([</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chosen</span><span class="p">,</span> <span class="n">costs</span> <span class="o">=</span> <span class="n">greedy_setcover</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">subsets</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cover: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">chosen</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total Cost: </span><span class="si">%r</span><span class="s1">=sum(</span><span class="si">%r</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">costs</span><span class="p">),</span> <span class="n">costs</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.inbounds">
<code class="descclassname">vtool.other.</code><code class="descname">inbounds</code><span class="sig-paren">(</span><em>num</em>, <em>low</em>, <em>high</em>, <em>eq=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#inbounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.inbounds" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>num</strong> (<em>scalar</em><em> or </em><em>ndarray</em>) – </li>
<li><strong>low</strong> (<em>scalar</em><em> or </em><em>ndarray</em>) – </li>
<li><strong>high</strong> (<em>scalar</em><em> or </em><em>ndarray</em>) – </li>
<li><strong>eq</strong> (<em>bool</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">is_inbounds</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">scalar or ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/other.py inbounds</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>   <span class="p">,</span>  <span class="mf">0.431</span><span class="p">,</span>  <span class="mf">0.279</span><span class="p">],</span>
<span class="gp">... </span>                <span class="p">[</span> <span class="mf">0.204</span><span class="p">,</span>  <span class="mf">0.352</span><span class="p">,</span>  <span class="mf">0.08</span> <span class="p">],</span>
<span class="gp">... </span>                <span class="p">[</span> <span class="mf">0.107</span><span class="p">,</span>  <span class="mf">0.325</span><span class="p">,</span>  <span class="mf">0.179</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">low</span>  <span class="o">=</span> <span class="o">.</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">high</span> <span class="o">=</span> <span class="o">.</span><span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_inbounds</span> <span class="o">=</span> <span class="n">inbounds</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">eq</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">is_inbounds</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.index_partition">
<code class="descclassname">vtool.other.</code><code class="descname">index_partition</code><span class="sig-paren">(</span><em>item_list</em>, <em>part1_items</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#index_partition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.index_partition" title="Permalink to this definition">¶</a></dt>
<dd><p>returns two lists. The first are the indecies of items in item_list that
are in part1_items. the second is the indices in item_list that are not
in part1_items. items in part1_items that are not in item_list are
ignored</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dist&#39;</span><span class="p">,</span> <span class="s1">&#39;fg&#39;</span><span class="p">,</span> <span class="s1">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fg&#39;</span><span class="p">,</span> <span class="s1">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_indexes</span><span class="p">,</span> <span class="n">part2_indexes</span> <span class="o">=</span> <span class="n">index_partition</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part1_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">part1_indexes</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">part2_indexes</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.intersect1d_reduce">
<code class="descclassname">vtool.other.</code><code class="descname">intersect1d_reduce</code><span class="sig-paren">(</span><em>arr_list</em>, <em>assume_unique=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect1d_reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.intersect1d_reduce" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.intersect2d_flags">
<code class="descclassname">vtool.other.</code><code class="descname">intersect2d_flags</code><span class="sig-paren">(</span><em>A</em>, <em>B</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.intersect2d_flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks intersection of rows of A against rows of B</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>A</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </li>
<li><strong>B</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(flag_list1, flag_list2)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-intersect2d_flags</dd>
<dt>SeeAlso:</dt>
<dd>np.in1d - the one dimensional version</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">609</span><span class="p">,</span> <span class="mi">307</span><span class="p">],</span> <span class="p">[</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">344</span><span class="p">],</span> <span class="p">[</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">690</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">422</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">422</span><span class="p">,</span>  <span class="mi">968</span><span class="p">],</span> <span class="p">[</span> <span class="mi">481</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">1132</span><span class="p">],</span> <span class="p">[</span> <span class="mi">759</span><span class="p">,</span>  <span class="mi">159</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">flag_list1</span><span class="p">,</span> <span class="n">flag_list2</span><span class="p">)</span> <span class="o">=</span> <span class="n">intersect2d_flags</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">flag_list1</span><span class="p">,</span> <span class="n">flag_list2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.intersect2d_indices">
<code class="descclassname">vtool.other.</code><code class="descname">intersect2d_indices</code><span class="sig-paren">(</span><em>A</em>, <em>B</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.intersect2d_indices" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>A</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </li>
<li><strong>B</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(ax_list, bx_list)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-intersect2d_indices</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">158</span><span class="p">,</span>  <span class="mi">171</span><span class="p">],</span> <span class="p">[</span> <span class="mi">542</span><span class="p">,</span>  <span class="mi">297</span><span class="p">],</span> <span class="p">[</span> <span class="mi">955</span><span class="p">,</span> <span class="mi">1113</span><span class="p">],</span> <span class="p">[</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1254</span><span class="p">],</span> <span class="p">[</span> <span class="mi">976</span><span class="p">,</span> <span class="mi">1255</span><span class="p">],</span> <span class="p">[</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">1265</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">117</span><span class="p">,</span>  <span class="mi">211</span><span class="p">],</span> <span class="p">[</span> <span class="mi">158</span><span class="p">,</span>  <span class="mi">171</span><span class="p">],</span> <span class="p">[</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1254</span><span class="p">],</span> <span class="p">[</span> <span class="mi">309</span><span class="p">,</span>  <span class="mi">328</span><span class="p">],</span> <span class="p">[</span> <span class="mi">447</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">750</span><span class="p">,</span>  <span class="mi">357</span><span class="p">],</span> <span class="p">[</span> <span class="mi">976</span><span class="p">,</span> <span class="mi">1255</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">ax_list</span><span class="p">,</span> <span class="n">bx_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">intersect2d_indices</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">ax_list</span><span class="p">,</span> <span class="n">bx_list</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.intersect2d_numpy">
<code class="descclassname">vtool.other.</code><code class="descname">intersect2d_numpy</code><span class="sig-paren">(</span><em>A</em>, <em>B</em>, <em>assume_unique=False</em>, <em>return_indices=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_numpy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.intersect2d_numpy" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>References::</dt>
<dd><a class="reference external" href="http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays/8317155#8317155">http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays/8317155#8317155</a></dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>A</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </li>
<li><strong>B</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </li>
<li><strong>assume_unique</strong> (<em>bool</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">C</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[ndims=2]</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-intersect2d_numpy</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">78</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span> <span class="mi">283</span><span class="p">,</span> <span class="mi">396</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">403</span><span class="p">,</span> <span class="mi">412</span><span class="p">,</span> <span class="mi">535</span><span class="p">,</span> <span class="mi">552</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">152</span><span class="p">,</span>  <span class="mi">98</span><span class="p">,</span>  <span class="mi">32</span><span class="p">,</span> <span class="mi">260</span><span class="p">,</span> <span class="mi">387</span><span class="p">,</span> <span class="mi">285</span><span class="p">,</span>  <span class="mi">22</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span>  <span class="mi">55</span><span class="p">,</span> <span class="mi">261</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">403</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span> <span class="mi">412</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span> <span class="mi">815</span><span class="p">,</span> <span class="mi">463</span><span class="p">,</span> <span class="mi">613</span><span class="p">,</span> <span class="mi">552</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span> <span class="mi">22</span><span class="p">,</span>  <span class="mi">32</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">199</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">254</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assume_unique</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span> <span class="o">=</span> <span class="n">intersect2d_numpy</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">C</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([[ 85, 403, 412],</span>
<span class="go">       [ 32,  22, 103]]), array([2, 6, 7]), array([0, 1, 2]))</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span> <span class="o">=</span> <span class="n">intersect2d_numpy</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">C</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([[1, 2, 3]]), array([0]), array([0]))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.intersect2d_structured_numpy">
<code class="descclassname">vtool.other.</code><code class="descname">intersect2d_structured_numpy</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em>, <em>assume_unique=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_structured_numpy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.intersect2d_structured_numpy" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr1</strong> – unstructured 2d array</li>
<li><strong>arr2</strong> – unstructured 2d array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><a href="#id95"><span class="problematic" id="id96">A_</span></a>, <a href="#id97"><span class="problematic" id="id98">B_</span></a>, <a href="#id99"><span class="problematic" id="id100">C_</span></a> - structured versions of arr1, and arr2, and their structured intersection</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array">http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array</a>
<a class="reference external" href="http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays">http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.iter_reduce_ufunc">
<code class="descclassname">vtool.other.</code><code class="descname">iter_reduce_ufunc</code><span class="sig-paren">(</span><em>ufunc</em>, <em>arr_iter</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#iter_reduce_ufunc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.iter_reduce_ufunc" title="Permalink to this definition">¶</a></dt>
<dd><p>constant memory iteration and reduction</p>
<p>applys ufunc from left to right over the input arrays</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">memory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen_memory</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">arr_gen</span><span class="p">(</span><span class="n">arr_list</span><span class="p">,</span> <span class="n">gen_memory</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arr_list</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">gen_memory</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">arr</span>
<span class="gp">... </span>        <span class="k">yield</span> <span class="n">gen_memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gen_memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gen_memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ufunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res1</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">arr_list</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res2</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">arr_list</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res3</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">arr_gen</span><span class="p">(</span><span class="n">arr_list</span><span class="p">,</span> <span class="n">gen_memory</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res1       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res1</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res2       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res2</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res3       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;memory     = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gen_memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gen_memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">res1</span> <span class="o">==</span> <span class="n">res2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">res2</span> <span class="o">==</span> <span class="n">res3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.list_compress_">
<code class="descclassname">vtool.other.</code><code class="descname">list_compress_</code><span class="sig-paren">(</span><em>list_</em>, <em>flag_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#list_compress_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.list_compress_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.list_take_">
<code class="descclassname">vtool.other.</code><code class="descname">list_take_</code><span class="sig-paren">(</span><em>list_</em>, <em>index_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#list_take_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.list_take_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.make_video">
<code class="descclassname">vtool.other.</code><code class="descname">make_video</code><span class="sig-paren">(</span><em>images</em>, <em>outvid=None</em>, <em>fps=5</em>, <em>size=None</em>, <em>is_color=True</em>, <em>format='XVID'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#make_video"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.make_video" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a video from a list of images.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://www.xavierdupre.fr/blog/2016-03-30_nojs.html">http://www.xavierdupre.fr/blog/2016-03-30_nojs.html</a>
<a class="reference external" href="http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_gui/py_video_display/py_video_display.html">http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_gui/py_video_display/py_video_display.html</a></p>
<p>&#64;param      outvid      output video
&#64;param      images      list of images to use in the video
&#64;param      fps         frame per second
&#64;param      size        size of each frame
&#64;param      is_color    color
&#64;param      format      see <a class="reference external" href="http://www.fourcc.org/codecs.php">http://www.fourcc.org/codecs.php</a></p>
<p>The function relies on <a class="reference external" href="http://opencv-python-tutroals.readthedocs.org/en/latest/">http://opencv-python-tutroals.readthedocs.org/en/latest/</a>.
By default, the video will have the size of the first image.
It will resize every image to this size before adding them to the video.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.make_video2">
<code class="descclassname">vtool.other.</code><code class="descname">make_video2</code><span class="sig-paren">(</span><em>images</em>, <em>outdir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#make_video2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.make_video2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.median_abs_dev">
<code class="descclassname">vtool.other.</code><code class="descname">median_abs_dev</code><span class="sig-paren">(</span><em>arr_list</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#median_abs_dev"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.median_abs_dev" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Median_absolute_deviation">https://en.wikipedia.org/wiki/Median_absolute_deviation</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.mult_lists">
<code class="descclassname">vtool.other.</code><code class="descname">mult_lists</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#mult_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.mult_lists" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.multigroup_lookup">
<code class="descclassname">vtool.other.</code><code class="descname">multigroup_lookup</code><span class="sig-paren">(</span><em>lazydict</em>, <em>keys_list</em>, <em>subkeys_list</em>, <em>custom_func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#multigroup_lookup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.multigroup_lookup" title="Permalink to this definition">¶</a></dt>
<dd><p>Efficiently calls custom_func for each item in zip(keys_list, subkeys_list)
by grouping subkeys to minimize the number of calls to custom_func.</p>
<p>We are given multiple lists of keys, and subvals.
The goal is to group the subvals by keys and apply the subval lookups
(a call to a function) to the key only once and at the same time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lazydict</strong> (<em>dict of utool.LazyDict</em>) – </li>
<li><strong>keys_list</strong> (<em>list</em>) – </li>
<li><strong>subkeys_list</strong> (<em>list</em>) – </li>
<li><strong>custom_func</strong> (<em>func</em>) – must have signature custom_func(lazydict, key, subkeys)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>vt.multigroup_lookup_naive - unoptomized version, but simple to read</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpath_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">util_grabdata</span><span class="o">.</span><span class="n">get_valid_test_imgkeys</span><span class="p">()]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lazydict</span> <span class="o">=</span> <span class="p">{</span><span class="n">count</span><span class="p">:</span> <span class="n">vt</span><span class="o">.</span><span class="n">testdata_annot_metadata</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span> <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">fpath</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fpath_list</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aids_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fms</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">keys_list</span> <span class="o">=</span> <span class="n">aids_list</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subkeys_list</span> <span class="o">=</span> <span class="n">fms</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">custom_func</span><span class="p">(</span><span class="n">lazydict</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">subkeys</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">annot</span> <span class="o">=</span> <span class="n">lazydict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">kpts</span> <span class="o">=</span> <span class="n">annot</span><span class="p">[</span><span class="s1">&#39;kpts&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">rchip</span> <span class="o">=</span> <span class="n">annot</span><span class="p">[</span><span class="s1">&#39;rchip&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">kpts_m</span> <span class="o">=</span> <span class="n">kpts</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">subkeys</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">warped_patches</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_warped_patches</span><span class="p">(</span><span class="n">rchip</span><span class="p">,</span> <span class="n">kpts_m</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">warped_patches</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_lists1</span> <span class="o">=</span> <span class="n">multigroup_lookup</span><span class="p">(</span><span class="n">lazydict</span><span class="p">,</span> <span class="n">keys_list</span><span class="p">,</span> <span class="n">subkeys_list</span><span class="p">,</span> <span class="n">custom_func</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_lists2</span> <span class="o">=</span> <span class="n">multigroup_lookup_naive</span><span class="p">(</span><span class="n">lazydict</span><span class="p">,</span> <span class="n">keys_list</span><span class="p">,</span> <span class="n">subkeys_list</span><span class="p">,</span> <span class="n">custom_func</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">sver_c_wrapper</span><span class="o">.</span><span class="n">asserteq</span><span class="p">(</span><span class="n">data_lists1</span><span class="p">,</span> <span class="n">data_lists2</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">keys_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subkeys_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.multigroup_lookup_naive">
<code class="descclassname">vtool.other.</code><code class="descname">multigroup_lookup_naive</code><span class="sig-paren">(</span><em>lazydict</em>, <em>keys_list</em>, <em>subkeys_list</em>, <em>custom_func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#multigroup_lookup_naive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.multigroup_lookup_naive" title="Permalink to this definition">¶</a></dt>
<dd><p>Slow version of multigroup_lookup. Makes a call to custom_func for each
item in zip(keys_list, subkeys_list).</p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>vt.multigroup_lookup</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.nearest_point">
<code class="descclassname">vtool.other.</code><code class="descname">nearest_point</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>pts</em>, <em>mode='random'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#nearest_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.nearest_point" title="Permalink to this definition">¶</a></dt>
<dd><p>finds the nearest point(s) in pts to (x, y)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.nonunique_row_flags">
<code class="descclassname">vtool.other.</code><code class="descname">nonunique_row_flags</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#nonunique_row_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.nonunique_row_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.nonunique_row_indexes">
<code class="descclassname">vtool.other.</code><code class="descname">nonunique_row_indexes</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#nonunique_row_indexes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.nonunique_row_indexes" title="Permalink to this definition">¶</a></dt>
<dd><p>rows that are not unique (does not include the first instance of each pattern)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arr</strong> (<em>ndarray</em>) – 2d array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">nonunique_rowx</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>unique_row_indexes
nonunique_row_flags</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-unique_row_indexes</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">534</span><span class="p">,</span> <span class="o">.</span><span class="mi">432</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">534</span><span class="p">,</span> <span class="o">.</span><span class="mi">432</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nonunique_rowx</span> <span class="o">=</span> <span class="n">unique_row_indexes</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;nonunique_rowx = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">nonunique_rowx</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">nonunique_rowx = np.array([4, 6, 7, 8], dtype=np.int64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.norm01">
<code class="descclassname">vtool.other.</code><code class="descname">norm01</code><span class="sig-paren">(</span><em>array</em>, <em>dim=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#norm01"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.norm01" title="Permalink to this definition">¶</a></dt>
<dd><p>normalizes a numpy array from 0 to 1 based in its extent</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>ndarray</em>) – </li>
<li><strong>dim</strong> (<em>int</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dim</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_norm</span> <span class="o">=</span> <span class="n">norm01</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">array_norm</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.or_lists">
<code class="descclassname">vtool.other.</code><code class="descname">or_lists</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#or_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.or_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Like np.logical_and, but can take more than 2 arguments</p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>and_lists</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.pad_vstack">
<code class="descclassname">vtool.other.</code><code class="descname">pad_vstack</code><span class="sig-paren">(</span><em>arrs</em>, <em>fill_value=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#pad_vstack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.pad_vstack" title="Permalink to this definition">¶</a></dt>
<dd><p>Stacks values and pads arrays with different lengths with zeros</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.rebuild_partition">
<code class="descclassname">vtool.other.</code><code class="descname">rebuild_partition</code><span class="sig-paren">(</span><em>part1_vals</em>, <em>part2_vals</em>, <em>part1_indexes</em>, <em>part2_indexes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#rebuild_partition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.rebuild_partition" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverts work done by index_partition</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>part1_vals</strong> (<em>list</em>) – </li>
<li><strong>part2_vals</strong> (<em>list</em>) – </li>
<li><strong>part1_indexes</strong> (<em>dict</em>) – </li>
<li><strong>part2_indexes</strong> (<em>dict</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-rebuild_partition</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dist&#39;</span><span class="p">,</span> <span class="s1">&#39;fg&#39;</span><span class="p">,</span> <span class="s1">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fg&#39;</span><span class="p">,</span> <span class="s1">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_indexes</span><span class="p">,</span> <span class="n">part2_indexes</span> <span class="o">=</span> <span class="n">index_partition</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part1_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_vals</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part1_indexes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part2_vals</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part2_indexes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val_list</span> <span class="o">=</span> <span class="n">rebuild_partition</span><span class="p">(</span><span class="n">part1_vals</span><span class="p">,</span> <span class="n">part2_vals</span><span class="p">,</span> <span class="n">part1_indexes</span><span class="p">,</span> <span class="n">part2_indexes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">val_list</span> <span class="o">==</span> <span class="n">item_list</span><span class="p">,</span> <span class="s1">&#39;incorrect inversin&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">val_list</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.rowwise_operation">
<code class="descclassname">vtool.other.</code><code class="descname">rowwise_operation</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em>, <em>op</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#rowwise_operation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.rowwise_operation" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRICATE THIS IS POSSIBLE WITH STRICTLY BROADCASTING AND
USING np.newaxis</p>
<p>DEPRICATE, numpy has better ways of doing this.
Is the rowwise name correct? Should it be colwise?</p>
<p>performs an operation between an
(N x A x B … x Z) array with an
(N x 1) array</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.safe_argmax">
<code class="descclassname">vtool.other.</code><code class="descname">safe_argmax</code><span class="sig-paren">(</span><em>arr</em>, <em>fill=nan</em>, <em>finite=False</em>, <em>nans=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_argmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.safe_argmax" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Doctest:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">safe_argmax</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">safe_argmax</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">safe_argmax</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">safe_argmax</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">safe_argmax</span><span class="p">([]))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.safe_cat">
<code class="descclassname">vtool.other.</code><code class="descname">safe_cat</code><span class="sig-paren">(</span><em>tup</em>, <em>axis=0</em>, <em>default_shape=(0</em>, <em>)</em>, <em>default_dtype=&lt;class 'float'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_cat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.safe_cat" title="Permalink to this definition">¶</a></dt>
<dd><p>stacks a tuple even if it is empty
Also deals with numpy bug where cat fails if an element in sequence is empty</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">safe_cat</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">safe_cat</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;s = &#39;</span><span class="p">,</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">s</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">safe_cat</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;s = &#39;</span><span class="p">,</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">s</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">safe_cat</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;s = &#39;</span><span class="p">,</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">s</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.safe_div">
<code class="descclassname">vtool.other.</code><code class="descname">safe_div</code><span class="sig-paren">(</span><em>a</em>, <em>b</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_div"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.safe_div" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.safe_extreme">
<code class="descclassname">vtool.other.</code><code class="descname">safe_extreme</code><span class="sig-paren">(</span><em>arr</em>, <em>op</em>, <em>fill=nan</em>, <em>finite=False</em>, <em>nans=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_extreme"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.safe_extreme" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies an exterme operation to an 1d array (typically max/min) but ensures
a value is always returned even in operations without identities. The
default identity must be specified using the <cite>fill</cite> argument.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arr</strong> (<em>ndarray</em>) – 1d array to take extreme of</li>
<li><strong>op</strong> (<em>func</em>) – vectorized operation like np.max to apply to array</li>
<li><strong>fill</strong> (<em>float</em>) – return type if arr has no elements (default = nan)</li>
<li><strong>finite</strong> (<em>bool</em>) – if True ignores non-finite values (default = False)</li>
<li><strong>nans</strong> (<em>bool</em>) – if False ignores nans (default = True)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.other.safe_max">
<code class="descclassname">vtool.other.</code><code class="descname">safe_max</code><span class="sig-paren">(</span><em>arr</em>, <em>fill=nan</em>, <em>finite=False</em>, <em>nans=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_max"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.safe_max" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arr</strong> (<em>ndarray</em>) – 1d array to take max of</li>
<li><strong>fill</strong> (<em>float</em>) – return type if arr has no elements (default = nan)</li>
<li><strong>finite</strong> (<em>bool</em>) – if True ignores non-finite values (default = False)</li>
<li><strong>nans</strong> (<em>bool</em>) – if False ignores nans (default = True)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other safe_max –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results1</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_max</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results2</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_max</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results3</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_max</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results4</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_max</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">results1</span><span class="p">,</span> <span class="n">results2</span><span class="p">,</span> <span class="n">results3</span><span class="p">,</span> <span class="n">results4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;results = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">results = [</span>
<span class="go">    [nan, nan, nan, inf, inf, 1],</span>
<span class="go">    [nan, nan, nan, nan, 1.0, 1],</span>
<span class="go">    [nan, nan, nan, nan, 1.0, 1],</span>
<span class="go">    [nan, nan, inf, inf, inf, 1],</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.safe_min">
<code class="descclassname">vtool.other.</code><code class="descname">safe_min</code><span class="sig-paren">(</span><em>arr</em>, <em>fill=nan</em>, <em>finite=False</em>, <em>nans=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_min"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.safe_min" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results1</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_min</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results2</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_min</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results3</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_min</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results4</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_min</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">results1</span><span class="p">,</span> <span class="n">results2</span><span class="p">,</span> <span class="n">results3</span><span class="p">,</span> <span class="n">results4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;results = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">results = [</span>
<span class="go">    [nan, nan, nan, inf, 1.0, 0],</span>
<span class="go">    [nan, nan, nan, nan, 1.0, 0],</span>
<span class="go">    [nan, nan, nan, nan, 1.0, 0],</span>
<span class="go">    [nan, nan, -inf, inf, 1.0, 0],</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.safe_vstack">
<code class="descclassname">vtool.other.</code><code class="descname">safe_vstack</code><span class="sig-paren">(</span><em>tup</em>, <em>default_shape=(0</em>, <em>)</em>, <em>default_dtype=&lt;class 'float'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_vstack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.safe_vstack" title="Permalink to this definition">¶</a></dt>
<dd><p>stacks a tuple even if it is empty</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.significant_shape">
<code class="descclassname">vtool.other.</code><code class="descname">significant_shape</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#significant_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.significant_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>find the shape without trailing 1’s</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.structure_rows">
<code class="descclassname">vtool.other.</code><code class="descname">structure_rows</code><span class="sig-paren">(</span><em>*arrs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#structure_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.structure_rows" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other structure_rows</dd>
<dt>SeeAlso:</dt>
<dd>unstructure_rows</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">609</span><span class="p">,</span> <span class="mi">307</span><span class="p">],</span> <span class="p">[</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">344</span><span class="p">],</span> <span class="p">[</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">690</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">422</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">422</span><span class="p">,</span>  <span class="mi">968</span><span class="p">],</span> <span class="p">[</span> <span class="mi">481</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">1132</span><span class="p">],</span> <span class="p">[</span> <span class="mi">759</span><span class="p">,</span>  <span class="mi">159</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structured_arrs</span> <span class="o">=</span> <span class="n">structure_rows</span><span class="p">(</span><span class="o">*</span><span class="n">arrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unstructured_arrs</span> <span class="o">=</span> <span class="n">unstructure_rows</span><span class="p">(</span><span class="o">*</span><span class="n">structured_arrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">unstructured_arrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">arrs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">unstructured_arrs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">arrs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">union_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">union1d</span><span class="p">(</span><span class="o">*</span><span class="n">structured_arrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">union</span><span class="p">,</span> <span class="o">=</span> <span class="n">unstructure_rows</span><span class="p">(</span><span class="n">union_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">union</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.take2">
<code class="descclassname">vtool.other.</code><code class="descname">take2</code><span class="sig-paren">(</span><em>arr</em>, <em>index_list</em>, <em>axis=None</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#take2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.take2" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around numpy compress that makes the signature more similar to take</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.take_col_per_row">
<code class="descclassname">vtool.other.</code><code class="descname">take_col_per_row</code><span class="sig-paren">(</span><em>arr</em>, <em>colx_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#take_col_per_row"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.take_col_per_row" title="Permalink to this definition">¶</a></dt>
<dd><p>takes a column from each row</p>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><p class="first">num_rows = 1000
num_cols = 4</p>
<p>arr = np.arange(10 * 4).reshape(10, 4)
colx_list = (np.random.rand(10) * 4).astype(np.int)</p>
<p class="last">%timeit np.array([row[cx] for (row, cx) in zip(arr, colx_list)])
%timeit arr.ravel().take(np.ravel_multi_index((np.arange(len(colx_list)), colx_list), arr.shape))
%timeit arr.ravel().take(colx_list + np.arange(arr.shape[0]) * arr.shape[1])</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.to_undirected_edges">
<code class="descclassname">vtool.other.</code><code class="descname">to_undirected_edges</code><span class="sig-paren">(</span><em>directed_edges</em>, <em>upper=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#to_undirected_edges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.to_undirected_edges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.trytake">
<code class="descclassname">vtool.other.</code><code class="descname">trytake</code><span class="sig-paren">(</span><em>list_</em>, <em>index_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#trytake"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.trytake" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.unique_rows">
<code class="descclassname">vtool.other.</code><code class="descname">unique_rows</code><span class="sig-paren">(</span><em>arr</em>, <em>directed=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#unique_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.unique_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Order or columns does not matter if directed = False</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.unstructure_rows">
<code class="descclassname">vtool.other.</code><code class="descname">unstructure_rows</code><span class="sig-paren">(</span><em>*structured_arrs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#unstructure_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.unstructure_rows" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>SeeAlso:</dt>
<dd>structure_rows</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.weighted_average_scoring">
<code class="descclassname">vtool.other.</code><code class="descname">weighted_average_scoring</code><span class="sig-paren">(</span><em>fsv</em>, <em>weight_filtxs</em>, <em>nonweight_filtxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#weighted_average_scoring"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.weighted_average_scoring" title="Permalink to this definition">¶</a></dt>
<dd><p>does frac{sum_i w^f_i * w^d_i * r_i}{sum_i w^f_i, w^d_i}
to get a weighed average of ratio scores</p>
<p>If we normalize the weight part to add to 1 then we can get per-feature
scores.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Weighted_arithmetic_mean">http://en.wikipedia.org/wiki/Weighted_arithmetic_mean</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.82992172</span><span class="p">,</span>  <span class="mf">1.56136119</span><span class="p">,</span>  <span class="mf">0.66465378</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.8000412</span> <span class="p">,</span>  <span class="mf">2.14719748</span><span class="p">,</span>  <span class="mf">1.</span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.80848503</span><span class="p">,</span>  <span class="mf">2.6816361</span> <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.86761665</span><span class="p">,</span>  <span class="mf">2.70189977</span><span class="p">,</span>  <span class="mf">1.</span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.8004055</span> <span class="p">,</span>  <span class="mf">1.58753884</span><span class="p">,</span>  <span class="mf">0.92178345</span><span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weight_filtxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nonweight_filtxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_fs</span> <span class="o">=</span> <span class="n">weighted_average_scoring</span><span class="p">(</span><span class="n">fsv</span><span class="p">,</span> <span class="n">weight_filtxs</span><span class="p">,</span> <span class="n">nonweight_filtxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">new_fs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.weighted_geometic_mean">
<code class="descclassname">vtool.other.</code><code class="descname">weighted_geometic_mean</code><span class="sig-paren">(</span><em>data</em>, <em>weights</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#weighted_geometic_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.weighted_geometic_mean" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>list of ndarrays</em>) – </li>
<li><strong>weights</strong> (<em>ndarray</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a href="#id101"><span class="problematic" id="id102">gmean_</span></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-weighted_geometic_mean</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Weighted_geometric_mean">https://en.wikipedia.org/wiki/Weighted_geometric_mean</a></p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>scipy.stats.mstats.gmean</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gmean_</span> <span class="o">=</span> <span class="n">weighted_geometic_mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;gmean_ = </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gmean_</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">gmean_ = 0.740</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gmean_</span> <span class="o">=</span> <span class="n">weighted_geometic_mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;gmean_ = &#39;</span><span class="p">,</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">gmean_</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd>res1 = ((img1 ** .5 * img2 ** .5)) ** 1
res2 = np.sqrt(img1 * img2)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.weighted_geometic_mean_unnormalized">
<code class="descclassname">vtool.other.</code><code class="descname">weighted_geometic_mean_unnormalized</code><span class="sig-paren">(</span><em>data</em>, <em>weights</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#weighted_geometic_mean_unnormalized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.weighted_geometic_mean_unnormalized" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.zipcat">
<code class="descclassname">vtool.other.</code><code class="descname">zipcat</code><span class="sig-paren">(</span><em>arr1_list</em>, <em>arr2_list</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#zipcat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.zipcat" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr1_list</strong> (<em>list</em>) – </li>
<li><strong>arr2_list</strong> (<em>list</em>) – </li>
<li><strong>axis</strong> (<em>None</em>) – (default = None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –exec-zipcat –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_list</span> <span class="o">=</span> <span class="n">zipcat</span><span class="p">(</span><span class="n">arr1_list</span><span class="p">,</span> <span class="n">arr2_list</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_list0</span> <span class="o">=</span> <span class="n">zipcat</span><span class="p">(</span><span class="n">arr1_list</span><span class="p">,</span> <span class="n">arr2_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_list1</span> <span class="o">=</span> <span class="n">zipcat</span><span class="p">(</span><span class="n">arr1_list</span><span class="p">,</span> <span class="n">arr2_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_list2</span> <span class="o">=</span> <span class="n">zipcat</span><span class="p">(</span><span class="n">arr1_list</span><span class="p">,</span> <span class="n">arr2_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr3_list = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">(</span><span class="n">arr3_list</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr3_list0 = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">(</span><span class="n">arr3_list0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr3_list2 = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">(</span><span class="n">arr3_list2</span><span class="p">),))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.zipcompress">
<code class="descclassname">vtool.other.</code><code class="descname">zipcompress</code><span class="sig-paren">(</span><em>arr_list</em>, <em>flags_list</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#zipcompress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.zipcompress" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.zipcompress_safe">
<code class="descclassname">vtool.other.</code><code class="descname">zipcompress_safe</code><span class="sig-paren">(</span><em>arr_list</em>, <em>flags_list</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#zipcompress_safe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.zipcompress_safe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.ziptake">
<code class="descclassname">vtool.other.</code><code class="descname">ziptake</code><span class="sig-paren">(</span><em>arr_list</em>, <em>indices_list</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#ziptake"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.ziptake" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.zstar_value">
<code class="descclassname">vtool.other.</code><code class="descname">zstar_value</code><span class="sig-paren">(</span><em>conf_level=0.95</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#zstar_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.zstar_value" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/28242593/correct-way-to-obtain-confidence-interval-with-scipy">http://stackoverflow.com/questions/28242593/correct-way-to-obtain-confidence-interval-with-scipy</a></p>
</dd></dl>

</div>
<div class="section" id="module-vtool.patch">
<span id="vtool-patch-module"></span><h2>vtool.patch module<a class="headerlink" href="#module-vtool.patch" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.patch.GaussianBlurInplace">
<code class="descclassname">vtool.patch.</code><code class="descname">GaussianBlurInplace</code><span class="sig-paren">(</span><em>img</em>, <em>sigma</em>, <em>size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#GaussianBlurInplace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.GaussianBlurInplace" title="Permalink to this definition">¶</a></dt>
<dd><p>simulates code from helpers.cpp in hesaff</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray</em>) – </li>
<li><strong>sigma</strong> (<em>flaot</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-GaussianBlurInplace:0 –show
python -m vtool.patch –test-GaussianBlurInplace:1 –show</dd>
<dt>References;</dt>
<dd><a class="reference external" href="http://www.cse.usf.edu/~r1k/MachineVisionBook/MachineVision.files/MachineVision_Chapter4.pdf">http://www.cse.usf.edu/~r1k/MachineVisionBook/MachineVision.files/MachineVision_Chapter4.pdf</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Scale_space_implementation">http://en.wikipedia.org/wiki/Scale_space_implementation</a>
<a class="reference external" href="http://www.cse.psu.edu/~rtc12/CSE486/lecture10_6pp.pdf">http://www.cse.psu.edu/~rtc12/CSE486/lecture10_6pp.pdf</a></dd>
</dl>
<p class="rubric">Notes</p>
<p>The product of the convolution of two Gaussian functions with spread
sigma is a Gaussian function with spread sqrt(2)*sigma scaled by the
area of the Gaussian filter</p>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">get_test_patch</span><span class="p">(</span><span class="s1">&#39;star2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_orig</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="mf">2.0</span> <span class="o">*</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="ow">not</span> <span class="n">size</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># check if even</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">size</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ksize</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_orig</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># demonstrate cascading smoothing property</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># THIS ISNT WORKING WHY???</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">get_test_patch</span><span class="p">(</span><span class="s1">&#39;star2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img3</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img4</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_orig</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma1</span> <span class="o">=</span> <span class="o">.</span><span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma2</span> <span class="o">=</span> <span class="o">.</span><span class="mi">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma3</span> <span class="o">=</span> <span class="n">sigma1</span> <span class="o">+</span> <span class="n">sigma2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># components</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img2</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># all in one shot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img3</span><span class="p">,</span> <span class="n">sigma3</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># addative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img4</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img4</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">img4</span> <span class="o">-</span> <span class="n">img3</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ksize</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#fig.add_subplot(1, 3, 1, projection=&#39;3d&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma3</span><span class="p">,</span> <span class="n">sigma3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_orig</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img1</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img2</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img4</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1"> + </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma1</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.draw_kp_ori_steps">
<code class="descclassname">vtool.patch.</code><code class="descname">draw_kp_ori_steps</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#draw_kp_ori_steps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.draw_kp_ori_steps" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows steps in orientation estimation</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd><p class="first">python -m vtool.patch –test-draw_kp_ori_steps –show –fname=zebra.png –fx=121
python -m vtool.patch –test-draw_kp_ori_steps –show –interact
python -m vtool.patch –test-draw_kp_ori_steps –save ~/latex/crall-candidacy-2015/figures/test_fint_kp_direction.jpg –dpath figures ‘–caption=visualization of the steps in the computation of the dominant gradient orientations.’ –figsize=14,9 –dpi=160 –height=2.65  –left=.04 –right=.96 –top=.95 –bottom=.05 –wspace=.1 –hspace=.1</p>
<p>python -m vtool.patch –test-draw_kp_ori_steps –dpath ~/latex/crall-candidacy-2015/ –save figures/draw_kp_ori_steps.jpg  –figsize=14,9 –dpi=180 –height=2.65 –left=.04 –right=.96 –top=.95 –bottom=.05 –wspace=.1 –hspace=.1 –diskshow</p>
<p class="last">python -m vtool.patch –test-draw_kp_ori_steps –dpath ~/latex/crall-candidacy-2015/ –save figures/draw_kp_ori_steps.jpg  –figsize=14,9 –dpi=180  –djust=.04,.05,.1 –diskshow –fname=zebra.png –fx=121</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_kp_ori_steps</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.find_dominant_kp_orientations">
<code class="descclassname">vtool.patch.</code><code class="descname">find_dominant_kp_orientations</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>kp</em>, <em>bins=36</em>, <em>maxima_thresh=0.8</em>, <em>DEBUG_ROTINVAR=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#find_dominant_kp_orientations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.find_dominant_kp_orientations" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf">http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf</a>
page 219</p>
<p><a class="reference external" href="http://www.cs.berkeley.edu/~malik/cs294/lowe-ijcv04.pdf">http://www.cs.berkeley.edu/~malik/cs294/lowe-ijcv04.pdf</a>
page 13.</p>
<p>Lowe uses a 36-bin histogram of edge orientations weigted by a gaussian
distance to the center and gradient magintude. He finds all peaks within
80% of the global maximum. Then he fine tunes the orientation using a
3-binned parabolic fit. Multiple orientations (and hence multiple
keypoints) can be returned, but empirically only about 15% will have
these and they do tend to be important.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">ori_offset - offset of current orientation to dominant orientation</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-find_dominant_kp_orientations</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#imgBGR = get_test_patch(&#39;cross&#39;, jitter=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;star.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kp</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;kp = </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">kp_cpp_infostr</span><span class="p">(</span><span class="n">kp</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_oris</span> <span class="o">=</span> <span class="n">find_dominant_kp_orientations</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">kp</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                         <span class="n">maxima_thresh</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                         <span class="n">DEBUG_ROTINVAR</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;new_oris = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">new_oris</span><span class="p">,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.find_kpts_direction">
<code class="descclassname">vtool.patch.</code><code class="descname">find_kpts_direction</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>kpts</em>, <em>DEBUG_ROTINVAR=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#find_kpts_direction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.find_kpts_direction" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>imgBGR</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data in opencv format (blue, green, red)</li>
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">kpts -  keypoints</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[float32_t, ndim=2]</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-find_kpts_direction</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.find_patch_dominant_orientations">
<code class="descclassname">vtool.patch.</code><code class="descname">find_patch_dominant_orientations</code><span class="sig-paren">(</span><em>patch</em>, <em>bins=36</em>, <em>maxima_thresh=0.8</em>, <em>DEBUG_ROTINVAR=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#find_patch_dominant_orientations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.find_patch_dominant_orientations" title="Permalink to this definition">¶</a></dt>
<dd><p>helper</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.gaussian_average_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">gaussian_average_patch</code><span class="sig-paren">(</span><em>patch</em>, <em>sigma=None</em>, <em>copy=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gaussian_average_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.gaussian_average_patch" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>patch</strong> (<em>ndarray</em>) – </li>
<li><strong>sigma</strong> (<em>float</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-gaussian_average_patch</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel">http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">get_star_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#sigma = 1.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">gaussian_average_patch</span><span class="p">(</span><span class="n">patch</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">0.414210641527</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd>import utool as ut
import wbia.plottool as pt
import vtool as vt
import cv2
gauss_kernel_d0 = (cv2.getGaussianKernel(patch.shape[0], sigma))
gauss_kernel_d1 = (cv2.getGaussianKernel(patch.shape[1], sigma))
weighted_patch = patch.copy()
weighted_patch = np.multiply(weighted_patch,   gauss_kernel_d0)
weighted_patch = np.multiply(weighted_patch.T, gauss_kernel_d1).T
gaussian_kern2 = gauss_kernel_d0.dot(gauss_kernel_d1.T)
fig = pt.figure(fnum=1, pnum=(1, 3, 1), doclf=True, docla=True)
pt.imshow(patch * 255)
fig = pt.figure(fnum=1, pnum=(1, 3, 2))
pt.imshow(ut.norm_zero_one(gaussian_kern2) * 255.0)
fig = pt.figure(fnum=1, pnum=(1, 3, 3))
pt.imshow(ut.norm_zero_one(weighted_patch) * 255.0)
pt.update()</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.gaussian_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">gaussian_patch</code><span class="sig-paren">(</span><em>shape=(7</em>, <em>7)</em>, <em>sigma=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gaussian_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.gaussian_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>another version of the guassian_patch function. hopefully better</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel">http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>shape</strong> (<em>tuple</em>) – array dimensions</li>
<li><strong>sigma</strong> (<em>float</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-gaussian_patch –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#shape = (7, 7)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># 1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gausspatch</span> <span class="o">=</span> <span class="n">gaussian_patch</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sum_</span> <span class="o">=</span> <span class="n">gausspatch</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_almost_eq</span><span class="p">(</span><span class="n">sum_</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">norm01</span><span class="p">(</span><span class="n">gausspatch</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.gaussian_weight_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">gaussian_weight_patch</code><span class="sig-paren">(</span><em>patch</em>, <em>sigma=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gaussian_weight_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.gaussian_weight_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies two one dimensional gaussian operations to a patch which
effectively weights it by a 2-dimensional gaussian. This is efficient
because the actually 2-d gaussian never needs to be allocated.</p>
<p>test_show_gaussian_patches</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.generate_to_patch_transforms">
<code class="descclassname">vtool.patch.</code><code class="descname">generate_to_patch_transforms</code><span class="sig-paren">(</span><em>kpts</em>, <em>patch_size=41</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#generate_to_patch_transforms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.generate_to_patch_transforms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.get_cross_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">get_cross_patch</code><span class="sig-paren">(</span><em>jitter=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_cross_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_cross_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_no_symbol">
<code class="descclassname">vtool.patch.</code><code class="descname">get_no_symbol</code><span class="sig-paren">(</span><em>variant='symbol'</em>, <em>size=(100</em>, <em>100)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_no_symbol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_no_symbol" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">errorimg</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-get_no_symbol –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">errorimg</span> <span class="o">=</span> <span class="n">get_no_symbol</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">errorimg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_orientation_histogram">
<code class="descclassname">vtool.patch.</code><code class="descname">get_orientation_histogram</code><span class="sig-paren">(</span><em>gori</em>, <em>gori_weights</em>, <em>bins=36</em>, <em>DEBUG_ROTINVAR=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_orientation_histogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_orientation_histogram" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gori</strong> – </li>
<li><strong>gori_weights</strong> – </li>
<li><strong>bins</strong> (<em>int</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(hist, centers)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-get_orientation_histogram</dd>
<dt>Ignore:</dt>
<dd>print(vt.kpts_docrepr(gori, ‘gori = ‘))
print(vt.kpts_docrepr(gori_weights, ‘gori_weights = ‘))</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gori</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">4.71</span><span class="p">,</span>  <span class="mf">6.15</span><span class="p">,</span>  <span class="mf">3.13</span><span class="p">,</span>  <span class="mf">3.24</span><span class="p">,</span>  <span class="mf">4.71</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">4.71</span><span class="p">,</span>  <span class="mf">4.61</span><span class="p">,</span>  <span class="mf">0.5</span> <span class="p">,</span>  <span class="mf">4.85</span><span class="p">,</span>  <span class="mf">4.71</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">1.57</span><span class="p">,</span>  <span class="mf">6.28</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">1.57</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gori_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.19</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.21</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.16</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.11</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.17</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.19</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_orientation_histogram</span><span class="p">(</span><span class="n">gori</span><span class="p">,</span> <span class="n">gori_weights</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_star2_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">get_star2_patch</code><span class="sig-paren">(</span><em>jitter=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_star2_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_star2_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_star_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">get_star_patch</code><span class="sig-paren">(</span><em>jitter=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_star_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_star_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_stripe_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">get_stripe_patch</code><span class="sig-paren">(</span><em>jitter=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_stripe_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_stripe_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_test_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">get_test_patch</code><span class="sig-paren">(</span><em>key='star'</em>, <em>jitter=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_test_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_test_patch" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> (<em>str</em>) – </li>
<li><strong>jitter</strong> (<em>bool</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">patch</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-get_test_patch –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;star2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jitter</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">get_test_patch</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">jitter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">patch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_unwarped_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">get_unwarped_patch</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>kp</em>, <em>gray=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_unwarped_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_unwarped_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns unwarped warped patch around a keypoint</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em>) – array representing an image</li>
<li><strong>kpt</strong> (<em>ndarray</em>) – keypoint ndarray in [x, y, a, c, d, theta] format</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(wpatch, wkp) the normalized 41x41 patches from the img corresonding to the keypoint</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_unwarped_patches">
<code class="descclassname">vtool.patch.</code><code class="descname">get_unwarped_patches</code><span class="sig-paren">(</span><em>img</em>, <em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_unwarped_patches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_unwarped_patches" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns cropped unwarped (keypoint is still elliptical) patch around a
keypoint</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em>) – array representing an image</li>
<li><strong>kpts</strong> (<em>ndarrays</em>) – keypoint ndarrays in [x, y, a, c, d, theta] format</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>(patches, subkpts) - the unnormalized patches from the img</dt>
<dd><p class="first last">corresonding to the keypoint</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_warped_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">get_warped_patch</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>kp</em>, <em>gray=False</em>, <em>flags=4</em>, <em>borderMode=1</em>, <em>patch_size=41</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_warped_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_warped_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns warped (into a unit circle) patch around a keypoint</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em>) – array representing an image</li>
<li><strong>kpt</strong> (<em>ndarray</em>) – keypoint ndarray in [x, y, a, c, d, theta] format</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>(wpatch, wkp) the normalized 41x41 patches from</dt>
<dd><p class="first last">the img corresonding to the keypoint</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(ndarray, ndarray)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_warped_patches">
<code class="descclassname">vtool.patch.</code><code class="descname">get_warped_patches</code><span class="sig-paren">(</span><em>img</em>, <em>kpts</em>, <em>flags=4</em>, <em>borderMode=1</em>, <em>patch_size=41</em>, <em>use_cpp=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_warped_patches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_warped_patches" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns warped (into a unit circle) patch around a keypoint</p>
<dl class="docutils">
<dt>FIXME:</dt>
<dd>there is a slight translation difference in the way Python extracts
patches and the way C++ extracts patches. C++ should be correct.
TODO: have C++ able to extract color.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – array representing an image</li>
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – list of keypoint ndarrays in
[[x, y, a, c, d, theta]] format</li>
<li><strong>flags</strong> (<em>long</em>) – cv2 interpolation flags</li>
<li><strong>borderMode</strong> (<em>long</em>) – cv2 border flags</li>
<li><strong>patch_size</strong> (<em>int</em>) – resolution of resulting image patch</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>(warped_patches, warped_subkpts) the normalized 41x41</dt>
<dd><p class="first last">patches from the img corresonding to the keypoint</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(list, list)</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-get_warped_patches –show –use_cpp
python -m vtool.patch –test-get_warped_patches –show –use_python</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cpp</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--use_cpp&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">desc</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">INTER_LANCZOS4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">borderMode</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_REPLICATE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">warped_patches</span><span class="p">,</span> <span class="n">warped_subkpts</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_warped_patches</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">kpts</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">borderMode</span><span class="p">,</span> <span class="n">use_cpp</span><span class="o">=</span><span class="n">use_cpp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">warped_patches</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">warped_subkpts</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">warped_patches</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_kpts2(warped_subkpts, pts=True, rect=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;use_cpp = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">use_cpp</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.gradient_fill">
<code class="descclassname">vtool.patch.</code><code class="descname">gradient_fill</code><span class="sig-paren">(</span><em>shape</em>, <em>theta=0</em>, <em>flip=False</em>, <em>vert=False</em>, <em>style='linear'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gradient_fill"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.gradient_fill" title="Permalink to this definition">¶</a></dt>
<dd><p>FIXME: angle does not work properly</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch gradient_fill –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#style = &#39;linear&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;step&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">gradient_fill</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_uint8</span><span class="p">(</span><span class="n">patch</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.intern_warp_single_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">intern_warp_single_patch</code><span class="sig-paren">(</span><em>img</em>, <em>x</em>, <em>y</em>, <em>ori</em>, <em>V</em>, <em>patch_size</em>, <em>flags=2</em>, <em>borderMode=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#intern_warp_single_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.intern_warp_single_patch" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Sympy:</dt>
<dd><p class="first"># <a class="reference external" href="https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA">https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</a>
from vtool.patch import *  # NOQA
import sympy
from sympy.abc import theta
ori = theta
x, y, a, c, d, patch_size = sympy.symbols(‘x y a c d S’)
half_patch_size = patch_size / 2</p>
<dl class="docutils">
<dt>def sympy_rotation_mat3x3(radians):</dt>
<dd><p class="first"># TODO: handle array impouts
<a href="#id103"><span class="problematic" id="id104">sin_</span></a> = sympy.sin(radians)
<a href="#id105"><span class="problematic" id="id106">cos_</span></a> = sympy.cos(radians)
R = np.array(((<a href="#id107"><span class="problematic" id="id108">cos_</span></a>, -<a href="#id109"><span class="problematic" id="id110">sin_</span></a>,  0),</p>
<blockquote>
<div>(<a href="#id111"><span class="problematic" id="id112">sin_</span></a>,  <a href="#id113"><span class="problematic" id="id114">cos_</span></a>,  0),
(   0,     0,  1),))</div></blockquote>
<p class="last">return sympy.Matrix(R)</p>
</dd>
</dl>
<p>kpts = np.array([[x, y, a, c, d, ori]])
kp = ktool.get_invV_mats(kpts, with_trans=True)[0]
invV = sympy.Matrix(kp)
V = invV.inv()
ss = sympy.sqrt(patch_size) * 3.0
T = sympy.Matrix(ltool.translation_mat3x3(-x, -y, None))  # Center the patch
R = sympy_rotation_mat3x3(-ori)  # Rotate the centered unit circle patch
S = sympy.Matrix(ltool.scale_mat3x3(ss, dtype=None))  # scale from unit circle to the patch size
X = sympy.Matrix(ltool.translation_mat3x3(half_patch_size, half_patch_size, None))  # Translate back to patch-image coordinates</p>
<p>sympy.MatMul(X, S, hold=True)</p>
<dl class="docutils">
<dt>def add_matmul_hold_prop(mat):</dt>
<dd><p class="first">#import functools
def matmul_hold(other, hold=True):</p>
<blockquote>
<div>new = sympy.MatMul(mat, other, hold=hold)
add_matmul_hold_prop(new)
return new</div></blockquote>
<p class="last">#matmul_hold = functools.partial(sympy.MatMul, mat, hold=True)
setattr(mat, ‘matmul_hold’, matmul_hold)</p>
</dd>
</dl>
<p>add_matmul_hold_prop(X)
add_matmul_hold_prop(S)
add_matmul_hold_prop(R)
add_matmul_hold_prop(V)
add_matmul_hold_prop(T)</p>
<p>M = X.matmul_hold(S).matmul_hold(R).matmul_hold(V).matmul_hold(T)
#M = X.multiply(S).multiply(R).multiply(V).multiply(T)</p>
<p class="last">V_full = R.multiply(V).multiply(T)
sympy.latex(V_full)
print(sympy.latex(R.multiply(V).multiply(T)))
print(sympy.latex(X))
print(sympy.latex(S))
print(sympy.latex(R))
print(sympy.latex(invV) + ‘^{-1}’)
print(sympy.latex(T))</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.inverted_sift_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">inverted_sift_patch</code><span class="sig-paren">(</span><em>sift</em>, <em>dim=32</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#inverted_sift_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.inverted_sift_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Idea for inverted sift visualization</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch test_sift_viz –show –name=star
python -m vtool.patch test_sift_viz –show –name=star2
python -m vtool.patch test_sift_viz –show –name=cross
python -m vtool.patch test_sift_viz –show –name=stripe</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_test_patch</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--name&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;star&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sift</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">extract_feature_from_patch</span><span class="p">(</span><span class="n">patch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">siftimg</span> <span class="o">=</span> <span class="n">test_sift_viz</span><span class="p">(</span><span class="n">sift</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Need to do some image blending</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">mpl_sift</span><span class="o">.</span><span class="n">draw_sift_on_patch</span><span class="p">(</span><span class="n">siftimg</span><span class="p">,</span> <span class="n">sift</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch2</span> <span class="o">=</span> <span class="n">patch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_uint8</span><span class="p">(</span><span class="n">patch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_square</span><span class="p">(</span><span class="n">patch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">mpl_sift</span><span class="o">.</span><span class="n">draw_sift_on_patch</span><span class="p">(</span><span class="n">patch2</span><span class="p">,</span> <span class="n">sift</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.make_test_image_keypoints">
<code class="descclassname">vtool.patch.</code><code class="descname">make_test_image_keypoints</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>scale=1.0</em>, <em>skew=0</em>, <em>theta=0</em>, <em>shift=(0</em>, <em>0)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#make_test_image_keypoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.make_test_image_keypoints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.patch_gaussian_weighted_average_intensities">
<code class="descclassname">vtool.patch.</code><code class="descname">patch_gaussian_weighted_average_intensities</code><span class="sig-paren">(</span><em>probchip</em>, <em>kpts_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_gaussian_weighted_average_intensities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.patch_gaussian_weighted_average_intensities" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.patch_gradient">
<code class="descclassname">vtool.patch.</code><code class="descname">patch_gradient</code><span class="sig-paren">(</span><em>patch</em>, <em>ksize=1</em>, <em>gaussian_weighted=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_gradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.patch_gradient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.patch_mag">
<code class="descclassname">vtool.patch.</code><code class="descname">patch_mag</code><span class="sig-paren">(</span><em>gradx</em>, <em>grady</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_mag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.patch_mag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.patch_ori">
<code class="descclassname">vtool.patch.</code><code class="descname">patch_ori</code><span class="sig-paren">(</span><em>gradx</em>, <em>grady</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_ori"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.patch_ori" title="Permalink to this definition">¶</a></dt>
<dd><p>returns patch orientation relative to the x-axis</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.show_gaussian_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">show_gaussian_patch</code><span class="sig-paren">(</span><em>shape</em>, <em>sigma1</em>, <em>sigma2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#show_gaussian_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.show_gaussian_patch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.show_patch_orientation_estimation">
<code class="descclassname">vtool.patch.</code><code class="descname">show_patch_orientation_estimation</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>kpts</em>, <em>patch</em>, <em>gradx</em>, <em>grady</em>, <em>gmag</em>, <em>gori</em>, <em>hist</em>, <em>centers</em>, <em>gori_weights</em>, <em>fx=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#show_patch_orientation_estimation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.show_patch_orientation_estimation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.test_ondisk_find_patch_fpath_dominant_orientations">
<code class="descclassname">vtool.patch.</code><code class="descname">test_ondisk_find_patch_fpath_dominant_orientations</code><span class="sig-paren">(</span><em>patch_fpath</em>, <em>bins=36</em>, <em>maxima_thresh=0.8</em>, <em>DEBUG_ROTINVAR=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#test_ondisk_find_patch_fpath_dominant_orientations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.test_ondisk_find_patch_fpath_dominant_orientations" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>patch_fpath</strong> – </li>
<li><strong>bins</strong> (<em>int</em>) – </li>
<li><strong>maxima_thresh</strong> (<em>float</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-test_ondisk_find_patch_fpath_dominant_orientations</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--patch-fpath&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;star.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_ondisk_find_patch_fpath_dominant_orientations</span><span class="p">(</span><span class="n">patch_fpath</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.test_show_gaussian_patches">
<code class="descclassname">vtool.patch.</code><code class="descname">test_show_gaussian_patches</code><span class="sig-paren">(</span><em>shape=(19</em>, <em>19)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#test_show_gaussian_patches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.test_show_gaussian_patches" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-test_show_gaussian_patches –show
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=7,7
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=17,17
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=41,41
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=29,29
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=41,7</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://matplotlib.org/examples/mplot3d/surface3d_demo.html">http://matplotlib.org/examples/mplot3d/surface3d_demo.html</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">((</span><span class="s1">&#39;--shape&#39;</span><span class="p">,),</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_show_gaussian_patches</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.test_show_gaussian_patches2">
<code class="descclassname">vtool.patch.</code><code class="descname">test_show_gaussian_patches2</code><span class="sig-paren">(</span><em>shape=(19</em>, <em>19)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#test_show_gaussian_patches2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.test_show_gaussian_patches2" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-test_show_gaussian_patches2 –show
python -m vtool.patch –test-test_show_gaussian_patches2 –show –shape=7,7
python -m vtool.patch –test-test_show_gaussian_patches2 –show –shape=19,19
python -m vtool.patch –test-test_show_gaussian_patches2 –show –shape=41,41
python -m vtool.patch –test-test_show_gaussian_patches2 –show –shape=41,7</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://matplotlib.org/examples/mplot3d/surface3d_demo.html">http://matplotlib.org/examples/mplot3d/surface3d_demo.html</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">((</span><span class="s1">&#39;--shape&#39;</span><span class="p">,),</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_show_gaussian_patches2</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.testdata_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">testdata_patch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#testdata_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.testdata_patch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.quality_classifier">
<span id="vtool-quality-classifier-module"></span><h2>vtool.quality_classifier module<a class="headerlink" href="#module-vtool.quality_classifier" title="Permalink to this headline">¶</a></h2>
<p class="rubric">References</p>
<p>% Single-image noise level estimation for blind denoising.
% <a class="reference external" href="http://www.ok.ctrl.titech.ac.jp/res/NLE/TIP2013-noise-level-estimation06607209.pdfhttp://www.ok.ctrl.titech.ac.jp/res/NLE/TIP2013-noise-level-estimation06607209.pdf">http://www.ok.ctrl.titech.ac.jp/res/NLE/TIP2013-noise-level-estimation06607209.pdfhttp://www.ok.ctrl.titech.ac.jp/res/NLE/TIP2013-noise-level-estimation06607209.pdf</a></p>
<dl class="function">
<dt id="vtool.quality_classifier.compute_average_contrast">
<code class="descclassname">vtool.quality_classifier.</code><code class="descname">compute_average_contrast</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/quality_classifier.html#compute_average_contrast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.quality_classifier.compute_average_contrast" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.quality_classifier –exec-compute_average_contrast –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.quality_classifier</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">average_contrast</span><span class="p">,</span> <span class="n">gradmag_sqrd</span> <span class="o">=</span> <span class="n">compute_average_contrast</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:plottool)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gradmag_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.quality_classifier.contrast_measures">
<code class="descclassname">vtool.quality_classifier.</code><code class="descname">contrast_measures</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/quality_classifier.html#contrast_measures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.quality_classifier.contrast_measures" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.quality_classifier.fourier_devtest">
<code class="descclassname">vtool.quality_classifier.</code><code class="descname">fourier_devtest</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/quality_classifier.html#fourier_devtest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.quality_classifier.fourier_devtest" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.quality_classifier –test-fourier_devtest –show</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_imgproc/py_transforms/py_fourier_transform/py_fourier_transform.html">http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_imgproc/py_transforms/py_fourier_transform/py_fourier_transform.html</a>
<a class="reference external" href="http://cns-alumni.bu.edu/~slehar/fourier/fourier.html">http://cns-alumni.bu.edu/~slehar/fourier/fourier.html</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.quality_classifier</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">magnitude_spectrum</span> <span class="o">=</span> <span class="n">fourier_devtest</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.quality_classifier.test_average_contrast">
<code class="descclassname">vtool.quality_classifier.</code><code class="descname">test_average_contrast</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/quality_classifier.html#test_average_contrast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.quality_classifier.test_average_contrast" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.score_normalization">
<span id="vtool-score-normalization-module"></span><h2>vtool.score_normalization module<a class="headerlink" href="#module-vtool.score_normalization" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="vtool.score_normalization.ScoreNormVisualizeClass">
<em class="property">class </em><code class="descclassname">vtool.score_normalization.</code><code class="descname">ScoreNormVisualizeClass</code><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormVisualizeClass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormVisualizeClass" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p># HACK; eventually move all individual plots into a class structure</p>
</dd></dl>

<dl class="class">
<dt id="vtool.score_normalization.ScoreNormalizer">
<em class="property">class </em><code class="descclassname">vtool.score_normalization.</code><code class="descname">ScoreNormalizer</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">utool.util_cache.Cachable</span></code>, <a class="reference internal" href="#vtool.score_normalization.ScoreNormVisualizeClass" title="vtool.score_normalization.ScoreNormVisualizeClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">vtool.score_normalization.ScoreNormVisualizeClass</span></code></a></p>
<p>Conforms to scikit-learn Estimator interface</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –test-ScoreNormalizer –show –cmd</dd>
<dt>Kwargs:</dt>
<dd><p class="first">tpr (float): target true positive rate (default .90)
fpr (float): target false positive rate (default None)
gridsize=1024,
adjust=8,
monotonize=False, if True ensures inferred probability curves are monotonic
clip_factor=None,
reverse (bool): True if lower scores are better, False if higher scores</p>
<blockquote class="last">
<div>are better (default=None)</div></blockquote>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ScoreNormalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">testdata_binary_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>X</em>, <em>y</em>, <em>attrs=None</em>, <em>verbose=False</em>, <em>finite_only=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits estimator to data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>ndarray</em>) – one dimensional scores</li>
<li><strong>y</strong> (<em>ndarray</em>) – binary labels</li>
<li><strong>attrs</strong> (<em>dict</em>) – dictionary of data attributes</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.fit_partitioned">
<code class="descname">fit_partitioned</code><span class="sig-paren">(</span><em>tp_scores</em>, <em>tn_scores</em>, <em>part_attrs=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.fit_partitioned"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.fit_partitioned" title="Permalink to this definition">¶</a></dt>
<dd><p>convinience func to fit only scores that have been separated
instead of labeled</p>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.get_accuracy">
<code class="descname">get_accuracy</code><span class="sig-paren">(</span><em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_accuracy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_accuracy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.get_confusion_indicies">
<code class="descname">get_confusion_indicies</code><span class="sig-paren">(</span><em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_confusion_indicies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_confusion_indicies" title="Permalink to this definition">¶</a></dt>
<dd><p>combination of get_correct_indices and get_error_indicies</p>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.get_correct_indices">
<code class="descname">get_correct_indices</code><span class="sig-paren">(</span><em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_correct_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_correct_indices" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>ndarray</em>) – data</li>
<li><strong>y</strong> (<em>ndarray</em>) – labels</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(fp_indicies, fn_indicies)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –test-get_correct_indices</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">testdata_score_normalier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">tp_indicies</span><span class="p">,</span> <span class="n">tn_indicies</span><span class="p">)</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">get_correct_indices</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">tp_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">tn_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span>    <span class="s1">&#39;tp_X = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">tp_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">tn_X = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">tn_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">tp_X = np.array([ 8.883,  8.77 ,  8.759])</span>
<span class="go">tn_X = np.array([ 0.727,  0.76 ,  0.841])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.get_error_indicies">
<code class="descname">get_error_indicies</code><span class="sig-paren">(</span><em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_error_indicies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_error_indicies" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the indicies of the most difficult type I and type II errors.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">testdata_score_normalier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">fp_indicies</span><span class="p">,</span> <span class="n">fn_indicies</span><span class="p">)</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">get_error_indicies</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fp_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">fp_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">fn_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span>    <span class="s1">&#39;fp_X = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fp_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">fn_X = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fn_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">fp_X = np.array([ 6.196,  5.912,  5.804])</span>
<span class="go">fn_X = np.array([ 3.947,  4.277,  4.43 ])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.get_partitioned_support">
<code class="descname">get_partitioned_support</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_partitioned_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_partitioned_support" title="Permalink to this definition">¶</a></dt>
<dd><p>convinience get prepartitioned data</p>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.get_prefix">
<code class="descname">get_prefix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_prefix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_prefix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.get_support">
<code class="descname">get_support</code><span class="sig-paren">(</span><em>finite_only=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_support" title="Permalink to this definition">¶</a></dt>
<dd><p>return X, y, and attrs</p>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.inverse_normalize">
<code class="descname">inverse_normalize</code><span class="sig-paren">(</span><em>probs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.inverse_normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.inverse_normalize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.learn_probabilities">
<code class="descname">learn_probabilities</code><span class="sig-paren">(</span><em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.learn_probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.learn_probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Kernel density estimation</p>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.learn_threshold">
<code class="descname">learn_threshold</code><span class="sig-paren">(</span><em>verbose=False</em>, <em>**thresh_kw</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.learn_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.learn_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Learns cutoff threshold that achieves the target confusion metric
Typically a desired false positive rate (recall) is specified</p>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.learn_threshold2">
<code class="descname">learn_threshold2</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.learn_threshold2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.learn_threshold2" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a cutoff where the probability of a truepos stats becoming
greater than probability of trueneg</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –exec-learn_threshold2 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder, X, y = testdata_score_normalier([(3.5, 256), (9.5, 1024), (15.5, 2048)], [(6.5, 256), (12.5, 5064), (18.5, 128)], adjust=1, p_tp_method=&#39;ratio&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">testdata_score_normalier</span><span class="p">([(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="p">(</span><span class="mf">9.5</span><span class="p">,</span> <span class="mi">1024</span><span class="p">),</span> <span class="p">(</span><span class="mf">15.5</span><span class="p">,</span> <span class="mi">5064</span><span class="p">)],</span> <span class="p">[(</span><span class="mf">6.5</span><span class="p">,</span> <span class="mi">256</span><span class="p">),</span> <span class="p">(</span><span class="mf">12.5</span><span class="p">,</span> <span class="mi">2048</span><span class="p">),</span> <span class="p">(</span><span class="mf">18.5</span><span class="p">,</span> <span class="mi">128</span><span class="p">)],</span> <span class="n">adjust</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">p_tp_method</span><span class="o">=</span><span class="s1">&#39;ratio&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder, X, y = testdata_score_normalier(adjust=1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder, X, y = testdata_score_normalier([(3.5, 2048)], [(30.5, 128)], tn_scale=.1, adjust=1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder, X, y = testdata_score_normalier([(0, 64)], [(-.1, 12)], adjust=8, min_clip=0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">encoder</span><span class="o">.</span><span class="n">learn_threshold2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exec</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">execstr_dict</span><span class="p">(</span><span class="n">locals_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.plot(xdata[0:-2], np.diff(np.diff(closeness)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#maxima_x, maxima_y, argmaxima = vt.hist_argmaxima(closeness)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fnum</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">multi_plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="p">[</span><span class="n">tp_curve</span><span class="p">,</span> <span class="n">tn_curve</span><span class="p">,</span> <span class="n">closeness</span><span class="p">,</span> <span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">label_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p(tp | s)&#39;</span><span class="p">,</span> <span class="s1">&#39;p(tn | s)&#39;</span><span class="p">,</span> <span class="s1">&#39;closeness&#39;</span><span class="p">,</span> <span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">linewidth_list</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;intersection points&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">xdata</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">closeness</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;closeness maxima&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_submax</span><span class="p">,</span> <span class="n">y_submax</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;chosen&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.plot(xdata[argmaxima], curveness[argmaxima], &#39;rx&#39;, label=&#39;curveness maxima&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.plot(x_submax, y_submax, &#39;o&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">tp_curve</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">tn_curve</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">tp_curve</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">tn_curve</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.plot(xdata[argmaxima], encoder.interp_fn(x_submax), &#39;rx&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_mkinterp</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">assume_sorted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_interp_sgtn</span> <span class="o">=</span> <span class="n">_mkinterp</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">tn_curve</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_interp_sgtp</span> <span class="o">=</span> <span class="n">_mkinterp</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">tp_curve</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_submax</span><span class="p">,</span> <span class="n">_interp_sgtn</span><span class="p">(</span><span class="n">x_submax</span><span class="p">),</span> <span class="s1">&#39;go&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_submax</span><span class="p">,</span> <span class="n">_interp_sgtp</span><span class="p">(</span><span class="n">x_submax</span><span class="p">),</span> <span class="s1">&#39;bx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">multi_plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="p">[</span><span class="n">tp_area</span><span class="p">,</span> <span class="n">fp_area</span><span class="p">,</span> <span class="n">tn_area</span><span class="p">,</span> <span class="n">fn_area</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;intersection areas&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">label_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tp_area&#39;</span><span class="p">,</span> <span class="s1">&#39;fp_area&#39;</span><span class="p">,</span> <span class="s1">&#39;tn_area&#39;</span><span class="p">,</span> <span class="s1">&#39;fn_area&#39;</span><span class="p">],</span> <span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">xdata</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">multi_plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="p">[</span><span class="n">lr_pos</span><span class="p">,</span> <span class="n">lr_neg</span><span class="p">,</span> <span class="n">acc</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;intersection quality (liklihood ratios)&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">label_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lr_pos=tp/fp&#39;</span><span class="p">,</span> <span class="s1">&#39;lr_neg=fn/tn&#39;</span><span class="p">,</span> <span class="s1">&#39;acc&#39;</span><span class="p">],</span> <span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">xdata</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pnum_</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">make_pnum_nextgen</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">_plot_score_support_hist</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder._plot_prebayes(fnum=fnum, pnum=pnum_())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">_plot_postbayes</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">_plot_roc</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">adjust_subplots</span><span class="p">(</span><span class="n">hspace</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">top</span><span class="o">=.</span><span class="mi">95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=.</span><span class="mi">08</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.normalize_scores">
<code class="descname">normalize_scores</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.normalize_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.normalize_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict true or false of <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.visualize">
<code class="descname">visualize</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.visualize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>shows details about the score normalizer</p>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd>fnum
figtitle
with_hist
interactive
with_scores
with_roc
with_precision_recall</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –exec-ScoreNormalizer.visualize:0 –show
python -m vtool.score_normalization –exec-ScoreNormalizer.visualize:1 –show</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># UNSTABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ScoreNormalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">testdata_binary_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_pr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_roc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_hist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># UNSTABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ScoreNormalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">testdata_binary_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_pr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_roc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_hist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_scores</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_prebayes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_postbayes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">target_tpr</span><span class="o">=.</span><span class="mi">95</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.check_unused_kwargs">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">check_unused_kwargs</code><span class="sig-paren">(</span><em>kwargs</em>, <em>expected_keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#check_unused_kwargs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.check_unused_kwargs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.estimate_pdf">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">estimate_pdf</code><span class="sig-paren">(</span><em>data</em>, <em>gridsize=1024</em>, <em>adjust=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#estimate_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.estimate_pdf" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>References;</dt>
<dd><a class="reference external" href="http://statsmodels.sourceforge.net/devel/generated/statsmodels.nonparametric.kde.KDEUnivariate.html">http://statsmodels.sourceforge.net/devel/generated/statsmodels.nonparametric.kde.KDEUnivariate.html</a>
<a class="reference external" href="https://jakevdp.github.io/blog/2013/12/01/kernel-density-estimation/">https://jakevdp.github.io/blog/2013/12/01/kernel-density-estimation/</a></dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>ndarray</em>) – 1 dimensional data of float64</li>
<li><strong>gridsize</strong> (<em>int</em>) – domain size</li>
<li><strong>adjust</strong> (<em>int</em>) – smoothing factor</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">data_pdf</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_pdf</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">estimate_pdf</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_pdf</span><span class="o">.</span><span class="n">support</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">data_pdf</span><span class="o">.</span><span class="n">cdf</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.find_clip_range">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">find_clip_range</code><span class="sig-paren">(</span><em>tp_support</em>, <em>tn_support</em>, <em>clip_factor=2.6180339887499997</em>, <em>reverse=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#find_clip_range"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.find_clip_range" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: generalize to arbitrary domains (not just 0-&gt;inf)</p>
<p>Finds score to clip true positives past. This is useful when the highest
true positive scores can be much larger than the highest true negative
score.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tp_support</strong> (<em>ndarray</em>) – </li>
<li><strong>tn_support</strong> (<em>ndarray</em>) – </li>
<li><strong>clip_factor</strong> (<em>float</em>) – factor of the true negative domain to search for true positives</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">min_score, max_score</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –test-find_clip_range</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">50000</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">110</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clip_factor</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">PHI</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_score</span><span class="p">,</span> <span class="n">max_score</span> <span class="o">=</span> <span class="n">find_clip_range</span><span class="p">(</span><span class="n">tp_support</span><span class="p">,</span> <span class="n">tn_support</span><span class="p">,</span>  <span class="n">clip_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.4f</span><span class="s1">, </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">((</span><span class="n">min_score</span><span class="p">,</span> <span class="n">max_score</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">10.0000, 287.9837</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.flatten_scores">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">flatten_scores</code><span class="sig-paren">(</span><em>tp_scores</em>, <em>tn_scores</em>, <em>part_attrs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#flatten_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.flatten_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>convinience helper to translate partitioned to unpartitioned data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tp_scores</strong> (<em>ndarray</em>) – </li>
<li><strong>tn_scores</strong> (<em>ndarray</em>) – </li>
<li><strong>part_attrs</strong> (<em>dict</em>) – (default = None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(scores, labels, attrs)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –test-flatten_scores</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part_attrs</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;qaid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">]},</span>
<span class="gp">... </span>    <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;qaid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]},</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">flatten_scores</span><span class="p">(</span>
<span class="gp">... </span><span class="n">tp_scores</span><span class="p">,</span> <span class="n">tn_scores</span><span class="p">,</span> <span class="n">part_attrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resdict</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">odict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;attrs&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">resdict</span><span class="p">,</span> <span class="n">nobraces</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="n">explicit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">X=np.array([5, 6, 6, 7, 1, 2, 2]),</span>
<span class="go">y=np.array([1, 1, 1, 1, 0, 0, 0]),</span>
<span class="go">attrs={&#39;qaid&#39;: np.array([21, 24, 25, 26, 11, 14, 15])},</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.get_left_area">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">get_left_area</code><span class="sig-paren">(</span><em>ydata</em>, <em>xdata</em>, <em>index_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#get_left_area"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.get_left_area" title="Permalink to this definition">¶</a></dt>
<dd><p>area to the left of each index point</p>
</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.get_right_area">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">get_right_area</code><span class="sig-paren">(</span><em>ydata</em>, <em>xdata</em>, <em>index_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#get_right_area"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.get_right_area" title="Permalink to this definition">¶</a></dt>
<dd><p>area to the right of each index point</p>
</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.inspect_pdfs">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">inspect_pdfs</code><span class="sig-paren">(</span><em>tn_support</em>, <em>tp_support</em>, <em>score_domain</em>, <em>p_tp_given_score</em>, <em>p_tn_given_score</em>, <em>p_score_given_tp</em>, <em>p_score_given_tn</em>, <em>p_score</em>, <em>prob_thresh=None</em>, <em>score_thresh=None</em>, <em>with_scores=False</em>, <em>with_roc=False</em>, <em>with_precision_recall=False</em>, <em>with_hist=False</em>, <em>fnum=None</em>, <em>figtitle=None</em>, <em>interactive=None</em>, <em>use_stems=None</em>, <em>part_attrs=None</em>, <em>thresh_kw=None</em>, <em>attr_callback=None</em>, <em>with_prebayes=True</em>, <em>with_postbayes=True</em>, <em>score_range=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#inspect_pdfs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.inspect_pdfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows plots of learned thresholds</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –test-ScoreNormalizer –show
python -m vtool.score_normalization –exec-ScoreNormalizer.visualize –show</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.learn_score_normalization">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">learn_score_normalization</code><span class="sig-paren">(</span><em>tp_support</em>, <em>tn_support</em>, <em>gridsize=1024</em>, <em>adjust=8</em>, <em>return_all=False</em>, <em>monotonize=True</em>, <em>clip_factor=2.6180339887499997</em>, <em>verbose=False</em>, <em>reverse=False</em>, <em>p_tp_method='eq'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#learn_score_normalization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.learn_score_normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes collected data and applys parzen window density estimation and bayes rule.</p>
<p>#True positive scores must be larger than true negative scores.
FIXME: might be an issue with pdfs summing to 1 here.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tp_support</strong> (<em>ndarray</em>) – </li>
<li><strong>tn_support</strong> (<em>ndarray</em>) – </li>
<li><strong>gridsize</strong> (<em>int</em>) – default 512</li>
<li><strong>adjust</strong> (<em>int</em>) – default 8</li>
<li><strong>return_all</strong> (<em>bool</em>) – default False</li>
<li><strong>monotonize</strong> (<em>bool</em>) – default True</li>
<li><strong>clip_factor</strong> (<em>float</em>) – default phi ** 2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(score_domain, p_tp_given_score, p_tn_given_score, p_score_given_tp, p_score_given_tn, p_score)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –test-learn_score_normalization</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsize</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adjust</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_all</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">monotonize</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clip_factor</span> <span class="o">=</span> <span class="mf">2.6180339887499997</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">score_domain</span><span class="p">,</span> <span class="n">p_tp_given_score</span><span class="p">)</span> <span class="o">=</span> <span class="n">learn_score_normalization</span><span class="p">(</span><span class="n">tp_support</span><span class="p">,</span> <span class="n">tn_support</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">p_tp_given_score</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">0.99</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.normalize_scores">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">normalize_scores</code><span class="sig-paren">(</span><em>score_domain</em>, <em>p_tp_given_score</em>, <em>scores</em>, <em>interp_fn=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#normalize_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.normalize_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjusts a raw scores to a probabilities based on a learned normalizer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>score_domain</strong> (<em>ndarray</em>) – input score domain</li>
<li><strong>p_tp_given_score</strong> (<em>ndarray</em>) – learned probability mapping</li>
<li><strong>scores</strong> (<em>ndarray</em>) – raw scores</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">probabilities</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –test-normalize_scores</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_tp_given_score</span> <span class="o">=</span> <span class="p">(</span><span class="n">score_domain</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">score_domain</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">9.99</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">11.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prob</span> <span class="o">=</span> <span class="n">normalize_scores</span><span class="p">(</span><span class="n">score_domain</span><span class="p">,</span> <span class="n">p_tp_given_score</span><span class="p">,</span> <span class="n">scores</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#np.set_printoptions(suppress=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress_small</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">score_domain</span><span class="p">,</span> <span class="n">p_tp_given_score</span><span class="p">,</span> <span class="s1">&#39;r-x&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;learned probability&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="s1">&#39;yo&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Normalized scores&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;query points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([ 0.  ,  0.  ,  0.  ,  0.05,  0.64,  1.  ,  1.  ,  1.  ,  1.  ], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.partition_scores">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">partition_scores</code><span class="sig-paren">(</span><em>X</em>, <em>y</em>, <em>attrs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#partition_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.partition_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>convinience helper to translate partitioned to unpartitioned data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tp_scores</strong> (<em>ndarray</em>) – </li>
<li><strong>tn_scores</strong> (<em>ndarray</em>) – </li>
<li><strong>attrs</strong> (<em>dict</em>) – (default = None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(scores, labels, attrs)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –test-partition_scores</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;qaid&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">21</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">])}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">partition_scores</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resdict</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">odict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="s1">&#39;tp_scores&#39;</span><span class="p">,</span> <span class="s1">&#39;tn_scores&#39;</span><span class="p">,</span> <span class="s1">&#39;part_attrs&#39;</span><span class="p">],</span> <span class="n">tup</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">resdict</span><span class="p">,</span> <span class="n">nobraces</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="n">explicit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">tp_scores=np.array([5, 6, 6, 7]),</span>
<span class="go">tn_scores=np.array([1, 2, 2]),</span>
<span class="go">part_attrs={</span>
<span class="go">    False: {&#39;qaid&#39;: np.array([11, 14, 15])},</span>
<span class="go">    True: {&#39;qaid&#39;: np.array([21, 24, 25, 26])},</span>
<span class="go">},</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.plot_postbayes_pdf">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">plot_postbayes_pdf</code><span class="sig-paren">(</span><em>score_domain</em>, <em>p_tn_given_score</em>, <em>p_tp_given_score</em>, <em>score_thresh=None</em>, <em>prob_thresh=None</em>, <em>cfgstr=''</em>, <em>fnum=None</em>, <em>pnum=(1</em>, <em>1</em>, <em>1)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#plot_postbayes_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.plot_postbayes_pdf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.plot_prebayes_pdf">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">plot_prebayes_pdf</code><span class="sig-paren">(</span><em>score_domain</em>, <em>p_score_given_tn</em>, <em>p_score_given_tp</em>, <em>p_score</em>, <em>cfgstr=''</em>, <em>fnum=None</em>, <em>pnum=(1</em>, <em>1</em>, <em>1)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#plot_prebayes_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.plot_prebayes_pdf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.test_score_normalization">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">test_score_normalization</code><span class="sig-paren">(</span><em>tp_support</em>, <em>tn_support</em>, <em>with_scores=True</em>, <em>verbose=True</em>, <em>with_roc=True</em>, <em>with_precision_recall=False</em>, <em>figtitle=None</em>, <em>normkw_varydict=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#test_score_normalization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.test_score_normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives an overview of how well threshold can be learned from raw scores.</p>
<p>DEPRICATE</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –test-test_score_normalization –show</dd>
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/score_normalization.py test_score_normalization</dd>
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># GUI_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Shows how score normalization works with gaussian noise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">randstate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get a training sample</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_support</span> <span class="o">=</span> <span class="n">randstate</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">6.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">256</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_support</span> <span class="o">=</span> <span class="n">randstate</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">256</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:plottool)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_score_normalization</span><span class="p">(</span><span class="n">tp_support</span><span class="p">,</span> <span class="n">tn_support</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.testdata_score_normalier">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">testdata_score_normalier</code><span class="sig-paren">(</span><em>tp_bumps=[(6.5, 256)], tn_bumps=[(3.5, 256)], tp_scale=1.0, tn_scale=1.0, min_clip=None, **kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#testdata_score_normalier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.testdata_score_normalier" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.segmentation">
<span id="vtool-segmentation-module"></span><h2>vtool.segmentation module<a class="headerlink" href="#module-vtool.segmentation" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.segmentation.clean_mask">
<code class="descclassname">vtool.segmentation.</code><code class="descname">clean_mask</code><span class="sig-paren">(</span><em>mask</em>, <em>num_dilate=3</em>, <em>num_erode=3</em>, <em>window_frac=0.025</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#clean_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.clean_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean the mask
(num_erode, num_dilate) = (1, 1)
(w, h) = (10, 10)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.segmentation.demo_grabcut">
<code class="descclassname">vtool.segmentation.</code><code class="descname">demo_grabcut</code><span class="sig-paren">(</span><em>bgr_img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#demo_grabcut"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.demo_grabcut" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.segmentation –test-demo_grabcut –show</dd>
<dt>SeeAlso:</dt>
<dd>python -m wbia.algo.preproc.preproc_probchip –test-postprocess_dev</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.segmentation</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bgr_img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bgr_img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">demo_grabcut</span><span class="p">(</span><span class="n">bgr_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">## xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.segmentation.fill_holes">
<code class="descclassname">vtool.segmentation.</code><code class="descname">fill_holes</code><span class="sig-paren">(</span><em>mask</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#fill_holes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.fill_holes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.segmentation.grabcut">
<code class="descclassname">vtool.segmentation.</code><code class="descname">grabcut</code><span class="sig-paren">(</span><em>bgr_img</em>, <em>prior_mask</em>, <em>binary=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#grabcut"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.grabcut" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Referencs:</dt>
<dd><a class="reference external" href="http://docs.opencv.org/trunk/doc/py_tutorials/py_imgproc/py_grabcut/py_grabcut.html">http://docs.opencv.org/trunk/doc/py_tutorials/py_imgproc/py_grabcut/py_grabcut.html</a></dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.segmentation.grabcut2">
<code class="descclassname">vtool.segmentation.</code><code class="descname">grabcut2</code><span class="sig-paren">(</span><em>rgb_chip</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#grabcut2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.grabcut2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.segmentation.mask_colored_img">
<code class="descclassname">vtool.segmentation.</code><code class="descname">mask_colored_img</code><span class="sig-paren">(</span><em>img_rgb</em>, <em>mask</em>, <em>encoding='bgr'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#mask_colored_img"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.mask_colored_img" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.segmentation.printDBG">
<code class="descclassname">vtool.segmentation.</code><code class="descname">printDBG</code><span class="sig-paren">(</span><em>msg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#printDBG"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.printDBG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.segmentation.resize_img_and_bbox">
<code class="descclassname">vtool.segmentation.</code><code class="descname">resize_img_and_bbox</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>bbox_</em>, <em>new_size=None</em>, <em>sqrt_area=400.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#resize_img_and_bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.resize_img_and_bbox" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.segmentation.segment">
<code class="descclassname">vtool.segmentation.</code><code class="descname">segment</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>bbox_</em>, <em>new_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#segment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs grabcut</p>
</dd></dl>

</div>
<div class="section" id="module-vtool.spatial_verification">
<span id="vtool-spatial-verification-module"></span><h2>vtool.spatial_verification module<a class="headerlink" href="#module-vtool.spatial_verification" title="Permalink to this headline">¶</a></h2>
<p>Spatial verification of keypoint matches</p>
<dl class="docutils">
<dt>Notation::</dt>
<dd>1_m = img1_matches; 2_m = img2_matches
x and y are locations, invV is the elliptical shapes.
fx are the original feature indexes (used for making sure 1 keypoint isn’t assigned to 2)</dd>
<dt>Look Into::</dt>
<dd>Standard
skimage.transform
<a class="reference external" href="http://stackoverflow.com/questions/11462781/fast-2d-rigid-body-transformations-in-numpy-scipy">http://stackoverflow.com/questions/11462781/fast-2d-rigid-body-transformations-in-numpy-scipy</a>
skimage.transform.fast_homography(im, H)</dd>
<dt>FIXME:</dt>
<dd>is it scaled_thresh or scaled_thresh_sqrd</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://ags.cs.uni-kl.de/fileadmin/inf_ags/3dcv-ws11-12/3DCV_WS11-12_lec04.pdf">http://ags.cs.uni-kl.de/fileadmin/inf_ags/3dcv-ws11-12/3DCV_WS11-12_lec04.pdf</a>
<a class="reference external" href="http://www.imgfsr.com/CVPR2011/Tutorial6/RANSAC_CVPR2011.pdf">http://www.imgfsr.com/CVPR2011/Tutorial6/RANSAC_CVPR2011.pdf</a>
<a class="reference external" href="http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf">http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf</a> Page 317</p>
<p class="rubric">Notes</p>
<p>Invariants of affine transforms - parallel lines, ratios of parallel lengths, ratios of areas
Invariants of homographies - cross‐ratio of four points on a line (ratio of ratio)</p>
<dl class="function">
<dt id="vtool.spatial_verification.build_affine_lstsqrs_Mx6">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">build_affine_lstsqrs_Mx6</code><span class="sig-paren">(</span><em>xy1_man</em>, <em>xy2_man</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#build_affine_lstsqrs_Mx6"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.build_affine_lstsqrs_Mx6" title="Permalink to this definition">¶</a></dt>
<dd><p>CURRENTLY NOT WORKING</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification –test-build_affine_lstsqrs_Mx6</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_man</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_man</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Mx6</span> <span class="o">=</span> <span class="n">build_affine_lstsqrs_Mx6</span><span class="p">(</span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">Mx6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">Mx6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Sympy:</dt>
<dd><p class="first">import sympy as sym
x1, y1, x2, y2 = sym.symbols(‘x1, y1, x2, y2’)
A = sym.Matrix([</p>
<blockquote>
<div>[x1, y1,  0,  0, 1, 0],
[ 0,  0, x1, y1, 0, 1],</div></blockquote>
<p class="last">])
b = sym.Matrix([[x2], [y2]])
x = (A.T.multiply(A)).inv().multiply(A.T.multiply(b))
x = (A.T.multiply(A)).pinv().multiply(A.T.multiply(b))</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf">https://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf</a> page 22</p>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.build_lstsqrs_Mx9">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">build_lstsqrs_Mx9</code><span class="sig-paren">(</span><em>xy1_mn</em>, <em>xy2_mn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#build_lstsqrs_Mx9"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.build_lstsqrs_Mx9" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the M x 9 least squares matrix</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification –test-build_lstsqrs_Mx9</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Mx9</span> <span class="o">=</span> <span class="n">build_lstsqrs_Mx9</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">Mx9</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">suppress_small</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[  0.00e+00,   0.00e+00,   0.00e+00,  -3.20e+01,  -2.72e+01,</span>
<span class="go">            -1.00e+00,   8.82e+02,   7.49e+02,   2.76e+01],</span>
<span class="go">          [  3.20e+01,   2.72e+01,   1.00e+00,   0.00e+00,   0.00e+00,</span>
<span class="go">             0.00e+00,  -1.09e+03,  -9.28e+02,  -3.42e+01]], dtype=np.float64)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://dip.sun.ac.za/~stefan/TW793/attach/notes/homography_estimation.pdf">http://dip.sun.ac.za/~stefan/TW793/attach/notes/homography_estimation.pdf</a>
<a class="reference external" href="http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf">http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf</a> Page 317
<a class="reference external" href="http://vision.ece.ucsb.edu/~zuliani/Research/RANSAC/docs/RANSAC4Dummies.pdf">http://vision.ece.ucsb.edu/~zuliani/Research/RANSAC/docs/RANSAC4Dummies.pdf</a> page 53</p>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.compute_affine">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">compute_affine</code><span class="sig-paren">(</span><em>xy1_man</em>, <em>xy2_man</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#compute_affine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.compute_affine" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xy1_mn</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – xy points in image1</li>
<li><strong>xy2_mn</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – corresponding xy points in image 2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A - affine matrix</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[shape=(3,3)]</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification –test-compute_affine:1 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">compute_affine</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy1_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers_normalized</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A_prime</span> <span class="o">=</span> <span class="n">compute_affine</span><span class="p">(</span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span> <span class="n">A_prime</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">T1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">/=</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip2_blendA</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">get_blended_chip</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rchip2_blendA</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">[[  1.19e+00  -1.06e-02  -4.49e+01]</span>
<span class="go"> [ -2.22e-01   1.12e+00  -2.78e+01]</span>
<span class="go"> [  0.00e+00   0.00e+00   1.00e+00]]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.compute_homog">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">compute_homog</code><span class="sig-paren">(</span><em>xy1_mn</em>, <em>xy2_mn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#compute_homog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.compute_homog" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate 6 degrees of freedom homography transformation
Computes homography from normalized (0 to 1) point correspondences
from 2 –&gt; 1
(database-&gt;query)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xy1_mn</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – xy points in image1</li>
<li><strong>xy2_mn</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – corresponding xy points in image 2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">H - homography matrix</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[shape=(3,3)]</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification –test-compute_homog:1 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">compute_homog</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#result = ut.hashstr(H)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[  1.83e-03   2.85e-03  -7.11e-01]</span>
<span class="go"> [  2.82e-03   1.80e-03  -7.03e-01]</span>
<span class="go"> [  1.67e-05   1.68e-05  -5.53e-03]]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers_normalized</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H_prime</span> <span class="o">=</span> <span class="n">compute_homog</span><span class="p">(</span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span> <span class="n">H_prime</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">T1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">/=</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip2_blendH</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">get_blended_chip</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rchip2_blendH</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">[[  9.22e-01  -2.50e-01   2.75e+01]</span>
<span class="go"> [ -2.04e-01   8.79e-01  -7.94e+00]</span>
<span class="go"> [ -1.82e-04  -5.99e-04   1.00e+00]]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.estimate_refined_transform">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">estimate_refined_transform</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>aff_inliers</em>, <em>refine_method='homog'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#estimate_refined_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.estimate_refined_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>estimates final transformation using normalized affine inliers</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/2.4/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html">http://docs.opencv.org/2.4/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.get_affine_inliers">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">get_affine_inliers</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>fs</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh_sqrd</em>, <em>ori_thresh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_affine_inliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.get_affine_inliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates inliers deterministically using elliptical shapes</p>
<p>Compute all transforms from kpts1 to kpts2 (enumerate all hypothesis)
We transform from chip1 -&gt; chip2
The determinants are squared keypoint scales</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">aff_inliers_list, aff_errors_list, Aff_mats</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<dl class="docutils">
<dt>FROM PERDOCH 2009::</dt>
<dd>H = inv(Aj).dot(Rj.T).dot(Ri).dot(Ai)
H = inv(Aj).dot(Ai)
The input invVs = perdoch.invA’s</dd>
<dt>CommandLine:</dt>
<dd>python2 -m vtool.spatial_verification –test-get_affine_inliers
python3 -m vtool.spatial_verification –test-get_affine_inliers</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">make_dummy_fm</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span><span class="p">(</span><span class="o">.</span><span class="mi">009</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh_sqrd</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_thresh</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span><span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">get_affine_inliers</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">scale_thresh_sqrd</span><span class="p">,</span> <span class="n">ori_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_str</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress_small</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;output_str = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">output_str</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_inliers_list</span><span class="p">,</span> <span class="n">aff_errors_list</span><span class="p">,</span> <span class="n">Aff_mats</span> <span class="o">=</span> <span class="n">output</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;nInliers=</span><span class="si">%r</span><span class="s1"> hash=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">aff_inliers_list</span><span class="p">),</span> <span class="n">ut</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">output_str</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.get_best_affine_inliers">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">get_best_affine_inliers</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>fs</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh</em>, <em>ori_thresh</em>, <em>forcepy=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_best_affine_inliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.get_best_affine_inliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests each hypothesis and returns only the best transformation and inliers</p>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.get_best_affine_inliers_">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">get_best_affine_inliers_</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>fs</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh</em>, <em>ori_thresh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_best_affine_inliers_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.get_best_affine_inliers_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.get_normalized_affine_inliers">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">get_normalized_affine_inliers</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>aff_inliers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_normalized_affine_inliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.get_normalized_affine_inliers" title="Permalink to this definition">¶</a></dt>
<dd><p>returns xy-inliers that are normalized to have a mean of 0 and std of 1 as
well as the transformations so the inverse can be taken</p>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.refine_inliers">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">refine_inliers</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>aff_inliers</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh=2.0</em>, <em>ori_thresh=1.57</em>, <em>full_homog_checks=True</em>, <em>refine_method='homog'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#refine_inliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.refine_inliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a set of hypothesis inliers, computes a homography and refines inliers
returned homography maps image1 space into image2 space</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification –test-refine_inliers
python -m vtool.spatial_verification –test-refine_inliers:0
python -m vtool.spatial_verification –test-refine_inliers:1 –show</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">make_dummy_fm</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_inliers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="o">.</span><span class="mi">01</span> <span class="o">*</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_kpts_dlen_sqrd</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homogtup</span> <span class="o">=</span> <span class="n">refine_inliers</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refined_inliers</span><span class="p">,</span> <span class="n">refined_errors</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">homogtup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">homogtup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_small</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup1</span> <span class="o">=</span> <span class="n">refine_inliers</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">homog_tup1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">homog_tup1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">show_sv</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">homog_tup</span><span class="o">=</span><span class="n">homog_tup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.spatially_verify_kpts">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">spatially_verify_kpts</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>xy_thresh=0.01</em>, <em>scale_thresh=2.0</em>, <em>ori_thresh=1.5707963267948966</em>, <em>dlen_sqrd2=None</em>, <em>min_nInliers=4</em>, <em>match_weights=None</em>, <em>returnAff=False</em>, <em>full_homog_checks=True</em>, <em>refine_method='homog'</em>, <em>max_nInliers=5000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#spatially_verify_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.spatially_verify_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Driver function
Spatially validates feature matches</p>
<p>FIXME: there is a non-determenism here</p>
<p>Returned homography maps image1 space into image2 space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts1</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – all keypoints in image 1</li>
<li><strong>kpts2</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – all keypoints in image 2</li>
<li><strong>fm</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – matching keypoint indexes […, (kp1x, kp2x), …]</li>
<li><strong>xy_thresh</strong> (<em>float</em>) – spatial distance threshold under affine transform to
be considered a match</li>
<li><strong>scale_thresh</strong> (<em>float</em>) – </li>
<li><strong>ori_thresh</strong> (<em>float</em>) – </li>
<li><strong>dlen_sqrd2</strong> (<em>float</em>) – diagonal length squared of image/chip 2</li>
<li><strong>min_nInliers</strong> (<em>int</em>) – default=4</li>
<li><strong>returnAff</strong> (<em>bool</em>) – returns best affine hypothesis as well</li>
<li><strong>max_nInliers</strong> (<em>int</em>) – homog is not considered after this threshold</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(refined_inliers, refined_errors, H, aff_inliers, aff_errors, Aff) if success else None</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m xdoctest vtool.spatial_verification spatially_verify_kpts:0 –show
python -m xdoctest vtool.spatial_verification spatially_verify_kpts:0 –show –refine-method=’affine’
python -m xdoctest vtool.spatial_verification spatially_verify_kpts:0 –dpath figures –show –save ~/latex/crall-candidacy-2015/figures/sver_kpts.jpg  # NOQA
python -m xdoctest vtool.spatial_verification spatially_verify_kpts:0</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname1&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname2&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;easy2.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_extract_features_default_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span><span class="p">[</span><span class="s1">&#39;ratio_thresh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">625</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">argparse_dict</span><span class="p">(</span><span class="n">default_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">)</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">testdata_ratio_matches</span><span class="p">(</span><span class="n">fname1</span><span class="p">,</span> <span class="n">fname2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dlen_sqrd2</span> <span class="o">=</span> <span class="mf">447271.015</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_thresh</span> <span class="o">=</span> <span class="mf">1.57</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_nInliers</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">returnAff</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refine_method</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--refine-method&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;homog&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svtup</span> <span class="o">=</span> <span class="n">spatially_verify_kpts</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">xy_thresh</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span><span class="p">,</span> <span class="n">dlen_sqrd2</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">min_nInliers</span><span class="p">,</span> <span class="n">match_weights</span><span class="p">,</span> <span class="n">returnAff</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">refine_method</span><span class="o">=</span><span class="n">refine_method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">svtup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">svtup</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;sver failed&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refined_inliers</span><span class="p">,</span> <span class="n">refined_errors</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">svtup</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_inliers</span><span class="p">,</span> <span class="n">aff_errors</span><span class="p">,</span> <span class="n">Aff</span> <span class="o">=</span> <span class="n">svtup</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print(&#39;aff_errors = %r&#39; % (aff_errors,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;aff_inliers = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">aff_inliers</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;refined_inliers = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">refined_inliers</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print(&#39;refined_errors = %r&#39; % (refined_errors,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_type_profile</span><span class="p">(</span><span class="n">svtup</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#result = ub.repr2(svtup, precision=3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">refined_inliers</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">aff_inliers</span><span class="p">,</span> <span class="n">Aff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">show_sv</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_tup</span><span class="o">=</span><span class="n">aff_tup</span><span class="p">,</span> <span class="n">homog_tup</span><span class="o">=</span><span class="n">homog_tup</span><span class="p">,</span> <span class="n">refine_method</span><span class="o">=</span><span class="n">refine_method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">tuple(numpy.ndarray, tuple(numpy.ndarray*3), numpy.ndarray, numpy.ndarray, tuple(numpy.ndarray*3), numpy.ndarray)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.test_affine_errors">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">test_affine_errors</code><span class="sig-paren">(</span><em>H</em>, <em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh_sqrd</em>, <em>ori_thresh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#test_affine_errors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.test_affine_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>used for refinement as opposed to initial estimation</p>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.test_homog_errors">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">test_homog_errors</code><span class="sig-paren">(</span><em>H</em>, <em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh</em>, <em>ori_thresh</em>, <em>full_homog_checks=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#test_homog_errors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.test_homog_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Test to see which keypoints the homography correctly maps</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>H</strong> (<em>ndarray</em><em>[</em><em>float64_t</em><em>, </em><em>ndim=2</em><em>]</em>) – homography/perspective matrix</li>
<li><strong>kpts1</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>kpts2</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>fm</strong> (<em>list</em>) – list of feature matches as tuples (qfx, dfx)</li>
<li><strong>xy_thresh_sqrd</strong> (<em>float</em>) – </li>
<li><strong>scale_thresh</strong> (<em>float</em>) – </li>
<li><strong>ori_thresh</strong> (<em>float</em>) – angle in radians</li>
<li><strong>full_homog_checks</strong> (<em>bool</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">homog_tup1</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification –test-test_homog_errors:0 –show
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –rotation_invariance
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –rotation_invariance –no-affine-invariance –xy-thresh=.001
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –rotation_invariance –no-affine-invariance –xy-thresh=.001 –no-full-homog-checks
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –no-full-homog-checks
# ————–
# Shows (sorta) how inliers are computed
python -m vtool.spatial_verification –test-test_homog_errors:1 –show
python -m vtool.spatial_verification –test-test_homog_errors:1 –show –rotation_invariance
python -m vtool.spatial_verification –test-test_homog_errors:1 –show –rotation_invariance –no-affine-invariance –xy-thresh=.001
python -m vtool.spatial_verification –test-test_homog_errors:1 –show –rotation_invariance –xy-thresh=.001
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –rotation_invariance –xy-thresh=.001</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">estimate_refined_transform</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.57</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">full_homog_checks</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--no-full-homog-checks&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup1</span> <span class="o">=</span> <span class="n">test_homog_errors</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">,</span> <span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span><span class="p">,</span> <span class="n">full_homog_checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">homog_tup1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">homog_tup1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">show_sv</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">homog_tup</span><span class="o">=</span><span class="n">homog_tup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm_</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">estimate_refined_transform</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm_</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.57</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">full_homog_checks</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--no-full-homog-checks&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ----------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Take subset of feature matches</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">fm_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_err</span><span class="p">,</span> <span class="n">xy_err</span><span class="p">,</span> <span class="n">ori_err</span> <span class="o">=</span> \
<span class="gp">... </span>    <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">test_homog_errors</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="s1">&#39;scale_err, xy_err, ori_err&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># we only care about checking out scale and orientation here. ignore bad xy points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_inliers_flag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">less</span><span class="p">(</span><span class="n">xy_err</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_err</span><span class="p">[</span><span class="o">~</span><span class="n">xy_inliers_flag</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">fm_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scale_err</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="mi">10</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">fm_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scale_err</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="mi">10</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Exec sourcecode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1_m</span><span class="p">,</span> <span class="n">kpts2_m</span><span class="p">,</span> <span class="n">off_xy1_m</span><span class="p">,</span> <span class="n">off_xy1_mt</span><span class="p">,</span> <span class="n">dxy1_m</span><span class="p">,</span> <span class="n">dxy1_mt</span><span class="p">,</span> <span class="n">xy2_m</span><span class="p">,</span> <span class="n">xy1_m</span><span class="p">,</span> <span class="n">xy1_mt</span><span class="p">,</span> <span class="n">scale_err</span><span class="p">,</span> <span class="n">xy_err</span><span class="p">,</span> <span class="n">ori_err</span> <span class="o">=</span> \
<span class="gp">... </span>    <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">test_homog_errors</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="s1">&#39;kpts1_m, kpts2_m, off_xy1_m, off_xy1_mt, dxy1_m, dxy1_mt, xy2_m, xy1_m, xy1_mt, scale_err, xy_err, ori_err&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;orig points and offset point&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy1_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">off_xy1_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">LIGHT_BLUE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;transformed points and matching points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># first have to make corresponding offset points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use reference point for scale and orientation tests</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oris2_m</span>   <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_oris</span><span class="p">(</span><span class="n">kpts2_m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scales2_m</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_scales</span><span class="p">(</span><span class="n">kpts2_m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dxy2_m</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">oris2_m</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">oris2_m</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaled_dxy2_m</span> <span class="o">=</span> <span class="n">dxy2_m</span> <span class="o">*</span> <span class="n">scales2_m</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">off_xy2_m</span> <span class="o">=</span> <span class="n">xy2_m</span> <span class="o">+</span> <span class="n">scaled_dxy2_m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw transformed semgents</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy2_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">off_xy2_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">GREEN</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw corresponding matches semgents</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy1_mt</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">off_xy1_mt</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw matches between correspondences</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy1_mt</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">xy2_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ORANGE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#vt.get _xy_axis_extents(kpts1_m)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_sv.show_sv(rchip1, rchip2, kpts1, kpts2, fm, homog_tup=homog_tup)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.testdata_matching_affine_inliers">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">testdata_matching_affine_inliers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#testdata_matching_affine_inliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.testdata_matching_affine_inliers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.testdata_matching_affine_inliers_normalized">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">testdata_matching_affine_inliers_normalized</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#testdata_matching_affine_inliers_normalized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.testdata_matching_affine_inliers_normalized" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.try_svd">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">try_svd</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#try_svd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.try_svd" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification try_svd</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">build_lstsqrs_Mx9</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">USV</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">compute_uv</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">USV</span> <span class="o">=</span> <span class="n">try_svd</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">(</span><span class="n">wh_num</span><span class="o">=</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">build_lstsqrs_Mx9</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">USV</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">compute_uv</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">USV</span> <span class="o">=</span> <span class="n">try_svd</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.unnormalize_transform">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">unnormalize_transform</code><span class="sig-paren">(</span><em>M_prime</em>, <em>T1</em>, <em>T2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#unnormalize_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.unnormalize_transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="vtool-sver-c-wrapper-module">
<h2>vtool.sver_c_wrapper module<a class="headerlink" href="#vtool-sver-c-wrapper-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-vtool.symbolic">
<span id="vtool-symbolic-module"></span><h2>vtool.symbolic module<a class="headerlink" href="#module-vtool.symbolic" title="Permalink to this headline">¶</a></h2>
<p>Sympy helpers</p>
<dl class="function">
<dt id="vtool.symbolic.check_expr_eq">
<code class="descclassname">vtool.symbolic.</code><code class="descname">check_expr_eq</code><span class="sig-paren">(</span><em>expr1</em>, <em>expr2</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#check_expr_eq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.symbolic.check_expr_eq" title="Permalink to this definition">¶</a></dt>
<dd><p>Does not work in general. Problem is not decidable.
Thanks Richard.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>expr1</strong> – </li>
<li><strong>expr2</strong> – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.symbolic –test-check_expr_eq</dd>
<dt>SeeALso:</dt>
<dd>vt.symbolic_randcheck</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.symbolic</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span> <span class="p">[</span><span class="n">sx</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">tx</span> <span class="o">+</span> <span class="n">w1</span><span class="o">*</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">sy</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">ty</span> <span class="o">+</span> <span class="n">w2</span><span class="o">*</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span> <span class="p">[</span><span class="n">sx</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">tx</span> <span class="o">+</span> <span class="n">w1</span><span class="o">*</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">sy</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">ty</span> <span class="o">+</span> <span class="n">w2</span><span class="o">*</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">check_expr_eq</span><span class="p">(</span><span class="n">expr1</span><span class="p">,</span> <span class="n">expr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.symbolic.custom_sympy_attrs">
<code class="descclassname">vtool.symbolic.</code><code class="descname">custom_sympy_attrs</code><span class="sig-paren">(</span><em>mat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#custom_sympy_attrs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.symbolic.custom_sympy_attrs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.symbolic.evalprint">
<code class="descclassname">vtool.symbolic.</code><code class="descname">evalprint</code><span class="sig-paren">(</span><em>str_</em>, <em>globals_=None</em>, <em>locals_=None</em>, <em>simplify=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#evalprint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.symbolic.evalprint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.symbolic.symbolic_randcheck">
<code class="descclassname">vtool.symbolic.</code><code class="descname">symbolic_randcheck</code><span class="sig-paren">(</span><em>expr1</em>, <em>expr2</em>, <em>domain={}</em>, <em>n=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#symbolic_randcheck"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.symbolic.symbolic_randcheck" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.symbolic.sympy_latex_repr">
<code class="descclassname">vtool.symbolic.</code><code class="descname">sympy_latex_repr</code><span class="sig-paren">(</span><em>expr1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#sympy_latex_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.symbolic.sympy_latex_repr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.symbolic.sympy_mat">
<code class="descclassname">vtool.symbolic.</code><code class="descname">sympy_mat</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#sympy_mat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.symbolic.sympy_mat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.symbolic.sympy_numpy_repr">
<code class="descclassname">vtool.symbolic.</code><code class="descname">sympy_numpy_repr</code><span class="sig-paren">(</span><em>expr1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#sympy_numpy_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.symbolic.sympy_numpy_repr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.trig">
<span id="vtool-trig-module"></span><h2>vtool.trig module<a class="headerlink" href="#module-vtool.trig" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.trig.atan2">
<code class="descclassname">vtool.trig.</code><code class="descname">atan2</code><span class="sig-paren">(</span><em>y</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/trig.html#atan2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.trig.atan2" title="Permalink to this definition">¶</a></dt>
<dd><p>does atan2 but returns from 0 to TAU</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.trig</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">theta</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">theta</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
<span class="go">90fe55311562f1c3ae4...</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.util_math">
<span id="vtool-util-math-module"></span><h2>vtool.util_math module<a class="headerlink" href="#module-vtool.util_math" title="Permalink to this headline">¶</a></h2>
<p># LICENCE Apache 2 or whatever</p>
<p>FIXME: monotization functions need more hueristics</p>
<dl class="function">
<dt id="vtool.util_math.beaton_tukey_loss">
<code class="descclassname">vtool.util_math.</code><code class="descname">beaton_tukey_loss</code><span class="sig-paren">(</span><em>u</em>, <em>a=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#beaton_tukey_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.beaton_tukey_loss" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m wbia.plottool.draw_func2 –exec-plot_func –show –range=-8,8 –func=vt.beaton_tukey_weight,vt.beaton_tukey_loss</dd>
</dl>
<p class="rubric">References</p>
<p>Steward_Robust%20parameter%20estimation%20in%20computer%20vision.pdf</p>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.beaton_tukey_weight">
<code class="descclassname">vtool.util_math.</code><code class="descname">beaton_tukey_weight</code><span class="sig-paren">(</span><em>u</em>, <em>a=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#beaton_tukey_weight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.beaton_tukey_weight" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m wbia.plottool.draw_func2 –exec-plot_func –show –range=-8,8 –func=vt.beaton_tukey_weight</dd>
</dl>
<p class="rubric">References</p>
<p>Steward_Robust%20parameter%20estimation%20in%20computer%20vision.pdf</p>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.breakup_equal_streak">
<code class="descclassname">vtool.util_math.</code><code class="descname">breakup_equal_streak</code><span class="sig-paren">(</span><em>arr_in</em>, <em>left_endpoint=None</em>, <em>right_endpoint=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#breakup_equal_streak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.breakup_equal_streak" title="Permalink to this definition">¶</a></dt>
<dd><p>Breaks up streaks of equal values by interpolating between the next lowest and next highest value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr_in</strong> – </li>
<li><strong>left_endpoint</strong> (<em>None</em>) – (default = None)</li>
<li><strong>right_endpoint</strong> (<em>None</em>) – (default = None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">arr -</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –exec-breakup_equal_streak
python -m vtool.util_math –test-ensure_monotone_strictly_increasing –show –offset=0</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">1.20488135</span><span class="p">,</span>  <span class="mf">1.2529297</span> <span class="p">,</span>  <span class="mf">1.27306686</span><span class="p">,</span>  <span class="mf">1.29859663</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="mf">1.31769871</span><span class="p">,</span> <span class="mf">1.37102388</span><span class="p">,</span>  <span class="mf">1.38114004</span><span class="p">,</span>  <span class="mf">1.45732054</span><span class="p">,</span>  <span class="mf">1.48119571</span><span class="p">,</span>  <span class="mf">1.48119571</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.5381895</span> <span class="p">,</span>  <span class="mf">1.54162741</span><span class="p">,</span>  <span class="mf">1.57492901</span><span class="p">,</span>  <span class="mf">1.61129523</span><span class="p">,</span>  <span class="mf">1.61129523</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.61270343</span><span class="p">,</span>  <span class="mf">1.63377551</span><span class="p">,</span>  <span class="mf">1.7423034</span> <span class="p">,</span>  <span class="mf">1.76364247</span><span class="p">,</span>  <span class="mf">1.79908459</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.83564709</span><span class="p">,</span>  <span class="mf">1.83819742</span><span class="p">,</span>  <span class="mf">1.83819742</span><span class="p">,</span>  <span class="mf">1.86786967</span><span class="p">,</span>  <span class="mf">1.86786967</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.90720142</span><span class="p">,</span>  <span class="mf">1.90720142</span><span class="p">,</span>  <span class="mf">1.92293973</span><span class="p">,</span>  <span class="mf">1.92293973</span><span class="p">,</span> <span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left_endpoint</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right_endpoint</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">breakup_equal_streak</span><span class="p">(</span><span class="n">arr_in</span><span class="p">,</span> <span class="n">left_endpoint</span><span class="p">,</span> <span class="n">right_endpoint</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_increasing</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;arr = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.ensure_monotone_decreasing">
<code class="descclassname">vtool.util_math.</code><code class="descname">ensure_monotone_decreasing</code><span class="sig-paren">(</span><em>arr_</em>, <em>fromleft=True</em>, <em>fromright=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#ensure_monotone_decreasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.ensure_monotone_decreasing" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arr</strong> (<em>ndarray</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">arr</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –test-ensure_monotone_decreasing –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_decreasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">fromright</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fromleft</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.ensure_monotone_increasing">
<code class="descclassname">vtool.util_math.</code><code class="descname">ensure_monotone_increasing</code><span class="sig-paren">(</span><em>arr_</em>, <em>fromright=True</em>, <em>fromleft=True</em>, <em>newmode=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#ensure_monotone_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.ensure_monotone_increasing" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arr</strong> (<em>ndarray</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">arr</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –test-ensure_monotone_increasing –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">argval</span><span class="p">(</span><span class="s1">&#39;--offset&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">2.3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">fromleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fromright</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (increasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.ensure_monotone_strictly_decreasing">
<code class="descclassname">vtool.util_math.</code><code class="descname">ensure_monotone_strictly_decreasing</code><span class="sig-paren">(</span><em>arr_</em>, <em>left_endpoint=None</em>, <em>right_endpoint=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#ensure_monotone_strictly_decreasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.ensure_monotone_strictly_decreasing" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr</strong> (<em>ndarray</em>) – </li>
<li><strong>left_endpoint</strong> (<em>None</em>) – </li>
<li><strong>right_endpoint</strong> (<em>None</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">arr</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –test-ensure_monotone_strictly_decreasing –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">75</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">05</span> <span class="o">+</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#arr_ = vt.demodata.testdata_nonmonotonic()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#domain = np.arange(len(arr_))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left_endpoint</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right_endpoint</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_strictly_decreasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">left_endpoint</span><span class="p">,</span> <span class="n">right_endpoint</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_decreasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s1">&#39;ensure strict monotonic failed&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">ensure_monotone_decreasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (strictly decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.ensure_monotone_strictly_increasing">
<code class="descclassname">vtool.util_math.</code><code class="descname">ensure_monotone_strictly_increasing</code><span class="sig-paren">(</span><em>arr_</em>, <em>left_endpoint=None</em>, <em>right_endpoint=None</em>, <em>zerohack=False</em>, <em>onehack=False</em>, <em>newmode=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#ensure_monotone_strictly_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.ensure_monotone_strictly_increasing" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arr</strong> (<em>ndarray</em>) – sequence to monotonize</li>
<li><strong>zerohack</strong> (<em>bool</em>) – default False, if True sets the first element to be zero and linearlly interpolates to the first nonzero item</li>
<li><strong>onehack</strong> (<em>bool</em>) – default False, if True one will not be in the resulting array (replaced with number very close to one)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="http://mathoverflow.net/questions/17464/making-a-non-monotone-function-monotone">http://mathoverflow.net/questions/17464/making-a-non-monotone-function-monotone</a>
<a class="reference external" href="http://stackoverflow.com/questions/28563711/make-a-numpy-array-monotonic-without-a-python-loop">http://stackoverflow.com/questions/28563711/make-a-numpy-array-monotonic-without-a-python-loop</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Isotonic_regression">https://en.wikipedia.org/wiki/Isotonic_regression</a>
<a class="reference external" href="http://scikit-learn.org/stable/auto_examples/plot_isotonic_regression.html">http://scikit-learn.org/stable/auto_examples/plot_isotonic_regression.html</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –test-ensure_monotone_strictly_increasing –show
python -m vtool.util_math –test-ensure_monotone_strictly_increasing –show –offset=0</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>   <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.91</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_strictly_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_increasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s1">&#39;ensure strict monotonic failed1&#39;</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left_endpoint</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right_endpoint</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--offset&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">2.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#arr_ = vt.demodata.testdata_nonmonotonic()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#domain = np.arange(len(arr_))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_strictly_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">left_endpoint</span><span class="p">,</span> <span class="n">right_endpoint</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">arr</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">non_decreasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s1">&#39;ensure nondecreasing failed2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_increasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s1">&#39;ensure strict monotonic failed2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">ensure_monotone_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (strictly decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.gauss_func1d">
<code class="descclassname">vtool.util_math.</code><code class="descname">gauss_func1d</code><span class="sig-paren">(</span><em>x</em>, <em>mu=0.0</em>, <em>sigma=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#gauss_func1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.gauss_func1d" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> – </li>
<li><strong>mu</strong> (<em>float</em>) – </li>
<li><strong>sigma</strong> (<em>float</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –test-gauss_func1d</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –test-gauss_func1d –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussval</span> <span class="o">=</span> <span class="n">gauss_func1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_repr</span><span class="p">(</span><span class="n">gaussval</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gaussval</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">array([ 0.05,  0.24,  0.35,  0.4 ,  0.35,  0.24,  0.05])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.gauss_func1d_unnormalized">
<code class="descclassname">vtool.util_math.</code><code class="descname">gauss_func1d_unnormalized</code><span class="sig-paren">(</span><em>x</em>, <em>sigma=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#gauss_func1d_unnormalized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.gauss_func1d_unnormalized" title="Permalink to this definition">¶</a></dt>
<dd><p>faster version of gauss_func1d with no normalization. So the maximum point
will have a value of 1.0</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –test-gauss_func1d_unnormalized –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussval</span> <span class="o">=</span> <span class="n">gauss_func1d_unnormalized</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_repr</span><span class="p">(</span><span class="n">gaussval</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gaussval</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">array([ 0.05,  0.24,  0.35,  0.4 ,  0.35,  0.24,  0.05])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.gauss_parzen_est">
<code class="descclassname">vtool.util_math.</code><code class="descname">gauss_parzen_est</code><span class="sig-paren">(</span><em>dist</em>, <em>L=1</em>, <em>sigma=0.38</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#gauss_parzen_est"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.gauss_parzen_est" title="Permalink to this definition">¶</a></dt>
<dd><p>python -m wbia.plottool.draw_func2 –exec-plot_func –show –range=-.2,.2 –func=vt.gauss_parzen_est
python -m wbia.plottool.draw_func2 –exec-plot_func –show –range=0,1 –func=vt.gauss_parzen_est</p>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.group_consecutive">
<code class="descclassname">vtool.util_math.</code><code class="descname">group_consecutive</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#group_consecutive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.group_consecutive" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns lists of consecutive values</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/7352684/how-to-find-the-groups-of-consecutive-elements-from-an-array-in-numpy">http://stackoverflow.com/questions/7352684/how-to-find-the-groups-of-consecutive-elements-from-an-array-in-numpy</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arr</strong> (<em>ndarray</em>) – must be integral and unique</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">arr -</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –exec-group_consecutive</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groups</span> <span class="o">=</span> <span class="n">group_consecutive</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;groups = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">groups</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">groups = [array([1, 2, 3]), array([ 5,  6,  7,  8,  9, 10]), array([15]), array([ 99, 100, 101])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.iceil">
<code class="descclassname">vtool.util_math.</code><code class="descname">iceil</code><span class="sig-paren">(</span><em>num</em>, <em>dtype=&lt;class 'numpy.int32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#iceil"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.iceil" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer ceiling. (because numpy doesn’t seem to have it!)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>num</strong> (<em>ndarray</em><em> or </em><em>scalar</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray or scalar</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –test-iceil</dd>
<dt>Setup:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
</pre></div>
</div>
</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">iceil</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">iceil</span><span class="p">(</span><span class="n">num</span><span class="p">),</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([2, 3], dtype=np.int32)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.interpolate_nans">
<code class="descclassname">vtool.util_math.</code><code class="descname">interpolate_nans</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#interpolate_nans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.interpolate_nans" title="Permalink to this definition">¶</a></dt>
<dd><p>replaces nans with interpolated values or 0</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arr</strong> (<em>ndarray</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">new_arr</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –exec-interpolate_nans</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_arr</span> <span class="o">=</span> <span class="n">interpolate_nans</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;new_arr = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">new_arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">new_arr = [ 0.  0.  0.  0.]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_arr</span> <span class="o">=</span> <span class="n">interpolate_nans</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;new_arr = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">new_arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">new_arr = [  1.    1.    2.8   4.6   6.4   8.2  10.    7.5   5. ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.iround">
<code class="descclassname">vtool.util_math.</code><code class="descname">iround</code><span class="sig-paren">(</span><em>num</em>, <em>dtype=&lt;class 'numpy.int32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#iround"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.iround" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer round. (because numpy doesn’t seem to have it!)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.logistic_01">
<code class="descclassname">vtool.util_math.</code><code class="descname">logistic_01</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#logistic_01"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.logistic_01" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> – </td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –exec-logistic_01 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">logistic_01</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.logit">
<code class="descclassname">vtool.util_math.</code><code class="descname">logit</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#logit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.logit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.util_math.non_decreasing">
<code class="descclassname">vtool.util_math.</code><code class="descname">non_decreasing</code><span class="sig-paren">(</span><em>L</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#non_decreasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.non_decreasing" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.non_increasing">
<code class="descclassname">vtool.util_math.</code><code class="descname">non_increasing</code><span class="sig-paren">(</span><em>L</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#non_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.non_increasing" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.strictly_decreasing">
<code class="descclassname">vtool.util_math.</code><code class="descname">strictly_decreasing</code><span class="sig-paren">(</span><em>L</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#strictly_decreasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.strictly_decreasing" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.strictly_increasing">
<code class="descclassname">vtool.util_math.</code><code class="descname">strictly_increasing</code><span class="sig-paren">(</span><em>L</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#strictly_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.strictly_increasing" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.util_math.test_language_modulus">
<code class="descclassname">vtool.util_math.</code><code class="descname">test_language_modulus</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#test_language_modulus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.util_math.test_language_modulus" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Modulo_operation">http://en.wikipedia.org/wiki/Modulo_operation</a></p>
</dd></dl>

</div>
<div class="section" id="module-vtool">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-vtool" title="Permalink to this headline">¶</a></h2>
<p>VTool - Computer vision tools</p>
<dl class="docutils">
<dt>Autogenerate Command:</dt>
<dd>mkinit vtool -i</dd>
</dl>
<dl class="class">
<dt id="vtool.AnnotPairFeatInfo">
<em class="property">class </em><code class="descclassname">vtool.</code><code class="descname">AnnotPairFeatInfo</code><span class="sig-paren">(</span><em>columns=None</em>, <em>importances=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Information class about feature dimensions of PairwiseMatch.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li>Can be used to compute marginal importances over groups of features</li>
</ul>
<p>used in the pairwise one-vs-one scoring algorithm</p>
<ul class="simple">
<li>Can be used to construct an appropriate cfgdict for a new</li>
</ul>
<p>PairwiseMatch.</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.matching AnnotPairFeatInfo</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">({})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">add_global_measures</span><span class="p">([</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;gps&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;aid1&#39;</span><span class="p">,</span> <span class="s1">&#39;aid2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Feat info without bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">make_feature_vector</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">featinfo</span> <span class="o">=</span> <span class="n">AnnotPairFeatInfo</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pairfeat_cfg</span><span class="p">,</span> <span class="n">global_keys</span> <span class="o">=</span> <span class="n">featinfo</span><span class="o">.</span><span class="n">make_pairfeat_cfg</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pairfeat_cfg = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pairfeat_cfg</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;global_keys = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">global_keys</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;delta&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">global_keys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;max&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">global_keys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">cprint</span><span class="p">(</span><span class="n">featinfo</span><span class="o">.</span><span class="n">get_infostr</span><span class="p">(),</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Feat info with bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">make_feature_vector</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">7</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">],</span> <span class="n">bin_key</span><span class="o">=</span><span class="s1">&#39;ratio&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">featinfo</span> <span class="o">=</span> <span class="n">AnnotPairFeatInfo</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pairfeat_cfg</span><span class="p">,</span> <span class="n">global_keys</span> <span class="o">=</span> <span class="n">featinfo</span><span class="o">.</span><span class="n">make_pairfeat_cfg</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pairfeat_cfg = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr4</span><span class="p">(</span><span class="n">pairfeat_cfg</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;global_keys = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">global_keys</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">cprint</span><span class="p">(</span><span class="n">featinfo</span><span class="o">.</span><span class="n">get_infostr</span><span class="p">(),</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="vtool.AnnotPairFeatInfo.binsum_fmt">
<code class="descname">binsum_fmt</code><em class="property"> = '{op}({measure}[{bin_key}&lt;{binval}])'</em><a class="headerlink" href="#vtool.AnnotPairFeatInfo.binsum_fmt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.dimkey_grammar">
<code class="descname">dimkey_grammar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.dimkey_grammar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.dimkey_grammar" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.matching AnnotPairFeatInfo.dimkey_grammar</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">({})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">add_global_measures</span><span class="p">([</span><span class="s1">&#39;view&#39;</span><span class="p">,</span> <span class="s1">&#39;qual&#39;</span><span class="p">,</span> <span class="s1">&#39;gps&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;aid1&#39;</span><span class="p">,</span> <span class="s1">&#39;aid2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Feat info without bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">make_feature_vector</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">featinfo</span> <span class="o">=</span> <span class="n">AnnotPairFeatInfo</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat_grammar</span> <span class="o">=</span> <span class="n">featinfo</span><span class="o">.</span><span class="n">dimkey_grammar</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">feat_grammar</span><span class="o">.</span><span class="n">parseString</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.feature">
<code class="descname">feature</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.feature"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.feature" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.find">
<code class="descname">find</code><span class="sig-paren">(</span><em>group_id</em>, <em>op</em>, <em>value</em>, <em>hack=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.find"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.find" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>groupid options:</dt>
<dd>measure_type global_measure, local_sorter, local_rank,
local_measure, summary_measure, summary_op, summary_bin,
summary_binval, summary_binkey,</dd>
<dt>Ignore:</dt>
<dd>group_id = ‘summary_op’
op = ‘==’
value = ‘len’</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.get_infostr">
<code class="descname">get_infostr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.get_infostr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.get_infostr" title="Permalink to this definition">¶</a></dt>
<dd><p>Summarizes the types (global, local, summary) of features in X based on
standardized dimension names.</p>
</dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.global_measure">
<code class="descname">global_measure</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.global_measure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.global_measure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.group_counts">
<code class="descname">group_counts</code><span class="sig-paren">(</span><em>item</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.group_counts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.group_counts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.group_importance">
<code class="descname">group_importance</code><span class="sig-paren">(</span><em>item</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.group_importance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.group_importance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.AnnotPairFeatInfo.loc_fmt">
<code class="descname">loc_fmt</code><em class="property"> = 'loc[{sorter},{rank}]({measure})'</em><a class="headerlink" href="#vtool.AnnotPairFeatInfo.loc_fmt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.local_measure">
<code class="descname">local_measure</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.local_measure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.local_measure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.local_rank">
<code class="descname">local_rank</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.local_rank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.local_rank" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.local_sorter">
<code class="descname">local_sorter</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.local_sorter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.local_sorter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.make_pairfeat_cfg">
<code class="descname">make_pairfeat_cfg</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.make_pairfeat_cfg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.make_pairfeat_cfg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.measure">
<code class="descname">measure</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.measure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.measure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.measure_type">
<code class="descname">measure_type</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.measure_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.measure_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.print_counts">
<code class="descname">print_counts</code><span class="sig-paren">(</span><em>group_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.print_counts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.print_counts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.print_margins">
<code class="descname">print_margins</code><span class="sig-paren">(</span><em>group_id</em>, <em>ignore_trivial=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.print_margins"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.print_margins" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.rrr">
<code class="descname">rrr</code><span class="sig-paren">(</span><em>verbose=True</em>, <em>reload_module=True</em><span class="sig-paren">)</span><a class="headerlink" href="#vtool.AnnotPairFeatInfo.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.select_columns">
<code class="descname">select_columns</code><span class="sig-paren">(</span><em>criteria</em>, <em>op='and'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.select_columns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.select_columns" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>criteria</strong> (<em>list</em>) – list of tokens denoting selection constraints
can be one of:
measure_type global_measure, local_sorter, local_rank,
local_measure, summary_measure, summary_op, summary_bin,
summary_binval, summary_binkey,</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">featinfo</span><span class="o">.</span><span class="n">select_columns</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;measure_type&#39;</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;local&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;local_sorter&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;weighted_ratio_score&#39;</span><span class="p">,</span> <span class="s1">&#39;lnbnn_norm_dist&#39;</span><span class="p">]),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">],</span> <span class="n">op</span><span class="o">=</span><span class="s1">&#39;and&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="vtool.AnnotPairFeatInfo.sum_fmt">
<code class="descname">sum_fmt</code><em class="property"> = '{op}({measure})'</em><a class="headerlink" href="#vtool.AnnotPairFeatInfo.sum_fmt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.summary_binkey">
<code class="descname">summary_binkey</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.summary_binkey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.summary_binkey" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.summary_binval">
<code class="descname">summary_binval</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.summary_binval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.summary_binval" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.summary_measure">
<code class="descname">summary_measure</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.summary_measure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.summary_measure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnotPairFeatInfo.summary_op">
<code class="descname">summary_op</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.summary_op"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.summary_op" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="vtool.AnnoyWraper">
<em class="property">class </em><code class="descclassname">vtool.</code><code class="descname">AnnoyWraper</code><a class="reference internal" href="_modules/vtool/clustering2.html#AnnoyWraper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnoyWraper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>flann-like interface to annnoy</p>
<dl class="method">
<dt id="vtool.AnnoyWraper.build_annoy">
<code class="descname">build_annoy</code><span class="sig-paren">(</span><em>centroids</em>, <em>trees=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#AnnoyWraper.build_annoy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnoyWraper.build_annoy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnoyWraper.nn">
<code class="descname">nn</code><span class="sig-paren">(</span><em>data_vecs</em>, <em>query_vecs</em>, <em>num</em>, <em>trees=3</em>, <em>checks=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#AnnoyWraper.nn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnoyWraper.nn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnoyWraper.query_annoy">
<code class="descname">query_annoy</code><span class="sig-paren">(</span><em>query_vecs</em>, <em>num</em>, <em>checks=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#AnnoyWraper.query_annoy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnoyWraper.query_annoy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="vtool.AnnoyWrapper">
<em class="property">class </em><code class="descclassname">vtool.</code><code class="descname">AnnoyWrapper</code><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#AnnoyWrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnoyWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Wrapper for annoy to use the FLANN api</p>
<dl class="method">
<dt id="vtool.AnnoyWrapper.build_index">
<code class="descname">build_index</code><span class="sig-paren">(</span><em>dvecs</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#AnnoyWrapper.build_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnoyWrapper.build_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.AnnoyWrapper.nn_index">
<code class="descname">nn_index</code><span class="sig-paren">(</span><em>qvecs</em>, <em>num_neighbs</em>, <em>checks=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#AnnoyWrapper.nn_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.AnnoyWrapper.nn_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="vtool.AssignTup">
<em class="property">class </em><code class="descclassname">vtool.</code><code class="descname">AssignTup</code><span class="sig-paren">(</span><em>fm</em>, <em>match_dist</em>, <em>norm_fx1</em>, <em>norm_dist</em><span class="sig-paren">)</span><a class="headerlink" href="#vtool.AssignTup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="vtool.AssignTup.fm">
<code class="descname">fm</code><a class="headerlink" href="#vtool.AssignTup.fm" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.AssignTup.match_dist">
<code class="descname">match_dist</code><a class="headerlink" href="#vtool.AssignTup.match_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.AssignTup.norm_dist">
<code class="descname">norm_dist</code><a class="headerlink" href="#vtool.AssignTup.norm_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.AssignTup.norm_fx1">
<code class="descname">norm_fx1</code><a class="headerlink" href="#vtool.AssignTup.norm_fx1" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="vtool.ConfusionMetrics">
<em class="property">class </em><code class="descclassname">vtool.</code><code class="descname">ConfusionMetrics</code><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ConfusionMetrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ubelt.util_mixins.NiceRepr</span></code></p>
<p>Can compute average percision using the PASCAL definition</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://www.flinders.edu.au/science_engineering/fms/School-CSEM/publications/tech_reps-research_artfcts/TRRA_2007.pdf">http://www.flinders.edu.au/science_engineering/fms/School-CSEM/publications/tech_reps-research_artfcts/TRRA_2007.pdf</a>
<a class="reference external" href="http://www.alta.asn.au/events/altss_w2003_proc/altss/courses/powers/Bookmaker-all/200302-ICCS-Bookmaker.pdfcs">http://www.alta.asn.au/events/altss_w2003_proc/altss/courses/powers/Bookmaker-all/200302-ICCS-Bookmaker.pdfcs</a>
<a class="reference external" href="http://www.cs.bris.ac.uk/Publications/Papers/1000704.pdf">http://www.cs.bris.ac.uk/Publications/Papers/1000704.pdf</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Information_retrieval">http://en.wikipedia.org/wiki/Information_retrieval</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Precision_and_recall">http://en.wikipedia.org/wiki/Precision_and_recall</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Confusion_matrix">https://en.wikipedia.org/wiki/Confusion_matrix</a>
<a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_curve.html#sklearn.metrics.roc_curve">http://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_curve.html#sklearn.metrics.roc_curve</a></p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>sklearn.metrics.ranking._binary_clf_curve</dd>
</dl>
<p class="rubric">Notes</p>
<p>From oxford:
Precision is defined as the ratio of retrieved positive images to the</p>
<blockquote>
<div>total number retrieved.</div></blockquote>
<dl class="docutils">
<dt>Recall is defined as the ratio of the number of retrieved positive</dt>
<dd>images to the total number of positive images in the corpus.</dd>
<dt>Ignore:</dt>
<dd>varname_list = ‘tp, fp, fn, tn, fpr, tpr, tpa’.split(‘, ‘)
lines = [‘self.{varname} = {varname}’.format(varname=varname) for varname in varname_list]
print(ut.indent(‘n’.join(lines)))</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.confusion ConfusionMetrics –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">=</span> <span class="n">confusions</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">n_pos</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">n_tp</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">n_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">n_neg</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">n_tn</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">n_fp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">rp</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">rn</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">pp</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">pn</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">fpr</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">tnr</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">fnr</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">tpr</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tpr</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">tp</span> <span class="o">/</span> <span class="n">c</span><span class="o">.</span><span class="n">rp</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tpa</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">tp</span> <span class="o">/</span> <span class="n">c</span><span class="o">.</span><span class="n">pp</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">jacc</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">tp</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tp</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">fn</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">fp</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">mcc</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">mk</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="n">bm</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">c</span><span class="o">.</span><span class="n">acc</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tpr</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">fpr</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">c</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ppv</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">recall</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="n">prev</span> <span class="o">/</span> <span class="n">c</span><span class="o">.</span><span class="n">bias</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">c</span><span class="o">.</span><span class="n">wracc</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tpr</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">fpr</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span><span class="o">.</span><span class="n">draw_roc_curve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="vtool.ConfusionMetrics.acc">
<code class="descname">acc</code><a class="headerlink" href="#vtool.ConfusionMetrics.acc" title="Permalink to this definition">¶</a></dt>
<dd><p>accuracy</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.aliases">
<code class="descname">aliases</code><em class="property"> = {'acc': {'accuracy', 'rand_accuracy', 'tea', 'ter'}, 'bm': {'bookmaker_informedness', &quot;deltaP'&quot;, 'informedness', 'r_R'}, 'cn': {'cost_neg'}, 'cp': {'cost_pos'}, 'cs': {'class_odds', 'skew'}, 'cv': {'cost_ratio'}, 'fn': {'false_neg', 'miss', 'type2_error'}, 'fnr': {'false_neg_rate', 'miss_rate'}, 'fp': {'false_alarm', 'false_pos', 'type1_error'}, 'fpr': {'fallout', 'false_pos_rate'}, 'jacc': {'jaccard_coefficient'}, 'mcc': {'matthews_correlation_coefficient'}, 'mk': {'deltaP', 'markedness', 'r_P'}, 'n_fn': {'n_false_neg', 'n_miss'}, 'n_fp': {'n_false_alarm', 'n_false_pos'}, 'n_tn': {'n_reject', 'n_true_neg'}, 'n_tp': {'n_hit', 'n_true_pos'}, 'pn': {'pred_neg'}, 'pp': {'bias', 'pred_pos'}, 'rn': {'real_neg'}, 'rp': {'prev', 'prevalence', 'real_pos'}, 'tn': {'reject', 'true_neg'}, 'tna': {'inv_precision', 'neg_predict_value', 'npv', 'true_neg_acc'}, 'tnr': {'inv_recall, specificity', 'true_neg_rate'}, 'tp': {'hit', 'true_pos'}, 'tpa': {'pos_predict_value', 'ppv', 'precision', 'true_pos_acc'}, 'tpr': {'hit_rate', 'recall', 'sensitivity', 'true_pos_rate'}, 'wracc': {'weighted_relative_accuracy'}}</em><a class="headerlink" href="#vtool.ConfusionMetrics.aliases" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.auc">
<code class="descname">auc</code><a class="headerlink" href="#vtool.ConfusionMetrics.auc" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>The AUC is a standard measure used to evaluate a binary classifier and</dt>
<dd>represents the probability that a random correct case will
receive a higher score than a random incorrect case.</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic#Area_under_the_curve">https://en.wikipedia.org/wiki/Receiver_operating_characteristic#Area_under_the_curve</a></p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.auc_trap">
<code class="descname">auc_trap</code><a class="headerlink" href="#vtool.ConfusionMetrics.auc_trap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.bm">
<code class="descname">bm</code><a class="headerlink" href="#vtool.ConfusionMetrics.bm" title="Permalink to this definition">¶</a></dt>
<dd><p>bookmaker informedness</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.c">
<code class="descname">c</code><a class="headerlink" href="#vtool.ConfusionMetrics.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.cs">
<code class="descname">cs</code><a class="headerlink" href="#vtool.ConfusionMetrics.cs" title="Permalink to this definition">¶</a></dt>
<dd><p>class ratio</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.cv">
<code class="descname">cv</code><a class="headerlink" href="#vtool.ConfusionMetrics.cv" title="Permalink to this definition">¶</a></dt>
<dd><p>ratio of cost of making a mistake</p>
</dd></dl>

<dl class="method">
<dt id="vtool.ConfusionMetrics.draw_precision_recall_curve">
<code class="descname">draw_precision_recall_curve</code><span class="sig-paren">(</span><em>nSamples=11</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.draw_precision_recall_curve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ConfusionMetrics.draw_precision_recall_curve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.ConfusionMetrics.draw_roc_curve">
<code class="descname">draw_roc_curve</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.draw_roc_curve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ConfusionMetrics.draw_roc_curve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.ConfusionMetrics.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>scores</em>, <em>labels</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ConfusionMetrics.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.fn">
<code class="descname">fn</code><a class="headerlink" href="#vtool.ConfusionMetrics.fn" title="Permalink to this definition">¶</a></dt>
<dd><p>false negative probability</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.fnr">
<code class="descname">fnr</code><a class="headerlink" href="#vtool.ConfusionMetrics.fnr" title="Permalink to this definition">¶</a></dt>
<dd><p>miss rate, false negative rate</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.fp">
<code class="descname">fp</code><a class="headerlink" href="#vtool.ConfusionMetrics.fp" title="Permalink to this definition">¶</a></dt>
<dd><p>false positive probability</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.fpr">
<code class="descname">fpr</code><a class="headerlink" href="#vtool.ConfusionMetrics.fpr" title="Permalink to this definition">¶</a></dt>
<dd><p>fallout, false positive rate</p>
</dd></dl>

<dl class="classmethod">
<dt id="vtool.ConfusionMetrics.from_tp_and_tn_scores">
<em class="property">classmethod </em><code class="descname">from_tp_and_tn_scores</code><span class="sig-paren">(</span><em>tp_scores</em>, <em>tn_scores</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.from_tp_and_tn_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ConfusionMetrics.from_tp_and_tn_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.ConfusionMetrics.get_ave_precision">
<code class="descname">get_ave_precision</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_ave_precision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ConfusionMetrics.get_ave_precision" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.ConfusionMetrics.get_fpr_at_recall">
<code class="descname">get_fpr_at_recall</code><span class="sig-paren">(</span><em>target_recall</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_fpr_at_recall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ConfusionMetrics.get_fpr_at_recall" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.ConfusionMetrics.get_index_at_metric">
<code class="descname">get_index_at_metric</code><span class="sig-paren">(</span><em>at_metric</em>, <em>at_value</em>, <em>subindex=False</em>, <em>tiebreaker='maxthresh'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_index_at_metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ConfusionMetrics.get_index_at_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the index that is closet to the metric at a given value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tiebreaker</strong> (<em>str</em>) – either ‘minimize’ or ‘maximize’
if ‘maximize’, then a larger threshold is considered better
when resolving ambiguities. Otherwise a smaller thresh is
better.</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Doctest:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pat1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pat2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pat3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pat4</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pats</span> <span class="o">=</span> <span class="p">[</span><span class="n">pat1</span><span class="p">,</span> <span class="n">pat2</span><span class="p">,</span> <span class="n">pat3</span><span class="p">,</span> <span class="n">pat4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">itertools</span> <span class="k">as</span> <span class="nn">it</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create places of ambiguitiy and unambiguity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">flatten</span><span class="p">([[</span><span class="nb">next</span><span class="p">(</span><span class="n">s</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">pat</span><span class="p">)</span> <span class="k">for</span> <span class="n">pat</span> <span class="ow">in</span> <span class="n">pats</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">flatten</span><span class="p">([</span><span class="n">pat</span> <span class="k">for</span> <span class="n">pat</span> <span class="ow">in</span> <span class="n">pats</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">at_metric</span> <span class="o">=</span> <span class="s1">&#39;n_false_pos&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">at_value</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subindex</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index_at_metric</span><span class="p">(</span><span class="n">at_metric</span><span class="p">,</span> <span class="n">at_value</span><span class="p">,</span> <span class="n">subindex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tiebreaker</span><span class="o">=</span><span class="s1">&#39;minthresh&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index_at_metric</span><span class="p">(</span><span class="n">at_metric</span><span class="p">,</span> <span class="n">at_value</span><span class="p">,</span> <span class="n">subindex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tiebreaker</span><span class="o">=</span> <span class="s1">&#39;maxthresh&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">idx1</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">idx2</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="vtool.ConfusionMetrics.get_metric_at_index">
<code class="descname">get_metric_at_index</code><span class="sig-paren">(</span><em>metric</em>, <em>subindex</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_metric_at_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ConfusionMetrics.get_metric_at_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.ConfusionMetrics.get_metric_at_metric">
<code class="descname">get_metric_at_metric</code><span class="sig-paren">(</span><em>get_metric</em>, <em>at_metric</em>, <em>at_value</em>, <em>subindex=False</em>, <em>tiebreaker='maxthresh'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_metric_at_metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ConfusionMetrics.get_metric_at_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the corresponding value of <cite>get_metric</cite> at a specific value of
<cite>at_metric</cite>.</p>
<p>get_metric = ‘fpr’
at_metric = ‘tpr’
at_value = .25
self.rrr()</p>
<p>self.get_metric_at_metric(‘fpr’, ‘tpr’, .25)
self.get_metric_at_metric(‘n_false_pos’, ‘tpr’, .25)
self.get_metric_at_metric(‘n_true_pos’, ‘tpr’, .25)</p>
<p>get_metric = ‘n_true_pos’
at_metric = ‘n_false_pos’
at_value = 0
subindex = False</p>
</dd></dl>

<dl class="method">
<dt id="vtool.ConfusionMetrics.get_metric_at_thresh">
<code class="descname">get_metric_at_thresh</code><span class="sig-paren">(</span><em>metric</em>, <em>thresh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_metric_at_thresh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ConfusionMetrics.get_metric_at_thresh" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>metric</strong> (<em>str</em>) – name of a metric</li>
<li><strong>thresh</strong> (<em>float</em>) – desired threshold</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">value - metric value</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.confusion –exec-get_metric_at_threshold</dd>
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">cfms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;fpr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;tpr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metric_at_thresh</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(None, None) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">((</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.ConfusionMetrics.get_recall_at_fpr">
<code class="descname">get_recall_at_fpr</code><span class="sig-paren">(</span><em>target_fpr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_recall_at_fpr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ConfusionMetrics.get_recall_at_fpr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.ConfusionMetrics.get_thresh_at_metric">
<code class="descname">get_thresh_at_metric</code><span class="sig-paren">(</span><em>metric</em>, <em>value</em>, <em>maximize=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_thresh_at_metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ConfusionMetrics.get_thresh_at_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets a threshold for a binary classifier using a target metric and value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>metric</strong> (<em>str</em>) – name of metric like tpr or fpr</li>
<li><strong>value</strong> (<em>float</em>) – corresponding numeric value</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">thresh</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.confusion get_thresh_at_metric
python -m vtool.confusion –exec-interact_roc_factory –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;tpr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="o">.</span><span class="mi">85</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_thresh_at_metric</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">value</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;thresh = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">thresh</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">thresh = 22.5</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd>metric = ‘fpr’
value = 1e-4
self = cfms
maximize = False</dd>
</dl>
<p>interpolate_replbounds(metric_values, self.thresholds, 0, maximize=maximize)
interpolate_replbounds(metric_values, self.thresholds, 1e-4, maximize=maximize)
interpolate_replbounds(metric_values, self.thresholds, 1e-3, maximize=maximize)
interpolate_replbounds(metric_values, self.thresholds, 1e-2, maximize=maximize)
interpolate_replbounds(metric_values, self.thresholds, 1e-2, maximize=maximize)</p>
</dd></dl>

<dl class="method">
<dt id="vtool.ConfusionMetrics.get_thresh_at_metric_max">
<code class="descname">get_thresh_at_metric_max</code><span class="sig-paren">(</span><em>metric</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_thresh_at_metric_max"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ConfusionMetrics.get_thresh_at_metric_max" title="Permalink to this definition">¶</a></dt>
<dd><p>metric = ‘mcc’
metric = ‘fnr’</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.inv_aliases">
<code class="descname">inv_aliases</code><em class="property"> = {'acc': 'acc', 'accuracy': 'acc', 'bias': 'pp', 'bm': 'bm', 'bookmaker_informedness': 'bm', 'class_odds': 'cs', 'cn': 'cn', 'cost_neg': 'cn', 'cost_pos': 'cp', 'cost_ratio': 'cv', 'cp': 'cp', 'cs': 'cs', 'cv': 'cv', 'deltaP': 'mk', &quot;deltaP'&quot;: 'bm', 'fallout': 'fpr', 'false_alarm': 'fp', 'false_neg': 'fn', 'false_neg_rate': 'fnr', 'false_pos': 'fp', 'false_pos_rate': 'fpr', 'fn': 'fn', 'fnr': 'fnr', 'fp': 'fp', 'fpr': 'fpr', 'hit': 'tp', 'hit_rate': 'tpr', 'informedness': 'bm', 'inv_precision': 'tna', 'inv_recall, specificity': 'tnr', 'jacc': 'jacc', 'jaccard_coefficient': 'jacc', 'markedness': 'mk', 'matthews_correlation_coefficient': 'mcc', 'mcc': 'mcc', 'miss': 'fn', 'miss_rate': 'fnr', 'mk': 'mk', 'n_false_alarm': 'n_fp', 'n_false_neg': 'n_fn', 'n_false_pos': 'n_fp', 'n_fn': 'n_fn', 'n_fp': 'n_fp', 'n_hit': 'n_tp', 'n_miss': 'n_fn', 'n_reject': 'n_tn', 'n_tn': 'n_tn', 'n_tp': 'n_tp', 'n_true_neg': 'n_tn', 'n_true_pos': 'n_tp', 'neg_predict_value': 'tna', 'npv': 'tna', 'pn': 'pn', 'pos_predict_value': 'tpa', 'pp': 'pp', 'ppv': 'tpa', 'precision': 'tpa', 'pred_neg': 'pn', 'pred_pos': 'pp', 'prev': 'rp', 'prevalence': 'rp', 'r_P': 'mk', 'r_R': 'bm', 'rand_accuracy': 'acc', 'real_neg': 'rn', 'real_pos': 'rp', 'recall': 'tpr', 'reject': 'tn', 'rn': 'rn', 'rp': 'rp', 'sensitivity': 'tpr', 'skew': 'cs', 'tea': 'acc', 'ter': 'acc', 'tn': 'tn', 'tna': 'tna', 'tnr': 'tnr', 'tp': 'tp', 'tpa': 'tpa', 'tpr': 'tpr', 'true_neg': 'tn', 'true_neg_acc': 'tna', 'true_neg_rate': 'tnr', 'true_pos': 'tp', 'true_pos_acc': 'tpa', 'true_pos_rate': 'tpr', 'type1_error': 'fp', 'type2_error': 'fn', 'weighted_relative_accuracy': 'wracc', 'wracc': 'wracc'}</em><a class="headerlink" href="#vtool.ConfusionMetrics.inv_aliases" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.jacc">
<code class="descname">jacc</code><a class="headerlink" href="#vtool.ConfusionMetrics.jacc" title="Permalink to this definition">¶</a></dt>
<dd><p>jaccard coefficient</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.mcc">
<code class="descname">mcc</code><a class="headerlink" href="#vtool.ConfusionMetrics.mcc" title="Permalink to this definition">¶</a></dt>
<dd><p>matthews correlation coefficient</p>
<dl class="docutils">
<dt>Also true that:</dt>
<dd>mcc == np.sqrt(self.bm * self.mk)</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.minimizing_metrics">
<code class="descname">minimizing_metrics</code><em class="property"> = {'fn', 'fnr', 'fp', 'fpr'}</em><a class="headerlink" href="#vtool.ConfusionMetrics.minimizing_metrics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.mk">
<code class="descname">mk</code><a class="headerlink" href="#vtool.ConfusionMetrics.mk" title="Permalink to this definition">¶</a></dt>
<dd><p>markedness</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.paper_alias">
<code class="descname">paper_alias</code><em class="property"> = [['dtp', 'determinant'], ['lr', 'liklihood-ratio'], ['nlr', 'negative-liklihood-ratio'], ['bmg', 'bookmarkG', 'bookmark_geometric_mean', 'mcc?'], ['evenness_R', 'PrevG2'], ['evenness_P', 'BiasG2'], ['rh', 'real_harmonic_mean'], ['ph', 'pred_harminic_mean']]</em><a class="headerlink" href="#vtool.ConfusionMetrics.paper_alias" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.paper_relations">
<code class="descname">paper_relations</code><em class="property"> = {'BMG': ['dtp / evenness_G'], 'BiasG2': ['bias * 1 - bias'], 'IBias': ['1 - Bias'], 'N': ['A + B + C + D'], 'bm': ['dtp / (prev * (1 - prev))'], 'deltap': ['dtp - dtn', '2 * dp'], 'dp': ['tp - etp', 'dtp', '-dtn', '-(tn - etn)'], 'dtp': ['A * D - B * C'], 'etn': ['rn * pn', 'expected_true_negatives'], 'etp': ['rp * pp', 'expected_true_positives'], 'kappa': ['deltap / (deltap + (fp + fn) / 2)'], 'lr': ['tpr / (1 - tnr)'], 'mk': ['dtp / (bias * (1 - bias))', 'dtp / biasG ** 2'], 'nlr': ['tnr / (1 - tpr)'], 'ph': ['2 * pp * pn / (pp + pn)', 'pred_harminic_mean'], 'rh': ['2 * rp * rn / (rp + rn)', 'real_harmonic_mean']}</em><a class="headerlink" href="#vtool.ConfusionMetrics.paper_relations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.ConfusionMetrics.plot_metrics">
<code class="descname">plot_metrics</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.plot_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ConfusionMetrics.plot_metrics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.ConfusionMetrics.plot_vs">
<code class="descname">plot_vs</code><span class="sig-paren">(</span><em>x_metric</em>, <em>y_metric</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.plot_vs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ConfusionMetrics.plot_vs" title="Permalink to this definition">¶</a></dt>
<dd><p>x_metric = ‘thresholds’
y_metric = ‘fpr’</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.pn">
<code class="descname">pn</code><a class="headerlink" href="#vtool.ConfusionMetrics.pn" title="Permalink to this definition">¶</a></dt>
<dd><p>predicted negative probability</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.pp">
<code class="descname">pp</code><a class="headerlink" href="#vtool.ConfusionMetrics.pp" title="Permalink to this definition">¶</a></dt>
<dd><p>predicted positive probability</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.rn">
<code class="descname">rn</code><a class="headerlink" href="#vtool.ConfusionMetrics.rn" title="Permalink to this definition">¶</a></dt>
<dd><p>real negative probability</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.rp">
<code class="descname">rp</code><a class="headerlink" href="#vtool.ConfusionMetrics.rp" title="Permalink to this definition">¶</a></dt>
<dd><p>real positive probability</p>
</dd></dl>

<dl class="method">
<dt id="vtool.ConfusionMetrics.show_mcc">
<code class="descname">show_mcc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.show_mcc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ConfusionMetrics.show_mcc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.sqrd_error">
<code class="descname">sqrd_error</code><a class="headerlink" href="#vtool.ConfusionMetrics.sqrd_error" title="Permalink to this definition">¶</a></dt>
<dd><p>squared error</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.thresh">
<code class="descname">thresh</code><a class="headerlink" href="#vtool.ConfusionMetrics.thresh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.tn">
<code class="descname">tn</code><a class="headerlink" href="#vtool.ConfusionMetrics.tn" title="Permalink to this definition">¶</a></dt>
<dd><p>true negative probability</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.tna">
<code class="descname">tna</code><a class="headerlink" href="#vtool.ConfusionMetrics.tna" title="Permalink to this definition">¶</a></dt>
<dd><p>negative predictive value, inverse precision</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.tnr">
<code class="descname">tnr</code><a class="headerlink" href="#vtool.ConfusionMetrics.tnr" title="Permalink to this definition">¶</a></dt>
<dd><p>true negative rate, inverse recall</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.tp">
<code class="descname">tp</code><a class="headerlink" href="#vtool.ConfusionMetrics.tp" title="Permalink to this definition">¶</a></dt>
<dd><p>true positive probability</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.tpa">
<code class="descname">tpa</code><a class="headerlink" href="#vtool.ConfusionMetrics.tpa" title="Permalink to this definition">¶</a></dt>
<dd><p>miss rate, false negative rate</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.tpr">
<code class="descname">tpr</code><a class="headerlink" href="#vtool.ConfusionMetrics.tpr" title="Permalink to this definition">¶</a></dt>
<dd><p>sensitivity, recall, hit rate, tpr</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.ConfusionMetrics.wracc">
<code class="descname">wracc</code><a class="headerlink" href="#vtool.ConfusionMetrics.wracc" title="Permalink to this definition">¶</a></dt>
<dd><p>weighted relative accuracy</p>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="vtool.DEFAULT_DTYPE">
<code class="descclassname">vtool.</code><code class="descname">DEFAULT_DTYPE</code><a class="headerlink" href="#vtool.DEFAULT_DTYPE" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.float32</span></code></p>
</dd></dl>

<dl class="function">
<dt id="vtool.GaussianBlurInplace">
<code class="descclassname">vtool.</code><code class="descname">GaussianBlurInplace</code><span class="sig-paren">(</span><em>img</em>, <em>sigma</em>, <em>size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#GaussianBlurInplace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.GaussianBlurInplace" title="Permalink to this definition">¶</a></dt>
<dd><p>simulates code from helpers.cpp in hesaff</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray</em>) – </li>
<li><strong>sigma</strong> (<em>flaot</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-GaussianBlurInplace:0 –show
python -m vtool.patch –test-GaussianBlurInplace:1 –show</dd>
<dt>References;</dt>
<dd><a class="reference external" href="http://www.cse.usf.edu/~r1k/MachineVisionBook/MachineVision.files/MachineVision_Chapter4.pdf">http://www.cse.usf.edu/~r1k/MachineVisionBook/MachineVision.files/MachineVision_Chapter4.pdf</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Scale_space_implementation">http://en.wikipedia.org/wiki/Scale_space_implementation</a>
<a class="reference external" href="http://www.cse.psu.edu/~rtc12/CSE486/lecture10_6pp.pdf">http://www.cse.psu.edu/~rtc12/CSE486/lecture10_6pp.pdf</a></dd>
</dl>
<p class="rubric">Notes</p>
<p>The product of the convolution of two Gaussian functions with spread
sigma is a Gaussian function with spread sqrt(2)*sigma scaled by the
area of the Gaussian filter</p>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">get_test_patch</span><span class="p">(</span><span class="s1">&#39;star2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_orig</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="mf">2.0</span> <span class="o">*</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="ow">not</span> <span class="n">size</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># check if even</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">size</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ksize</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_orig</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># demonstrate cascading smoothing property</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># THIS ISNT WORKING WHY???</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">get_test_patch</span><span class="p">(</span><span class="s1">&#39;star2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img3</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img4</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_orig</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma1</span> <span class="o">=</span> <span class="o">.</span><span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma2</span> <span class="o">=</span> <span class="o">.</span><span class="mi">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma3</span> <span class="o">=</span> <span class="n">sigma1</span> <span class="o">+</span> <span class="n">sigma2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># components</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img2</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># all in one shot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img3</span><span class="p">,</span> <span class="n">sigma3</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># addative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img4</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img4</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">img4</span> <span class="o">-</span> <span class="n">img3</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ksize</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#fig.add_subplot(1, 3, 1, projection=&#39;3d&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma3</span><span class="p">,</span> <span class="n">sigma3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_orig</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img1</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img2</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img4</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1"> + </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma1</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="vtool.INDEX_DTYPE">
<code class="descclassname">vtool.</code><code class="descname">INDEX_DTYPE</code><a class="headerlink" href="#vtool.INDEX_DTYPE" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.int32</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.KPTS_DTYPE">
<code class="descclassname">vtool.</code><code class="descname">KPTS_DTYPE</code><a class="headerlink" href="#vtool.KPTS_DTYPE" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.float32</span></code></p>
</dd></dl>

<dl class="function">
<dt id="vtool.L1">
<code class="descclassname">vtool.</code><code class="descname">L1</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em>, <em>dtype=&lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.L1" title="Permalink to this definition">¶</a></dt>
<dd><p>returns L1 (aka manhatten or grid) distance between two histograms</p>
</dd></dl>

<dl class="function">
<dt id="vtool.L2">
<code class="descclassname">vtool.</code><code class="descname">L2</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.L2" title="Permalink to this definition">¶</a></dt>
<dd><p>returns L2 (aka euclidean or standard) distance between two histograms</p>
</dd></dl>

<dl class="function">
<dt id="vtool.L2_root_sift">
<code class="descclassname">vtool.</code><code class="descname">L2_root_sift</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2_root_sift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.L2_root_sift" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalized Root-SIFT L2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hist1</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</li>
<li><strong>hist2</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">euclidean distance between 0-1 normalized sift descriptors</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.L2_sift">
<code class="descclassname">vtool.</code><code class="descname">L2_sift</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2_sift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.L2_sift" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalized SIFT L2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hist1</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</li>
<li><strong>hist2</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">euclidean distance between 0-1 normalized sift descriptors</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance –test-L2_sift</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sift1</span><span class="p">,</span> <span class="n">sift2</span><span class="p">,</span> <span class="n">sift3</span><span class="p">,</span> <span class="n">sift4</span><span class="p">,</span> <span class="n">sift5</span> <span class="o">=</span> <span class="n">testdata_sift2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2_dist</span> <span class="o">=</span> <span class="n">L2_sift</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dist</span> <span class="o">=</span> <span class="n">L2_sift</span><span class="p">(</span><span class="n">sift4</span><span class="p">,</span> <span class="n">sift5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">max_dist</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">l2_dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.L2_sift_sqrd">
<code class="descclassname">vtool.</code><code class="descname">L2_sift_sqrd</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2_sift_sqrd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.L2_sift_sqrd" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalized SIFT L2**2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hist1</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</li>
<li><strong>hist2</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">squared euclidean distance between 0-1 normalized sift descriptors</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.L2_sqrd">
<code class="descclassname">vtool.</code><code class="descname">L2_sqrd</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em>, <em>dtype=&lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2_sqrd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.L2_sqrd" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the squared L2 distance</p>
<dl class="docutils">
<dt># FIXME:</dt>
<dd>if hist1.shape = (0,) and hist.shape = (0,) then result=0.0</dd>
<dt>SeeAlso:</dt>
<dd>L2</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">exec_funckw</span><span class="p">(</span><span class="n">L2_sqrd</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2dist</span> <span class="o">=</span> <span class="n">L2_sqrd</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">l2dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="exception">
<dt id="vtool.MatchingError">
<em class="property">exception </em><code class="descclassname">vtool.</code><code class="descname">MatchingError</code><a class="reference internal" href="_modules/vtool/matching.html#MatchingError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.MatchingError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="class">
<dt id="vtool.PairwiseMatch">
<em class="property">class </em><code class="descclassname">vtool.</code><code class="descname">PairwiseMatch</code><span class="sig-paren">(</span><em>annot1=None</em>, <em>annot2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.PairwiseMatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ubelt.util_mixins.NiceRepr</span></code></p>
<p>Newest (Sept-16-2016) object oriented one-vs-one matching interface</p>
<p>Creates an object holding two annotations
Then a pipeline of operations can be applied to
generate score and refine the matches</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The annotation dictionaries are required to have certain attributes.</p>
<dl class="last docutils">
<dt>Required annotation attributes:</dt>
<dd>(kpts, vecs) OR rchip OR rchip_fpath</dd>
<dt>Optional annotation attributes:</dt>
<dd>aid, nid, flann, rchip, dlen_sqrd, weight</dd>
</dl>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgL</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy2.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rchip&#39;</span><span class="p">:</span> <span class="n">imgR</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rchip&#39;</span><span class="p">:</span> <span class="n">imgL</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">PairwiseMatch</span><span class="p">(</span><span class="n">annot1</span><span class="p">,</span> <span class="n">annot2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">apply_all</span><span class="p">({</span><span class="s1">&#39;refine_method&#39;</span><span class="p">:</span> <span class="s1">&#39;affine&#39;</span><span class="p">,</span> <span class="s1">&#39;affine_invariance&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;rotation_invariance&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="n">imgR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR_warp</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">warpHomog</span><span class="p">(</span><span class="n">imgR</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">H_12</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">kwplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">autompl</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR_warp</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR_warp</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--gui)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.guitool</span> <span class="k">as</span> <span class="nn">gt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">ensure_qapp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">ishow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgL</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy2.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rchip&#39;</span><span class="p">:</span> <span class="n">imgR</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rchip&#39;</span><span class="p">:</span> <span class="n">imgL</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">PairwiseMatch</span><span class="p">(</span><span class="n">annot1</span><span class="p">,</span> <span class="n">annot2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">apply_all</span><span class="p">({</span><span class="s1">&#39;refine_method&#39;</span><span class="p">:</span> <span class="s1">&#39;affine&#39;</span><span class="p">,</span> <span class="s1">&#39;affine_invariance&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;rotation_invariance&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="n">imgR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR_warp</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">warpHomog</span><span class="p">(</span><span class="n">imgR</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">H_12</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">kwplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">autompl</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR_warp</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR_warp</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--gui)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.guitool</span> <span class="k">as</span> <span class="nn">gt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">ensure_qapp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">ishow</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="vtool.PairwiseMatch.add_global_measures">
<code class="descname">add_global_measures</code><span class="sig-paren">(</span><em>global_keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.add_global_measures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.PairwiseMatch.add_global_measures" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.PairwiseMatch.add_local_measures">
<code class="descname">add_local_measures</code><span class="sig-paren">(</span><em>xy=True</em>, <em>scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.add_local_measures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.PairwiseMatch.add_local_measures" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.PairwiseMatch.apply_all">
<code class="descname">apply_all</code><span class="sig-paren">(</span><em>cfgdict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.apply_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.PairwiseMatch.apply_all" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.PairwiseMatch.apply_ratio_test">
<code class="descname">apply_ratio_test</code><span class="sig-paren">(</span><em>cfgdict={}</em>, <em>inplace=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.apply_ratio_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.PairwiseMatch.apply_ratio_test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.PairwiseMatch.apply_sver">
<code class="descname">apply_sver</code><span class="sig-paren">(</span><em>cfgdict={}</em>, <em>inplace=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.apply_sver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.PairwiseMatch.apply_sver" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;ratio_thresh&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>           <span class="s1">&#39;thresh_bins&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">6</span><span class="p">,</span> <span class="o">.</span><span class="mi">7</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">cfgbase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">apply_ratio_test</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags1</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">apply_sver</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="vtool.PairwiseMatch.assign">
<code class="descname">assign</code><span class="sig-paren">(</span><em>cfgdict={}</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.assign"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.PairwiseMatch.assign" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign feature correspondences between annots</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">({},</span> <span class="n">apply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m1</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">assign</span><span class="p">({</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m2</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">assign</span><span class="p">({</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Grid:</dt>
<dd><p class="first">from vtool.matching import *  # NOQA
grid = {</p>
<blockquote>
<div>‘symmetric’: [True, False],</div></blockquote>
<p>}
for cfgdict in ut.all_dict_combinations(grid):</p>
<blockquote class="last">
<div>match = demodata_match(cfgdict, apply=False)
match.assign()</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="vtool.PairwiseMatch.compress">
<code class="descname">compress</code><span class="sig-paren">(</span><em>flags</em>, <em>inplace=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.compress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.PairwiseMatch.compress" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.PairwiseMatch.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.PairwiseMatch.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.PairwiseMatch.ishow">
<code class="descname">ishow</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.ishow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.PairwiseMatch.ishow" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.matching ishow –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.guitool</span> <span class="k">as</span> <span class="nn">gt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">ensure_qapp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">(</span><span class="n">use_cache</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">ishow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">disp_config</span><span class="p">[</span><span class="s1">&#39;show_homog&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">qtapp_loop</span><span class="p">(</span><span class="n">qwin</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.PairwiseMatch.make_feature_vector">
<code class="descname">make_feature_vector</code><span class="sig-paren">(</span><em>local_keys=None</em>, <em>global_keys=None</em>, <em>summary_ops=None</em>, <em>sorters='ratio'</em>, <em>indices=3</em>, <em>bin_key=None</em>, <em>bins=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.make_feature_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.PairwiseMatch.make_feature_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs the pairwise feature vector that represents a match</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>local_keys</strong> (<em>None</em>) – (default = None)</li>
<li><strong>global_keys</strong> (<em>None</em>) – (default = None)</li>
<li><strong>summary_ops</strong> (<em>None</em>) – (default = None)</li>
<li><strong>sorters</strong> (<em>str</em>) – (default = ‘ratio’)</li>
<li><strong>indices</strong> (<em>int</em>) – (default = 3)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">feat</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.matching make_feature_vector</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">({})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">make_feature_vector</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;feat = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.PairwiseMatch.matched_vecs2">
<code class="descname">matched_vecs2</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.matched_vecs2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.PairwiseMatch.matched_vecs2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.PairwiseMatch.ratio_test_flags">
<code class="descname">ratio_test_flags</code><span class="sig-paren">(</span><em>cfgdict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.ratio_test_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.PairwiseMatch.ratio_test_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.PairwiseMatch.show">
<code class="descname">show</code><span class="sig-paren">(</span><em>ax=None</em>, <em>show_homog=False</em>, <em>show_ori=False</em>, <em>show_ell=True</em>, <em>show_pts=False</em>, <em>show_lines=True</em>, <em>show_rect=False</em>, <em>show_eig=False</em>, <em>show_all_kpts=False</em>, <em>mask_blend=0</em>, <em>ell_alpha=0.6</em>, <em>line_alpha=0.35</em>, <em>modifysize=False</em>, <em>vert=None</em>, <em>overlay=True</em>, <em>heatmask=False</em>, <em>line_lw=1.4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.show"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.PairwiseMatch.show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.PairwiseMatch.sver_flags">
<code class="descname">sver_flags</code><span class="sig-paren">(</span><em>cfgdict={}</em>, <em>return_extra=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.sver_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.PairwiseMatch.sver_flags" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;newsym&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgbase</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;ratio_thresh&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">8</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_union</span><span class="p">(</span><span class="n">cfgbase</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">thresh_bins</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">6</span><span class="p">,</span> <span class="o">.</span><span class="mi">7</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">cfgbase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">apply_ratio_test</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags1</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">sver_flags</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags2</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">sver_flags</span><span class="p">(</span><span class="n">cfgbase</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.PairwiseMatch.take">
<code class="descname">take</code><span class="sig-paren">(</span><em>indicies</em>, <em>inplace=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.take"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.PairwiseMatch.take" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="vtool.SV_DTYPE">
<code class="descclassname">vtool.</code><code class="descname">SV_DTYPE</code><a class="headerlink" href="#vtool.SV_DTYPE" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.float64</span></code></p>
</dd></dl>

<dl class="class">
<dt id="vtool.ScaleStrat">
<em class="property">class </em><code class="descclassname">vtool.</code><code class="descname">ScaleStrat</code><a class="reference internal" href="_modules/vtool/chip.html#ScaleStrat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScaleStrat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Scaling strategies</p>
<dl class="staticmethod">
<dt id="vtool.ScaleStrat.area">
<em class="property">static </em><code class="descname">area</code><span class="sig-paren">(</span><em>target</em>, <em>orig_wh</em>, <em>tol=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#ScaleStrat.area"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScaleStrat.area" title="Permalink to this definition">¶</a></dt>
<dd><p>The area becomes target</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>target</strong> (<em>int</em>) – target size</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="mi">800</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">)),</span> <span class="p">(</span><span class="mi">743</span><span class="p">,</span> <span class="mi">861</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="mi">800</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">190</span><span class="p">)),</span> <span class="p">(</span><span class="mi">861</span><span class="p">,</span> <span class="mi">743</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="vtool.ScaleStrat.maxwh">
<em class="property">static </em><code class="descname">maxwh</code><span class="sig-paren">(</span><em>target</em>, <em>orig_wh</em>, <em>tol=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#ScaleStrat.maxwh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScaleStrat.maxwh" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum dimension becomes target</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>target</strong> (<em>int</em>) – target size</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">maxwh</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="p">(</span><span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">)),</span> <span class="p">(</span><span class="mi">691</span><span class="p">,</span> <span class="mi">800</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">maxwh</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">190</span><span class="p">)),</span> <span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">691</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="vtool.ScaleStrat.width">
<em class="property">static </em><code class="descname">width</code><span class="sig-paren">(</span><em>target</em>, <em>orig_wh</em>, <em>tol=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#ScaleStrat.width"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScaleStrat.width" title="Permalink to this definition">¶</a></dt>
<dd><p>The width becomes target</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>target</strong> (<em>int</em>) – target size</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="p">(</span><span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">)),</span> <span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">926</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">190</span><span class="p">)),</span> <span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">691</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="vtool.ScoreNormVisualizeClass">
<em class="property">class </em><code class="descclassname">vtool.</code><code class="descname">ScoreNormVisualizeClass</code><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormVisualizeClass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScoreNormVisualizeClass" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p># HACK; eventually move all individual plots into a class structure</p>
</dd></dl>

<dl class="class">
<dt id="vtool.ScoreNormalizer">
<em class="property">class </em><code class="descclassname">vtool.</code><code class="descname">ScoreNormalizer</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScoreNormalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">utool.util_cache.Cachable</span></code>, <a class="reference internal" href="#vtool.score_normalization.ScoreNormVisualizeClass" title="vtool.score_normalization.ScoreNormVisualizeClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">vtool.score_normalization.ScoreNormVisualizeClass</span></code></a></p>
<p>Conforms to scikit-learn Estimator interface</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –test-ScoreNormalizer –show –cmd</dd>
<dt>Kwargs:</dt>
<dd><p class="first">tpr (float): target true positive rate (default .90)
fpr (float): target false positive rate (default None)
gridsize=1024,
adjust=8,
monotonize=False, if True ensures inferred probability curves are monotonic
clip_factor=None,
reverse (bool): True if lower scores are better, False if higher scores</p>
<blockquote class="last">
<div>are better (default=None)</div></blockquote>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ScoreNormalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">testdata_binary_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="vtool.ScoreNormalizer.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>X</em>, <em>y</em>, <em>attrs=None</em>, <em>verbose=False</em>, <em>finite_only=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScoreNormalizer.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits estimator to data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>ndarray</em>) – one dimensional scores</li>
<li><strong>y</strong> (<em>ndarray</em>) – binary labels</li>
<li><strong>attrs</strong> (<em>dict</em>) – dictionary of data attributes</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="vtool.ScoreNormalizer.fit_partitioned">
<code class="descname">fit_partitioned</code><span class="sig-paren">(</span><em>tp_scores</em>, <em>tn_scores</em>, <em>part_attrs=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.fit_partitioned"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScoreNormalizer.fit_partitioned" title="Permalink to this definition">¶</a></dt>
<dd><p>convinience func to fit only scores that have been separated
instead of labeled</p>
</dd></dl>

<dl class="method">
<dt id="vtool.ScoreNormalizer.get_accuracy">
<code class="descname">get_accuracy</code><span class="sig-paren">(</span><em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_accuracy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScoreNormalizer.get_accuracy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.ScoreNormalizer.get_confusion_indicies">
<code class="descname">get_confusion_indicies</code><span class="sig-paren">(</span><em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_confusion_indicies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScoreNormalizer.get_confusion_indicies" title="Permalink to this definition">¶</a></dt>
<dd><p>combination of get_correct_indices and get_error_indicies</p>
</dd></dl>

<dl class="method">
<dt id="vtool.ScoreNormalizer.get_correct_indices">
<code class="descname">get_correct_indices</code><span class="sig-paren">(</span><em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_correct_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScoreNormalizer.get_correct_indices" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>ndarray</em>) – data</li>
<li><strong>y</strong> (<em>ndarray</em>) – labels</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(fp_indicies, fn_indicies)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –test-get_correct_indices</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">testdata_score_normalier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">tp_indicies</span><span class="p">,</span> <span class="n">tn_indicies</span><span class="p">)</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">get_correct_indices</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">tp_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">tn_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span>    <span class="s1">&#39;tp_X = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">tp_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">tn_X = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">tn_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">tp_X = np.array([ 8.883,  8.77 ,  8.759])</span>
<span class="go">tn_X = np.array([ 0.727,  0.76 ,  0.841])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.ScoreNormalizer.get_error_indicies">
<code class="descname">get_error_indicies</code><span class="sig-paren">(</span><em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_error_indicies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScoreNormalizer.get_error_indicies" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the indicies of the most difficult type I and type II errors.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">testdata_score_normalier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">fp_indicies</span><span class="p">,</span> <span class="n">fn_indicies</span><span class="p">)</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">get_error_indicies</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fp_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">fp_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">fn_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span>    <span class="s1">&#39;fp_X = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fp_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">fn_X = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fn_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">fp_X = np.array([ 6.196,  5.912,  5.804])</span>
<span class="go">fn_X = np.array([ 3.947,  4.277,  4.43 ])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.ScoreNormalizer.get_partitioned_support">
<code class="descname">get_partitioned_support</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_partitioned_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScoreNormalizer.get_partitioned_support" title="Permalink to this definition">¶</a></dt>
<dd><p>convinience get prepartitioned data</p>
</dd></dl>

<dl class="method">
<dt id="vtool.ScoreNormalizer.get_prefix">
<code class="descname">get_prefix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_prefix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScoreNormalizer.get_prefix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.ScoreNormalizer.get_support">
<code class="descname">get_support</code><span class="sig-paren">(</span><em>finite_only=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScoreNormalizer.get_support" title="Permalink to this definition">¶</a></dt>
<dd><p>return X, y, and attrs</p>
</dd></dl>

<dl class="method">
<dt id="vtool.ScoreNormalizer.inverse_normalize">
<code class="descname">inverse_normalize</code><span class="sig-paren">(</span><em>probs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.inverse_normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScoreNormalizer.inverse_normalize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.ScoreNormalizer.learn_probabilities">
<code class="descname">learn_probabilities</code><span class="sig-paren">(</span><em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.learn_probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScoreNormalizer.learn_probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Kernel density estimation</p>
</dd></dl>

<dl class="method">
<dt id="vtool.ScoreNormalizer.learn_threshold">
<code class="descname">learn_threshold</code><span class="sig-paren">(</span><em>verbose=False</em>, <em>**thresh_kw</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.learn_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScoreNormalizer.learn_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Learns cutoff threshold that achieves the target confusion metric
Typically a desired false positive rate (recall) is specified</p>
</dd></dl>

<dl class="method">
<dt id="vtool.ScoreNormalizer.learn_threshold2">
<code class="descname">learn_threshold2</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.learn_threshold2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScoreNormalizer.learn_threshold2" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a cutoff where the probability of a truepos stats becoming
greater than probability of trueneg</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –exec-learn_threshold2 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder, X, y = testdata_score_normalier([(3.5, 256), (9.5, 1024), (15.5, 2048)], [(6.5, 256), (12.5, 5064), (18.5, 128)], adjust=1, p_tp_method=&#39;ratio&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">testdata_score_normalier</span><span class="p">([(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="p">(</span><span class="mf">9.5</span><span class="p">,</span> <span class="mi">1024</span><span class="p">),</span> <span class="p">(</span><span class="mf">15.5</span><span class="p">,</span> <span class="mi">5064</span><span class="p">)],</span> <span class="p">[(</span><span class="mf">6.5</span><span class="p">,</span> <span class="mi">256</span><span class="p">),</span> <span class="p">(</span><span class="mf">12.5</span><span class="p">,</span> <span class="mi">2048</span><span class="p">),</span> <span class="p">(</span><span class="mf">18.5</span><span class="p">,</span> <span class="mi">128</span><span class="p">)],</span> <span class="n">adjust</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">p_tp_method</span><span class="o">=</span><span class="s1">&#39;ratio&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder, X, y = testdata_score_normalier(adjust=1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder, X, y = testdata_score_normalier([(3.5, 2048)], [(30.5, 128)], tn_scale=.1, adjust=1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder, X, y = testdata_score_normalier([(0, 64)], [(-.1, 12)], adjust=8, min_clip=0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">encoder</span><span class="o">.</span><span class="n">learn_threshold2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exec</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">execstr_dict</span><span class="p">(</span><span class="n">locals_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.plot(xdata[0:-2], np.diff(np.diff(closeness)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#maxima_x, maxima_y, argmaxima = vt.hist_argmaxima(closeness)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fnum</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">multi_plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="p">[</span><span class="n">tp_curve</span><span class="p">,</span> <span class="n">tn_curve</span><span class="p">,</span> <span class="n">closeness</span><span class="p">,</span> <span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">label_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p(tp | s)&#39;</span><span class="p">,</span> <span class="s1">&#39;p(tn | s)&#39;</span><span class="p">,</span> <span class="s1">&#39;closeness&#39;</span><span class="p">,</span> <span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">linewidth_list</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;intersection points&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">xdata</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">closeness</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;closeness maxima&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_submax</span><span class="p">,</span> <span class="n">y_submax</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;chosen&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.plot(xdata[argmaxima], curveness[argmaxima], &#39;rx&#39;, label=&#39;curveness maxima&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.plot(x_submax, y_submax, &#39;o&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">tp_curve</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">tn_curve</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">tp_curve</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">tn_curve</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.plot(xdata[argmaxima], encoder.interp_fn(x_submax), &#39;rx&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_mkinterp</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">assume_sorted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_interp_sgtn</span> <span class="o">=</span> <span class="n">_mkinterp</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">tn_curve</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_interp_sgtp</span> <span class="o">=</span> <span class="n">_mkinterp</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">tp_curve</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_submax</span><span class="p">,</span> <span class="n">_interp_sgtn</span><span class="p">(</span><span class="n">x_submax</span><span class="p">),</span> <span class="s1">&#39;go&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_submax</span><span class="p">,</span> <span class="n">_interp_sgtp</span><span class="p">(</span><span class="n">x_submax</span><span class="p">),</span> <span class="s1">&#39;bx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">multi_plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="p">[</span><span class="n">tp_area</span><span class="p">,</span> <span class="n">fp_area</span><span class="p">,</span> <span class="n">tn_area</span><span class="p">,</span> <span class="n">fn_area</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;intersection areas&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">label_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tp_area&#39;</span><span class="p">,</span> <span class="s1">&#39;fp_area&#39;</span><span class="p">,</span> <span class="s1">&#39;tn_area&#39;</span><span class="p">,</span> <span class="s1">&#39;fn_area&#39;</span><span class="p">],</span> <span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">xdata</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">multi_plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="p">[</span><span class="n">lr_pos</span><span class="p">,</span> <span class="n">lr_neg</span><span class="p">,</span> <span class="n">acc</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;intersection quality (liklihood ratios)&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">label_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lr_pos=tp/fp&#39;</span><span class="p">,</span> <span class="s1">&#39;lr_neg=fn/tn&#39;</span><span class="p">,</span> <span class="s1">&#39;acc&#39;</span><span class="p">],</span> <span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">xdata</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pnum_</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">make_pnum_nextgen</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">_plot_score_support_hist</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder._plot_prebayes(fnum=fnum, pnum=pnum_())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">_plot_postbayes</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">_plot_roc</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">adjust_subplots</span><span class="p">(</span><span class="n">hspace</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">top</span><span class="o">=.</span><span class="mi">95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=.</span><span class="mi">08</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.ScoreNormalizer.normalize_scores">
<code class="descname">normalize_scores</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.normalize_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScoreNormalizer.normalize_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.ScoreNormalizer.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScoreNormalizer.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict true or false of <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="vtool.ScoreNormalizer.visualize">
<code class="descname">visualize</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.visualize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ScoreNormalizer.visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>shows details about the score normalizer</p>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd>fnum
figtitle
with_hist
interactive
with_scores
with_roc
with_precision_recall</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –exec-ScoreNormalizer.visualize:0 –show
python -m vtool.score_normalization –exec-ScoreNormalizer.visualize:1 –show</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># UNSTABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ScoreNormalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">testdata_binary_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_pr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_roc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_hist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># UNSTABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ScoreNormalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">testdata_binary_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_pr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_roc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_hist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_scores</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_prebayes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_postbayes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">target_tpr</span><span class="o">=.</span><span class="mi">95</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="vtool.TEMP_VEC_DTYPE">
<code class="descclassname">vtool.</code><code class="descname">TEMP_VEC_DTYPE</code><a class="headerlink" href="#vtool.TEMP_VEC_DTYPE" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.float64</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.TRANSFORM_DTYPE">
<code class="descclassname">vtool.</code><code class="descname">TRANSFORM_DTYPE</code><a class="headerlink" href="#vtool.TRANSFORM_DTYPE" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.float64</span></code></p>
</dd></dl>

<dl class="function">
<dt id="vtool.adaptive_scale">
<code class="descclassname">vtool.</code><code class="descname">adaptive_scale</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>kpts</em>, <em>nScales=4</em>, <em>low=-0.5</em>, <em>high=0.5</em>, <em>nSamples=16</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#adaptive_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.adaptive_scale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.add_homogenous_coordinate">
<code class="descclassname">vtool.</code><code class="descname">add_homogenous_coordinate</code><span class="sig-paren">(</span><em>_xys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#add_homogenous_coordinate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.add_homogenous_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.linalg –test-add_homogenous_coordinate</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xyzs</span> <span class="o">=</span> <span class="n">add_homogenous_coordinate</span><span class="p">(</span><span class="n">_xys</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">_xys</span> <span class="o">==</span> <span class="n">remove_homogenous_coordinate</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.affine_around_mat3x3">
<code class="descclassname">vtool.</code><code class="descname">affine_around_mat3x3</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>sx=1.0</em>, <em>sy=1.0</em>, <em>theta=0.0</em>, <em>shear=0.0</em>, <em>tx=0.0</em>, <em>ty=0.0</em>, <em>x2=None</em>, <em>y2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#affine_around_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.affine_around_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes an affine transform around center point (x, y).
Equivalent to translation.dot(affine).dot(inv(translation))</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>float</em>) – center x location in input space</li>
<li><strong>y</strong> (<em>float</em>) – center y location in input space</li>
<li><strong>sx</strong> (<em>float</em>) – x scale factor (default = 1)</li>
<li><strong>sy</strong> (<em>float</em>) – y scale factor (default = 1)</li>
<li><strong>theta</strong> (<em>float</em>) – counter-clockwise rotation angle in radians(default = 0)</li>
<li><strong>shear</strong> (<em>float</em>) – counter-clockwise shear angle in radians(default = 0)</li>
<li><strong>tx</strong> (<em>float</em>) – x-translation (default = 0)</li>
<li><strong>ty</strong> (<em>float</em>) – y-translation (default = 0)</li>
<li><strong>x2</strong> (<em>float</em><em>, </em><em>optional</em>) – center y location in output space (default = x)</li>
<li><strong>y2</strong> (<em>float</em><em>, </em><em>optional</em>) – center y location in output space (default = y)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.linalg affine_around_mat3x3 –show</dd>
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/linalg.py affine_around_mat3x3</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orig_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">verts_from_bbox</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">bbox_center</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">bbox_from_verts</span><span class="p">(</span><span class="n">orig_pts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shear</span> <span class="o">=</span> <span class="o">.</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff</span> <span class="o">=</span> <span class="n">affine_around_mat3x3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                           <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trans_pts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">transform_points_with_homography</span><span class="p">(</span><span class="n">Aff</span><span class="p">,</span> <span class="n">orig_pts</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoc: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;bx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">orig_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">orig_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trans_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trans_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;transformed&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Demo of affine_around_mat3x3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p># Timeit:
#     &gt;&gt;&gt; from vtool.linalg import *  # NOQA
#     &gt;&gt;&gt; x, y, sx, sy, theta, shear, tx, ty, x2, y2 = (
#     &gt;&gt;&gt;     256.0, 256.0, 1.5, 1.0, 0.78, 0.2, 0, 100, 500.0, 500.0)
#     &gt;&gt;&gt; for timer in ub.Timerit(1000, ‘old’):  # 19.0697 µs
#     &gt;&gt;&gt;     with timer:
#     &gt;&gt;&gt;         <a href="#id115"><span class="problematic" id="id116">tr1_</span></a> = translation_mat3x3(-x, -y)
#     &gt;&gt;&gt;         <a href="#id117"><span class="problematic" id="id118">Aff_</span></a> = affine_mat3x3(sx, sy, theta, shear, tx, ty)
#     &gt;&gt;&gt;         <a href="#id119"><span class="problematic" id="id120">tr2_</span></a> = translation_mat3x3(x2, y2)
#     &gt;&gt;&gt;         Aff1 = <a href="#id121"><span class="problematic" id="id122">tr2_</span></a>.dot(<a href="#id123"><span class="problematic" id="id124">Aff_</span></a>).dot(<a href="#id125"><span class="problematic" id="id126">tr1_</span></a>)
#     &gt;&gt;&gt; for timer in ub.Timerit(1000, ‘new’):  # 11.0242 µs
#     &gt;&gt;&gt;     with timer:
#     &gt;&gt;&gt;         Aff2 = affine_around_mat3x3(x, y, sx, sy, theta, shear,
#     &gt;&gt;&gt;                                     tx, ty, x2, y2)
#     &gt;&gt;&gt; assert np.all(np.isclose(Aff2, Aff1))</p>
<p># Sympy:
#     &gt;&gt;&gt; from vtool.linalg import *  # NOQA
#     &gt;&gt;&gt; import vtool as vt
#     &gt;&gt;&gt; import sympy
#     &gt;&gt;&gt; # Shows the symbolic construction of the code
#     &gt;&gt;&gt; # <a class="reference external" href="https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA">https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</a>
#     &gt;&gt;&gt; from sympy.abc import theta
#     &gt;&gt;&gt; x, y, sx, sy, theta, shear, tx, ty, x2, y2 = sympy.symbols(
#     &gt;&gt;&gt;     ‘x, y, sx, sy, theta, shear, tx, ty, x2, y2’)
#     &gt;&gt;&gt; theta = sx = sy = tx = ty = 0
#     &gt;&gt;&gt; # move to center xy, apply affine transform, move center xy2
#     &gt;&gt;&gt; <a href="#id127"><span class="problematic" id="id128">tr1_</span></a> = translation_mat3x3(-x, -y, dtype=None)
#     &gt;&gt;&gt; <a href="#id129"><span class="problematic" id="id130">Aff_</span></a> = affine_mat3x3(sx, sy, theta, shear, tx, ty, trig=sympy)
#     &gt;&gt;&gt; <a href="#id131"><span class="problematic" id="id132">tr2_</span></a> = translation_mat3x3(x2, y2, dtype=None)
#     &gt;&gt;&gt; # combine transformations
#     &gt;&gt;&gt; Aff = vt.sympy_mat(<a href="#id133"><span class="problematic" id="id134">tr2_</span></a>.dot(<a href="#id135"><span class="problematic" id="id136">Aff_</span></a>).dot(<a href="#id137"><span class="problematic" id="id138">tr1_</span></a>))
#     &gt;&gt;&gt; vt.evalprint(‘Aff’)
#     &gt;&gt;&gt; print(‘——-‘)
#     &gt;&gt;&gt; print(‘Numpy’)
#     &gt;&gt;&gt; vt.sympy_numpy_repr(Aff)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.affine_mat3x3">
<code class="descclassname">vtool.</code><code class="descname">affine_mat3x3</code><span class="sig-paren">(</span><em>sx=1</em>, <em>sy=1</em>, <em>theta=0</em>, <em>shear=0</em>, <em>tx=0</em>, <em>ty=0</em>, <em>trig=&lt;module 'numpy' from '/Users/jason.parham/virtualenv/wildme3/lib/python3.6/site-packages/numpy/__init__.py'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#affine_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.affine_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sx</strong> (<em>float</em>) – x scale factor (default = 1)</li>
<li><strong>sy</strong> (<em>float</em>) – y scale factor (default = 1)</li>
<li><strong>theta</strong> (<em>float</em>) – rotation angle (radians) in counterclockwise direction</li>
<li><strong>shear</strong> (<em>float</em>) – shear angle (radians) in counterclockwise directions</li>
<li><strong>tx</strong> (<em>float</em>) – x-translation (default = 0)</li>
<li><strong>ty</strong> (<em>float</em>) – y-translation (default = 0)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://github.com/scikit-image/scikit-image/blob/master/skimage/transform/_geometric.py">https://github.com/scikit-image/scikit-image/blob/master/skimage/transform/_geometric.py</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.affine_warp_around_center">
<code class="descclassname">vtool.</code><code class="descname">affine_warp_around_center</code><span class="sig-paren">(</span><em>img</em>, <em>sx=1</em>, <em>sy=1</em>, <em>theta=0</em>, <em>shear=0</em>, <em>tx=0</em>, <em>ty=0</em>, <em>dsize=None</em>, <em>borderMode=0</em>, <em>flags=4</em>, <em>out=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#affine_warp_around_center"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.affine_warp_around_center" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-affine_warp_around_center –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shear</span> <span class="o">=</span> <span class="o">.</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ty</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sy</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">borderMode</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_CONSTANT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">INTER_LANCZOS4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_warped</span> <span class="o">=</span> <span class="n">affine_warp_around_center</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">sx</span><span class="o">=</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="o">=</span><span class="n">sy</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">theta</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="o">=</span><span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="o">=</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="o">=</span><span class="n">ty</span><span class="p">,</span> <span class="n">dsize</span><span class="o">=</span><span class="n">dsize</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">borderMode</span><span class="o">=</span><span class="n">borderMode</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span> <span class="n">borderValue</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">img_warped</span> <span class="o">*</span> <span class="mf">255.0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.and_lists">
<code class="descclassname">vtool.</code><code class="descname">and_lists</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#and_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.and_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Like np.logical_and, but can take more than 2 arguments</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-and_lists</dd>
<dt>SeeAlso:</dt>
<dd>or_lists</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">and_lists</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[False  True False  True]</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg3</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">and_lists</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ensure equal division</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">flags</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">endx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">segments</span> <span class="o">*</span> <span class="p">(</span><span class="n">validx</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="p">(</span><span class="n">segments</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">validx</span><span class="p">[:</span><span class="n">endx</span><span class="p">],</span> <span class="n">segments</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">parts</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[243734, 714397, 1204989, 1729375, 2235191]</span>
</pre></div>
</div>
</dd>
</dl>
<p>%timeit reduce(np.logical_and, args)
%timeit np.logical_and.reduce(args)  # wins with more data</p>
</dd></dl>

<dl class="function">
<dt id="vtool.ann_flann_once">
<code class="descclassname">vtool.</code><code class="descname">ann_flann_once</code><span class="sig-paren">(</span><em>dpts</em>, <em>qpts</em>, <em>num_neighbors</em>, <em>flann_params={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#ann_flann_once"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ann_flann_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the approximate nearest neighbors of qpts in dpts</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/nearest_neighbors.py ann_flann_once:0</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qx2_dx</span><span class="p">,</span> <span class="n">qx2_dist</span> <span class="o">=</span> <span class="n">ann_flann_once</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">qpts</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">qx2_dx</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">qx2_dist</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">    np.array([[3, 3, 3, 3, 0],</span>
<span class="go">              [2, 0, 1, 4, 4]], dtype=np.int32),</span>
<span class="go">    np.array([[1037329., 1235876., 1168550., 1286435., 1075507.],</span>
<span class="go">              [1038324., 1243690., 1304896., 1320598., 1369036.]], dtype=np.float32),</span>
<span class="go">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Test upper bounds on sift descriptors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># SeeAlso distance.understanding_pseudomax_props</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># get points on unit sphere</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nDpts</span> <span class="o">=</span> <span class="mi">5000</span> <span class="c1"># 5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nQpts</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c1"># 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">normalize_rows</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nDpts</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">normalize_rows</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nQpts</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">qpts</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">qmag</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="s1">&#39;not on unit sphere&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dmag</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="s1">&#39;not on unit sphere&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># cast to uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uint8_max</span> <span class="o">=</span> <span class="mi">512</span>  <span class="c1"># hack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uint8_min</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># hack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># 2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">qpts8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">qpts</span> <span class="o">*</span> <span class="n">uint8_max</span><span class="p">),</span> <span class="n">uint8_min</span><span class="p">,</span> <span class="n">uint8_max</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">dpts</span> <span class="o">*</span> <span class="n">uint8_max</span><span class="p">),</span> <span class="n">uint8_min</span><span class="p">,</span> <span class="n">uint8_max</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmag8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">qpts8</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmag8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">dpts8</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qx2_dx</span><span class="p">,</span> <span class="n">qx2_dist</span> <span class="o">=</span> <span class="n">ann_flann_once</span><span class="p">(</span><span class="n">dpts8</span><span class="p">,</span> <span class="n">qpts8</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">biggest_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">qx2_dist</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;biggest_dist = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">biggest_dist</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get actual distance by hand</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hand_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">qpts8</span> <span class="o">-</span> <span class="n">dpts8</span><span class="p">[</span><span class="n">qx2_dx</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Seems like flann returns squared distance. makes sense</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="nb">repr</span><span class="p">((</span><span class="n">qx2_dx</span><span class="p">,</span> <span class="n">qx2_dist</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl class="last docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Build theoretically maximally distant vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="mi">512</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">D</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span> <span class="o">*</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">512</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">qpts</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">dpts</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># FIX TO ACTUALLY BE AT THE RIGHT NORM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="p">(</span><span class="n">dpts</span> <span class="o">*</span> <span class="p">(</span><span class="mi">512</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[:,</span> <span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="p">(</span><span class="n">qpts</span> <span class="o">*</span> <span class="p">(</span><span class="mi">512</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">qpts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[:,</span> <span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">qpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">qpts</span> <span class="o">-</span> <span class="n">dpts</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Because of norm condition another maximally disant pair of vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># is [1, 0, 0, ... 0] and [0, 1, .. 0, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verifythat this gives you same dist.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">512</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">512</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.apply_filter_funcs">
<code class="descclassname">vtool.</code><code class="descname">apply_filter_funcs</code><span class="sig-paren">(</span><em>chipBGR</em>, <em>filter_funcs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#apply_filter_funcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.apply_filter_funcs" title="Permalink to this definition">¶</a></dt>
<dd><p>applies a list of preprocessing filters to a chip</p>
<p>DEPRICATE</p>
</dd></dl>

<dl class="function">
<dt id="vtool.apply_grouping">
<code class="descclassname">vtool.</code><code class="descname">apply_grouping</code><span class="sig-paren">(</span><em>items</em>, <em>groupxs</em>, <em>axis=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.apply_grouping" title="Permalink to this definition">¶</a></dt>
<dd><p>applies grouping from group_indicies
apply_grouping</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>items</strong> (<em>ndarray</em>) – </li>
<li><strong>groupxs</strong> (<em>list of ndarrays</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">grouped items</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of ndarrays</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>group_indices
invert_apply_grouping</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.clustering2 –test-apply_grouping</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_items</span> <span class="o">=</span> <span class="n">apply_grouping</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">grouped_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[array([8, 5, 6]), array([1, 5, 8, 7]), array([5, 3, 0, 9])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.apply_grouping_">
<code class="descclassname">vtool.</code><code class="descname">apply_grouping_</code><span class="sig-paren">(</span><em>items</em>, <em>groupxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.apply_grouping_" title="Permalink to this definition">¶</a></dt>
<dd><p>non-optimized version</p>
</dd></dl>

<dl class="function">
<dt id="vtool.apply_grouping_iter">
<code class="descclassname">vtool.</code><code class="descname">apply_grouping_iter</code><span class="sig-paren">(</span><em>items</em>, <em>groupxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping_iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.apply_grouping_iter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.apply_grouping_iter2">
<code class="descclassname">vtool.</code><code class="descname">apply_grouping_iter2</code><span class="sig-paren">(</span><em>items</em>, <em>groupxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping_iter2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.apply_grouping_iter2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.apply_jagged_grouping">
<code class="descclassname">vtool.</code><code class="descname">apply_jagged_grouping</code><span class="sig-paren">(</span><em>unflat_items</em>, <em>groupxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_jagged_grouping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.apply_jagged_grouping" title="Permalink to this definition">¶</a></dt>
<dd><p>takes unflat_list and flat group indices. Returns the unflat grouping</p>
</dd></dl>

<dl class="function">
<dt id="vtool.argsort_groups">
<code class="descclassname">vtool.</code><code class="descname">argsort_groups</code><span class="sig-paren">(</span><em>scores_list</em>, <em>reverse=False</em>, <em>rng=&lt;module 'numpy.random' from '/Users/jason.parham/virtualenv/wildme3/lib/python3.6/site-packages/numpy/random/__init__.py'&gt;</em>, <em>randomize_levels=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#argsort_groups"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.argsort_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Sorts each group normally, but randomizes order of level values.</p>
<p>TODO: move to vtool</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>scores_list</strong> (<em>list</em>) – </li>
<li><strong>reverse</strong> (<em>bool</em>) – (default = True)</li>
<li><strong>rng</strong> (<em>module</em>) – random number generator(default = numpy.random)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m wbia.init.filter_annots –exec-argsort_groups</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idxs_list</span> <span class="o">=</span> <span class="n">argsort_groups</span><span class="p">(</span><span class="n">scores_list</span><span class="p">,</span> <span class="n">reverse</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;idxs_list = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr4</span><span class="p">(</span><span class="n">idxs_list</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.argsort_records">
<code class="descclassname">vtool.</code><code class="descname">argsort_records</code><span class="sig-paren">(</span><em>arrays</em>, <em>reverse=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#argsort_records"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.argsort_records" title="Permalink to this definition">¶</a></dt>
<dd><p>Sorts arrays that form records.
Same as lexsort(arrays[::-1]) — ie. rows are reversed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arrays</strong> (<em>ndarray</em>) – array of records</li>
<li><strong>reverse</strong> (<em>bool</em>) – (default = False)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">sortx - sorted indicies</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –exec-argsort_records</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrays</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">],)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sortx</span> <span class="o">=</span> <span class="n">argsort_records</span><span class="p">(</span><span class="n">arrays</span><span class="p">,</span> <span class="n">reverse</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;sortx = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sortx</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lxsrt = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span><span class="n">arrays</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">sortx = [1 2 0 5 4 3 6 7 8]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.argsubextrema2">
<code class="descclassname">vtool.</code><code class="descname">argsubextrema2</code><span class="sig-paren">(</span><em>op</em>, <em>ydata</em>, <em>xdata=None</em>, <em>thresh_factor=None</em>, <em>normalize_x=True</em>, <em>flat=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubextrema2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.argsubextrema2" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines approximate maxima values to subindex accuracy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ydata</strong> (<em>ndarray</em>) – ydata, histogram frequencies</li>
<li><strong>xdata</strong> (<em>ndarray</em>) – xdata, histogram labels</li>
<li><strong>thresh_factor</strong> (<em>float</em>) – cutoff point for labeing a value as a maxima</li>
<li><strong>flat</strong> (<em>bool</em>) – if True allows for flat extrema to be found.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(submaxima_x, submaxima_y)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram argsubmaxima
python -m vtool.histogram argsubmaxima –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh_factor</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">op</span> <span class="o">=</span> <span class="s1">&#39;min&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">argsubextrema2</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="p">,</span> <span class="n">thresh_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_hist_subbin_maxima</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Doctest:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh_factor</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">op</span> <span class="o">=</span> <span class="s1">&#39;max&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh_factor</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">argsubextrema2</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">thresh_factor</span><span class="o">=</span><span class="n">thresh_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">qtensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">doclf</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.argsubmax">
<code class="descclassname">vtool.</code><code class="descname">argsubmax</code><span class="sig-paren">(</span><em>ydata</em>, <em>xdata=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.argsubmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a single submaximum value to subindex accuracy.
If xdata is not specified, submax_x is a fractional index.
Otherwise, submax_x is sub-xdata (essentially doing the index interpolation
for you)</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span>  <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="p">[</span><span class="mi">00</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span>  <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">argsubmax</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">argsubmax</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="n">xdata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">([</span><span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">],</span> <span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(2.1667, 2.0208),</span>
<span class="go">(21.6667, 2.0208),</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span><span class="o">=</span><span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argsubmax</span><span class="p">(</span><span class="n">hist_</span><span class="p">)</span>
<span class="go">(4.0, 4.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.argsubmax2">
<code class="descclassname">vtool.</code><code class="descname">argsubmax2</code><span class="sig-paren">(</span><em>ydata</em>, <em>xdata=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmax2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.argsubmax2" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a single submaximum value to subindex accuracy.
If xdata is not specified, submax_x is a fractional index.
This version always normalizes x-coordinates.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span>  <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="p">[</span><span class="mi">00</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span>  <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">argsubmax</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">argsubmax</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="n">xdata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">([</span><span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">],</span> <span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(2.1667, 2.0208),</span>
<span class="go">(21.6667, 2.0208),</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh_factor</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argsubmax</span><span class="p">(</span><span class="n">hist_</span><span class="p">)</span>
<span class="go">(4.0, 4.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.argsubmaxima">
<code class="descclassname">vtool.</code><code class="descname">argsubmaxima</code><span class="sig-paren">(</span><em>hist</em>, <em>centers=None</em>, <em>maxima_thresh=None</em>, <em>_debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmaxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.argsubmaxima" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines approximate maxima values to subindex accuracy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hist</strong> (<em>ndarray</em>) – ydata, histogram frequencies</li>
<li><strong>centers</strong> (<em>ndarray</em>) – xdata, histogram labels</li>
<li><strong>maxima_thresh</strong> (<em>float</em>) – cutoff point for labeing a value as a maxima</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(submaxima_x, submaxima_y)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram argsubmaxima
python -m vtool.histogram argsubmaxima –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">argsubmaxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_hist_subbin_maxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">(array([ 3.0318792]), array([ 37.19208239]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.argsubmaxima2">
<code class="descclassname">vtool.</code><code class="descname">argsubmaxima2</code><span class="sig-paren">(</span><em>ydata</em>, <em>xdata=None</em>, <em>thresh_factor=None</em>, <em>normalize_x=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmaxima2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.argsubmaxima2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.argsubmin2">
<code class="descclassname">vtool.</code><code class="descname">argsubmin2</code><span class="sig-paren">(</span><em>ydata</em>, <em>xdata=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmin2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.argsubmin2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.argsubminima2">
<code class="descclassname">vtool.</code><code class="descname">argsubminima2</code><span class="sig-paren">(</span><em>ydata</em>, <em>xdata=None</em>, <em>thresh_factor=None</em>, <em>normalize_x=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubminima2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.argsubminima2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.assert_zipcompress">
<code class="descclassname">vtool.</code><code class="descname">assert_zipcompress</code><span class="sig-paren">(</span><em>arr_list</em>, <em>flags_list</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#assert_zipcompress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.assert_zipcompress" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.asserteq">
<code class="descclassname">vtool.</code><code class="descname">asserteq</code><span class="sig-paren">(</span><em>output1</em>, <em>output2</em>, <em>thresh=1e-08</em>, <em>nestpath=None</em>, <em>level=0</em>, <em>lbl1=None</em>, <em>lbl2=None</em>, <em>output_lbl=None</em>, <em>verbose=True</em>, <em>iswarning=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#asserteq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.asserteq" title="Permalink to this definition">¶</a></dt>
<dd><p>recursive equality checks</p>
<p>asserts that output1 and output2 are close to equal.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.assign_symmetric_matches">
<code class="descclassname">vtool.</code><code class="descname">assign_symmetric_matches</code><span class="sig-paren">(</span><em>fx2_to_fx1</em>, <em>fx2_to_dist</em>, <em>fx1_to_fx2</em>, <em>fx1_to_dist</em>, <em>K</em>, <em>Knorm=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#assign_symmetric_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.assign_symmetric_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>import vtool as vt
from vtool.matching import *
K = 2
Knorm = 1
feat1 = np.random.rand(5, 3)
feat2 = np.random.rand(7, 3)</p>
<p># Assign distances
distmat = vt.L2(feat1[:, None], feat2[None, :])</p>
<p># Find nearest K
fx1_to_fx2 = distmat.argsort()[:, 0:K + Knorm]
fx2_to_fx1 = distmat.T.argsort()[:, 0:K + Knorm]
# and order their distances
fx1_to_dist = np.array([distmat[i].take(col) for i, col in enumerate(fx1_to_fx2)])
fx2_to_dist = np.array([distmat.T[j].take(row) for j, row in enumerate(fx2_to_fx1)])</p>
<p># flat_matx1 = fx1_to_fx2 + np.arange(distmat.shape[0])[:, None] * distmat.shape[1]
# fx1_to_dist = distmat.take(flat_matx1).reshape(fx1_to_fx2.shape)</p>
<p>fx21 = pd.DataFrame(fx2_to_fx1)
fx21.columns.name = ‘K’
fx21.index.name = ‘fx1’</p>
<p>fx12 = pd.DataFrame(fx1_to_fx2)
fx12.columns.name = ‘K’
fx12.index.name = ‘fx2’</p>
<p>fx12 = fx12.T[0:K].T.astype(np.float)
fx21 = fx21.T[0:K].T.astype(np.float)</p>
<p>fx12.values[~fx1_to_flags] = np.nan
fx21.values[~fx2_to_flags] = np.nan</p>
<p>print(‘fx12.values =n%r’ % (fx12,))
print(‘<a href="#id139"><span class="problematic" id="id140">fm_</span></a> =n%r’ % (<a href="#id141"><span class="problematic" id="id142">fm_</span></a>,))</p>
<p>print(‘fx21.values =n%r’ % (fx21,))
print(‘fm =n%r’ % (fm,))</p>
<p>unflat_match_idx2 = -np.ones(fx2_to_fx1.shape)
unflat_match_idx2.ravel()[flat_match_idx2] = flat_match_idx2
inv_lookup21 = unflat_match_idx2.T[0:K].T</p>
<p>for fx2 in zip(fx12.values[fx1_to_flags]:</p>
<dl class="docutils">
<dt>for fx1, fx2 in zip(<a href="#id143"><span class="problematic" id="id144">match_fx1_</span></a>, <a href="#id145"><span class="problematic" id="id146">match_fx2_</span></a>):</dt>
<dd>cx = np.where(fx2_to_fx1[fx2][0:K] == fx1)[0][0]
inv_idx = inv_lookup21[fx2][cx]
print(‘inv_idx = %r’ % (inv_idx,))</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.assign_to_centroids">
<code class="descclassname">vtool.</code><code class="descname">assign_to_centroids</code><span class="sig-paren">(</span><em>dpts</em>, <em>qpts</em>, <em>num_neighbors=1</em>, <em>flann_params={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#assign_to_centroids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.assign_to_centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper for akmeans</p>
</dd></dl>

<dl class="function">
<dt id="vtool.assign_unconstrained_matches">
<code class="descclassname">vtool.</code><code class="descname">assign_unconstrained_matches</code><span class="sig-paren">(</span><em>fx2_to_fx1</em>, <em>fx2_to_dist</em>, <em>K</em>, <em>Knorm=None</em>, <em>fx2_to_flags=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#assign_unconstrained_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.assign_unconstrained_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>assigns vsone matches using results of nearest neighbors.</p>
<dl class="docutils">
<dt>Ignore:</dt>
<dd>fx2_to_dist = np.arange(fx2_to_fx1.size).reshape(fx2_to_fx1.shape)</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.matching –test-assign_unconstrained_matches –show
python -m vtool.matching assign_unconstrained_matches:0
python -m vtool.matching assign_unconstrained_matches:1</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx2_to_dist</span> <span class="o">=</span> <span class="n">empty_neighbors</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Knorm</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flags</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assigntup</span> <span class="o">=</span> <span class="n">assign_unconstrained_matches</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx2_to_dist</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                         <span class="n">Knorm</span><span class="p">,</span> <span class="n">fx2_to_flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="p">,</span> <span class="n">match_dist</span><span class="p">,</span> <span class="n">norm_fx1</span><span class="p">,</span> <span class="n">norm_dist</span> <span class="o">=</span> <span class="n">assigntup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">assigntup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">77</span><span class="p">,</span>   <span class="mi">971</span><span class="p">,</span> <span class="mi">22</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">116</span><span class="p">,</span>   <span class="mi">120</span><span class="p">,</span> <span class="mi">34</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">122</span><span class="p">,</span>   <span class="mi">128</span><span class="p">,</span> <span class="mi">99</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">1075</span><span class="p">,</span>  <span class="mi">692</span><span class="p">,</span> <span class="mi">102</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">530</span><span class="p">,</span>   <span class="mi">45</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span>  <span class="mi">45</span><span class="p">,</span>  <span class="mi">530</span><span class="p">,</span> <span class="mi">77</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.059</span><span class="p">,</span>  <span class="mf">0.238</span><span class="p">,</span> <span class="o">.</span><span class="mi">3</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.021</span><span class="p">,</span>  <span class="mf">0.240</span><span class="p">,</span> <span class="o">.</span><span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.039</span><span class="p">,</span>  <span class="mf">0.247</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.149</span><span class="p">,</span>  <span class="mf">0.151</span><span class="p">,</span> <span class="o">.</span><span class="mi">6</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.226</span><span class="p">,</span>  <span class="mf">0.244</span><span class="p">,</span> <span class="o">.</span><span class="mi">7</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.215</span><span class="p">,</span>  <span class="mf">0.236</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Knorm</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flags</span> <span class="o">=</span> <span class="n">fx2_to_flags</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">K</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assigntup</span> <span class="o">=</span> <span class="n">assign_unconstrained_matches</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx2_to_dist</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                         <span class="n">Knorm</span><span class="p">,</span> <span class="n">fx2_to_flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="p">,</span> <span class="n">match_dist</span><span class="p">,</span> <span class="n">norm_fx1</span><span class="p">,</span> <span class="n">norm_dist</span> <span class="o">=</span> <span class="n">assigntup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">assigntup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">fm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">ub</span><span class="o">.</span><span class="n">allsame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">assigntup</span><span class="p">)))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.asymmetric_correspondence">
<code class="descclassname">vtool.</code><code class="descname">asymmetric_correspondence</code><span class="sig-paren">(</span><em>annot1</em>, <em>annot2</em>, <em>K</em>, <em>Knorm</em>, <em>checks</em>, <em>allow_shrink=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#asymmetric_correspondence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.asymmetric_correspondence" title="Permalink to this definition">¶</a></dt>
<dd><p>Find symmetric feature corresopndences</p>
</dd></dl>

<dl class="function">
<dt id="vtool.atan2">
<code class="descclassname">vtool.</code><code class="descname">atan2</code><span class="sig-paren">(</span><em>y</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/trig.html#atan2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.atan2" title="Permalink to this definition">¶</a></dt>
<dd><p>does atan2 but returns from 0 to TAU</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.trig</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">theta</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">theta</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
<span class="go">90fe55311562f1c3ae4...</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.atleast_3channels">
<code class="descclassname">vtool.</code><code class="descname">atleast_3channels</code><span class="sig-paren">(</span><em>arr</em>, <em>copy=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#atleast_3channels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.atleast_3channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures that there are 3 channels in the image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr</strong> (<em>ndarray</em><em>[</em><em>N</em><em>, </em><em>M</em><em>, </em><em>..</em><em>]</em>) – the image</li>
<li><strong>copy</strong> (<em>bool</em>) – Always copies if True, if False, then copies only when the
size of the array must change.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">with shape (N, M, C), where C in {3, 4}</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other atleast_3channels</dd>
<dt>Doctest:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_3channels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_3channels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_3channels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_3channels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.atleast_nd">
<code class="descclassname">vtool.</code><code class="descname">atleast_nd</code><span class="sig-paren">(</span><em>arr</em>, <em>n</em>, <em>tofront=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#atleast_nd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.atleast_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>View inputs as arrays with at least n dimensions.
TODO: Submit as a PR to numpy</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arr</strong> (<em>array_like</em>) – One array-like object.  Non-array inputs are
converted to arrays.  Arrays that already have n or more
dimensions are preserved.</li>
<li><strong>n</strong> (<em>int</em>) – number of dimensions to ensure</li>
<li><strong>tofront</strong> (<em>bool</em>) – if True new dimensions are added to the front of the
array.  otherwise they are added to the back.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.numpy_utils atleast_nd</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">An array with <code class="docutils literal notranslate"><span class="pre">a.ndim</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>.  Copies are avoided where possible,
and views with three or more dimensions are returned.  For example,
a 1-D array of shape <code class="docutils literal notranslate"><span class="pre">(N,)</span></code> becomes a view of shape
<code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">N,</span> <span class="pre">1)</span></code>, and a 2-D array of shape <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">N)</span></code> becomes a view
of shape <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">N,</span> <span class="pre">1)</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">ensure_shape, np.atleast_1d, np.atleast_2d, np.atleast_3d</p>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[[[</span><span class="mi">1</span><span class="p">]]]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr1_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr2_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result3</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr3_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">,</span> <span class="n">result3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">vtool.</code><code class="descname">atleast_nd</code><span class="sig-paren">(</span><em>arr</em>, <em>n</em>, <em>tofront=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#atleast_nd"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>View inputs as arrays with at least n dimensions.
TODO: Submit as a PR to numpy</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arr</strong> (<em>array_like</em>) – One array-like object.  Non-array inputs are
converted to arrays.  Arrays that already have n or more
dimensions are preserved.</li>
<li><strong>n</strong> (<em>int</em>) – number of dimensions to ensure</li>
<li><strong>tofront</strong> (<em>bool</em>) – if True new dimensions are added to the front of the
array.  otherwise they are added to the back.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.numpy_utils atleast_nd</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">An array with <code class="docutils literal notranslate"><span class="pre">a.ndim</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>.  Copies are avoided where possible,
and views with three or more dimensions are returned.  For example,
a 1-D array of shape <code class="docutils literal notranslate"><span class="pre">(N,)</span></code> becomes a view of shape
<code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">N,</span> <span class="pre">1)</span></code>, and a 2-D array of shape <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">N)</span></code> becomes a view
of shape <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">N,</span> <span class="pre">1)</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">ensure_shape, np.atleast_1d, np.atleast_2d, np.atleast_3d</p>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[[[</span><span class="mi">1</span><span class="p">]]]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr1_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr2_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result3</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr3_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">,</span> <span class="n">result3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.atleast_shape">
<code class="descclassname">vtool.</code><code class="descname">atleast_shape</code><span class="sig-paren">(</span><em>arr</em>, <em>dimshape</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#atleast_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.atleast_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures that an array takes a certain shape. The total size of the array
must not change.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr</strong> (<em>ndarray</em>) – array to change the shape of</li>
<li><strong>dimshape</strong> (<em>tuple</em>) – desired shape (Nones can be used to broadcast
dimensions)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a href="#id147"><span class="problematic" id="id148">arr_</span></a> -  the input array, which has been modified inplace.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other ensure_shape</dd>
<dt>Doctest:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(()),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(()),</span> <span class="nb">tuple</span><span class="p">())</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(()),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">atleast_shape</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">atleast_shape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.augment_2x2_with_translation">
<code class="descclassname">vtool.</code><code class="descname">augment_2x2_with_translation</code><span class="sig-paren">(</span><em>kpts</em>, <em>_mat2x2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#augment_2x2_with_translation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.augment_2x2_with_translation" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function to augment shape matrix with a translation component.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.bar_L2_sift">
<code class="descclassname">vtool.</code><code class="descname">bar_L2_sift</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#bar_L2_sift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.bar_L2_sift" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalized SIFT L2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>hist1</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</li>
<li><strong>hist2</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance –test-bar_L2_sift</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">barl2_dist</span> <span class="o">=</span> <span class="n">bar_L2_sift</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">barl2_dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.bar_cos_sift">
<code class="descclassname">vtool.</code><code class="descname">bar_cos_sift</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#bar_cos_sift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.bar_cos_sift" title="Permalink to this definition">¶</a></dt>
<dd><p>1 - cos dist</p>
</dd></dl>

<dl class="function">
<dt id="vtool.bbox_center">
<code class="descclassname">vtool.</code><code class="descname">bbox_center</code><span class="sig-paren">(</span><em>bbox</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_center"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.bbox_center" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.bbox_from_center_wh">
<code class="descclassname">vtool.</code><code class="descname">bbox_from_center_wh</code><span class="sig-paren">(</span><em>center_xy</em>, <em>wh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_from_center_wh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.bbox_from_center_wh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.bbox_from_extent">
<code class="descclassname">vtool.</code><code class="descname">bbox_from_extent</code><span class="sig-paren">(</span><em>extent</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_from_extent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.bbox_from_extent" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>extent</strong> (<em>ndarray</em>) – tl_x, br_x, tl_y, br_y</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">tl_x, tl_y, w, h</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bbox (ndarray)</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="n">bbox_from_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;bbox = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">bbox = [0, 0, 10, 10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.bbox_from_verts">
<code class="descclassname">vtool.</code><code class="descname">bbox_from_verts</code><span class="sig-paren">(</span><em>verts</em>, <em>castint=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_from_verts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.bbox_from_verts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.bbox_from_xywh">
<code class="descclassname">vtool.</code><code class="descname">bbox_from_xywh</code><span class="sig-paren">(</span><em>xy, wh, xy_rel_pos=[0, 0]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_from_xywh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.bbox_from_xywh" title="Permalink to this definition">¶</a></dt>
<dd><p>need to specify xy_rel_pos if xy is not in tl already</p>
</dd></dl>

<dl class="function">
<dt id="vtool.bboxes_from_vert_list">
<code class="descclassname">vtool.</code><code class="descname">bboxes_from_vert_list</code><span class="sig-paren">(</span><em>verts_list</em>, <em>castint=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bboxes_from_vert_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.bboxes_from_vert_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the bounding polygon inside a rectangle</p>
</dd></dl>

<dl class="function">
<dt id="vtool.beaton_tukey_loss">
<code class="descclassname">vtool.</code><code class="descname">beaton_tukey_loss</code><span class="sig-paren">(</span><em>u</em>, <em>a=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#beaton_tukey_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.beaton_tukey_loss" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m wbia.plottool.draw_func2 –exec-plot_func –show –range=-8,8 –func=vt.beaton_tukey_weight,vt.beaton_tukey_loss</dd>
</dl>
<p class="rubric">References</p>
<p>Steward_Robust%20parameter%20estimation%20in%20computer%20vision.pdf</p>
</dd></dl>

<dl class="function">
<dt id="vtool.beaton_tukey_weight">
<code class="descclassname">vtool.</code><code class="descname">beaton_tukey_weight</code><span class="sig-paren">(</span><em>u</em>, <em>a=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#beaton_tukey_weight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.beaton_tukey_weight" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m wbia.plottool.draw_func2 –exec-plot_func –show –range=-8,8 –func=vt.beaton_tukey_weight</dd>
</dl>
<p class="rubric">References</p>
<p>Steward_Robust%20parameter%20estimation%20in%20computer%20vision.pdf</p>
</dd></dl>

<dl class="function">
<dt id="vtool.blend_images">
<code class="descclassname">vtool.</code><code class="descname">blend_images</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>mode='average'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend_images" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img1</strong> (<em>np.ndarray</em>) – first image</li>
<li><strong>img2</strong> (<em>np.ndarray</em>) – second image</li>
<li><strong>mode</strong> (<em>str</em>) – can be average, multiply, or overlay</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.blend_images_average">
<code class="descclassname">vtool.</code><code class="descname">blend_images_average</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>alpha=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend_images_average" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>alpha</strong> (<em>float</em>) – (default = 0.5)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">imgB</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.blend blend_images_average:0 –show
python -m vtool.blend blend_images_average:1 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_average</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">blend_images_average</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s1">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;alpha=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.blend_images_average_stack">
<code class="descclassname">vtool.</code><code class="descname">blend_images_average_stack</code><span class="sig-paren">(</span><em>images</em>, <em>alpha=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_average_stack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend_images_average_stack" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>alpha</strong> (<em>float</em>) – (default = 0.5)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">imgB</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.blend –test-blend_images_average:0 –show
python -m vtool.blend –test-blend_images_average:1 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_average</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.blend_images_mult_average">
<code class="descclassname">vtool.</code><code class="descname">blend_images_mult_average</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>alpha=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_mult_average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend_images_mult_average" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>alpha</strong> (<em>float</em>) – (default = 0.5)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">imgB</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.blend –test-blend_images_mult_average:0 –show
python -m vtool.blend –test-blend_images_mult_average:1 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_mult_average</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">blend_images_mult_average</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s1">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;alpha=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.blend_images_multiply">
<code class="descclassname">vtool.</code><code class="descname">blend_images_multiply</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>alpha=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_multiply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend_images_multiply" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>alpha</strong> (<em>float</em>) – (default = 0.5)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">imgB</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.blend –test-blend_images_multiply:0 –show
python -m vtool.blend –test-blend_images_multiply:1 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_multiply</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">blend_images_multiply</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s1">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;alpha=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.breakup_equal_streak">
<code class="descclassname">vtool.</code><code class="descname">breakup_equal_streak</code><span class="sig-paren">(</span><em>arr_in</em>, <em>left_endpoint=None</em>, <em>right_endpoint=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#breakup_equal_streak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.breakup_equal_streak" title="Permalink to this definition">¶</a></dt>
<dd><p>Breaks up streaks of equal values by interpolating between the next lowest and next highest value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr_in</strong> – </li>
<li><strong>left_endpoint</strong> (<em>None</em>) – (default = None)</li>
<li><strong>right_endpoint</strong> (<em>None</em>) – (default = None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">arr -</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –exec-breakup_equal_streak
python -m vtool.util_math –test-ensure_monotone_strictly_increasing –show –offset=0</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">1.20488135</span><span class="p">,</span>  <span class="mf">1.2529297</span> <span class="p">,</span>  <span class="mf">1.27306686</span><span class="p">,</span>  <span class="mf">1.29859663</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="mf">1.31769871</span><span class="p">,</span> <span class="mf">1.37102388</span><span class="p">,</span>  <span class="mf">1.38114004</span><span class="p">,</span>  <span class="mf">1.45732054</span><span class="p">,</span>  <span class="mf">1.48119571</span><span class="p">,</span>  <span class="mf">1.48119571</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.5381895</span> <span class="p">,</span>  <span class="mf">1.54162741</span><span class="p">,</span>  <span class="mf">1.57492901</span><span class="p">,</span>  <span class="mf">1.61129523</span><span class="p">,</span>  <span class="mf">1.61129523</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.61270343</span><span class="p">,</span>  <span class="mf">1.63377551</span><span class="p">,</span>  <span class="mf">1.7423034</span> <span class="p">,</span>  <span class="mf">1.76364247</span><span class="p">,</span>  <span class="mf">1.79908459</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.83564709</span><span class="p">,</span>  <span class="mf">1.83819742</span><span class="p">,</span>  <span class="mf">1.83819742</span><span class="p">,</span>  <span class="mf">1.86786967</span><span class="p">,</span>  <span class="mf">1.86786967</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.90720142</span><span class="p">,</span>  <span class="mf">1.90720142</span><span class="p">,</span>  <span class="mf">1.92293973</span><span class="p">,</span>  <span class="mf">1.92293973</span><span class="p">,</span> <span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left_endpoint</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right_endpoint</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">breakup_equal_streak</span><span class="p">(</span><span class="n">arr_in</span><span class="p">,</span> <span class="n">left_endpoint</span><span class="p">,</span> <span class="n">right_endpoint</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_increasing</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;arr = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.build_affine_lstsqrs_Mx6">
<code class="descclassname">vtool.</code><code class="descname">build_affine_lstsqrs_Mx6</code><span class="sig-paren">(</span><em>xy1_man</em>, <em>xy2_man</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#build_affine_lstsqrs_Mx6"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.build_affine_lstsqrs_Mx6" title="Permalink to this definition">¶</a></dt>
<dd><p>CURRENTLY NOT WORKING</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification –test-build_affine_lstsqrs_Mx6</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_man</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_man</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Mx6</span> <span class="o">=</span> <span class="n">build_affine_lstsqrs_Mx6</span><span class="p">(</span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">Mx6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">Mx6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Sympy:</dt>
<dd><p class="first">import sympy as sym
x1, y1, x2, y2 = sym.symbols(‘x1, y1, x2, y2’)
A = sym.Matrix([</p>
<blockquote>
<div>[x1, y1,  0,  0, 1, 0],
[ 0,  0, x1, y1, 0, 1],</div></blockquote>
<p class="last">])
b = sym.Matrix([[x2], [y2]])
x = (A.T.multiply(A)).inv().multiply(A.T.multiply(b))
x = (A.T.multiply(A)).pinv().multiply(A.T.multiply(b))</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf">https://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf</a> page 22</p>
</dd></dl>

<dl class="function">
<dt id="vtool.build_lstsqrs_Mx9">
<code class="descclassname">vtool.</code><code class="descname">build_lstsqrs_Mx9</code><span class="sig-paren">(</span><em>xy1_mn</em>, <em>xy2_mn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#build_lstsqrs_Mx9"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.build_lstsqrs_Mx9" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the M x 9 least squares matrix</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification –test-build_lstsqrs_Mx9</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Mx9</span> <span class="o">=</span> <span class="n">build_lstsqrs_Mx9</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">Mx9</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">suppress_small</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[  0.00e+00,   0.00e+00,   0.00e+00,  -3.20e+01,  -2.72e+01,</span>
<span class="go">            -1.00e+00,   8.82e+02,   7.49e+02,   2.76e+01],</span>
<span class="go">          [  3.20e+01,   2.72e+01,   1.00e+00,   0.00e+00,   0.00e+00,</span>
<span class="go">             0.00e+00,  -1.09e+03,  -9.28e+02,  -3.42e+01]], dtype=np.float64)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://dip.sun.ac.za/~stefan/TW793/attach/notes/homography_estimation.pdf">http://dip.sun.ac.za/~stefan/TW793/attach/notes/homography_estimation.pdf</a>
<a class="reference external" href="http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf">http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf</a> Page 317
<a class="reference external" href="http://vision.ece.ucsb.edu/~zuliani/Research/RANSAC/docs/RANSAC4Dummies.pdf">http://vision.ece.ucsb.edu/~zuliani/Research/RANSAC/docs/RANSAC4Dummies.pdf</a> page 53</p>
</dd></dl>

<dl class="function">
<dt id="vtool.calc_error_bars_from_sample">
<code class="descclassname">vtool.</code><code class="descname">calc_error_bars_from_sample</code><span class="sig-paren">(</span><em>sample_size</em>, <em>num_positive</em>, <em>pop</em>, <em>conf_level=0.95</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#calc_error_bars_from_sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.calc_error_bars_from_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines a error bars of sample</p>
<p class="rubric">References</p>
<p><a class="reference external" href="https://www.qualtrics.com/blog/determining-sample-size/">https://www.qualtrics.com/blog/determining-sample-size/</a>
<a class="reference external" href="http://www.surveysystem.com/sscalc.htm">http://www.surveysystem.com/sscalc.htm</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Sample_size_determination">https://en.wikipedia.org/wiki/Sample_size_determination</a>
<a class="reference external" href="http://www.surveysystem.com/sample-size-formula.htm">http://www.surveysystem.com/sample-size-formula.htm</a>
<a class="reference external" href="http://courses.wcupa.edu/rbove/Berenson/10th%20ed%20CD-ROM%20topics/section8_7.pdf">http://courses.wcupa.edu/rbove/Berenson/10th%20ed%20CD-ROM%20topics/section8_7.pdf</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Standard_normal_table">https://en.wikipedia.org/wiki/Standard_normal_table</a>
<a class="reference external" href="https://www.unc.edu/~rls/s151-2010/class23.pdf">https://www.unc.edu/~rls/s151-2010/class23.pdf</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.calc_sample_from_error_bars">
<code class="descclassname">vtool.</code><code class="descname">calc_sample_from_error_bars</code><span class="sig-paren">(</span><em>err_frac</em>, <em>pop</em>, <em>conf_level=0.95</em>, <em>prior=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#calc_sample_from_error_bars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.calc_sample_from_error_bars" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines a reasonable sample size to achieve desired error bars.</p>
<p>import sympy
p, n, N, z = sympy.symbols(‘prior, ss, pop, zval’)
me = sympy.symbols(‘err_frac’)
expr = (z * sympy.sqrt((p * (1 - p) / n) * ((N - n) / (N - 1))))
equation = sympy.Eq(me, expr)
nexpr = sympy.solve(equation, [n])[0]
nexpr = sympy.simplify(nexpr)</p>
<p>import autopep8
print(autopep8.fix_lines([‘ss = ‘ + str(nexpr)], autopep8._get_options({}, False)))</p>
<p>ss = -pop * prior* (zval**2) <em>(prior - 1) / ((err_frac *</em> 2) * pop - (err_frac**2) - prior * (zval**2) * (prior - 1))
ss = pop * prior * zval ** 2 * (prior - 1) / (-err_frac ** 2 * pop + err_frac ** 2 + prior * zval ** 2 * (prior - 1))</p>
</dd></dl>

<dl class="function">
<dt id="vtool.cast_split">
<code class="descclassname">vtool.</code><code class="descname">cast_split</code><span class="sig-paren">(</span><em>kpts</em>, <em>dtype=&lt;class 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#cast_split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.cast_split" title="Permalink to this definition">¶</a></dt>
<dd><p>breakup keypoints into location, shape, and orientation</p>
</dd></dl>

<dl class="function">
<dt id="vtool.check_exif_keys">
<code class="descclassname">vtool.</code><code class="descname">check_exif_keys</code><span class="sig-paren">(</span><em>pil_img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#check_exif_keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.check_exif_keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.check_expr_eq">
<code class="descclassname">vtool.</code><code class="descname">check_expr_eq</code><span class="sig-paren">(</span><em>expr1</em>, <em>expr2</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#check_expr_eq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.check_expr_eq" title="Permalink to this definition">¶</a></dt>
<dd><p>Does not work in general. Problem is not decidable.
Thanks Richard.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>expr1</strong> – </li>
<li><strong>expr2</strong> – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.symbolic –test-check_expr_eq</dd>
<dt>SeeALso:</dt>
<dd>vt.symbolic_randcheck</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.symbolic</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span> <span class="p">[</span><span class="n">sx</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">tx</span> <span class="o">+</span> <span class="n">w1</span><span class="o">*</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">sy</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">ty</span> <span class="o">+</span> <span class="n">w2</span><span class="o">*</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span> <span class="p">[</span><span class="n">sx</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">tx</span> <span class="o">+</span> <span class="n">w1</span><span class="o">*</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">sy</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">ty</span> <span class="o">+</span> <span class="n">w2</span><span class="o">*</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">check_expr_eq</span><span class="p">(</span><span class="n">expr1</span><span class="p">,</span> <span class="n">expr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.check_kpts_in_bounds">
<code class="descclassname">vtool.</code><code class="descname">check_kpts_in_bounds</code><span class="sig-paren">(</span><em>kpts_</em>, <em>width</em>, <em>height</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#check_kpts_in_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.check_kpts_in_bounds" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.check_sift_validity">
<code class="descclassname">vtool.</code><code class="descname">check_sift_validity</code><span class="sig-paren">(</span><em>sift_uint8</em>, <em>lbl=None</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#check_sift_validity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.check_sift_validity" title="Permalink to this definition">¶</a></dt>
<dd><p>checks if a SIFT descriptor is valid</p>
</dd></dl>

<dl class="function">
<dt id="vtool.check_unused_kwargs">
<code class="descclassname">vtool.</code><code class="descname">check_unused_kwargs</code><span class="sig-paren">(</span><em>kwargs</em>, <em>expected_keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#check_unused_kwargs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.check_unused_kwargs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.circular_distance">
<code class="descclassname">vtool.</code><code class="descname">circular_distance</code><span class="sig-paren">(</span><em>arr=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#circular_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.circular_distance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clipnorm">
<code class="descclassname">vtool.</code><code class="descname">clipnorm</code><span class="sig-paren">(</span><em>arr</em>, <em>min_</em>, <em>max_</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#clipnorm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clipnorm" title="Permalink to this definition">¶</a></dt>
<dd><p>normalizes arr to the range 0 to 1 using <a href="#id149"><span class="problematic" id="id150">min_</span></a> and <a href="#id151"><span class="problematic" id="id152">max_</span></a> as clipping bounds</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clipwhite">
<code class="descclassname">vtool.</code><code class="descname">clipwhite</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#clipwhite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clipwhite" title="Permalink to this definition">¶</a></dt>
<dd><p>Strips white borders off an image</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clipwhite_ondisk">
<code class="descclassname">vtool.</code><code class="descname">clipwhite_ondisk</code><span class="sig-paren">(</span><em>fpath_in</em>, <em>fpath_out=None</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#clipwhite_ondisk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clipwhite_ondisk" title="Permalink to this definition">¶</a></dt>
<dd><p>Strips white borders off an image on disk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fpath_in</strong> (<em>str</em>) – </li>
<li><strong>fpath_out</strong> (<em>None</em>) – (default = None)</li>
<li><strong>verbose</strong> (<em>bool</em>) – verbosity flag(default = True)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">fpath_out</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">str</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image clipwhite_ondisk</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.closest_point">
<code class="descclassname">vtool.</code><code class="descname">closest_point</code><span class="sig-paren">(</span><em>pt</em>, <em>pt_arr</em>, <em>distfunc=&lt;function L2_sqrd&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#closest_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.closest_point" title="Permalink to this definition">¶</a></dt>
<dd><p>finds the nearest point(s) in pts to (x, y)
pt = np.array([1])
pt_arr = np.array([1.1, 2, .95, 20])[:, None]
distfunc = vt.L2_sqrd</p>
</dd></dl>

<dl class="function">
<dt id="vtool.closest_point_on_bbox">
<code class="descclassname">vtool.</code><code class="descname">closest_point_on_bbox</code><span class="sig-paren">(</span><em>p</em>, <em>bbox</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#closest_point_on_bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.closest_point_on_bbox" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">21</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">closest_point_on_bbox</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_list</span><span class="p">]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.closest_point_on_line">
<code class="descclassname">vtool.</code><code class="descname">closest_point_on_line</code><span class="sig-paren">(</span><em>p</em>, <em>e1</em>, <em>e2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#closest_point_on_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.closest_point_on_line" title="Permalink to this definition">¶</a></dt>
<dd><p>e1 and e2 define two points on the line.
Does not clip to the segment.</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.geometry closest_point_on_line –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">21.83012702</span><span class="p">,</span>  <span class="mf">13.16987298</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">16.83012702</span><span class="p">,</span>  <span class="mf">21.83012702</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span>  <span class="mf">8.16987298</span><span class="p">,</span>  <span class="mf">16.83012702</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">13.16987298</span><span class="p">,</span>   <span class="mf">8.16987298</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">21.83012702</span><span class="p">,</span>  <span class="mf">13.16987298</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_list</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">close_pts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_list</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">closest_point_on_line</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span> <span class="k">for</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">itertwo</span><span class="p">(</span><span class="n">verts</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">L2_sqrd</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">new_pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">new_pt</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">close_pts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidates</span><span class="p">[</span><span class="n">dists</span><span class="o">.</span><span class="n">argmin</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">close_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">close_pts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original point&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">close_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">close_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;closest point on shape&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">p_list</span><span class="p">,</span> <span class="n">close_pts</span><span class="p">)):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.closest_point_on_line_segment">
<code class="descclassname">vtool.</code><code class="descname">closest_point_on_line_segment</code><span class="sig-paren">(</span><em>p</em>, <em>e1</em>, <em>e2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#closest_point_on_line_segment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.closest_point_on_line_segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the closet point from p on line segment (e1, e2)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>p</strong> (<em>ndarray</em>) – and xy point</li>
<li><strong>e1</strong> (<em>ndarray</em>) – the first xy endpoint of the segment</li>
<li><strong>e2</strong> (<em>ndarray</em>) – the second xy endpoint of the segment</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">pt_on_seg - the closest xy point on (e1, e2) from p</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line">http://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line</a>
<a class="reference external" href="http://stackoverflow.com/questions/849211/shortest-distance-between-a-point-and-a-line-segment">http://stackoverflow.com/questions/849211/shortest-distance-between-a-point-and-a-line-segment</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.geometry –exec-closest_point_on_line_segment –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#bbox = np.array([10, 10, 10, 10], dtype=np.float)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#verts_ = np.array(vt.verts_from_bbox(bbox, close=True))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#R = vt.rotation_around_bbox_mat3x3(vt.TAU / 3, bbox)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#verts = vt.transform_points_with_homography(R, verts_.T).T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">21.83012702</span><span class="p">,</span>  <span class="mf">13.16987298</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">16.83012702</span><span class="p">,</span>  <span class="mf">21.83012702</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span>  <span class="mf">8.16987298</span><span class="p">,</span>  <span class="mf">16.83012702</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">13.16987298</span><span class="p">,</span>   <span class="mf">8.16987298</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">21.83012702</span><span class="p">,</span>  <span class="mf">13.16987298</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_list</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">close_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">closest_point_on_vert_segments</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">verts</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original point&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">close_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">close_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;closest point on shape&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">p_list</span><span class="p">,</span> <span class="n">close_pts</span><span class="p">)):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.closest_point_on_vert_segments">
<code class="descclassname">vtool.</code><code class="descname">closest_point_on_vert_segments</code><span class="sig-paren">(</span><em>p</em>, <em>verts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#closest_point_on_vert_segments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.closest_point_on_vert_segments" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.colwise_operation">
<code class="descclassname">vtool.</code><code class="descname">colwise_operation</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em>, <em>op</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#colwise_operation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.colwise_operation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.combine_offset_lists">
<code class="descclassname">vtool.</code><code class="descname">combine_offset_lists</code><span class="sig-paren">(</span><em>offsets_list</em>, <em>sfs_list</em>, <em>offset_tups</em>, <em>sf_tups</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#combine_offset_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.combine_offset_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper for stacking</p>
</dd></dl>

<dl class="function">
<dt id="vtool.compare_implementations">
<code class="descclassname">vtool.</code><code class="descname">compare_implementations</code><span class="sig-paren">(</span><em>func1</em>, <em>func2</em>, <em>args</em>, <em>show_output=False</em>, <em>lbl1=''</em>, <em>lbl2=''</em>, <em>output_lbl=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compare_implementations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.compare_implementations" title="Permalink to this definition">¶</a></dt>
<dd><p>tests two different implementations of the same function</p>
</dd></dl>

<dl class="function">
<dt id="vtool.compare_matrix_columns">
<code class="descclassname">vtool.</code><code class="descname">compare_matrix_columns</code><span class="sig-paren">(</span><em>matrix</em>, <em>columns</em>, <em>comp_op=&lt;ufunc 'equal'&gt;</em>, <em>logic_op=&lt;ufunc 'logical_or'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compare_matrix_columns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.compare_matrix_columns" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>REPLACE WITH:</dt>
<dd>qfx2_invalid = logic_op.reduce([comp_op([:, None], qfx2_normnid) for col1 in qfx2_topnid.T])</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.compare_matrix_to_rows">
<code class="descclassname">vtool.</code><code class="descname">compare_matrix_to_rows</code><span class="sig-paren">(</span><em>row_matrix</em>, <em>row_list</em>, <em>comp_op=&lt;ufunc 'equal'&gt;</em>, <em>logic_op=&lt;ufunc 'logical_or'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compare_matrix_to_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.compare_matrix_to_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares each row in row_list to each row in row matrix using comp_op
Both must have the same number of columns.
Performs logic_op on the results of each individual row</p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>wbia.algo.hots.nn_weights.mark_name_valid_normalizers</dd>
</dl>
<p>compop   = np.equal
logic_op = np.logical_or</p>
</dd></dl>

<dl class="function">
<dt id="vtool.componentwise_dot">
<code class="descclassname">vtool.</code><code class="descname">componentwise_dot</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#componentwise_dot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.componentwise_dot" title="Permalink to this definition">¶</a></dt>
<dd><p>a dot product is a componentwise multiplication of
two vector and then a sum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr1</strong> (<em>ndarray</em>) – </li>
<li><strong>arr2</strong> (<em>ndarray</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">cosangle</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">arr1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">arr1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosangle</span> <span class="o">=</span> <span class="n">componentwise_dot</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cosangle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ 1.  1.  1.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.compress2">
<code class="descclassname">vtool.</code><code class="descname">compress2</code><span class="sig-paren">(</span><em>arr</em>, <em>flag_list</em>, <em>axis=None</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compress2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.compress2" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around numpy compress that makes the signature more similar to take</p>
</dd></dl>

<dl class="function">
<dt id="vtool.compute_affine">
<code class="descclassname">vtool.</code><code class="descname">compute_affine</code><span class="sig-paren">(</span><em>xy1_man</em>, <em>xy2_man</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#compute_affine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.compute_affine" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xy1_mn</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – xy points in image1</li>
<li><strong>xy2_mn</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – corresponding xy points in image 2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A - affine matrix</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[shape=(3,3)]</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification –test-compute_affine:1 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">compute_affine</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy1_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers_normalized</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A_prime</span> <span class="o">=</span> <span class="n">compute_affine</span><span class="p">(</span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span> <span class="n">A_prime</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">T1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">/=</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip2_blendA</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">get_blended_chip</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rchip2_blendA</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">[[  1.19e+00  -1.06e-02  -4.49e+01]</span>
<span class="go"> [ -2.22e-01   1.12e+00  -2.78e+01]</span>
<span class="go"> [  0.00e+00   0.00e+00   1.00e+00]]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.compute_chip">
<code class="descclassname">vtool.</code><code class="descname">compute_chip</code><span class="sig-paren">(</span><em>gfpath</em>, <em>bbox</em>, <em>theta</em>, <em>new_size</em>, <em>filter_list=[]</em>, <em>interpolation=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#compute_chip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.compute_chip" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts a chip and applies filters</p>
<p>DEPRICATE</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gfpath</strong> (<em>str</em>) – image file path string</li>
<li><strong>bbox</strong> (<em>tuple</em>) – bounding box in the format (x, y, w, h)</li>
<li><strong>theta</strong> (<em>float</em>) – angle in radians</li>
<li><strong>new_size</strong> (<em>tuple</em>) – must maintain the same aspect ratio or else you will get weirdness</li>
<li><strong>filter_list</strong> (<em>list</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">chipBGR -  cropped image</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.chip –test-compute_chip –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="n">TAU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gfpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filter_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR</span> <span class="o">=</span> <span class="n">compute_chip</span><span class="p">(</span><span class="n">gfpath</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">new_size</span><span class="p">,</span> <span class="n">filter_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">chipBGR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_size</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;did not resize correctly&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">draw_verts</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">gfpath</span><span class="p">),</span> <span class="n">vt</span><span class="o">.</span><span class="n">scaled_verts_from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.compute_distances">
<code class="descclassname">vtool.</code><code class="descname">compute_distances</code><span class="sig-paren">(</span><em>hist1, hist2, dist_list=['L1', 'L2']</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#compute_distances"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.compute_distances" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hist1</strong> (<em>ndarray</em>) – </li>
<li><strong>hist2</strong> (<em>ndarray</em>) – </li>
<li><strong>dist_list</strong> (<em>list</em>) – (default = [‘L1’, ‘L2’])</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dist_dict</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance –test-compute_distances</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">,</span> <span class="s1">&#39;L2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_dict</span> <span class="o">=</span> <span class="n">compute_distances</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">,</span> <span class="n">dist_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">dist_dict</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.compute_homog">
<code class="descclassname">vtool.</code><code class="descname">compute_homog</code><span class="sig-paren">(</span><em>xy1_mn</em>, <em>xy2_mn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#compute_homog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.compute_homog" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate 6 degrees of freedom homography transformation
Computes homography from normalized (0 to 1) point correspondences
from 2 –&gt; 1
(database-&gt;query)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xy1_mn</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – xy points in image1</li>
<li><strong>xy2_mn</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – corresponding xy points in image 2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">H - homography matrix</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[shape=(3,3)]</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification –test-compute_homog:1 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">compute_homog</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#result = ut.hashstr(H)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[  1.83e-03   2.85e-03  -7.11e-01]</span>
<span class="go"> [  2.82e-03   1.80e-03  -7.03e-01]</span>
<span class="go"> [  1.67e-05   1.68e-05  -5.53e-03]]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers_normalized</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H_prime</span> <span class="o">=</span> <span class="n">compute_homog</span><span class="p">(</span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span> <span class="n">H_prime</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">T1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">/=</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip2_blendH</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">get_blended_chip</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rchip2_blendH</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">[[  9.22e-01  -2.50e-01   2.75e+01]</span>
<span class="go"> [ -2.04e-01   8.79e-01  -7.94e+00]</span>
<span class="go"> [ -1.82e-04  -5.99e-04   1.00e+00]]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.compute_ndarray_unique_rowids_unsafe">
<code class="descclassname">vtool.</code><code class="descname">compute_ndarray_unique_rowids_unsafe</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_ndarray_unique_rowids_unsafe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.compute_ndarray_unique_rowids_unsafe" title="Permalink to this definition">¶</a></dt>
<dd><p>arr = np.random.randint(2, size=(10000, 10))
vt.compute_unique_data_ids_(list(map(tuple, arr)))
len(vt.compute_unique_data_ids_(list(map(tuple, arr))))
len(np.unique(vt.compute_unique_data_ids_(list(map(tuple, arr)))))</p>
<p>%timeit vt.compute_unique_data_ids_(list(map(tuple, arr)))
%timeit compute_ndarray_unique_rowids_unsafe(arr)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.compute_unique_arr_dataids">
<code class="descclassname">vtool.</code><code class="descname">compute_unique_arr_dataids</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_arr_dataids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.compute_unique_arr_dataids" title="Permalink to this definition">¶</a></dt>
<dd><p>specialized version for speed when arr is an ndarray</p>
</dd></dl>

<dl class="function">
<dt id="vtool.compute_unique_data_ids">
<code class="descclassname">vtool.</code><code class="descname">compute_unique_data_ids</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_data_ids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.compute_unique_data_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>This is actually faster than compute_unique_integer_data_ids it seems</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-compute_unique_data_ids</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">534</span><span class="p">,</span> <span class="o">.</span><span class="mi">432</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">534</span><span class="p">,</span> <span class="o">.</span><span class="mi">432</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataid_list</span> <span class="o">=</span> <span class="n">compute_unique_data_ids</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;dataid_list = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">dataid_list</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">dataid_list = np.array([0, 1, 2, 3, 0, 4, 4, 2, 1], dtype=np.int32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.compute_unique_data_ids_">
<code class="descclassname">vtool.</code><code class="descname">compute_unique_data_ids_</code><span class="sig-paren">(</span><em>hashable_rows</em>, <em>iddict_=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_data_ids_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.compute_unique_data_ids_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.compute_unique_integer_data_ids">
<code class="descclassname">vtool.</code><code class="descname">compute_unique_integer_data_ids</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_integer_data_ids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.compute_unique_integer_data_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>This is actually slower than compute_unique_data_ids it seems</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">compute_unique_data_ids</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">compute_unique_integer_data_ids</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p>%timeit compute_unique_data_ids(data)
%timeit compute_unique_integer_data_ids(data)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.convert_colorspace">
<code class="descclassname">vtool.</code><code class="descname">convert_colorspace</code><span class="sig-paren">(</span><em>img</em>, <em>colorspace</em>, <em>src_colorspace='BGR'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#convert_colorspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.convert_colorspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts colorspace of img.
Convinience function around cv2.cvtColor</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>colorspace</strong> (<em>str</em>) – RGB, LAB, etc</li>
<li><strong>src_colorspace</strong> (<em>unicode</em>) – (default = u’BGR’)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">img -  image data</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[uint8_t, ndim=2]</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image convert_colorspace –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;zebra.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://itsnasb.com/wp-content/uploads/2013/03/lisa-frank-logo1.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_float</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_float01</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">colorspace</span> <span class="o">=</span> <span class="s1">&#39;LAB&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">src_colorspace</span> <span class="o">=</span> <span class="s1">&#39;BGR&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgLAB</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgL</span> <span class="o">=</span> <span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillL</span> <span class="o">=</span> <span class="n">imgL</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillAB</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">is_float</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">else</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgAB_LAB</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">fillL</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgA_LAB</span>  <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="n">fillL</span><span class="p">,</span> <span class="n">fillAB</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB_LAB</span>  <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="n">fillL</span><span class="p">,</span> <span class="n">fillAB</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgAB_BGR</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">imgAB_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgA_BGR</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">imgA_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB_BGR</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">imgB_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#imgAB_HSV = convert_colorspace(convert_colorspace(imgAB_LAB, &#39;LAB&#39;, &#39;BGR&#39;), &#39;BGR&#39;, &#39;HSV&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgAB_HSV</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="s1">&#39;HSV&#39;</span><span class="p">,</span> <span class="s1">&#39;BGR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgAB_HSV</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">6</span> <span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">is_float</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">else</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgCOLOR_BRG</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">imgAB_HSV</span><span class="p">,</span> <span class="s1">&#39;BGR&#39;</span><span class="p">,</span> <span class="s1">&#39;HSV&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;L (lightness)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A (grayscale)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B (grayscale)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgCOLOR_BRG</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Hue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgAB_BGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A+B (color overlay)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgA_BGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A (Red-Green)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB_BGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B (Blue-Yellow)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgblind_LAB</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">fillAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgblind_BRG</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">rgblind_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">byblind_LAB</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">fillAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">byblind_BGR</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">byblind_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">byblind_BGR</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;colorblind B-Y&#39;</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rgblind_BRG</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;colorblind R-G&#39;</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.convert_degrees">
<code class="descclassname">vtool.</code><code class="descname">convert_degrees</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#convert_degrees"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.convert_degrees" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to convert the GPS coordinates stored in the EXIF to degress in float format</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Geographic_coordinate_conversion">http://en.wikipedia.org/wiki/Geographic_coordinate_conversion</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.convert_image_list_colorspace">
<code class="descclassname">vtool.</code><code class="descname">convert_image_list_colorspace</code><span class="sig-paren">(</span><em>image_list</em>, <em>colorspace</em>, <em>src_colorspace='BGR'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#convert_image_list_colorspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.convert_image_list_colorspace" title="Permalink to this definition">¶</a></dt>
<dd><p>converts a list of images from &lt;src_colorspace&gt; to &lt;colorspace&gt;</p>
</dd></dl>

<dl class="function">
<dt id="vtool.convert_kptsZ_to_kpts">
<code class="descclassname">vtool.</code><code class="descname">convert_kptsZ_to_kpts</code><span class="sig-paren">(</span><em>kpts_Z</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#convert_kptsZ_to_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.convert_kptsZ_to_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert keypoints in Z format to invV format</p>
</dd></dl>

<dl class="function">
<dt id="vtool.cos_sift">
<code class="descclassname">vtool.</code><code class="descname">cos_sift</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#cos_sift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.cos_sift" title="Permalink to this definition">¶</a></dt>
<dd><p>cos dist</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance –test-cos_sift</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2_dist</span> <span class="o">=</span> <span class="n">cos_sift</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.cosine_dist">
<code class="descclassname">vtool.</code><code class="descname">cosine_dist</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#cosine_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.cosine_dist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.crop_out_imgfill">
<code class="descclassname">vtool.</code><code class="descname">crop_out_imgfill</code><span class="sig-paren">(</span><em>img</em>, <em>fillval=None</em>, <em>thresh=0</em>, <em>channel=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#crop_out_imgfill"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.crop_out_imgfill" title="Permalink to this definition">¶</a></dt>
<dd><p>Crops image to remove fillval</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>fillval</strong> (<em>None</em>) – (default = None)</li>
<li><strong>thresh</strong> (<em>int</em>) – (default = 0)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">cropped_img</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –exec-crop_out_imgfill</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_stripe_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="n">img</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_GRAY2RGB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_img</span> <span class="o">=</span> <span class="n">crop_out_imgfill</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">fillval</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_img2</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">cropped_img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_RGB2GRAY</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;cropped_img2 = </span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cropped_img2</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_stripe_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="n">img</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillval</span> <span class="o">=</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_img</span> <span class="o">=</span> <span class="n">crop_out_imgfill</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">fillval</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;cropped_img = </span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cropped_img</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.csum">
<code class="descclassname">vtool.</code><code class="descname">csum</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#csum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.csum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.custom_sympy_attrs">
<code class="descclassname">vtool.</code><code class="descname">custom_sympy_attrs</code><span class="sig-paren">(</span><em>mat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#custom_sympy_attrs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.custom_sympy_attrs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.cvt_BGR2L">
<code class="descclassname">vtool.</code><code class="descname">cvt_BGR2L</code><span class="sig-paren">(</span><em>imgBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#cvt_BGR2L"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.cvt_BGR2L" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.cvt_BGR2RGB">
<code class="descclassname">vtool.</code><code class="descname">cvt_BGR2RGB</code><span class="sig-paren">(</span><em>imgBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#cvt_BGR2RGB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.cvt_BGR2RGB" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.cvt_bbox_xywh_to_pt1pt2">
<code class="descclassname">vtool.</code><code class="descname">cvt_bbox_xywh_to_pt1pt2</code><span class="sig-paren">(</span><em>xywh</em>, <em>sx=1.0</em>, <em>sy=1.0</em>, <em>round_=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#cvt_bbox_xywh_to_pt1pt2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.cvt_bbox_xywh_to_pt1pt2" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts bbox to thumb format with a scale factor</p>
</dd></dl>

<dl class="function">
<dt id="vtool.cyclic_distance">
<code class="descclassname">vtool.</code><code class="descname">cyclic_distance</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em>, <em>modulo</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#cyclic_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.cyclic_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>returns an unsigned distance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr1</strong> (<em>ndarray</em>) – </li>
<li><strong>arr2</strong> (<em>ndarray</em>) – </li>
<li><strong>modulo</strong> (<em>float</em><em> or </em><em>int</em>) – </li>
<li><strong>out</strong> (<em>ndarray</em>) – (default = None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">arr_dist</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance cyclic_distance</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modulo</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># doesnt matter what offset is</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">modulo</span> <span class="o">+</span> <span class="n">offset</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">arr1</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_dist</span> <span class="o">=</span> <span class="n">cyclic_distance</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="n">modulo</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;arr_dist =</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_dist</span><span class="p">),))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.decompose_Z_to_RV_mats2x2">
<code class="descclassname">vtool.</code><code class="descname">decompose_Z_to_RV_mats2x2</code><span class="sig-paren">(</span><em>Z_mats2x2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#decompose_Z_to_RV_mats2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.decompose_Z_to_RV_mats2x2" title="Permalink to this definition">¶</a></dt>
<dd><p>A, B, C = [0.016682, 0.001693, 0.014927]
#A, B, C = [0.010141, -1.1e-05, 0.02863]
Z = np.array([[A, B], [B, C]])</p>
<p>A, B, C = 0.010141, -1.1e-05, 0.02863</p>
<dl class="docutils">
<dt>Ignore:</dt>
<dd># Working on figuring relationship between us and VGG
A, B, _, C = Z_mats2x2[0].ravel()
X, Y = 0, 0
theta = np.linspace(0, np.pi * 2)
circle_xy = np.vstack([np.cos(theta), np.sin(theta)])
invV = invV_mats[0, 0:2, 0:2]
x, y = invV.dot(circle_xy)
V = np.linalg.inv(invV)
E = V.T.dot(V)
[[A, B], [_, C]] = E
[[<a href="#id153"><span class="problematic" id="id154">A_</span></a>, <a href="#id155"><span class="problematic" id="id156">B_</span></a>], [_, <a href="#id157"><span class="problematic" id="id158">C_</span></a>]] = E
print(A*(x-X) ** 2 + 2*B*(x-X)*(y-Y) + C*(y-Y) ** 2)</dd>
<dt>Z_mats2x2 = np.array([</dt>
<dd>[[ .016682, .001693],
[ .001693, .014927]],
[[ .01662, .001693],
[ .001693, .014927]],
[[ .016682, .00193],
[ .00193, .01492]],
])</dd>
</dl>
<p>import scipy.linalg
%timeit np.array([scipy.linalg.sqrtm(Z) for Z in Z_mats2x2])
%timeit decompose_Z_to_VR_mats2x2(Z_mats2x2)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.decompose_Z_to_V_2x2">
<code class="descclassname">vtool.</code><code class="descname">decompose_Z_to_V_2x2</code><span class="sig-paren">(</span><em>Z_2x2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#decompose_Z_to_V_2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.decompose_Z_to_V_2x2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.decompose_Z_to_invV_2x2">
<code class="descclassname">vtool.</code><code class="descname">decompose_Z_to_invV_2x2</code><span class="sig-paren">(</span><em>Z_2x2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#decompose_Z_to_invV_2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.decompose_Z_to_invV_2x2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.decompose_Z_to_invV_mats2x2">
<code class="descclassname">vtool.</code><code class="descname">decompose_Z_to_invV_mats2x2</code><span class="sig-paren">(</span><em>Z_mats2x2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#decompose_Z_to_invV_mats2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.decompose_Z_to_invV_mats2x2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.demodata_match">
<code class="descclassname">vtool.</code><code class="descname">demodata_match</code><span class="sig-paren">(</span><em>cfgdict={}</em>, <em>apply=True</em>, <em>use_cache=True</em>, <em>recompute=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#demodata_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.demodata_match" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.det_distance">
<code class="descclassname">vtool.</code><code class="descname">det_distance</code><span class="sig-paren">(</span><em>det1</em>, <em>det2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#det_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.det_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns how far off determinants are from one another</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaledist</span> <span class="o">=</span> <span class="n">det_distance</span><span class="p">(</span><span class="n">det1</span><span class="p">,</span> <span class="n">det2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">scaledist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.det_ltri">
<code class="descclassname">vtool.</code><code class="descname">det_ltri</code><span class="sig-paren">(</span><em>ltri</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#det_ltri"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.det_ltri" title="Permalink to this definition">¶</a></dt>
<dd><p>Lower triangular determinant</p>
</dd></dl>

<dl class="function">
<dt id="vtool.detect_opencv_keypoints">
<code class="descclassname">vtool.</code><code class="descname">detect_opencv_keypoints</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#detect_opencv_keypoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.detect_opencv_keypoints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.distance_to_lineseg">
<code class="descclassname">vtool.</code><code class="descname">distance_to_lineseg</code><span class="sig-paren">(</span><em>p</em>, <em>e1</em>, <em>e2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#distance_to_lineseg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance_to_lineseg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.dot_ltri">
<code class="descclassname">vtool.</code><code class="descname">dot_ltri</code><span class="sig-paren">(</span><em>ltri1</em>, <em>ltri2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#dot_ltri"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.dot_ltri" title="Permalink to this definition">¶</a></dt>
<dd><p>Lower triangular dot product</p>
</dd></dl>

<dl class="function">
<dt id="vtool.draw_border">
<code class="descclassname">vtool.</code><code class="descname">draw_border</code><span class="sig-paren">(</span><em>img_in</em>, <em>color=(0</em>, <em>128</em>, <em>255)</em>, <em>thickness=2</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#draw_border"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.draw_border" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img_in</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>color</strong> (<em>tuple</em>) – in bgr</li>
<li><strong>thickness</strong> (<em>int</em>) – </li>
<li><strong>out</strong> (<em>None</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.geometry –test-draw_border –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_in</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:plottool)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">draw_border</span><span class="p">(</span><span class="n">img_in</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.draw_kp_ori_steps">
<code class="descclassname">vtool.</code><code class="descname">draw_kp_ori_steps</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#draw_kp_ori_steps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.draw_kp_ori_steps" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows steps in orientation estimation</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd><p class="first">python -m vtool.patch –test-draw_kp_ori_steps –show –fname=zebra.png –fx=121
python -m vtool.patch –test-draw_kp_ori_steps –show –interact
python -m vtool.patch –test-draw_kp_ori_steps –save ~/latex/crall-candidacy-2015/figures/test_fint_kp_direction.jpg –dpath figures ‘–caption=visualization of the steps in the computation of the dominant gradient orientations.’ –figsize=14,9 –dpi=160 –height=2.65  –left=.04 –right=.96 –top=.95 –bottom=.05 –wspace=.1 –hspace=.1</p>
<p>python -m vtool.patch –test-draw_kp_ori_steps –dpath ~/latex/crall-candidacy-2015/ –save figures/draw_kp_ori_steps.jpg  –figsize=14,9 –dpi=180 –height=2.65 –left=.04 –right=.96 –top=.95 –bottom=.05 –wspace=.1 –hspace=.1 –diskshow</p>
<p class="last">python -m vtool.patch –test-draw_kp_ori_steps –dpath ~/latex/crall-candidacy-2015/ –save figures/draw_kp_ori_steps.jpg  –figsize=14,9 –dpi=180  –djust=.04,.05,.1 –diskshow –fname=zebra.png –fx=121</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_kp_ori_steps</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.draw_precision_recall_curve">
<code class="descclassname">vtool.</code><code class="descname">draw_precision_recall_curve</code><span class="sig-paren">(</span><em>recall_domain</em>, <em>p_interp</em>, <em>title_pref=None</em>, <em>fnum=1</em>, <em>pnum=None</em>, <em>color=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#draw_precision_recall_curve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.draw_precision_recall_curve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.draw_roc_curve">
<code class="descclassname">vtool.</code><code class="descname">draw_roc_curve</code><span class="sig-paren">(</span><em>fpr</em>, <em>tpr</em>, <em>fnum=None</em>, <em>pnum=None</em>, <em>marker=''</em>, <em>target_tpr=None</em>, <em>target_fpr=None</em>, <em>thresholds=None</em>, <em>color=None</em>, <em>name=None</em>, <em>label=None</em>, <em>show_operating_point=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#draw_roc_curve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.draw_roc_curve" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fpr</strong> – </li>
<li><strong>tpr</strong> – </li>
<li><strong>fnum</strong> (<em>int</em>) – figure number(default = None)</li>
<li><strong>pnum</strong> (<em>tuple</em>) – plot number(default = None)</li>
<li><strong>marker</strong> (<em>str</em>) – (default = ‘-x’)</li>
<li><strong>target_tpr</strong> (<em>None</em>) – (default = None)</li>
<li><strong>target_fpr</strong> (<em>None</em>) – (default = None)</li>
<li><strong>thresholds</strong> (<em>None</em>) – (default = None)</li>
<li><strong>color</strong> (<em>None</em>) – (default = None)</li>
<li><strong>show_operating_point</strong> (<em>bool</em>) – (default = False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.confusion –exec-draw_roc_curve –show –lightbg</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpr</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">fpr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tpr</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">tpr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresholds</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">thresholds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fnum</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pnum</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_tpr</span> <span class="o">=</span> <span class="o">.</span><span class="mi">85</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_fpr</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_operating_point</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_roc_curve</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">target_tpr</span><span class="p">,</span> <span class="n">target_fpr</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">thresholds</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">show_operating_point</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.draw_text">
<code class="descclassname">vtool.</code><code class="descname">draw_text</code><span class="sig-paren">(</span><em>img, text, org, textcolor_rgb=[0, 0, 0], fontScale=1, thickness=2, fontFace=0, lineType=16, bottomLeftOrigin=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#draw_text"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.draw_text" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-draw_text:0 –show
python -m vtool.image –test-draw_text:1 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">font_names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cv2</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;FONT_H&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;opencv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">400</span><span class="p">,</span> <span class="mi">1024</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fontScale</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CV_AA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">font_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">font_names</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">font_name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fontFace</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">font_name</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">count</span> <span class="o">*</span> <span class="mi">45</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;opencv - &#39;</span> <span class="o">+</span> <span class="n">font_name</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">draw_text</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">org</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">fontFace</span><span class="o">=</span><span class="n">fontFace</span><span class="p">,</span> <span class="n">textcolor_rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="n">fontScale</span><span class="o">=</span><span class="n">fontScale</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">font_names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cv2</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;FONT_H&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;opencv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">400</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span> <span class="p">:</span><span class="mi">512</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">200</span><span class="p">:,</span> <span class="mi">512</span><span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fontScale</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CV_AA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">font_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">font_names</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">font_name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fontFace</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">font_name</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">count</span> <span class="o">*</span> <span class="mi">45</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;opencv - &#39;</span> <span class="o">+</span> <span class="n">font_name</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">draw_text</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">org</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">fontFace</span><span class="o">=</span><span class="n">fontFace</span><span class="p">,</span> <span class="n">textcolor_rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="n">fontScale</span><span class="o">=</span><span class="n">fontScale</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<p>where each of the font IDs can be combined with FONT_ITALIC to get the slanted letters.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.draw_verts">
<code class="descclassname">vtool.</code><code class="descname">draw_verts</code><span class="sig-paren">(</span><em>img_in</em>, <em>verts</em>, <em>color=(0</em>, <em>128</em>, <em>255)</em>, <em>thickness=2</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#draw_verts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.draw_verts" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img_in</strong> – </li>
<li><strong>verts</strong> – </li>
<li><strong>color</strong> (<em>tuple</em>) – </li>
<li><strong>thickness</strong> (<em>int</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">img -  image data</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[uint8_t, ndim=2]</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.geometry –test-draw_verts –show
python -m vtool.geometry –test-draw_verts:0 –show
python -m vtool.geometry –test-draw_verts:1 –show</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/core/doc/drawing_functions.html#line">http://docs.opencv.org/modules/core/doc/drawing_functions.html#line</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_in</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">draw_verts</span><span class="p">(</span><span class="n">img_in</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_in</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">img</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">img</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">img_in</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_in</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">img_in</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">draw_verts</span><span class="p">(</span><span class="n">img_in</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_in</span> <span class="ow">is</span> <span class="n">img</span><span class="p">,</span> <span class="s1">&#39;should be in place&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">out</span> <span class="ow">is</span> <span class="n">img</span><span class="p">,</span> <span class="s1">&#39;should be in place&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<p>out = img_in = np.zeros((500, 500, 3), dtype=np.uint8)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.dummy_img">
<code class="descclassname">vtool.</code><code class="descname">dummy_img</code><span class="sig-paren">(</span><em>w</em>, <em>h</em>, <em>intensity=200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#dummy_img"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.dummy_img" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a demodata test image</p>
</dd></dl>

<dl class="function">
<dt id="vtool.dummy_seed">
<code class="descclassname">vtool.</code><code class="descname">dummy_seed</code><span class="sig-paren">(</span><em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#dummy_seed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.dummy_seed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.embed_channels">
<code class="descclassname">vtool.</code><code class="descname">embed_channels</code><span class="sig-paren">(</span><em>img</em>, <em>input_channels=(0</em>, <em>)</em>, <em>nchannels=3</em>, <em>fill=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#embed_channels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.embed_channels" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>input_channels</strong> (<em>tuple</em>) – (default = (0,))</li>
<li><strong>nchannels</strong> (<em>int</em>) – (default = 3)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image embed_channels –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Embed a (N,M,2) image into an (N,M,3) image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_channels</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nchannels</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newimg</span> <span class="o">=</span> <span class="n">embed_channels</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">input_channels</span><span class="p">,</span> <span class="n">nchannels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">newimg</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">newimg</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">input_channels</span><span class="p">]</span> <span class="o">==</span> <span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.embed_in_square_image">
<code class="descclassname">vtool.</code><code class="descname">embed_in_square_image</code><span class="sig-paren">(</span><em>img</em>, <em>target_size</em>, <em>img_origin=(0.5</em>, <em>0.5)</em>, <em>target_origin=(0.5</em>, <em>0.5)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#embed_in_square_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.embed_in_square_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Embeds an image in the center of an empty image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>target_size</strong> (<em>tuple</em>) – </li>
<li><strong>offset</strong> (<em>tuple</em>) – position of</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">img_sqare</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image embed_in_square_image –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_size</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">))</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_origin</span> <span class="o">=</span> <span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_origin</span> <span class="o">=</span> <span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_square</span> <span class="o">=</span> <span class="n">embed_in_square_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">target_size</span><span class="p">,</span> <span class="n">img_origin</span><span class="p">,</span> <span class="n">target_origin</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_square</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="n">img</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img_square</span><span class="p">)</span> <span class="o">==</span> <span class="n">target_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_origin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_origin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_square2</span> <span class="o">=</span> <span class="n">embed_in_square_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">target_size</span><span class="p">,</span> <span class="n">img_origin</span><span class="p">,</span> <span class="n">target_origin</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_square</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="n">img</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img_square</span><span class="p">)</span> <span class="o">==</span> <span class="n">target_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_square</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_square2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.emd">
<code class="descclassname">vtool.</code><code class="descname">emd</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em>, <em>cost_matrix='sift'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#emd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.emd" title="Permalink to this definition">¶</a></dt>
<dd><p>earth mover’s distance by robjects(lpSovle::lp.transport)
require: lpsolve55-5.5.0.9.win32-py2.7.exe</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance –test-emd</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emd_dists</span> <span class="o">=</span> <span class="n">emd</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">emd_dists</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.empty_assign">
<code class="descclassname">vtool.</code><code class="descname">empty_assign</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#empty_assign"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.empty_assign" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.empty_neighbors">
<code class="descclassname">vtool.</code><code class="descname">empty_neighbors</code><span class="sig-paren">(</span><em>num_vecs=0</em>, <em>K=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#empty_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.empty_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ensure_3channel">
<code class="descclassname">vtool.</code><code class="descname">ensure_3channel</code><span class="sig-paren">(</span><em>patch</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#ensure_3channel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ensure_3channel" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRICATE IN FAVOR OF atleast_3channels?</p>
<p>Ensures that there are 3 channels in the image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>patch</strong> (<em>ndarray</em><em>[</em><em>N</em><em>, </em><em>M</em><em>, </em><em>..</em><em>]</em>) – the image</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">[N, M, 3]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –exec-ensure_3channel –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch1</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;astro.png&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">:</span><span class="mi">512</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span> <span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;ada.jpg&#39;</span><span class="p">))[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch3</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;jeff.png&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">:</span><span class="mi">390</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">400</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res1</span> <span class="o">=</span> <span class="n">ensure_3channel</span><span class="p">(</span><span class="n">patch1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res2</span> <span class="o">=</span> <span class="n">ensure_3channel</span><span class="p">(</span><span class="n">patch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res3</span> <span class="o">=</span> <span class="n">ensure_3channel</span><span class="p">(</span><span class="n">patch3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">patch1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;failed test1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">patch2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;failed test2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">patch3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;failed test3&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.ensure_4channel">
<code class="descclassname">vtool.</code><code class="descname">ensure_4channel</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#ensure_4channel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ensure_4channel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ensure_alpha_channel">
<code class="descclassname">vtool.</code><code class="descname">ensure_alpha_channel</code><span class="sig-paren">(</span><em>img</em>, <em>alpha=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#ensure_alpha_channel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ensure_alpha_channel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ensure_grayscale">
<code class="descclassname">vtool.</code><code class="descname">ensure_grayscale</code><span class="sig-paren">(</span><em>img</em>, <em>colorspace_hint='BGR'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#ensure_grayscale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ensure_grayscale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ensure_metadata_dlen_sqrd">
<code class="descclassname">vtool.</code><code class="descname">ensure_metadata_dlen_sqrd</code><span class="sig-paren">(</span><em>annot</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_dlen_sqrd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ensure_metadata_dlen_sqrd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ensure_metadata_feats">
<code class="descclassname">vtool.</code><code class="descname">ensure_metadata_feats</code><span class="sig-paren">(</span><em>annot</em>, <em>cfgdict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_feats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ensure_metadata_feats" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds feature evaluation keys to a lazy dictionary</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>annot</strong> (<em>utool.LazyDict</em>) – </li>
<li><strong>suffix</strong> (<em>str</em>) – (default = ‘’)</li>
<li><strong>cfgdict</strong> (<em>dict</em>) – (default = {})</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.matching –exec-ensure_metadata_feats</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">LazyDict</span><span class="p">({</span><span class="s1">&#39;rchip_fpath&#39;</span><span class="p">:</span> <span class="n">rchip_fpath</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_metadata_feats</span><span class="p">(</span><span class="n">annot</span><span class="p">,</span> <span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">annot</span><span class="o">.</span><span class="n">_stored_results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span><span class="p">[</span><span class="s1">&#39;kpts&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">annot</span><span class="o">.</span><span class="n">_stored_results</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span><span class="p">[</span><span class="s1">&#39;vecs&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">annot</span><span class="o">.</span><span class="n">_stored_results</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.ensure_metadata_flann">
<code class="descclassname">vtool.</code><code class="descname">ensure_metadata_flann</code><span class="sig-paren">(</span><em>annot</em>, <em>cfgdict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_flann"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ensure_metadata_flann" title="Permalink to this definition">¶</a></dt>
<dd><p>setup lazy flann evaluation</p>
</dd></dl>

<dl class="function">
<dt id="vtool.ensure_metadata_normxy">
<code class="descclassname">vtool.</code><code class="descname">ensure_metadata_normxy</code><span class="sig-paren">(</span><em>annot</em>, <em>cfgdict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_normxy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ensure_metadata_normxy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ensure_metadata_vsone">
<code class="descclassname">vtool.</code><code class="descname">ensure_metadata_vsone</code><span class="sig-paren">(</span><em>annot1</em>, <em>annot2</em>, <em>cfgdict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_vsone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ensure_metadata_vsone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ensure_monotone_decreasing">
<code class="descclassname">vtool.</code><code class="descname">ensure_monotone_decreasing</code><span class="sig-paren">(</span><em>arr_</em>, <em>fromleft=True</em>, <em>fromright=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#ensure_monotone_decreasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ensure_monotone_decreasing" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arr</strong> (<em>ndarray</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">arr</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –test-ensure_monotone_decreasing –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_decreasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">fromright</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fromleft</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.ensure_monotone_increasing">
<code class="descclassname">vtool.</code><code class="descname">ensure_monotone_increasing</code><span class="sig-paren">(</span><em>arr_</em>, <em>fromright=True</em>, <em>fromleft=True</em>, <em>newmode=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#ensure_monotone_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ensure_monotone_increasing" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arr</strong> (<em>ndarray</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">arr</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –test-ensure_monotone_increasing –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">argval</span><span class="p">(</span><span class="s1">&#39;--offset&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">2.3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">fromleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fromright</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (increasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.ensure_monotone_strictly_decreasing">
<code class="descclassname">vtool.</code><code class="descname">ensure_monotone_strictly_decreasing</code><span class="sig-paren">(</span><em>arr_</em>, <em>left_endpoint=None</em>, <em>right_endpoint=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#ensure_monotone_strictly_decreasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ensure_monotone_strictly_decreasing" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr</strong> (<em>ndarray</em>) – </li>
<li><strong>left_endpoint</strong> (<em>None</em>) – </li>
<li><strong>right_endpoint</strong> (<em>None</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">arr</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –test-ensure_monotone_strictly_decreasing –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">75</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">05</span> <span class="o">+</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#arr_ = vt.demodata.testdata_nonmonotonic()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#domain = np.arange(len(arr_))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left_endpoint</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right_endpoint</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_strictly_decreasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">left_endpoint</span><span class="p">,</span> <span class="n">right_endpoint</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_decreasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s1">&#39;ensure strict monotonic failed&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">ensure_monotone_decreasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (strictly decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.ensure_monotone_strictly_increasing">
<code class="descclassname">vtool.</code><code class="descname">ensure_monotone_strictly_increasing</code><span class="sig-paren">(</span><em>arr_</em>, <em>left_endpoint=None</em>, <em>right_endpoint=None</em>, <em>zerohack=False</em>, <em>onehack=False</em>, <em>newmode=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#ensure_monotone_strictly_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ensure_monotone_strictly_increasing" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arr</strong> (<em>ndarray</em>) – sequence to monotonize</li>
<li><strong>zerohack</strong> (<em>bool</em>) – default False, if True sets the first element to be zero and linearlly interpolates to the first nonzero item</li>
<li><strong>onehack</strong> (<em>bool</em>) – default False, if True one will not be in the resulting array (replaced with number very close to one)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="http://mathoverflow.net/questions/17464/making-a-non-monotone-function-monotone">http://mathoverflow.net/questions/17464/making-a-non-monotone-function-monotone</a>
<a class="reference external" href="http://stackoverflow.com/questions/28563711/make-a-numpy-array-monotonic-without-a-python-loop">http://stackoverflow.com/questions/28563711/make-a-numpy-array-monotonic-without-a-python-loop</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Isotonic_regression">https://en.wikipedia.org/wiki/Isotonic_regression</a>
<a class="reference external" href="http://scikit-learn.org/stable/auto_examples/plot_isotonic_regression.html">http://scikit-learn.org/stable/auto_examples/plot_isotonic_regression.html</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –test-ensure_monotone_strictly_increasing –show
python -m vtool.util_math –test-ensure_monotone_strictly_increasing –show –offset=0</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>   <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.91</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_strictly_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_increasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s1">&#39;ensure strict monotonic failed1&#39;</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left_endpoint</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right_endpoint</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--offset&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">2.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#arr_ = vt.demodata.testdata_nonmonotonic()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#domain = np.arange(len(arr_))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_strictly_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">left_endpoint</span><span class="p">,</span> <span class="n">right_endpoint</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">arr</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">non_decreasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s1">&#39;ensure nondecreasing failed2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_increasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s1">&#39;ensure strict monotonic failed2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">ensure_monotone_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (strictly decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.ensure_rng">
<code class="descclassname">vtool.</code><code class="descname">ensure_rng</code><span class="sig-paren">(</span><em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#ensure_rng"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ensure_rng" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a numpy random number generator given a seed.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.ensure_shape">
<code class="descclassname">vtool.</code><code class="descname">ensure_shape</code><span class="sig-paren">(</span><em>arr</em>, <em>dimshape</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#ensure_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ensure_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: Submit as a PR to numpy?</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">vtool.</code><code class="descname">ensure_shape</code><span class="sig-paren">(</span><em>arr</em>, <em>dimshape</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#ensure_shape"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>TODO: Submit as a PR to numpy?</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.estimate_pdf">
<code class="descclassname">vtool.</code><code class="descname">estimate_pdf</code><span class="sig-paren">(</span><em>data</em>, <em>gridsize=1024</em>, <em>adjust=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#estimate_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.estimate_pdf" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>References;</dt>
<dd><a class="reference external" href="http://statsmodels.sourceforge.net/devel/generated/statsmodels.nonparametric.kde.KDEUnivariate.html">http://statsmodels.sourceforge.net/devel/generated/statsmodels.nonparametric.kde.KDEUnivariate.html</a>
<a class="reference external" href="https://jakevdp.github.io/blog/2013/12/01/kernel-density-estimation/">https://jakevdp.github.io/blog/2013/12/01/kernel-density-estimation/</a></dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>ndarray</em>) – 1 dimensional data of float64</li>
<li><strong>gridsize</strong> (<em>int</em>) – domain size</li>
<li><strong>adjust</strong> (<em>int</em>) – smoothing factor</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">data_pdf</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_pdf</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">estimate_pdf</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_pdf</span><span class="o">.</span><span class="n">support</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">data_pdf</span><span class="o">.</span><span class="n">cdf</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.estimate_refined_transform">
<code class="descclassname">vtool.</code><code class="descname">estimate_refined_transform</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>aff_inliers</em>, <em>refine_method='homog'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#estimate_refined_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.estimate_refined_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>estimates final transformation using normalized affine inliers</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/2.4/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html">http://docs.opencv.org/2.4/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.evalprint">
<code class="descclassname">vtool.</code><code class="descname">evalprint</code><span class="sig-paren">(</span><em>str_</em>, <em>globals_=None</em>, <em>locals_=None</em>, <em>simplify=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#evalprint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.evalprint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.example_binary">
<code class="descclassname">vtool.</code><code class="descname">example_binary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#example_binary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.example_binary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.expand_kpts">
<code class="descclassname">vtool.</code><code class="descname">expand_kpts</code><span class="sig-paren">(</span><em>kpts</em>, <em>scales</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#expand_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.expand_kpts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.expand_scales">
<code class="descclassname">vtool.</code><code class="descname">expand_scales</code><span class="sig-paren">(</span><em>kpts</em>, <em>nScales</em>, <em>low</em>, <em>high</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#expand_scales"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.expand_scales" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.expand_subscales">
<code class="descclassname">vtool.</code><code class="descname">expand_subscales</code><span class="sig-paren">(</span><em>kpts</em>, <em>subscale_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#expand_subscales"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.expand_subscales" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.extent_from_bbox">
<code class="descclassname">vtool.</code><code class="descname">extent_from_bbox</code><span class="sig-paren">(</span><em>bbox</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#extent_from_bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.extent_from_bbox" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>bbox</strong> (<em>ndarray</em>) – tl_x, tl_y, w, h</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">tl_x, br_x, tl_y, br_y</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">extent (ndarray)</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/geometry.py extent_from_bbox</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">extent_from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;extent = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">extent = [0, 10, 0, 10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.extent_from_verts">
<code class="descclassname">vtool.</code><code class="descname">extent_from_verts</code><span class="sig-paren">(</span><em>verts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#extent_from_verts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.extent_from_verts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.extract_chip_from_gpath">
<code class="descclassname">vtool.</code><code class="descname">extract_chip_from_gpath</code><span class="sig-paren">(</span><em>gfpath</em>, <em>bbox</em>, <em>theta</em>, <em>new_size</em>, <em>interpolation=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_from_gpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.extract_chip_from_gpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.extract_chip_from_gpath_into_square">
<code class="descclassname">vtool.</code><code class="descname">extract_chip_from_gpath_into_square</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_from_gpath_into_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.extract_chip_from_gpath_into_square" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.extract_chip_from_img">
<code class="descclassname">vtool.</code><code class="descname">extract_chip_from_img</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>bbox</em>, <em>theta</em>, <em>new_size</em>, <em>interpolation=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_from_img"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.extract_chip_from_img" title="Permalink to this definition">¶</a></dt>
<dd><p>Crops chip from image ; Rotates and scales;</p>
<p>ibs.show_annot_image(aid)[0].pt_save_and_view()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gfpath</strong> (<em>str</em>) – </li>
<li><strong>bbox</strong> (<em>tuple</em>) – xywh</li>
<li><strong>theta</strong> (<em>float</em>) – </li>
<li><strong>new_size</strong> (<em>tuple</em>) – wy</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">chipBGR</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.chip –test-extract_chip_from_img
python -m vtool.chip –test-extract_chip_from_img –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">gtool</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">58</span><span class="p">,</span> <span class="mi">34</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR</span> <span class="o">=</span> <span class="n">extract_chip_from_img</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">new_size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">chipBGR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_size</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;did not resize correctly&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.extract_chip_into_square">
<code class="descclassname">vtool.</code><code class="descname">extract_chip_into_square</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>bbox</em>, <em>theta</em>, <em>target_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_into_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.extract_chip_into_square" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.extract_feature_from_patch">
<code class="descclassname">vtool.</code><code class="descname">extract_feature_from_patch</code><span class="sig-paren">(</span><em>patch</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#extract_feature_from_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.extract_feature_from_patch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.extract_features">
<code class="descclassname">vtool.</code><code class="descname">extract_features</code><span class="sig-paren">(</span><em>img_or_fpath</em>, <em>feat_type='hesaff+sift'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#extract_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.extract_features" title="Permalink to this definition">¶</a></dt>
<dd><p>calls pyhesaff’s main driver function for detecting hessian affine keypoints.
extra parameters can be passed to the hessian affine detector by using
kwargs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img_or_fpath</strong> (<em>str</em>) – image file path on disk</li>
<li><strong>use_adaptive_scale</strong> (<em>bool</em>) – </li>
<li><strong>nogravity_hack</strong> (<em>bool</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(kpts, vecs)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.features –test-extract_features
python -m vtool.features –test-extract_features –show
python -m vtool.features –test-extract_features –feat-type=hesaff+siam128 –show
python -m vtool.features –test-extract_features –feat-type=hesaff+siam128 –show
python -m vtool.features –test-extract_features –feat-type=hesaff+siam128 –show –no-affine-invariance</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.features</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;lena.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat_type</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">argval</span><span class="p">(</span><span class="s1">&#39;--feat_type&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;hesaff+sift&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyhesaff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">parse_dict_from_argv</span><span class="p">(</span><span class="n">pyhesaff</span><span class="o">.</span><span class="n">get_hesaff_default_params</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#(kpts, vecs) = extract_features(img_fpath)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">extract_features</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">feat_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Show keypoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.figure(fnum=1, doclf=True, docla=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.imshow(imgBGR)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_kpts2(kpts, ori=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">interact_keypoints</span><span class="o">.</span><span class="n">ishow_keypoints</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ell_alpha</span><span class="o">=.</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;distinct&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.extrema_neighbors">
<code class="descclassname">vtool.</code><code class="descname">extrema_neighbors</code><span class="sig-paren">(</span><em>extrema_list</em>, <em>nBins</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#extrema_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.extrema_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.filterflags_valid_images">
<code class="descclassname">vtool.</code><code class="descname">filterflags_valid_images</code><span class="sig-paren">(</span><em>gpaths</em>, <em>valid_formats=None</em>, <em>invalid_formats=None</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#filterflags_valid_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.filterflags_valid_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Flags images with a format that disagrees with its extension</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gpaths</strong> (<em>list</em>) – list of image paths</li>
<li><strong>valid_formats</strong> (<em>None</em>) – (default = None)</li>
<li><strong>invalid_formats</strong> (<em>None</em>) – (default = None)</li>
<li><strong>verbose</strong> (<em>bool</em>) – verbosity flag(default = True)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">isvalid_flags</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image filterflags_valid_images –show</dd>
</dl>
<p class="rubric">Notes</p>
<p>An MPO (Multi Picture Object) file is a stereoscopic image and contains
two JPG images side-by-side, and allows them to be viewed as a single
3D image.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gpaths</span> <span class="o">=</span> <span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;astro.png&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">filterflags_valid_images</span><span class="p">(</span><span class="n">gpaths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.find_best_undirected_edge_indexes">
<code class="descclassname">vtool.</code><code class="descname">find_best_undirected_edge_indexes</code><span class="sig-paren">(</span><em>directed_edges</em>, <em>score_arr=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_best_undirected_edge_indexes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.find_best_undirected_edge_indexes" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>directed_edges</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </li>
<li><strong>score_arr</strong> (<em>ndarray</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">unique_edge_xs</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-find_best_undirected_edge_indexes</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">directed_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_edge_xs</span> <span class="o">=</span> <span class="n">find_best_undirected_edge_indexes</span><span class="p">(</span><span class="n">directed_edges</span><span class="p">,</span> <span class="n">score_arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">unique_edge_xs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[0 3 4 6]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">directed_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_arr</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_edge_xs</span> <span class="o">=</span> <span class="n">find_best_undirected_edge_indexes</span><span class="p">(</span><span class="n">directed_edges</span><span class="p">,</span> <span class="n">score_arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">unique_edge_xs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[0 2 3 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.find_clip_range">
<code class="descclassname">vtool.</code><code class="descname">find_clip_range</code><span class="sig-paren">(</span><em>tp_support</em>, <em>tn_support</em>, <em>clip_factor=2.6180339887499997</em>, <em>reverse=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#find_clip_range"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.find_clip_range" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: generalize to arbitrary domains (not just 0-&gt;inf)</p>
<p>Finds score to clip true positives past. This is useful when the highest
true positive scores can be much larger than the highest true negative
score.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tp_support</strong> (<em>ndarray</em>) – </li>
<li><strong>tn_support</strong> (<em>ndarray</em>) – </li>
<li><strong>clip_factor</strong> (<em>float</em>) – factor of the true negative domain to search for true positives</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">min_score, max_score</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –test-find_clip_range</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">50000</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">110</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clip_factor</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">PHI</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_score</span><span class="p">,</span> <span class="n">max_score</span> <span class="o">=</span> <span class="n">find_clip_range</span><span class="p">(</span><span class="n">tp_support</span><span class="p">,</span> <span class="n">tn_support</span><span class="p">,</span>  <span class="n">clip_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.4f</span><span class="s1">, </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">((</span><span class="n">min_score</span><span class="p">,</span> <span class="n">max_score</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">10.0000, 287.9837</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.find_dominant_kp_orientations">
<code class="descclassname">vtool.</code><code class="descname">find_dominant_kp_orientations</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>kp</em>, <em>bins=36</em>, <em>maxima_thresh=0.8</em>, <em>DEBUG_ROTINVAR=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#find_dominant_kp_orientations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.find_dominant_kp_orientations" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf">http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf</a>
page 219</p>
<p><a class="reference external" href="http://www.cs.berkeley.edu/~malik/cs294/lowe-ijcv04.pdf">http://www.cs.berkeley.edu/~malik/cs294/lowe-ijcv04.pdf</a>
page 13.</p>
<p>Lowe uses a 36-bin histogram of edge orientations weigted by a gaussian
distance to the center and gradient magintude. He finds all peaks within
80% of the global maximum. Then he fine tunes the orientation using a
3-binned parabolic fit. Multiple orientations (and hence multiple
keypoints) can be returned, but empirically only about 15% will have
these and they do tend to be important.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">ori_offset - offset of current orientation to dominant orientation</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-find_dominant_kp_orientations</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#imgBGR = get_test_patch(&#39;cross&#39;, jitter=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;star.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kp</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;kp = </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">kp_cpp_infostr</span><span class="p">(</span><span class="n">kp</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_oris</span> <span class="o">=</span> <span class="n">find_dominant_kp_orientations</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">kp</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                         <span class="n">maxima_thresh</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                         <span class="n">DEBUG_ROTINVAR</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;new_oris = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">new_oris</span><span class="p">,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.find_duplicate_items">
<code class="descclassname">vtool.</code><code class="descname">find_duplicate_items</code><span class="sig-paren">(</span><em>item_arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#find_duplicate_items"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.find_duplicate_items" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>item_arr</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">duplicate_items</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">?</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.clustering2 –test-find_duplicate_items</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/21888406/getting-the-indexes-to-the-duplicate-columns-of-a-numpy-array">http://stackoverflow.com/questions/21888406/getting-the-indexes-to-the-duplicate-columns-of-a-numpy-array</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">duplicate_items</span> <span class="o">=</span> <span class="n">find_duplicate_items</span><span class="p">(</span><span class="n">item_arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">duplicate_items</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="n">six</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">find_duplicate_items</span><span class="p">(</span><span class="n">item_arr</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">duplicate_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[9, 67, 87, 88]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.find_elbow_point">
<code class="descclassname">vtool.</code><code class="descname">find_elbow_point</code><span class="sig-paren">(</span><em>curve</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_elbow_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.find_elbow_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the on the curve point furthest from the line defined by the
endpoints of the curve.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>curve</strong> (<em>ndarray</em>) – a monotonic curve</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">tradeoff_idx - this is an elbow point in the curve</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/2018178/trade-off-point-on-curve">http://stackoverflow.com/questions/2018178/trade-off-point-on-curve</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other find_elbow_point –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">curve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tradeoff_idx</span> <span class="o">=</span> <span class="n">find_elbow_point</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;tradeoff_idx = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">tradeoff_idx</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">tradeoff_idx</span> <span class="o">==</span> <span class="mi">76</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">tradeoff_idx</span><span class="p">,</span> <span class="n">curve</span><span class="p">[</span><span class="n">tradeoff_idx</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">curve</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">curve</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_point</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">closest_point_on_line_segment</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dist_point</span><span class="p">,</span> <span class="n">point</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">curve</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;curve&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;tradeoff point&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dist_line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;-xb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">segment</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">segment</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;-xb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.find_first_true_indices">
<code class="descclassname">vtool.</code><code class="descname">find_first_true_indices</code><span class="sig-paren">(</span><em>flags_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_first_true_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.find_first_true_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: move to vtool</p>
<p>returns a list of indexes where the index is the first True position
in the corresponding sublist or None if it does not exist</p>
<p>in other words: for each row finds the smallest True column number or None</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>flags_list</strong> (<em>list</em>) – list of lists of booleans</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m utool.util_list –test-find_first_true_indices</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags_list</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">find_first_true_indices</span><span class="p">(</span><span class="n">flags_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">index_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[0, None, 1, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.find_k_true_indicies">
<code class="descclassname">vtool.</code><code class="descname">find_k_true_indicies</code><span class="sig-paren">(</span><em>flags_list</em>, <em>k</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_k_true_indicies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.find_k_true_indicies" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses output of either this function or find_first_true_indices
to find the next index of true flags</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>flags_list</strong> (<em>list</em>) – list of lists of booleans</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m utool.util_list –test-find_next_true_indices</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags_list</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">find_k_true_indicies</span><span class="p">(</span><span class="n">flags_list</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[array([2]), None, array([1, 2]), array([0, 1])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.find_kpts_direction">
<code class="descclassname">vtool.</code><code class="descname">find_kpts_direction</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>kpts</em>, <em>DEBUG_ROTINVAR=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#find_kpts_direction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.find_kpts_direction" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>imgBGR</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data in opencv format (blue, green, red)</li>
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">kpts -  keypoints</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[float32_t, ndim=2]</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-find_kpts_direction</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.find_maxima">
<code class="descclassname">vtool.</code><code class="descname">find_maxima</code><span class="sig-paren">(</span><em>y_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#find_maxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.find_maxima" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.find_maxima_with_neighbors">
<code class="descclassname">vtool.</code><code class="descname">find_maxima_with_neighbors</code><span class="sig-paren">(</span><em>scalar_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#find_maxima_with_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.find_maxima_with_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.find_next_true_indices">
<code class="descclassname">vtool.</code><code class="descname">find_next_true_indices</code><span class="sig-paren">(</span><em>flags_list</em>, <em>offset_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_next_true_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.find_next_true_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses output of either this function or find_first_true_indices
to find the next index of true flags</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>flags_list</strong> (<em>list</em>) – list of lists of booleans</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m utool.util_list –test-find_next_true_indices</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags_list</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset_list</span> <span class="o">=</span> <span class="n">find_first_true_indices</span><span class="p">(</span><span class="n">flags_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">find_next_true_indices</span><span class="p">(</span><span class="n">flags_list</span><span class="p">,</span> <span class="n">offset_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">index_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[2, None, 2, None]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.find_patch_dominant_orientations">
<code class="descclassname">vtool.</code><code class="descname">find_patch_dominant_orientations</code><span class="sig-paren">(</span><em>patch</em>, <em>bins=36</em>, <em>maxima_thresh=0.8</em>, <em>DEBUG_ROTINVAR=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#find_patch_dominant_orientations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.find_patch_dominant_orientations" title="Permalink to this definition">¶</a></dt>
<dd><p>helper</p>
</dd></dl>

<dl class="function">
<dt id="vtool.find_pixel_value_index">
<code class="descclassname">vtool.</code><code class="descname">find_pixel_value_index</code><span class="sig-paren">(</span><em>img</em>, <em>pixel</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#find_pixel_value_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.find_pixel_value_index" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>pixel</strong> (<em>ndarray</em><em> or </em><em>scalar</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –test-find_pixel_value_index</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/21407815/get-column-row-index-from-numpy-array-that-meets-a-boolean-condition">http://stackoverflow.com/questions/21407815/get-column-row-index-from-numpy-array-that-meets-a-boolean-condition</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pixel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">find_pixel_value_index</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pixel</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[0 0]</span>
<span class="go"> [1 1]</span>
<span class="go"> [2 0]</span>
<span class="go"> [2 3]</span>
<span class="go"> [5 5]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.flag_intersection">
<code class="descclassname">vtool.</code><code class="descname">flag_intersection</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#flag_intersection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.flag_intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Flags the rows in <cite>arr1</cite> that contain items in <cite>arr2</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">flags where len(flags) == len(arr1)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">flag_intersection</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;flags = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flags</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">structure_rows</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">flag_intersection</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;flags = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flags</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">flag_intersection</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">flag_intersection</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
</dd>
<dt>Timeit:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="sa">r</span><span class="s1">&#39;&#39;&#39;</span>
<span class="go">        import vtool as vt</span>
<span class="go">        import numpy as np</span>
<span class="go">        rng = np.random.RandomState(0)</span>
<span class="go">        arr1 = rng.randint(0, 100, 100000).reshape(-1, 2)</span>
<span class="go">        arr2 = rng.randint(0, 100, 1000).reshape(-1, 2)</span>
<span class="go">        arr1_, arr2_ = vt.structure_rows(arr1, arr2)</span>
<span class="go">        &#39;&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;&#39;&#39;</span>
<span class="go">        np.array([row in arr2_ for row in arr1_])</span>
<span class="go">        np.logical_or.reduce([arr1_ == row_ for row_ in arr2_]).ravel()</span>
<span class="go">        vt.iter_reduce_ufunc(np.logical_or, (arr1_ == row_ for row_ in arr2_)).ravel()</span>
<span class="go">        &#39;&#39;&#39;).split(&#39;\n&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="o">=</span><span class="n">setup</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.flag_sym_slow">
<code class="descclassname">vtool.</code><code class="descname">flag_sym_slow</code><span class="sig-paren">(</span><em>fx1_to_fx2</em>, <em>fx2_to_fx1</em>, <em>K</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#flag_sym_slow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.flag_sym_slow" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns flags indicating if the matches in fx1_to_fx2 are reciprocal
with the matches in fx2_to_fx1.</p>
<p>Much slower version of flag_symmetric_matches, but more clear</p>
</dd></dl>

<dl class="function">
<dt id="vtool.flag_symmetric_matches">
<code class="descclassname">vtool.</code><code class="descname">flag_symmetric_matches</code><span class="sig-paren">(</span><em>fx2_to_fx1</em>, <em>fx1_to_fx2</em>, <em>K=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#flag_symmetric_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.flag_symmetric_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns flags indicating if the matches in fx2_to_fx1 are reciprocal
with the matches in fx1_to_fx2.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span> <span class="c1"># 0</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span> <span class="c1"># 1</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span> <span class="c1"># 2</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span> <span class="c1"># 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx1_to_fx2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># 0</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># 1</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># 2</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># 3</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span> <span class="c1"># 4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flagsA</span> <span class="o">=</span> <span class="n">flag_symmetric_matches</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx1_to_fx2</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flagsB</span> <span class="o">=</span> <span class="n">flag_sym_slow</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx1_to_fx2</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">fx2_to_flagsA</span> <span class="o">==</span> <span class="n">fx2_to_flagsB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fx2_to_flagsB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.flann_augment">
<code class="descclassname">vtool.</code><code class="descname">flann_augment</code><span class="sig-paren">(</span><em>dpts</em>, <em>new_dpts</em>, <em>cache_dir</em>, <em>cfgstr</em>, <em>new_cfgstr</em>, <em>flann_params</em>, <em>use_cache=True</em>, <em>save=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#flann_augment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.flann_augment" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_dpts</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_nth_prime</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_dpts</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_dpts</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_nth_prime</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_app_resource_dir</span><span class="p">(</span><span class="s1">&#39;vtool&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgstr</span> <span class="o">=</span> <span class="s1">&#39;_testcfg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_cfgstr</span> <span class="o">=</span> <span class="s1">&#39;_new_testcfg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="n">get_kdtree_flann_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.flann_cache">
<code class="descclassname">vtool.</code><code class="descname">flann_cache</code><span class="sig-paren">(</span><em>dpts</em>, <em>cache_dir='default'</em>, <em>cfgstr=''</em>, <em>flann_params={}</em>, <em>use_cache=True</em>, <em>save=True</em>, <em>use_params_hash=True</em>, <em>use_data_hash=True</em>, <em>appname='vtool'</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#flann_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.flann_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to load a cached flann index before doing anything
from vtool.nn</p>
</dd></dl>

<dl class="function">
<dt id="vtool.flann_index_time_experiment">
<code class="descclassname">vtool.</code><code class="descname">flann_index_time_experiment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#flann_index_time_experiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.flann_index_time_experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows a plot of how long it takes to build a flann index for a given number of KD-trees</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.nearest_neighbors –test-flann_index_time_experiment</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">flann_index_time_experiment</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.flatten_invV_mats_to_kpts">
<code class="descclassname">vtool.</code><code class="descname">flatten_invV_mats_to_kpts</code><span class="sig-paren">(</span><em>invV_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#flatten_invV_mats_to_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.flatten_invV_mats_to_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>flattens invV matrices into kpts format</p>
</dd></dl>

<dl class="function">
<dt id="vtool.flatten_scores">
<code class="descclassname">vtool.</code><code class="descname">flatten_scores</code><span class="sig-paren">(</span><em>tp_scores</em>, <em>tn_scores</em>, <em>part_attrs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#flatten_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.flatten_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>convinience helper to translate partitioned to unpartitioned data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tp_scores</strong> (<em>ndarray</em>) – </li>
<li><strong>tn_scores</strong> (<em>ndarray</em>) – </li>
<li><strong>part_attrs</strong> (<em>dict</em>) – (default = None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(scores, labels, attrs)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –test-flatten_scores</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part_attrs</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;qaid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">]},</span>
<span class="gp">... </span>    <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;qaid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]},</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">flatten_scores</span><span class="p">(</span>
<span class="gp">... </span><span class="n">tp_scores</span><span class="p">,</span> <span class="n">tn_scores</span><span class="p">,</span> <span class="n">part_attrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resdict</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">odict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;attrs&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">resdict</span><span class="p">,</span> <span class="n">nobraces</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="n">explicit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">X=np.array([5, 6, 6, 7, 1, 2, 2]),</span>
<span class="go">y=np.array([1, 1, 1, 1, 0, 0, 0]),</span>
<span class="go">attrs={&#39;qaid&#39;: np.array([21, 24, 25, 26, 11, 14, 15])},</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.force_kpts_feasibility">
<code class="descclassname">vtool.</code><code class="descname">force_kpts_feasibility</code><span class="sig-paren">(</span><em>kpts</em>, <em>xys_nonneg=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#force_kpts_feasibility"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.force_kpts_feasibility" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.fromiter_nd">
<code class="descclassname">vtool.</code><code class="descname">fromiter_nd</code><span class="sig-paren">(</span><em>iter_</em>, <em>shape</em>, <em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#fromiter_nd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.fromiter_nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Like np.fromiter but handles iterators that generated
n-dimensional arrays. Slightly faster than np.array.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">np.vstack(<a href="#id159"><span class="problematic" id="id160">list_</span></a>) is still faster than
vt.fromiter_nd(ut.iflatten(<a href="#id161"><span class="problematic" id="id162">list_</span></a>))</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>iter</strong> (<em>iter</em>) – an iterable that generates homogenous ndarrays</li>
<li><strong>shape</strong> (<em>tuple</em>) – the expected output shape</li>
<li><strong>dtype</strong> (<em>dtype</em>) – the numpy datatype of the generated ndarrays</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The iterable must yeild a numpy array. It cannot yeild a Python list.</p>
</div>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.numpy_utils fromiter_nd</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total</span> <span class="o">=</span> <span class="mi">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">fromiter_nd</span><span class="p">(</span><span class="n">iter_</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">shape</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dfxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">qfxs</span><span class="p">,</span> <span class="n">dfxs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qfxs</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">fromiter_nd</span><span class="p">(</span><span class="n">iter_</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">shape</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Timeit:</dt>
<dd><div class="first highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat_dim</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mi">500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_data</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_feat_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_data</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">+</span> <span class="n">mu</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Make a large list of vectors of various sizes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Making random vectors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">feat_dim</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">n_feat_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mega_bytes</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">nbytes</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vecs_list</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mega_bytes = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mega_bytes</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">itertools</span> <span class="k">as</span> <span class="nn">it</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_total</span> <span class="o">=</span> <span class="n">n_feat_list</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_total</span><span class="p">,</span> <span class="n">feat_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">fromiter_nd</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">),</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">target1</span> <span class="o">==</span> <span class="n">target2</span><span class="p">)</span>
</pre></div>
</div>
<p>%timeit np.vstack(vecs_list)
20.4ms
%timeit vt.fromiter_nd(it.chain.from_iterable(vecs_list), shape, dtype)
102ms</p>
<p class="last"><a href="#id163"><span class="problematic" id="id164">iter_</span></a> = it.chain.from_iterable(vecs_list)
%time vt.fromiter_nd(<a href="#id165"><span class="problematic" id="id166">iter_</span></a>, shape, dtype)
%time np.vstack(vecs_list)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">vtool.</code><code class="descname">fromiter_nd</code><span class="sig-paren">(</span><em>iter_</em>, <em>shape</em>, <em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#fromiter_nd"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Like np.fromiter but handles iterators that generated
n-dimensional arrays. Slightly faster than np.array.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">np.vstack(<a href="#id167"><span class="problematic" id="id168">list_</span></a>) is still faster than
vt.fromiter_nd(ut.iflatten(<a href="#id169"><span class="problematic" id="id170">list_</span></a>))</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>iter</strong> (<em>iter</em>) – an iterable that generates homogenous ndarrays</li>
<li><strong>shape</strong> (<em>tuple</em>) – the expected output shape</li>
<li><strong>dtype</strong> (<em>dtype</em>) – the numpy datatype of the generated ndarrays</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The iterable must yeild a numpy array. It cannot yeild a Python list.</p>
</div>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.numpy_utils fromiter_nd</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total</span> <span class="o">=</span> <span class="mi">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">fromiter_nd</span><span class="p">(</span><span class="n">iter_</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">shape</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dfxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">qfxs</span><span class="p">,</span> <span class="n">dfxs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qfxs</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">fromiter_nd</span><span class="p">(</span><span class="n">iter_</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">shape</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Timeit:</dt>
<dd><div class="first highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat_dim</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mi">500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_data</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_feat_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_data</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">+</span> <span class="n">mu</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Make a large list of vectors of various sizes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Making random vectors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">feat_dim</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">n_feat_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mega_bytes</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">nbytes</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vecs_list</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mega_bytes = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mega_bytes</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">itertools</span> <span class="k">as</span> <span class="nn">it</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_total</span> <span class="o">=</span> <span class="n">n_feat_list</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_total</span><span class="p">,</span> <span class="n">feat_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">fromiter_nd</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">),</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">target1</span> <span class="o">==</span> <span class="n">target2</span><span class="p">)</span>
</pre></div>
</div>
<p>%timeit np.vstack(vecs_list)
20.4ms
%timeit vt.fromiter_nd(it.chain.from_iterable(vecs_list), shape, dtype)
102ms</p>
<p class="last"><a href="#id171"><span class="problematic" id="id172">iter_</span></a> = it.chain.from_iterable(vecs_list)
%time vt.fromiter_nd(<a href="#id173"><span class="problematic" id="id174">iter_</span></a>, shape, dtype)
%time np.vstack(vecs_list)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.gamma_adjust">
<code class="descclassname">vtool.</code><code class="descname">gamma_adjust</code><span class="sig-paren">(</span><em>img</em>, <em>gamma=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#gamma_adjust"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.gamma_adjust" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.blend –test-gamma_adjust:0 –show</dd>
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">gamma_adjust</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_float01</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">img</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s1">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;gamma=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.gauss2d_pdf">
<code class="descclassname">vtool.</code><code class="descname">gauss2d_pdf</code><span class="sig-paren">(</span><em>x_</em>, <em>y_</em>, <em>sigma=None</em>, <em>mu=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#gauss2d_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.gauss2d_pdf" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Input: x and y coordinate of a 2D gaussian</dt>
<dd>sigma, mu - covariance and mean vector</dd>
</dl>
<p>Output: The probability density at that point</p>
</dd></dl>

<dl class="function">
<dt id="vtool.gauss_func1d">
<code class="descclassname">vtool.</code><code class="descname">gauss_func1d</code><span class="sig-paren">(</span><em>x</em>, <em>mu=0.0</em>, <em>sigma=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#gauss_func1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.gauss_func1d" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> – </li>
<li><strong>mu</strong> (<em>float</em>) – </li>
<li><strong>sigma</strong> (<em>float</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –test-gauss_func1d</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –test-gauss_func1d –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussval</span> <span class="o">=</span> <span class="n">gauss_func1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_repr</span><span class="p">(</span><span class="n">gaussval</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gaussval</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">array([ 0.05,  0.24,  0.35,  0.4 ,  0.35,  0.24,  0.05])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.gauss_func1d_unnormalized">
<code class="descclassname">vtool.</code><code class="descname">gauss_func1d_unnormalized</code><span class="sig-paren">(</span><em>x</em>, <em>sigma=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#gauss_func1d_unnormalized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.gauss_func1d_unnormalized" title="Permalink to this definition">¶</a></dt>
<dd><p>faster version of gauss_func1d with no normalization. So the maximum point
will have a value of 1.0</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –test-gauss_func1d_unnormalized –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussval</span> <span class="o">=</span> <span class="n">gauss_func1d_unnormalized</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_repr</span><span class="p">(</span><span class="n">gaussval</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gaussval</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">array([ 0.05,  0.24,  0.35,  0.4 ,  0.35,  0.24,  0.05])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.gauss_parzen_est">
<code class="descclassname">vtool.</code><code class="descname">gauss_parzen_est</code><span class="sig-paren">(</span><em>dist</em>, <em>L=1</em>, <em>sigma=0.38</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#gauss_parzen_est"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.gauss_parzen_est" title="Permalink to this definition">¶</a></dt>
<dd><p>python -m wbia.plottool.draw_func2 –exec-plot_func –show –range=-.2,.2 –func=vt.gauss_parzen_est
python -m wbia.plottool.draw_func2 –exec-plot_func –show –range=0,1 –func=vt.gauss_parzen_est</p>
</dd></dl>

<dl class="function">
<dt id="vtool.gaussian_average_patch">
<code class="descclassname">vtool.</code><code class="descname">gaussian_average_patch</code><span class="sig-paren">(</span><em>patch</em>, <em>sigma=None</em>, <em>copy=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gaussian_average_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.gaussian_average_patch" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>patch</strong> (<em>ndarray</em>) – </li>
<li><strong>sigma</strong> (<em>float</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-gaussian_average_patch</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel">http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">get_star_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#sigma = 1.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">gaussian_average_patch</span><span class="p">(</span><span class="n">patch</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">0.414210641527</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd>import utool as ut
import wbia.plottool as pt
import vtool as vt
import cv2
gauss_kernel_d0 = (cv2.getGaussianKernel(patch.shape[0], sigma))
gauss_kernel_d1 = (cv2.getGaussianKernel(patch.shape[1], sigma))
weighted_patch = patch.copy()
weighted_patch = np.multiply(weighted_patch,   gauss_kernel_d0)
weighted_patch = np.multiply(weighted_patch.T, gauss_kernel_d1).T
gaussian_kern2 = gauss_kernel_d0.dot(gauss_kernel_d1.T)
fig = pt.figure(fnum=1, pnum=(1, 3, 1), doclf=True, docla=True)
pt.imshow(patch * 255)
fig = pt.figure(fnum=1, pnum=(1, 3, 2))
pt.imshow(ut.norm_zero_one(gaussian_kern2) * 255.0)
fig = pt.figure(fnum=1, pnum=(1, 3, 3))
pt.imshow(ut.norm_zero_one(weighted_patch) * 255.0)
pt.update()</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.gaussian_patch">
<code class="descclassname">vtool.</code><code class="descname">gaussian_patch</code><span class="sig-paren">(</span><em>shape=(7</em>, <em>7)</em>, <em>sigma=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gaussian_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.gaussian_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>another version of the guassian_patch function. hopefully better</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel">http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>shape</strong> (<em>tuple</em>) – array dimensions</li>
<li><strong>sigma</strong> (<em>float</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-gaussian_patch –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#shape = (7, 7)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># 1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gausspatch</span> <span class="o">=</span> <span class="n">gaussian_patch</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sum_</span> <span class="o">=</span> <span class="n">gausspatch</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_almost_eq</span><span class="p">(</span><span class="n">sum_</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">norm01</span><span class="p">(</span><span class="n">gausspatch</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.gaussian_weight_patch">
<code class="descclassname">vtool.</code><code class="descname">gaussian_weight_patch</code><span class="sig-paren">(</span><em>patch</em>, <em>sigma=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gaussian_weight_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.gaussian_weight_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies two one dimensional gaussian operations to a patch which
effectively weights it by a 2-dimensional gaussian. This is efficient
because the actually 2-d gaussian never needs to be allocated.</p>
<p>test_show_gaussian_patches</p>
</dd></dl>

<dl class="function">
<dt id="vtool.generate_to_patch_transforms">
<code class="descclassname">vtool.</code><code class="descname">generate_to_patch_transforms</code><span class="sig-paren">(</span><em>kpts</em>, <em>patch_size=41</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#generate_to_patch_transforms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.generate_to_patch_transforms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_RV_mats2x2">
<code class="descclassname">vtool.</code><code class="descname">get_RV_mats2x2</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_RV_mats2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_RV_mats2x2" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">sequence of matrices that transform an ellipse to unit circle</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">V_mats (ndarray)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.get_RV_mats_3x3">
<code class="descclassname">vtool.</code><code class="descname">get_RV_mats_3x3</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_RV_mats_3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_RV_mats_3x3" title="Permalink to this definition">¶</a></dt>
<dd><p>prefered over get_invV_mats</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">sequence of matrices that transform an ellipse to unit circle</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">V_mats (ndarray)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.get_V_mats">
<code class="descclassname">vtool.</code><code class="descname">get_V_mats</code><span class="sig-paren">(</span><em>kpts</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_V_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_V_mats" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">sequence of matrices that transform an ellipse to unit circle</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">V_mats (ndarray)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.get_Z_mats">
<code class="descclassname">vtool.</code><code class="descname">get_Z_mats</code><span class="sig-paren">(</span><em>V_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_Z_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_Z_mats" title="Permalink to this definition">¶</a></dt>
<dd><p>transform into conic matrix Z
Z = (V.T).dot(V)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Z is a conic representation of an ellipse</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">Z_mats (ndarray)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.get_affine_inliers">
<code class="descclassname">vtool.</code><code class="descname">get_affine_inliers</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>fs</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh_sqrd</em>, <em>ori_thresh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_affine_inliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_affine_inliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates inliers deterministically using elliptical shapes</p>
<p>Compute all transforms from kpts1 to kpts2 (enumerate all hypothesis)
We transform from chip1 -&gt; chip2
The determinants are squared keypoint scales</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">aff_inliers_list, aff_errors_list, Aff_mats</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<dl class="docutils">
<dt>FROM PERDOCH 2009::</dt>
<dd>H = inv(Aj).dot(Rj.T).dot(Ri).dot(Ai)
H = inv(Aj).dot(Ai)
The input invVs = perdoch.invA’s</dd>
<dt>CommandLine:</dt>
<dd>python2 -m vtool.spatial_verification –test-get_affine_inliers
python3 -m vtool.spatial_verification –test-get_affine_inliers</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">make_dummy_fm</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span><span class="p">(</span><span class="o">.</span><span class="mi">009</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh_sqrd</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_thresh</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span><span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">get_affine_inliers</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">scale_thresh_sqrd</span><span class="p">,</span> <span class="n">ori_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_str</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress_small</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;output_str = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">output_str</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_inliers_list</span><span class="p">,</span> <span class="n">aff_errors_list</span><span class="p">,</span> <span class="n">Aff_mats</span> <span class="o">=</span> <span class="n">output</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;nInliers=</span><span class="si">%r</span><span class="s1"> hash=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">aff_inliers_list</span><span class="p">),</span> <span class="n">ut</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">output_str</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_best_affine_inliers">
<code class="descclassname">vtool.</code><code class="descname">get_best_affine_inliers</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>fs</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh</em>, <em>ori_thresh</em>, <em>forcepy=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_best_affine_inliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_best_affine_inliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests each hypothesis and returns only the best transformation and inliers</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_best_affine_inliers_">
<code class="descclassname">vtool.</code><code class="descname">get_best_affine_inliers_</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>fs</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh</em>, <em>ori_thresh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_best_affine_inliers_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_best_affine_inliers_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_covered_mask">
<code class="descclassname">vtool.</code><code class="descname">get_covered_mask</code><span class="sig-paren">(</span><em>covered_array</em>, <em>covering_array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_covered_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_covered_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_crop_slices">
<code class="descclassname">vtool.</code><code class="descname">get_crop_slices</code><span class="sig-paren">(</span><em>isfill</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_crop_slices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_crop_slices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_cross_patch">
<code class="descclassname">vtool.</code><code class="descname">get_cross_patch</code><span class="sig-paren">(</span><em>jitter=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_cross_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_cross_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_dummy_dpts">
<code class="descclassname">vtool.</code><code class="descname">get_dummy_dpts</code><span class="sig-paren">(</span><em>num</em>, <em>dtype=&lt;class 'numpy.uint8'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_dpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_dummy_dpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Random SIFTish keypoints</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_dummy_invV_mats">
<code class="descclassname">vtool.</code><code class="descname">get_dummy_invV_mats</code><span class="sig-paren">(</span><em>dtype=&lt;class 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_invV_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_dummy_invV_mats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_dummy_kpts">
<code class="descclassname">vtool.</code><code class="descname">get_dummy_kpts</code><span class="sig-paren">(</span><em>num=1</em>, <em>dtype=&lt;class 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_dummy_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Some testing data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>num</strong> (<em>int</em>) – number of times to duplicate</li>
<li><strong>dtype</strong> (<em>type</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">kpts -  keypoints</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[float32_t, ndim=2][ndims=2]</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/demodata.py get_dummy_kpts</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">get_dummy_kpts</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_dummy_kpts_pair">
<code class="descclassname">vtool.</code><code class="descname">get_dummy_kpts_pair</code><span class="sig-paren">(</span><em>wh_stride=(30</em>, <em>30)</em>, <em>wh_num=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_kpts_pair"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_dummy_kpts_pair" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_dummy_matching_kpts">
<code class="descclassname">vtool.</code><code class="descname">get_dummy_matching_kpts</code><span class="sig-paren">(</span><em>dtype=&lt;class 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_matching_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_dummy_matching_kpts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_dummy_xy">
<code class="descclassname">vtool.</code><code class="descname">get_dummy_xy</code><span class="sig-paren">(</span><em>seed=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_xy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_dummy_xy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_even_point_sample">
<code class="descclassname">vtool.</code><code class="descname">get_even_point_sample</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_even_point_sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_even_point_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>gets even points sample along the boundary of the ellipse</p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>pyhesaff.tests.test_ellipse</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ell_border_pts_list</span> <span class="o">=</span> <span class="n">get_even_point_sample</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">ell_border_pts_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;even sample points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_exif_dict">
<code class="descclassname">vtool.</code><code class="descname">get_exif_dict</code><span class="sig-paren">(</span><em>pil_img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exif_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_exif_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns exif dictionary by TAGID</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_exif_dict2">
<code class="descclassname">vtool.</code><code class="descname">get_exif_dict2</code><span class="sig-paren">(</span><em>pil_img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exif_dict2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_exif_dict2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns exif dictionary by TAG (less efficient)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_exif_tagids">
<code class="descclassname">vtool.</code><code class="descname">get_exif_tagids</code><span class="sig-paren">(</span><em>tag_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exif_tagids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_exif_tagids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_exist">
<code class="descclassname">vtool.</code><code class="descname">get_exist</code><span class="sig-paren">(</span><em>data</em>, <em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_exist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_extract_features_default_params">
<code class="descclassname">vtool.</code><code class="descname">get_extract_features_default_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#get_extract_features_default_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_extract_features_default_params" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.features –test-get_extract_features_default_params</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.features</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_dict</span> <span class="o">=</span> <span class="n">get_extract_features_default_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">param_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_extramargin_measures">
<code class="descclassname">vtool.</code><code class="descname">get_extramargin_measures</code><span class="sig-paren">(</span><em>bbox_gs</em>, <em>new_size</em>, <em>halfoffset_ms=(64</em>, <em>64)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#get_extramargin_measures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_extramargin_measures" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a detection chip with a bit of spatial context so the detection
algorithm doesn’t clip boundaries</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>mbbox_gs, margin_size -</dt>
<dd>margin bounding box in image size,
size of entire margined chip,</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.chip –test-get_extramargin_measures –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gfpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox_gs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="o">.</span><span class="mi">15</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">halfoffset_ms</span> <span class="o">=</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mbbox_gs</span><span class="p">,</span> <span class="n">margin_size</span> <span class="o">=</span> <span class="n">get_extramargin_measures</span><span class="p">(</span><span class="n">bbox_gs</span><span class="p">,</span> <span class="n">new_size</span><span class="p">,</span> <span class="n">halfoffset_ms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">testshow_extramargin_info</span><span class="p">(</span><span class="n">gfpath</span><span class="p">,</span> <span class="n">bbox_gs</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">new_size</span><span class="p">,</span> <span class="n">halfoffset_ms</span><span class="p">,</span> <span class="n">mbbox_gs</span><span class="p">,</span> <span class="n">margin_size</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_flann_cfgstr">
<code class="descclassname">vtool.</code><code class="descname">get_flann_cfgstr</code><span class="sig-paren">(</span><em>dpts</em>, <em>flann_params</em>, <em>cfgstr=''</em>, <em>use_params_hash=True</em>, <em>use_data_hash=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_flann_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.nearest_neighbors –test-get_flann_cfgstr</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgstr</span> <span class="o">=</span> <span class="s1">&#39;_FEAT(alg=heshes)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="n">get_kdtree_flann_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_flann_cfgstr</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">flann_params</span><span class="p">,</span> <span class="n">cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">_FEAT(alg=heshes)_FLANN(4kdtree)_DPTS((10,128)xxaotseonmfjkzcr)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_flann_fpath">
<code class="descclassname">vtool.</code><code class="descname">get_flann_fpath</code><span class="sig-paren">(</span><em>dpts</em>, <em>cache_dir='default'</em>, <em>cfgstr=''</em>, <em>flann_params={}</em>, <em>use_params_hash=True</em>, <em>use_data_hash=True</em>, <em>appname='vtool'</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_flann_fpath" title="Permalink to this definition">¶</a></dt>
<dd><p>returns filepath for flann index</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_flann_params">
<code class="descclassname">vtool.</code><code class="descname">get_flann_params</code><span class="sig-paren">(</span><em>algorithm='kdtree'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_flann_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns flann params that are relvant tothe algorithm</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf">http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>algorithm</strong> (<em>str</em>) – (default = ‘kdtree’)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">flann_params</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.nearest_neighbors –test-get_flann_params –algo=kdtree
python -m vtool.nearest_neighbors –test-get_flann_params –algo=kmeans</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">algorithm</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--algo&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;kdtree&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="n">get_flann_params</span><span class="p">(</span><span class="n">algorithm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;flann_params = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flann_params</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_flann_params_cfgstr">
<code class="descclassname">vtool.</code><code class="descname">get_flann_params_cfgstr</code><span class="sig-paren">(</span><em>flann_params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_params_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_flann_params_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_grid_kpts">
<code class="descclassname">vtool.</code><code class="descname">get_grid_kpts</code><span class="sig-paren">(</span><em>wh=(300</em>, <em>300)</em>, <em>wh_stride=None</em>, <em>scale=20</em>, <em>wh_num=None</em>, <em>dtype=&lt;class 'numpy.float32'&gt;</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_grid_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_grid_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a regular grid of keypoints</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>wh</strong> (<em>tuple</em>) – (default = (300, 300))</li>
<li><strong>wh_stride</strong> (<em>tuple</em>) – stride of keypoints (defaults to (50, 50))</li>
<li><strong>scale</strong> (<em>int</em>) – (default = 20)</li>
<li><strong>wh_num</strong> (<em>tuple</em>) – desired number of keypoints in x and y direction.
(incompatible with stride).</li>
<li><strong>dtype</strong> (<em>type</em>) – (default = &lt;type ‘numpy.float32’&gt;)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">kpts -  keypoints</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[float32_t, ndim=2]</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint get_grid_kpts –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh</span> <span class="o">=</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_stride</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_num</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">get_grid_kpts</span><span class="p">(</span><span class="n">wh</span><span class="p">,</span> <span class="n">wh_num</span><span class="o">=</span><span class="n">wh_num</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">wh_num</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;kpts = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">kpts</span><span class="o">.</span><span class="n">shape</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_histinfo_str">
<code class="descclassname">vtool.</code><code class="descname">get_histinfo_str</code><span class="sig-paren">(</span><em>hist</em>, <em>edges</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#get_histinfo_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_histinfo_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_image_to_chip_transform">
<code class="descclassname">vtool.</code><code class="descname">get_image_to_chip_transform</code><span class="sig-paren">(</span><em>bbox</em>, <em>chipsz</em>, <em>theta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#get_image_to_chip_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_image_to_chip_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>transforms image space into chipspace</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>- bounding box of chip in image space</strong> (<em>bbox</em>) – </li>
<li><strong>- size of the chip</strong> (<em>chipsz</em>) – </li>
<li><strong>- rotation of the bounding box</strong> (<em>theta</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Sympy:</dt>
<dd><p class="first"># <a class="reference external" href="https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA">https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</a>
from vtool.patch import *  # NOQA
import sympy
import sympy.abc
theta = sympy.abc.theta</p>
<p>x, y, w, h, target_area  = sympy.symbols(‘x y w h, a’)
gx, gy  = sympy.symbols(‘gx, gy’)</p>
<p>round = sympy.floor  # hack</p>
<p>ht = sympy.sqrt(target_area * h / w)
wt = w * ht / h
<a href="#id175"><span class="problematic" id="id176">cw_</span></a>, <a href="#id177"><span class="problematic" id="id178">ch_</span></a> = round(wt), round(ht)</p>
<p>from vtool import ltool
T1 = ltool.translation_mat3x3(tx1, ty1, dtype=None)
S  = ltool.scale_mat3x3(sx, sy, dtype=None)
R  = ltool.rotation_mat3x3(-theta, sympy.sin, sympy.cos)
T2 = ltool.translation_mat3x3(tx2, ty2, dtype=None)</p>
<dl class="docutils">
<dt>def add_matmul_hold_prop(mat):</dt>
<dd><p class="first">#import functools
mat = sympy.Matrix(mat)
def matmul_hold(other, hold=False):</p>
<blockquote>
<div>new = sympy.MatMul(mat, other, hold=hold)
add_matmul_hold_prop(new)
return new</div></blockquote>
<p class="last">setattr(mat, ‘matmul_hold’, matmul_hold)
return mat</p>
</dd>
</dl>
<p>T1 = add_matmul_hold_prop(T1)
T2 = add_matmul_hold_prop(T2)
R = add_matmul_hold_prop(R)
S = add_matmul_hold_prop(S)</p>
<p class="last">C = T2.multiply(R.multiply(S.multiply(T1)))
sympy.simplify(C)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.get_invVR_mats2x2">
<code class="descclassname">vtool.</code><code class="descname">get_invVR_mats2x2</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_invVR_mats2x2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keypoint shape+rotation matrix (from unit circle to ellipse)
Ignores translation component</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em><em>[</em><em>ndims=2</em><em>]</em>) – keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">invVR_mats</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint –test-get_invVR_mats2x2</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats2x2</span> <span class="o">=</span> <span class="n">get_invVR_mats2x2</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invVR_mats2x2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats2x2</span> <span class="o">=</span> <span class="n">get_invVR_mats2x2</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">invVR_mats2x2</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_invVR_mats3x3">
<code class="descclassname">vtool.</code><code class="descname">get_invVR_mats3x3</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_invVR_mats3x3" title="Permalink to this definition">¶</a></dt>
<dd><p>NEWER FUNCTION</p>
<p>Returns full keypoint transform matricies from a unit circle to an
ellipse that has been rotated, scaled, skewed, and translated. Into
the image keypoint position.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">invVR_mats</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray[float32_t, ndim=3]</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats3x3</span> <span class="o">=</span> <span class="n">get_invVR_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invVR_mats3x3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[ 1.,  0., 10.],</span>
<span class="go">        [ 2.,  3., 20.],</span>
<span class="go">        [ 0.,  0.,  1.]],</span>
<span class="go">       [[ 0., -1., 30.],</span>
<span class="go">        [ 3., -2., 40.],</span>
<span class="go">        [ 0.,  0.,  1.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_invVR_mats_oris">
<code class="descclassname">vtool.</code><code class="descname">get_invVR_mats_oris</code><span class="sig-paren">(</span><em>invVR_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_oris"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_invVR_mats_oris" title="Permalink to this definition">¶</a></dt>
<dd><p>extracts orientation from matrix encoding, this is a bit tricker
can use -arctan2 or (0, 0) and (0, 1), but then have to normalize</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">get_invVR_mats_oris</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Sympy:</dt>
<dd><div class="first highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># BEST PROOF SO FAR OF EXTRACTION FROM ARBITRARY COMPOMENTS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symkw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#x, y, v21  = sympy.symbols(&#39;x, y, v21&#39;, **symkw)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#v11, v22    = sympy.symbols(&#39;v11, v22&#39;, positive=True, **symkw)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">v21</span>  <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, y, c&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v11</span><span class="p">,</span> <span class="n">v22</span>    <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a, d&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span>       <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symtau</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sympy</span><span class="o">.</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Forward rotation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">keypoint_terms</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">v11</span><span class="p">,</span> <span class="n">v21</span><span class="p">,</span> <span class="n">v22</span><span class="p">,</span> <span class="n">theta</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Ell to ucircle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">v11</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">v21</span><span class="p">,</span> <span class="n">v22</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Backwards rotation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">),</span> <span class="o">-</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">),</span> <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span>               <span class="mi">0</span><span class="p">,</span>                 <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Backwards translation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>  <span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="o">-</span><span class="n">x</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>  <span class="o">-</span><span class="n">y</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Scale is the inverse square root determinant of the shape matrix.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">V</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Inverse of components</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invT</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">inv_</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">inv_</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">inv_</span><span class="p">()</span>  <span class="c1"># TODO: figure out how to make -theta say inside sin and cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># -----------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Build the B matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RVT_held_full</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RVT_full</span> <span class="o">=</span> <span class="n">RVT_held_full</span><span class="o">.</span><span class="n">as_mutable</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Build the inv(B) matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invTVR_held_full</span> <span class="o">=</span> <span class="n">invT</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">invV</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">invR</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invTVR_full</span> <span class="o">=</span> <span class="n">invTVR_held_full</span><span class="o">.</span><span class="n">as_mutable</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Build the invTVR_full in arbitrary terms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iv11</span><span class="p">,</span> <span class="n">iv12</span><span class="p">,</span> <span class="n">iv13</span><span class="p">,</span> <span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span> <span class="n">iv23</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;iv11, iv12, iv13, iv21, iv22, iv23&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arb_symbols</span> <span class="o">=</span> <span class="p">[</span><span class="n">iv11</span><span class="p">,</span> <span class="n">iv12</span><span class="p">,</span> <span class="n">iv13</span><span class="p">,</span> <span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span> <span class="n">iv23</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_arb</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>  <span class="n">iv11</span><span class="p">,</span> <span class="n">iv12</span><span class="p">,</span> <span class="n">iv13</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>  <span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span> <span class="n">iv23</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>   <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set set terms equal to the construction from the inverse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arb_expr1</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">invVR_arb</span><span class="p">,</span> <span class="n">invTVR_full</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arb_assign</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">arb_expr1</span><span class="p">,</span> <span class="n">arb_symbols</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Solve for keypoint varibles in terms of the arbitrary invVR_arb mat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solutions</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">arb_expr1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solutions</span><span class="p">[</span><span class="n">theta</span><span class="p">]</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">arb_expr1</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Solutions for scale is not well defined, but can be taken through the determ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#solutions_ad = sympy.solve(arb_expr1, v11, v22)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#solutions_scale = sympy.solve(arb_expr1, scale)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#solutions = sympy.solve(arb_expr1, *keypoint_terms)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Print review info (ell to ucirc)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Keypoint review (RVT):&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indenter</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">Indenter</span><span class="p">(</span><span class="s1">&#39;[RVT] &#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="o">=</span> <span class="n">indenter</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Translate keypoint to origin&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warp from ellipse to unit circle shape:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Orientation normalize by -theta radians&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;These can be combined as such:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;RVT_held_full&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This simplifies to a matrix which tranlates, scales, skews, and rotates an ellipse into a unit circle&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(B) = RVT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;RVT_full&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="o">=</span> <span class="n">indenter</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Print review info (ucirc to ell)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Now backwards:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unorient&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indenter</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">Indenter</span><span class="p">(</span><span class="s1">&#39;[invTVR] &#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="o">=</span> <span class="n">indenter</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warp from unit circle to ellipse&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invV&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Translate to point in annot space&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;These can be combined as such:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invTVR_held_full&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This simplifies to a matrix which rotates, skews, scales, and translates a unit circle into an ellipse&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inv(B) = inv(T) inv(V) inv(R)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invTVR_full&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="o">=</span> <span class="n">indenter</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now we will solve for keypoint componts given an arbitrary shape matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Given an arbitrary invVRT shape matrix&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invVR_arb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The keypoint components can be extracte as such&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The position is easy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Scale is not found through symbolic manipulation but can be taken through linear algebra properites&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Orientation is a bit more involved&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">solutions</span><span class="p">,</span> <span class="n">sorted_</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># PROOVE ORIENTATION EQUATION IS CORRECT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#ivr11 must be positive for this to work</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_arb</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">sympy</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">iv12</span><span class="p">,</span> <span class="n">iv11</span><span class="p">))</span> <span class="o">%</span> <span class="p">(</span><span class="n">symtau</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_arb_nomod</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">iv12</span><span class="p">,</span> <span class="n">iv11</span><span class="p">)</span>  <span class="c1"># outputs from -TAU/2 to TAU/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_arb</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">invVR_arb</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> CLAIM:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Scale is be computed as:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;scale_arb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;scale_arb.subs(arb_assign)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;scale_arb.subs(arb_assign)&#39;</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> CLAIM:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Orientation is be computed as:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;ori_arb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;ori_arb.subs(arb_assign)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;ori_arb.subs(arb_assign)&#39;</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_subs</span> <span class="o">=</span> <span class="n">ori_arb</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">arb_assign</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Consider only the arctan2 part&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># hack aroung resolve atan2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_arb_nomod</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">iv12</span><span class="p">,</span> <span class="n">iv11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.assumptions.refine</span> <span class="k">import</span> <span class="n">refine_atan2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># There are 3 cases we need to wory about for atan2(y, x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Case where x is positive</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atan2_case1</span> <span class="o">=</span> <span class="n">refine_atan2</span><span class="p">(</span><span class="n">ori_arb_nomod</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="n">sympy</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">iv12</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">positive</span><span class="p">(</span><span class="n">iv11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Case where x is negative and y is non-negative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atan2_case2</span> <span class="o">=</span> <span class="n">refine_atan2</span><span class="p">(</span><span class="n">ori_arb_nomod</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">sympy</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">negative</span><span class="p">(</span><span class="n">iv11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">positive</span><span class="p">(</span><span class="n">iv12</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Case where x is negative and y is negative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atan2_case3</span> <span class="o">=</span> <span class="n">refine_atan2</span><span class="p">(</span><span class="n">ori_arb_nomod</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">sympy</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">negative</span><span class="p">(</span><span class="n">iv11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">negative</span><span class="p">(</span><span class="n">iv12</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atan2_case_strs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;QI, QIV&#39;</span><span class="p">,</span> <span class="s1">&#39;QII&#39;</span><span class="p">,</span> <span class="s1">&#39;QIII&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_ranges</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span> <span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span> <span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atan2_case_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">atan2_case1</span><span class="p">,</span> <span class="n">atan2_case2</span><span class="p">,</span> <span class="n">atan2_case3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">caseno</span><span class="p">,</span> <span class="n">atan2_case</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">atan2_case_list</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">----</span><span class="se">\n</span><span class="s1">caseno = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">caseno</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Quadrent: </span><span class="si">%r</span><span class="s1">&#39;</span>  <span class="o">%</span> <span class="p">(</span><span class="n">atan2_case_strs</span><span class="p">[</span><span class="n">caseno</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;theta_ranges: </span><span class="si">%r</span><span class="s1">&#39;</span>  <span class="o">%</span> <span class="p">(</span><span class="n">theta_ranges</span><span class="p">[</span><span class="n">caseno</span><span class="p">],))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">atan2_case_subs</span> <span class="o">=</span> <span class="n">atan2_case</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">arb_assign</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;atan2_case_subs&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">atan2_case_subs</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">atan2_case_subs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">atan2_case_subs</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">atan2_case_subs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;atan2_case_subs&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ori_arb_case</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">atan2_case</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">symtau</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ori_arb_case_subs</span> <span class="o">=</span> <span class="n">ori_arb_case</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">arb_assign</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ori_arb_case_subs</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">ori_arb_case_subs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ori_arb_case_subs</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">ori_arb_case_subs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;ori_arb_case_subs&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
</pre></div>
</div>
<p>nptheta = np.linspace(0, 2 * np.pi, 32, endpoint=False)</p>
<p>mapping = np.arctan(np.tan(nptheta))
print(ub.repr2(zip(nptheta / (2 * np.pi), nptheta, mapping, nptheta == mapping), precision=3))
print(ub.repr2(zip(nptheta / (2 * np.pi), nptheta, mapping  % (np.pi * 2), nptheta == mapping % (np.pi * 2)), precision=3))</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># NUMPY CHECKS</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nptheta_special</span> <span class="o">=</span> <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nptheta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="n">nptheta_special</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Case 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#\modfn{\paren{-\atan{\tan{(-\theta)}}} }{\TAU}           &amp;\text{if } \cos{(-\theta )} &gt; 0 \\</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">nptheta</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case1_theta</span>  <span class="o">=</span> <span class="n">nptheta</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case1_result</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="o">-</span><span class="n">case1_theta</span><span class="p">))</span> <span class="o">%</span> <span class="n">TAU</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case1_theta</span> <span class="o">==</span> <span class="n">case1_result</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">case1_theta</span><span class="p">,</span> <span class="n">case1_result</span><span class="p">,</span> <span class="n">vt</span><span class="o">.</span><span class="n">ori_distance</span><span class="p">(</span><span class="n">case1_theta</span><span class="p">,</span> <span class="n">case1_result</span><span class="p">)</span> <span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Case 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#\modfn{\paren{-\atan{\tan{(-\theta)}} - \pi }}{\TAU}     &amp;\text{if } \cos{(-\theta )} &lt; 0 \AND \sin{(-\theta )} \ge 0 \\</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">nptheta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">nptheta</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case2_theta</span> <span class="o">=</span>  <span class="n">nptheta</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case2_result</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="o">-</span><span class="n">case2_theta</span><span class="p">))</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">%</span> <span class="n">TAU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">case2_theta</span><span class="p">,</span> <span class="n">case2_result</span><span class="p">,</span> <span class="n">vt</span><span class="o">.</span><span class="n">ori_distance</span><span class="p">(</span><span class="n">case2_theta</span><span class="p">,</span> <span class="n">case2_result</span><span class="p">)</span> <span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Case 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#\modfn{\paren{-\atan{\tan{(-\theta)}} + \pi }}{\TAU} &amp;\text{if } \cos{(-\theta )} &lt; 0 \AND \sin{(-\theta )} &lt; 0 \\</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">nptheta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">nptheta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case3_theta</span> <span class="o">=</span>  <span class="n">nptheta</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case3_result</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="o">-</span><span class="n">case3_theta</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">%</span> <span class="n">TAU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">case3_theta</span><span class="p">,</span> <span class="n">case3_result</span><span class="p">,</span> <span class="n">vt</span><span class="o">.</span><span class="n">ori_distance</span><span class="p">(</span><span class="n">case3_theta</span><span class="p">,</span> <span class="n">case3_result</span><span class="p">)),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Case 4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#\modfn{\paren{-\frac{\pi}{2} }}{\TAU}                &amp;\text{if } \cos{(-\theta )} = 0 \AND \sin{(-\theta )} &gt; 0 \\</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># There are 2 locations with cos(-theta) = 0 and sing(-theta) &gt; 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># case4_theta = [ 3 * TAU / 4,   -TAU / 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosine0_theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="n">TAU</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span><span class="p">])</span> <span class="c1"># positions with cosine = 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">cosine0_theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">cosine0_theta</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case4_theta</span> <span class="o">=</span>  <span class="n">cosine0_theta</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;case4_theta = </span><span class="si">%r</span><span class="s1"> =? </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">case4_theta</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">%</span> <span class="n">TAU</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Case 5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># There are 2 locations with cos(-theta) = 0 and sing(-theta) &lt; 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># case4_theta = [ -3 * TAU / 4,   TAU / 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#\modfn{\paren{\frac{\pi}{2} }}{\TAU}                &amp;\text{if } \cos{(-\theta )} = 0 \AND \sin{(-\theta )} &lt; 0 \\</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">cosine0_theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">cosine0_theta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case5_theta</span> <span class="o">=</span>  <span class="n">cosine0_theta</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;case5_theta = </span><span class="si">%r</span><span class="s1"> =? </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">case5_theta</span><span class="p">,</span> <span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">%</span> <span class="n">TAU</span><span class="p">))</span>
</pre></div>
</div>
<p># numpy check</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># LATEX PART</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invTVR_held_full</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invTVR_full</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">refine</span><span class="p">,</span> <span class="n">atan2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.assumptions.refine</span> <span class="k">import</span> <span class="n">refine_atan2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="k">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">refine_atan2</span><span class="p">(</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="n">Q</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">Q</span><span class="o">.</span><span class="n">positive</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">refine_atan2</span><span class="p">(</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="n">Q</span><span class="o">.</span><span class="n">negative</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">Q</span><span class="o">.</span><span class="n">negative</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">refine_atan2</span><span class="p">(</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="n">Q</span><span class="o">.</span><span class="n">positive</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">Q</span><span class="o">.</span><span class="n">negative</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="go">atan(y/x)</span>
<span class="go">atan(y/x) - pi</span>
<span class="go">atan(y/x) + pi</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">negtheta</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;negtheta&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_subs2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">ori_subs</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ori_subs3</span> <span class="o">=</span> <span class="n">ori_subs2</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">theta</span><span class="p">:</span><span class="o">-</span><span class="n">negtheta</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_subs4</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">ori_subs3</span><span class="p">)</span>
<span class="go">Out[45]: Mod(-atan2(sin(negtheta)/a, cos(negtheta)/a), 2*pi)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>SimpleError:</dt>
<dd><p class="first">import sympy
from sympy.assumptions.refine import refine_atan2
symkw = dict(real=True, finite=True)
a = sympy.symbols(‘a’, positive=True, <a href="#id13"><span class="problematic" id="id14">**</span></a>symkw)
theta  = sympy.symbols(‘theta’, <a href="#id15"><span class="problematic" id="id16">**</span></a>symkw)</p>
<p>iv11, iv12  = sympy.symbols(‘iv11, iv12’, <a href="#id17"><span class="problematic" id="id18">**</span></a>symkw)
arb_assign = {</p>
<blockquote>
<div>iv12: -sympy.sin(theta)/a,
iv11: sympy.cos(theta)/a,</div></blockquote>
<p>}</p>
<p>ori_subs_nomod = sympy.atan2(-sympy.sin(theta)/a, sympy.cos(theta)/a)
atan2_case1 = refine_atan2(ori_subs_nomod,</p>
<blockquote>
<div>sympy.Q.real(arb_assign[iv12]) &amp; sympy.Q.positive(arb_assign[iv11])</div></blockquote>
<p class="last">)</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ori_subs3</span> <span class="o">=</span> <span class="n">ori_subs2</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">theta</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_subs3</span> <span class="o">=</span> <span class="n">ori_subs2</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">simultanious</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">for sym in ori_subs2.free_symbols:</span>
<span class="go">    print(&#39;%r.assumptions0 = %s&#39; % (sym, ub.repr2(sym.assumptions0),))</span>
</pre></div>
</div>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#invTVR = sympy.simplify(RVT_full.inv())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invTVR_full</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Sympy:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># First orient a unit circle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symkw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span>       <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">iv21</span>  <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y iv21&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">v21</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;vx, vy, v21&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iv11</span><span class="p">,</span> <span class="n">iv22</span>  <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;iv11 iv12&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v11</span><span class="p">,</span> <span class="n">v22</span>    <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;v11 v22&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Forward rotation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="o">-</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span>              <span class="mi">0</span><span class="p">,</span>          <span class="mi">0</span><span class="p">,</span>      <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Warps a unit circle at (0, 0) onto an ellipse at (x, y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">iv11</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="n">x</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span>  <span class="n">y</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">v11</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">vx</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">v21</span><span class="p">,</span> <span class="n">v22</span><span class="p">,</span> <span class="n">vy</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="go">veq = sympy.Eq(invVR, VR.inv())</span>
<span class="go">print(&#39;iv11 = &#39; + str(sympy.solve(veq, iv11)))</span>
<span class="go">print(&#39;iv21 = &#39; + str(sympy.solve(veq, iv21)))</span>
<span class="go">print(&#39;iv22 = &#39; + str(sympy.solve(veq, iv22)))</span>
<span class="go">print(&#39;x = &#39; + str(sympy.solve(veq, x)))</span>
<span class="go">print(&#39;y = &#39; + str(sympy.solve(veq, y)))</span>
<span class="go">inveq = sympy.Eq(V, invV.inv())</span>
<span class="go">print(&#39;v11 = &#39; + str(sympy.solve(inveq, v11)))</span>
<span class="go">print(&#39;v12 = &#39; + str(sympy.solve(inveq, v21)))</span>
<span class="go">print(&#39;v22 = &#39; + str(sympy.solve(inveq, v22)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">eval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">invVR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">invVR</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">rrrr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invV</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">other_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">other_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invVR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Sympy:</dt>
<dd><div class="first highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Show orientation property</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># First orient a unit circle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">iv21</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y g&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">v21</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;vx, vy, c&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iv11</span><span class="p">,</span> <span class="n">iv22</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;e h&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v11</span><span class="p">,</span> <span class="n">v22</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a d&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Forward rotation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="o">-</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span>              <span class="mi">0</span><span class="p">,</span>          <span class="mi">0</span><span class="p">,</span>      <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Warps a unit circle at (0, 0) onto an ellipse at (x, y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">iv11</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="n">x</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span>  <span class="n">y</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">v11</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">vx</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">v21</span><span class="p">,</span> <span class="n">v22</span><span class="p">,</span> <span class="n">vy</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="go">veq = sympy.Eq(invVR, VR.inv())</span>
<span class="go">print(&#39;iv11 = &#39; + str(sympy.solve(veq, iv11)))</span>
<span class="go">print(&#39;iv21 = &#39; + str(sympy.solve(veq, iv21)))</span>
<span class="go">print(&#39;iv22 = &#39; + str(sympy.solve(veq, iv22)))</span>
<span class="go">print(&#39;x = &#39; + str(sympy.solve(veq, x)))</span>
<span class="go">print(&#39;y = &#39; + str(sympy.solve(veq, y)))</span>
<span class="go">inveq = sympy.Eq(V, invV.inv())</span>
<span class="go">print(&#39;v11 = &#39; + str(sympy.solve(inveq, v11)))</span>
<span class="go">print(&#39;v12 = &#39; + str(sympy.solve(inveq, v21)))</span>
<span class="go">print(&#39;v22 = &#39; + str(sympy.solve(inveq, v22)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">eval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">invVR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">invVR</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">rrrr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invV</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">other_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">other_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invVR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="go">Matrix([</span>
<span class="go">[                 iv11*cos(theta),                  -iv11*sin(theta),  x],</span>
<span class="go">[iv21*cos(theta) + iv22*sin(theta), -iv21*sin(theta) + iv22*cos(theta),  y],</span>
<span class="go">[                               0,                                 0, 1.0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">invVR</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now extract the orientation from any invVR formated matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[[</span><span class="n">ivr11</span><span class="p">,</span> <span class="n">ivr12</span><span class="p">,</span> <span class="n">ivr13</span><span class="p">],</span> <span class="p">[</span><span class="n">ivr21</span><span class="p">,</span> <span class="n">ivr22</span><span class="p">,</span> <span class="n">ivr23</span><span class="p">],</span> <span class="p">[</span><span class="n">ivr31</span><span class="p">,</span> <span class="n">ivr32</span><span class="p">,</span> <span class="n">ivr33</span><span class="p">],]</span> <span class="o">=</span> <span class="n">invVR</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># tan = sin / cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symtau</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sympy</span><span class="o">.</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#ivr11 must be positive for this to work</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">sympy</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">ivr12</span><span class="p">,</span> <span class="n">ivr11</span><span class="p">))</span> <span class="o">%</span> <span class="p">(</span><span class="n">symtau</span><span class="p">)</span>  <span class="c1"># outputs from -TAU/2 to TAU/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Check Equality with a domain</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1</span> <span class="o">=</span> <span class="n">ori</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr2</span> <span class="o">=</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="p">{</span><span class="n">theta</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">truth_list</span><span class="p">,</span> <span class="n">results_list</span><span class="p">,</span> <span class="n">input_list</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">symbolic_randcheck</span><span class="p">(</span><span class="n">ori</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">truth_list</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">results_list</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">input_list</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">difference</span> <span class="o">=</span> <span class="n">results_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">results_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;diff = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">difference</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ori diff = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">ori_distance</span><span class="p">(</span><span class="n">results_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">results_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</pre></div>
</div>
<p class="last">truth_list, results_list, input_list =
check_random_points(sympy.sin(theta) / sympy.cos(theta),
sympy.tan(theta))
_oris = (-trig.atan2(_iv12s, _iv11s)) % TAU
ori.evalf(subs=dict(iv11=1, theta=3), verbose=True)
sympy.trigsimp(sympy.simplify(sympy.trigsimp(z)))
ori = np.arctan2(_iv12s, _iv11s)
z = ori.subs(dict(iv11=1, theta=1))</p>
</dd>
<dt>Timeit:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;&#39;&#39;</span>
<span class="go">        import numpy as np</span>
<span class="go">        np.random.seed(0)</span>
<span class="go">        invVR_mats = np.random.rand(10000, 2, 2).astype(np.float64)</span>
<span class="go">        &#39;&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;&#39;&#39;</span>
<span class="go">        invVR_mats[:, 0, 1]</span>
<span class="go">        invVR_mats.T[1, 0]</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">util_dev</span><span class="o">.</span><span class="n">rrr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">util_dev</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1E3</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.get_invVR_mats_shape">
<code class="descclassname">vtool.</code><code class="descname">get_invVR_mats_shape</code><span class="sig-paren">(</span><em>invVR_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_invVR_mats_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts keypoint shape components</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">get_invVR_mats_shape</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">pibujdiaimwcnmomserkcytyyikahjmp</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p>TODO
(a.ravel()[(cols + (rows * a.shape[1]).reshape((-1,1))).ravel()]).reshape(rows.size, cols.size)
<a class="reference external" href="http://stackoverflow.com/questions/14386822/fast-numpy-fancy-indexing">http://stackoverflow.com/questions/14386822/fast-numpy-fancy-indexing</a>
# So, this doesn’t work
# Try this instead
<a class="reference external" href="http://docs.cython.org/src/userguide/memoryviews.html#memoryviews">http://docs.cython.org/src/userguide/memoryviews.html#memoryviews</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_invVR_mats_sqrd_scale">
<code class="descclassname">vtool.</code><code class="descname">get_invVR_mats_sqrd_scale</code><span class="sig-paren">(</span><em>invVR_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_sqrd_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_invVR_mats_sqrd_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the squared scale of the invVR keyponts</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det_arr</span> <span class="o">=</span> <span class="n">get_invVR_mats_sqrd_scale</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">det_arr</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([-0.16, -0.09, -0.34, 0.59, -0.2 , 0.18, 0.06], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_invVR_mats_xys">
<code class="descclassname">vtool.</code><code class="descname">get_invVR_mats_xys</code><span class="sig-paren">(</span><em>invVR_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_xys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_invVR_mats_xys" title="Permalink to this definition">¶</a></dt>
<dd><p>extracts locations
extracts xys from matrix encoding, Its just the (0, 2), and (1, 2) components</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>invVR_mats</strong> (<em>ndarray</em>) – list of matrices mapping ucircles to ellipses</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the xy location</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Timeit:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;&#39;&#39;</span>
<span class="go">        import numpy as np</span>
<span class="go">        np.random.seed(0)</span>
<span class="go">        invVR_mats = np.random.rand(1000, 3, 3).astype(np.float64)</span>
<span class="go">        &#39;&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;&#39;&#39;</span>
<span class="go">        invVR_mats[:, 0:2, 2].T</span>
<span class="go">        invVR_mats.T[2, 0:2]</span>
<span class="go">        invVR_mats.T.take(2, axis=0).take([0, 1], axis=0)</span>
<span class="go">        invVR_mats.T.take(2, axis=0)[0:2]</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">util_dev</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1E5</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_invV_mats">
<code class="descclassname">vtool.</code><code class="descname">get_invV_mats</code><span class="sig-paren">(</span><em>kpts</em>, <em>with_trans=False</em>, <em>with_ori=False</em>, <em>ashomog=False</em>, <em>ascontiguous=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_invV_mats" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: DEPRICATE. too many conditionals</p>
<p>packs keypoint shapes into affine invV matrixes
(default is just the 2x2 shape. But translation, orientation,
homogonous, and contiguous flags can be set.)</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">with_trans</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">with_ori</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ashomog</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascontiguous</span><span class="o">=</span><span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">innVR_mats</span> <span class="o">=</span> <span class="n">get_invV_mats</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">with_trans</span><span class="p">,</span> <span class="n">with_ori</span><span class="p">,</span> <span class="n">ashomog</span><span class="p">,</span> <span class="n">ascontiguous</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">innVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[ 1.,  0., 10.],</span>
<span class="go">        [ 2.,  3., 20.],</span>
<span class="go">        [ 0.,  0.,  1.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_invV_mats2x2">
<code class="descclassname">vtool.</code><code class="descname">get_invV_mats2x2</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_mats2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_invV_mats2x2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keypoint shape (from unit circle to ellipse)
Ignores translation and rotation component</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">invV_mats</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray[float32_t, ndim=3]</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint –test-get_invV_mats2x2</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_mats2x2</span> <span class="o">=</span> <span class="n">get_invV_mats2x2</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invV_mats2x2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_invV_mats3x3">
<code class="descclassname">vtool.</code><code class="descname">get_invV_mats3x3</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_mats3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_invV_mats3x3" title="Permalink to this definition">¶</a></dt>
<dd><p>NEWER FUNCTION</p>
<p>Returns full keypoint transform matricies from a unit circle to an
ellipse that has been scaled, skewed, and translated. Into
the image keypoint position.</p>
<p>DOES NOT INCLUDE ROTATION</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">invVR_mats -  keypoint shape and rotations (possibly translation)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray[float32_t, ndim=3]</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_arrs3x3</span> <span class="o">=</span> <span class="n">get_invV_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invV_arrs3x3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_invVs">
<code class="descclassname">vtool.</code><code class="descname">get_invVs</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_invVs" title="Permalink to this definition">¶</a></dt>
<dd><p>Keypoint shapes (oriented with the gravity vector)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_kdtree_flann_params">
<code class="descclassname">vtool.</code><code class="descname">get_kdtree_flann_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_kdtree_flann_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_kdtree_flann_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_kpts_dlen_sqrd">
<code class="descclassname">vtool.</code><code class="descname">get_kpts_dlen_sqrd</code><span class="sig-paren">(</span><em>kpts</em>, <em>outer=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_dlen_sqrd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_kpts_dlen_sqrd" title="Permalink to this definition">¶</a></dt>
<dd><p>returns diagonal length squared of keypoint extent</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>outer</strong> (<em>bool</em>) – loose if False tight if True</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dlen_sqrd</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dlen_sqrd</span> <span class="o">=</span> <span class="n">get_kpts_dlen_sqrd</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">dlen_sqrd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">3735.01</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_kpts_dummy_img">
<code class="descclassname">vtool.</code><code class="descname">get_kpts_dummy_img</code><span class="sig-paren">(</span><em>kpts</em>, <em>sf=1.0</em>, <em>intensity=200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_kpts_dummy_img"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_kpts_dummy_img" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>sf</strong> (<em>float</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">img</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sf</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span>  <span class="n">get_kpts_dummy_img</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">sf</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_kpts_eccentricity">
<code class="descclassname">vtool.</code><code class="descname">get_kpts_eccentricity</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_eccentricity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_kpts_eccentricity" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>SeeAlso:</dt>
<dd>pyhesaff.tests.test_ellipse</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Eccentricity_(mathematics">https://en.wikipedia.org/wiki/Eccentricity_(mathematics</a>)</p>
<dl class="docutils">
<dt>Ascii:</dt>
<dd><p class="first">Connic marix is
Z_mat = np.array(((‘    A’, ‘B / 2’, ‘D / 2’),</p>
<blockquote>
<div>(‘B / 2’, ‘    C’, ‘E / 2’),
(‘D / 2’, ‘E / 2’, ‘    F’)))</div></blockquote>
<p>The eccentricity is determined by:
[A, B, C, D] = kpts_mat</p>
<blockquote>
<div>(2 * np.sqrt((A - C) ** 2 + B ** 2))</div></blockquote>
<dl class="docutils">
<dt>ecc = ———————————————–</dt>
<dd>(nu * (A + C) + np.sqrt((A - C) ** 2 + B ** 2))</dd>
</dl>
<p>nu = 1 if det(Z) &gt; 0, -1 if det(Z) &lt; 0, and 0 if det(Z) == 0</p>
<p class="last">(nu is always 1 for ellipses.)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For an ellipse/hyperbola the eccentricity is
sqrt(1 - (b ** 2 / a ** 2))</p>
<p>Eccentricity is undefined for parabolas</p>
<p>where a is the lenth of the semi-major axis and b is the length of the
semi minor axis. The length of the semi-major axis is 2 time the
largest eigenvalue.  And the length of the semi-minor axis is 2 times
the smallest eigenvalue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>offset</strong> (<em>tuple</em>) – (default = (0.0, 0.0))</li>
<li><strong>scale_factor</strong> (<em>float</em>) – (default = 1.0)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint –exec-get_kpts_eccentricity –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts_</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kpts_</span><span class="p">,</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ecc</span> <span class="o">=</span> <span class="n">get_kpts_eccentricity</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;ecc = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">ecc</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">colors</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">scores_to_color</span><span class="p">(</span><span class="n">ecc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_axis_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ecc</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">ecc = np.array([ 0.96, 0.99, 0.87, 0.91, 0.55, 0.  ])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_kpts_image_extent">
<code class="descclassname">vtool.</code><code class="descname">get_kpts_image_extent</code><span class="sig-paren">(</span><em>kpts</em>, <em>outer=False</em>, <em>only_xy=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_image_extent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_kpts_image_extent" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the width and height of keypoint bounding box
This combines xy and shape information
Does not take into account if keypoint extent goes under (0, 0)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em><em>[</em><em>ndims=2</em><em>]</em>) – keypoints</li>
<li><strong>outer</strong> – uses outer rectangle if True. Set to false for a
tighter extent.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(minx, maxx, miny, maxy)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">outer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">extent</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_axis_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([ 14.78, 48.05,  0.32, 51.58])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_kpts_strs">
<code class="descclassname">vtool.</code><code class="descname">get_kpts_strs</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_strs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_kpts_strs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_kpts_wh">
<code class="descclassname">vtool.</code><code class="descname">get_kpts_wh</code><span class="sig-paren">(</span><em>kpts</em>, <em>outer=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_wh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_kpts_wh" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the width / height diameter of a keypoint
ie the diameter of the xaxis and yaxis of the keypoint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em><em>[</em><em>ndims=2</em><em>]</em>) – keypoints</li>
<li><strong>outer</strong> (<em>bool</em>) – if True returns wh of bounding box.
This is useful because extracting a patch needs a rectangle.
If false it returns the otherwise gets the extent of the ellipse.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(2xN) column1 is X extent and column2 is Y extent</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><p class="first"># Determine formula for min/maxing x and y
import sympy
x, y = sympy.symbols(‘x, y’, real=True)
a, d = sympy.symbols(‘a, d’, real=True, positive=True)
c = sympy.symbols(‘c’, real=True)
theta = sympy.symbols(‘theta’, real=True, nonnegative=True)
xeqn = sympy.Eq(x, a * sympy.cos(theta))
yeqn = sympy.Eq(y, c * sympy.sin(theta) + v * d)
dxdt = sympy.solve(sympy.diff(xeqn, theta), 0)
dydt = sympy.solve(sympy.diff(yeqn, theta), 0)</p>
<p># Ugg, cant get sympy to do trig derivative, do it manually
dxdt = -a * sin(theta)
dydt = d * cos(theta) - c * sin(theta)
critical_thetas = solve(Eq(dxdt, 0), theta)
critical_thetas += solve(Eq(dydt, 0), theta)
[a, _, c, d] = invV.ravel()
critical_thetas = [</p>
<blockquote>
<div>0, np.pi,
-2 * np.arctan((c + np.sqrt(c ** 2 + d ** 2)) / d),
-2 * np.arctan((c - np.sqrt(c ** 2 + d ** 2)) / d),</div></blockquote>
<p>]
critical_uvs = np.vstack([np.cos(critical_thetas),</p>
<blockquote>
<div>np.sin(critical_thetas)])</div></blockquote>
<p class="last">critical_xys = invV.dot(critical_uvs)</p>
</dd>
<dt>SeeAlso:</dt>
<dd>get_kpts_major_minor</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span> <span class="o">*</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span> <span class="o">*</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyexnts</span> <span class="o">=</span> <span class="n">get_kpts_wh</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">xyexnts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">scale_extents</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_axis_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radii</span> <span class="o">=</span> <span class="n">xyexnts</span> <span class="o">/</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">horiz_pts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">xs</span> <span class="o">-</span> <span class="n">radii</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ys</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">horiz_pts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">xs</span> <span class="o">+</span> <span class="n">radii</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ys</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert_pts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xs</span><span class="p">,</span> <span class="p">(</span><span class="n">ys</span> <span class="o">-</span> <span class="n">radii</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert_pts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xs</span><span class="p">,</span> <span class="p">(</span><span class="n">ys</span> <span class="o">+</span> <span class="n">radii</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments2</span><span class="p">(</span><span class="n">horiz_pts1</span><span class="p">,</span> <span class="n">horiz_pts2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments2</span><span class="p">(</span><span class="n">vert_pts1</span><span class="p">,</span> <span class="n">vert_pts2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([[10.43315411, 58.5216589 ],</span>
<span class="go">          [ 4.71017647, 58.5216589 ],</span>
<span class="go">          [24.43314171, 45.09558868],</span>
<span class="go">          [26.71114159, 63.47679138],</span>
<span class="go">          [32.10540009, 30.28536987]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_lat_lon">
<code class="descclassname">vtool.</code><code class="descname">get_lat_lon</code><span class="sig-paren">(</span><em>exif_dict</em>, <em>default=(-1</em>, <em>-1)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_lat_lon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_lat_lon" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the latitude and longitude, if available, from the provided
exif_data2 (obtained through exif_data2 above)</p>
<p class="rubric">Notes</p>
<p>Might need to downgrade to Pillow 2.9.0 to solve a bug with getting GPS
<a class="reference external" href="https://github.com/python-pillow/Pillow/issues/1477">https://github.com/python-pillow/Pillow/issues/1477</a></p>
<p>python -c “from PIL import Image; print(Image.PILLOW_VERSION)”</p>
<p>pip uninstall Pillow
pip install Pillow==2.9</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.exif –test-get_lat_lon</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exif_dict</span> <span class="o">=</span> <span class="n">get_exif_dict</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latlon</span> <span class="o">=</span> <span class="n">get_lat_lon</span><span class="p">(</span><span class="n">exif_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">latlon</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_left_area">
<code class="descclassname">vtool.</code><code class="descname">get_left_area</code><span class="sig-paren">(</span><em>ydata</em>, <em>xdata</em>, <em>index_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#get_left_area"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_left_area" title="Permalink to this definition">¶</a></dt>
<dd><p>area to the left of each index point</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_match_spatial_squared_error">
<code class="descclassname">vtool.</code><code class="descname">get_match_spatial_squared_error</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>H</em>, <em>fx2_to_fx1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_match_spatial_squared_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_match_spatial_squared_error" title="Permalink to this definition">¶</a></dt>
<dd><p>transforms img2 to img2 and finds squared spatial error</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts1</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>kpts2</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>H</strong> (<em>ndarray</em><em>[</em><em>float64_t</em><em>, </em><em>ndim=2</em><em>]</em>) – homography/perspective matrix mapping image 1 to image 2 space</li>
<li><strong>fx2_to_fx1</strong> (<em>ndarray</em>) – has shape (nMatch, K)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">fx2_to_xyerr_sqrd has shape (nMatch, K)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">129.83</span><span class="p">,</span>  <span class="mf">46.97</span><span class="p">,</span>  <span class="mf">15.84</span><span class="p">,</span>   <span class="mf">4.66</span><span class="p">,</span>   <span class="mf">7.24</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">137.88</span><span class="p">,</span>  <span class="mf">49.87</span><span class="p">,</span>  <span class="mf">20.09</span><span class="p">,</span>   <span class="mf">5.76</span><span class="p">,</span>   <span class="mf">6.2</span> <span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">115.95</span><span class="p">,</span>  <span class="mf">53.13</span><span class="p">,</span>  <span class="mf">12.96</span><span class="p">,</span>   <span class="mf">1.73</span><span class="p">,</span>   <span class="mf">8.77</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">324.88</span><span class="p">,</span> <span class="mf">172.58</span><span class="p">,</span> <span class="mf">127.69</span><span class="p">,</span>  <span class="mf">41.29</span><span class="p">,</span>  <span class="mf">50.5</span> <span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">285.44</span><span class="p">,</span> <span class="mf">254.61</span><span class="p">,</span> <span class="mf">136.06</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.77</span><span class="p">,</span>  <span class="mf">76.69</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">367.72</span><span class="p">,</span> <span class="mf">140.81</span><span class="p">,</span> <span class="mf">172.13</span><span class="p">,</span>  <span class="mf">12.99</span><span class="p">,</span>  <span class="mf">96.15</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">318.93</span><span class="p">,</span>  <span class="mf">11.98</span><span class="p">,</span>  <span class="mf">12.11</span><span class="p">,</span>   <span class="mf">0.38</span><span class="p">,</span>   <span class="mf">8.04</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">509.47</span><span class="p">,</span>  <span class="mf">12.53</span><span class="p">,</span>  <span class="mf">22.4</span> <span class="p">,</span>   <span class="mf">1.31</span><span class="p">,</span>   <span class="mf">5.04</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">514.03</span><span class="p">,</span>  <span class="mf">13.04</span><span class="p">,</span>  <span class="mf">19.25</span><span class="p">,</span>   <span class="mf">1.74</span><span class="p">,</span>   <span class="mf">4.72</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">490.19</span><span class="p">,</span> <span class="mf">185.49</span><span class="p">,</span>  <span class="mf">95.67</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.84</span><span class="p">,</span>  <span class="mf">88.23</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">316.97</span><span class="p">,</span> <span class="mf">206.07</span><span class="p">,</span>  <span class="mf">90.87</span><span class="p">,</span>   <span class="mf">0.07</span><span class="p">,</span>  <span class="mf">80.45</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">366.07</span><span class="p">,</span> <span class="mf">140.05</span><span class="p">,</span> <span class="mf">161.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">47.01</span><span class="p">,</span>  <span class="mf">85.62</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="o">-</span><span class="mf">0.70098</span><span class="p">,</span>  <span class="mf">0.12273</span><span class="p">,</span>  <span class="mf">5.18734</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mf">0.12444</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.63474</span><span class="p">,</span> <span class="mf">14.13995</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mf">0.00004</span><span class="p">,</span>  <span class="mf">0.00025</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.64873</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr_sqrd</span> <span class="o">=</span> <span class="n">get_match_spatial_squared_error</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">fx2_to_fx1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fx2_to_xyerr_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fx2_to_xyerr</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">6.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">,</span>  <span class="mf">15.84</span><span class="p">,</span>   <span class="mf">4.66</span><span class="p">,</span>   <span class="mf">7.24</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">9.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>  <span class="mf">20.09</span><span class="p">,</span>   <span class="mf">5.76</span><span class="p">,</span>   <span class="mf">6.2</span> <span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">12.96</span><span class="p">,</span>   <span class="mf">1.73</span><span class="p">,</span>   <span class="mf">8.77</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">12.11</span><span class="p">,</span>   <span class="mf">0.38</span><span class="p">,</span>   <span class="mf">8.04</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">5.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">22.4</span> <span class="p">,</span>   <span class="mf">1.31</span><span class="p">,</span>   <span class="mf">5.04</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">6.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">19.25</span><span class="p">,</span>   <span class="mf">1.74</span><span class="p">,</span>   <span class="mf">4.72</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr_sqrd</span> <span class="o">=</span> <span class="n">get_match_spatial_squared_error</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">fx2_to_fx1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fx2_to_xyerr_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fx2_to_xyerr</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.get_no_symbol">
<code class="descclassname">vtool.</code><code class="descname">get_no_symbol</code><span class="sig-paren">(</span><em>variant='symbol'</em>, <em>size=(100</em>, <em>100)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_no_symbol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_no_symbol" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">errorimg</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-get_no_symbol –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">errorimg</span> <span class="o">=</span> <span class="n">get_no_symbol</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">errorimg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_normalized_affine_inliers">
<code class="descclassname">vtool.</code><code class="descname">get_normalized_affine_inliers</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>aff_inliers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_normalized_affine_inliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_normalized_affine_inliers" title="Permalink to this definition">¶</a></dt>
<dd><p>returns xy-inliers that are normalized to have a mean of 0 and std of 1 as
well as the transformations so the inverse can be taken</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_num_channels">
<code class="descclassname">vtool.</code><code class="descname">get_num_channels</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_num_channels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_num_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of color channels</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_ori_mats">
<code class="descclassname">vtool.</code><code class="descname">get_ori_mats</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_ori_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_ori_mats" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns keypoint orientation matrixes</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_ori_strs">
<code class="descclassname">vtool.</code><code class="descname">get_ori_strs</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_ori_strs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_ori_strs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_orientation">
<code class="descclassname">vtool.</code><code class="descname">get_orientation</code><span class="sig-paren">(</span><em>exif_dict</em>, <em>default=0</em>, <em>on_error='warn'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_orientation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_orientation" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the image orientation, if available, from the provided
exif_data2 (obtained through exif_data2 above)</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.exif –test-get_orientation</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="k">import</span> <span class="n">join</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://wildbookiarepository.azureedge.net/models/orientation.zip&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">images_path</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_zipped_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">image_filename</span> <span class="o">=</span> <span class="s1">&#39;orientation_</span><span class="si">%05d</span><span class="s1">.JPG&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">images_path</span><span class="p">,</span> <span class="n">image_filename</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">exif_dict</span> <span class="o">=</span> <span class="n">get_exif_dict</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">orient</span> <span class="o">=</span> <span class="n">get_orientation</span><span class="p">(</span><span class="n">exif_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">orient</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1, 6, 8]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_orientation_histogram">
<code class="descclassname">vtool.</code><code class="descname">get_orientation_histogram</code><span class="sig-paren">(</span><em>gori</em>, <em>gori_weights</em>, <em>bins=36</em>, <em>DEBUG_ROTINVAR=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_orientation_histogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_orientation_histogram" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gori</strong> – </li>
<li><strong>gori_weights</strong> – </li>
<li><strong>bins</strong> (<em>int</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(hist, centers)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-get_orientation_histogram</dd>
<dt>Ignore:</dt>
<dd>print(vt.kpts_docrepr(gori, ‘gori = ‘))
print(vt.kpts_docrepr(gori_weights, ‘gori_weights = ‘))</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gori</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">4.71</span><span class="p">,</span>  <span class="mf">6.15</span><span class="p">,</span>  <span class="mf">3.13</span><span class="p">,</span>  <span class="mf">3.24</span><span class="p">,</span>  <span class="mf">4.71</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">4.71</span><span class="p">,</span>  <span class="mf">4.61</span><span class="p">,</span>  <span class="mf">0.5</span> <span class="p">,</span>  <span class="mf">4.85</span><span class="p">,</span>  <span class="mf">4.71</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">1.57</span><span class="p">,</span>  <span class="mf">6.28</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">1.57</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gori_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.19</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.21</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.16</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.11</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.17</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.19</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_orientation_histogram</span><span class="p">(</span><span class="n">gori</span><span class="p">,</span> <span class="n">gori_weights</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_orientation_str">
<code class="descclassname">vtool.</code><code class="descname">get_orientation_str</code><span class="sig-paren">(</span><em>exif_dict</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_orientation_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_orientation_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the image orientation strings, if available, from the provided
exif_data2 (obtained through exif_data2 above)</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.exif –test-get_orientation_str</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="k">import</span> <span class="n">join</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://wildbookiarepository.azureedge.net/models/orientation.zip&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">images_path</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_zipped_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">image_filename</span> <span class="o">=</span> <span class="s1">&#39;orientation_</span><span class="si">%05d</span><span class="s1">.JPG&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">images_path</span><span class="p">,</span> <span class="n">image_filename</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">exif_dict</span> <span class="o">=</span> <span class="n">get_exif_dict</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">orient_str</span> <span class="o">=</span> <span class="n">get_orientation_str</span><span class="p">(</span><span class="n">exif_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">orient_str</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[&#39;Normal&#39;, &#39;90 Clockwise&#39;, &#39;90 Counter-Clockwise&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_oris">
<code class="descclassname">vtool.</code><code class="descname">get_oris</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_oris"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_oris" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts keypoint orientations for kpts array</p>
<p>(in isotropic guassian space relative to the gravity vector)
(in simpler words: the orientation is is taken from keypoints warped to the unit circle)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray</em>) – (N x 6) [x, y, a, c, d, theta]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(ndarray) theta</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.get_pixel_dist">
<code class="descclassname">vtool.</code><code class="descname">get_pixel_dist</code><span class="sig-paren">(</span><em>img</em>, <em>pixel</em>, <em>channel=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_pixel_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_pixel_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>pixel = fillval
isfill = mask2d</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_pointset_extent_wh">
<code class="descclassname">vtool.</code><code class="descname">get_pointset_extent_wh</code><span class="sig-paren">(</span><em>pts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#get_pointset_extent_wh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_pointset_extent_wh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_pointset_extents">
<code class="descclassname">vtool.</code><code class="descname">get_pointset_extents</code><span class="sig-paren">(</span><em>pts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#get_pointset_extents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_pointset_extents" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_right_area">
<code class="descclassname">vtool.</code><code class="descname">get_right_area</code><span class="sig-paren">(</span><em>ydata</em>, <em>xdata</em>, <em>index_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#get_right_area"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_right_area" title="Permalink to this definition">¶</a></dt>
<dd><p>area to the right of each index point</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_round_scaled_dsize">
<code class="descclassname">vtool.</code><code class="descname">get_round_scaled_dsize</code><span class="sig-paren">(</span><em>dsize</em>, <em>scale</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_round_scaled_dsize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_round_scaled_dsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an integer size and scale that best approximates
the floating point scale on the original size</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dsize</strong> (<em>tuple</em>) – original width height</li>
<li><strong>scale</strong> (<em>float</em><em> or </em><em>tuple</em>) – desired floating point scale factor</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.get_scale_factor">
<code class="descclassname">vtool.</code><code class="descname">get_scale_factor</code><span class="sig-paren">(</span><em>src_img</em>, <em>dst_img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_scale_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_scale_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>returns scale factor from one image to the next</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_scaled_size_with_dlen">
<code class="descclassname">vtool.</code><code class="descname">get_scaled_size_with_dlen</code><span class="sig-paren">(</span><em>target_dlen</em>, <em>w</em>, <em>h</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#get_scaled_size_with_dlen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_scaled_size_with_dlen" title="Permalink to this definition">¶</a></dt>
<dd><p>returns new_size which scales (w, h) as close to target_dlen as possible
and maintains aspect ratio</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_scales">
<code class="descclassname">vtool.</code><code class="descname">get_scales</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_scales"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_scales" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets average scale (does not take into account elliptical shape</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_shape_strs">
<code class="descclassname">vtool.</code><code class="descname">get_shape_strs</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_shape_strs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_shape_strs" title="Permalink to this definition">¶</a></dt>
<dd><p>strings debugging and output</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_size">
<code class="descclassname">vtool.</code><code class="descname">get_size</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the image size in (width, height)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_sqrd_scales">
<code class="descclassname">vtool.</code><code class="descname">get_sqrd_scales</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_sqrd_scales"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_sqrd_scales" title="Permalink to this definition">¶</a></dt>
<dd><p>gets average squared scale (does not take into account elliptical shape</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_scales_sqrd</span> <span class="o">=</span> <span class="n">get_sqrd_scales</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_scales_sqrd</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_scales_sqrd</span> <span class="o">=</span> <span class="n">get_sqrd_scales</span><span class="p">([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_scales_sqrd</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_star2_patch">
<code class="descclassname">vtool.</code><code class="descname">get_star2_patch</code><span class="sig-paren">(</span><em>jitter=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_star2_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_star2_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_star_patch">
<code class="descclassname">vtool.</code><code class="descname">get_star_patch</code><span class="sig-paren">(</span><em>jitter=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_star_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_star_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_stripe_patch">
<code class="descclassname">vtool.</code><code class="descname">get_stripe_patch</code><span class="sig-paren">(</span><em>jitter=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_stripe_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_stripe_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_test_patch">
<code class="descclassname">vtool.</code><code class="descname">get_test_patch</code><span class="sig-paren">(</span><em>key='star'</em>, <em>jitter=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_test_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_test_patch" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> (<em>str</em>) – </li>
<li><strong>jitter</strong> (<em>bool</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">patch</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-get_test_patch –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;star2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jitter</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">get_test_patch</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">jitter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">patch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_testdata_kpts">
<code class="descclassname">vtool.</code><code class="descname">get_testdata_kpts</code><span class="sig-paren">(</span><em>fname=None</em>, <em>with_vecs=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_testdata_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_testdata_kpts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_transforms_from_patch_image_kpts">
<code class="descclassname">vtool.</code><code class="descname">get_transforms_from_patch_image_kpts</code><span class="sig-paren">(</span><em>kpts</em>, <em>patch_shape</em>, <em>scale_factor=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_transforms_from_patch_image_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_transforms_from_patch_image_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Given some patch (like a gaussian patch) transforms a patch to be overlayed
on top of each keypoint in the image (adjusted for a scale factor)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>patch_shape</strong> – </li>
<li><strong>scale_factor</strong> (<em>float</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a list of 3x3 tranformation matricies for each keypoint</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">M_list</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_factor</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M_list</span> <span class="o">=</span> <span class="n">get_transforms_from_patch_image_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">patch_shape</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">M_list</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.get_uncovered_mask">
<code class="descclassname">vtool.</code><code class="descname">get_uncovered_mask</code><span class="sig-paren">(</span><em>covered_array</em>, <em>covering_array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_uncovered_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_uncovered_mask" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>covered_array</strong> (<em>ndarray</em>) – </li>
<li><strong>covering_array</strong> (<em>ndarray</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">flags</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-get_uncovered_mask</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covering_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">get_uncovered_mask</span><span class="p">(</span><span class="n">covered_array</span><span class="p">,</span> <span class="n">covering_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ True False  True False False]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covering_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">get_uncovered_mask</span><span class="p">(</span><span class="n">covered_array</span><span class="p">,</span> <span class="n">covering_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ True  True  True  True  True]</span>
</pre></div>
</div>
</dd>
<dt>Example3:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
<span class="gp">... </span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covering_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">get_uncovered_mask</span><span class="p">(</span><span class="n">covered_array</span><span class="p">,</span> <span class="n">covering_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flags</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[ True, False,  True],</span>
<span class="go">          [False, False,  True],</span>
<span class="go">          [ True,  True,  True]], dtype=bool)</span>
</pre></div>
</div>
</dd>
<dt>Ignore::</dt>
<dd>covering_array = [1, 2, 3, 4, 5, 6, 7]
%timeit get_uncovered_mask(covered_array, covering_array)
100000 loops, best of 3: 18.6 µs per loop
%timeit get_uncovered_mask2(covered_array, covering_array)
100000 loops, best of 3: 16.9 µs per loop</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.get_undirected_edge_ids">
<code class="descclassname">vtool.</code><code class="descname">get_undirected_edge_ids</code><span class="sig-paren">(</span><em>directed_edges</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_undirected_edge_ids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_undirected_edge_ids" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>directed_edges</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">edgeid_list</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –exec-get_undirected_edge_ids</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">directed_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edgeid_list</span> <span class="o">=</span> <span class="n">get_undirected_edge_ids</span><span class="p">(</span><span class="n">directed_edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;edgeid_list = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">edgeid_list</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">edgeid_list = [0 0 1 2 3 1 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_uneven_point_sample">
<code class="descclassname">vtool.</code><code class="descname">get_uneven_point_sample</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_uneven_point_sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_uneven_point_sample" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>for each keypoint returns an uneven sample of points along the ellipical</dt>
<dd>boundries.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>pyhesaff.tests.test_ellipse
python -m pyhesaff.tests.test_ellipse –test-in_depth_ellipse –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ellipse_pts1</span> <span class="o">=</span> <span class="n">get_uneven_point_sample</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">ellipse_pts1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;uneven sample points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_unixtime">
<code class="descclassname">vtool.</code><code class="descname">get_unixtime</code><span class="sig-paren">(</span><em>exif_dict</em>, <em>default=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_unixtime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_unixtime" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: Exif.Image.TimeZoneOffset</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exif_dict</span> <span class="o">=</span> <span class="n">get_exif_dict</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_unixtime_gps">
<code class="descclassname">vtool.</code><code class="descname">get_unixtime_gps</code><span class="sig-paren">(</span><em>exif_dict</em>, <em>default=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_unixtime_gps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_unixtime_gps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.get_unwarped_patch">
<code class="descclassname">vtool.</code><code class="descname">get_unwarped_patch</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>kp</em>, <em>gray=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_unwarped_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_unwarped_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns unwarped warped patch around a keypoint</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em>) – array representing an image</li>
<li><strong>kpt</strong> (<em>ndarray</em>) – keypoint ndarray in [x, y, a, c, d, theta] format</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(wpatch, wkp) the normalized 41x41 patches from the img corresonding to the keypoint</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.get_unwarped_patches">
<code class="descclassname">vtool.</code><code class="descname">get_unwarped_patches</code><span class="sig-paren">(</span><em>img</em>, <em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_unwarped_patches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_unwarped_patches" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns cropped unwarped (keypoint is still elliptical) patch around a
keypoint</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em>) – array representing an image</li>
<li><strong>kpts</strong> (<em>ndarrays</em>) – keypoint ndarrays in [x, y, a, c, d, theta] format</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>(patches, subkpts) - the unnormalized patches from the img</dt>
<dd><p class="first last">corresonding to the keypoint</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.get_warped_patch">
<code class="descclassname">vtool.</code><code class="descname">get_warped_patch</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>kp</em>, <em>gray=False</em>, <em>flags=4</em>, <em>borderMode=1</em>, <em>patch_size=41</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_warped_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_warped_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns warped (into a unit circle) patch around a keypoint</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em>) – array representing an image</li>
<li><strong>kpt</strong> (<em>ndarray</em>) – keypoint ndarray in [x, y, a, c, d, theta] format</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>(wpatch, wkp) the normalized 41x41 patches from</dt>
<dd><p class="first last">the img corresonding to the keypoint</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(ndarray, ndarray)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.get_warped_patches">
<code class="descclassname">vtool.</code><code class="descname">get_warped_patches</code><span class="sig-paren">(</span><em>img</em>, <em>kpts</em>, <em>flags=4</em>, <em>borderMode=1</em>, <em>patch_size=41</em>, <em>use_cpp=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_warped_patches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_warped_patches" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns warped (into a unit circle) patch around a keypoint</p>
<dl class="docutils">
<dt>FIXME:</dt>
<dd>there is a slight translation difference in the way Python extracts
patches and the way C++ extracts patches. C++ should be correct.
TODO: have C++ able to extract color.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – array representing an image</li>
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – list of keypoint ndarrays in
[[x, y, a, c, d, theta]] format</li>
<li><strong>flags</strong> (<em>long</em>) – cv2 interpolation flags</li>
<li><strong>borderMode</strong> (<em>long</em>) – cv2 border flags</li>
<li><strong>patch_size</strong> (<em>int</em>) – resolution of resulting image patch</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>(warped_patches, warped_subkpts) the normalized 41x41</dt>
<dd><p class="first last">patches from the img corresonding to the keypoint</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(list, list)</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-get_warped_patches –show –use_cpp
python -m vtool.patch –test-get_warped_patches –show –use_python</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cpp</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--use_cpp&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">desc</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">INTER_LANCZOS4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">borderMode</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_REPLICATE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">warped_patches</span><span class="p">,</span> <span class="n">warped_subkpts</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_warped_patches</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">kpts</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">borderMode</span><span class="p">,</span> <span class="n">use_cpp</span><span class="o">=</span><span class="n">use_cpp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">warped_patches</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">warped_subkpts</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">warped_patches</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_kpts2(warped_subkpts, pts=True, rect=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;use_cpp = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">use_cpp</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.get_xy_strs">
<code class="descclassname">vtool.</code><code class="descname">get_xy_strs</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_xy_strs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_xy_strs" title="Permalink to this definition">¶</a></dt>
<dd><p>strings debugging and output</p>
</dd></dl>

<dl class="function">
<dt id="vtool.get_xys">
<code class="descclassname">vtool.</code><code class="descname">get_xys</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_xys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.get_xys" title="Permalink to this definition">¶</a></dt>
<dd><p>Keypoint locations in chip space</p>
</dd></dl>

<dl class="function">
<dt id="vtool.grab_webcam_image">
<code class="descclassname">vtool.</code><code class="descname">grab_webcam_image</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#grab_webcam_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.grab_webcam_image" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_gui/py_video_display/py_video_display.html">http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_gui/py_video_display/py_video_display.html</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-grab_webcam_image –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">grab_webcam_image</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s1">&#39;webcap.jpg&#39;</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.gradient_fill">
<code class="descclassname">vtool.</code><code class="descname">gradient_fill</code><span class="sig-paren">(</span><em>shape</em>, <em>theta=0</em>, <em>flip=False</em>, <em>vert=False</em>, <em>style='linear'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gradient_fill"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.gradient_fill" title="Permalink to this definition">¶</a></dt>
<dd><p>FIXME: angle does not work properly</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch gradient_fill –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#style = &#39;linear&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;step&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">gradient_fill</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_uint8</span><span class="p">(</span><span class="n">patch</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.gradient_magnitude">
<code class="descclassname">vtool.</code><code class="descname">gradient_magnitude</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#gradient_magnitude"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.gradient_magnitude" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.greedy_setcover">
<code class="descclassname">vtool.</code><code class="descname">greedy_setcover</code><span class="sig-paren">(</span><em>universe</em>, <em>subsets</em>, <em>weights=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#greedy_setcover"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.greedy_setcover" title="Permalink to this definition">¶</a></dt>
<dd><p>Copied implmentation of greedy set cover from stack overflow. Needs work.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/7942312/of-greedy-set-cover-faster">http://stackoverflow.com/questions/7942312/of-greedy-set-cover-faster</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">universe</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subsets</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="nb">set</span><span class="p">([</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chosen</span><span class="p">,</span> <span class="n">costs</span> <span class="o">=</span> <span class="n">greedy_setcover</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">subsets</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cover: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">chosen</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total Cost: </span><span class="si">%r</span><span class="s1">=sum(</span><span class="si">%r</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">costs</span><span class="p">),</span> <span class="n">costs</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.gridsearch_addWeighted">
<code class="descclassname">vtool.</code><code class="descname">gridsearch_addWeighted</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#gridsearch_addWeighted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.gridsearch_addWeighted" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/blend.py gridsearch_addWeighted</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.gridsearch_chipextract">
<code class="descclassname">vtool.</code><code class="descname">gridsearch_chipextract</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#gridsearch_chipextract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.gridsearch_chipextract" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/chip.py gridsearch_chipextract –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_chipextract</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.gridsearch_image_function">
<code class="descclassname">vtool.</code><code class="descname">gridsearch_image_function</code><span class="sig-paren">(</span><em>param_info</em>, <em>test_func</em>, <em>args=()</em>, <em>show_func=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#gridsearch_image_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.gridsearch_image_function" title="Permalink to this definition">¶</a></dt>
<dd><p>gridsearch for a function that produces a single image</p>
</dd></dl>

<dl class="function">
<dt id="vtool.group_consecutive">
<code class="descclassname">vtool.</code><code class="descname">group_consecutive</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#group_consecutive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.group_consecutive" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns lists of consecutive values</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/7352684/how-to-find-the-groups-of-consecutive-elements-from-an-array-in-numpy">http://stackoverflow.com/questions/7352684/how-to-find-the-groups-of-consecutive-elements-from-an-array-in-numpy</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arr</strong> (<em>ndarray</em>) – must be integral and unique</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">arr -</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –exec-group_consecutive</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groups</span> <span class="o">=</span> <span class="n">group_consecutive</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;groups = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">groups</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">groups = [array([1, 2, 3]), array([ 5,  6,  7,  8,  9, 10]), array([15]), array([ 99, 100, 101])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.group_indices">
<code class="descclassname">vtool.</code><code class="descname">group_indices</code><span class="sig-paren">(</span><em>idx2_groupid</em>, <em>assume_sorted=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#group_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.group_indices" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>idx2_groupid</strong> (<em>ndarray</em>) – numpy array of group ids (must be numeric)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(keys, groupxs)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple (ndarray, list of ndarrays)</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/clustering2.py group_indices
xdoctest -m ~/code/vtool/vtool/clustering2.py group_indices:0
xdoctest -m ~/code/vtool/vtool/clustering2.py group_indices:1</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([1, 2, 3], dtype=np.int64),</span>
<span class="go">[</span>
<span class="go">    np.array([1, 3, 5], dtype=np.int64),</span>
<span class="go">    np.array([0, 2, 4, 6], dtype=np.int64),</span>
<span class="go">    np.array([ 7,  8,  9, 10], dtype=np.int64),</span>
<span class="go">],</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mi">24</span><span class="p">],</span> <span class="p">[</span> <span class="mi">129</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">24</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span><span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">822</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span><span class="mi">24</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2d arrays must be flattened before coming into this function so</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># information is on the last axis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([ 24, 129, 659, 822], dtype=np.int64),</span>
<span class="go">[</span>
<span class="go">    np.array([ 0,  4, 10], dtype=np.int64),</span>
<span class="go">    np.array([1], dtype=np.int64),</span>
<span class="go">    np.array([2, 3, 5, 6, 8, 9], dtype=np.int64),</span>
<span class="go">    np.array([7], dtype=np.int64),</span>
<span class="go">],</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([False,  True], dtype=np.bool),</span>
<span class="go">[</span>
<span class="go">    np.array([2, 4, 5], dtype=np.int64),</span>
<span class="go">    np.array([0, 1, 3, 6], dtype=np.int64),</span>
<span class="go">],</span>
</pre></div>
</div>
</dd>
<dt>Time:</dt>
<dd><div class="first highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">extract_timeit_setup</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">group_indices</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;groupxs =&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">setup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="go">        [sortx[lx:rx] for lx, rx in ut.itertwo(idxs)]</span>
<span class="go">        [sortx[lx:rx] for lx, rx in zip(idxs, idxs[1:])]</span>
<span class="go">        #[sortx[lx:rx] for lx, rx in ut.iter_window(idxs)]</span>
<span class="go">        #[sortx[slice(*_)] for _ in ut.itertwo(idxs)]</span>
<span class="go">        #[sortx[slice(lr, lx)] for lr, lx in ut.itertwo(idxs)]</span>
<span class="go">        #np.split(sortx, idxs[1:-1])</span>
<span class="go">        #np.hsplit(sortx, idxs[1:-1])</span>
<span class="go">        np.array_split(sortx, idxs[1:-1])</span>
<span class="go">        &#39;&#39;&#39;).split(&#39;\n&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stmt_list</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">passed</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="go">        np.diff(groupids_sorted)</span>
<span class="go">        np.ediff1d(groupids_sorted)</span>
<span class="go">        np.subtract(groupids_sorted[1:], groupids_sorted[:-1])</span>
<span class="go">        &#39;&#39;&#39;).split(&#39;\n&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stmt_list</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">passed</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Timeit:</dt>
<dd>import numba
group_indices_numba = numba.jit(group_indices)
group_indices_numba(idx2_groupid)</dd>
<dt>SeeAlso:</dt>
<dd>apply_grouping</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4651683/">http://stackoverflow.com/questions/4651683/</a>
numpy-grouping-using-itertools-groupby-performance</p>
</dd></dl>

<dl class="function">
<dt id="vtool.groupby">
<code class="descclassname">vtool.</code><code class="descname">groupby</code><span class="sig-paren">(</span><em>items</em>, <em>idx2_groupid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupby"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.groupby" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">items</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span> <span class="o">=</span> <span class="n">idx2_groupid</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.groupby_dict">
<code class="descclassname">vtool.</code><code class="descname">groupby_dict</code><span class="sig-paren">(</span><em>items</em>, <em>idx2_groupid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupby_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.groupby_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.groupby_gen">
<code class="descclassname">vtool.</code><code class="descname">groupby_gen</code><span class="sig-paren">(</span><em>items</em>, <em>idx2_groupid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupby_gen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.groupby_gen" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">items</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.groupedzip">
<code class="descclassname">vtool.</code><code class="descname">groupedzip</code><span class="sig-paren">(</span><em>id_list</em>, <em>datas_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupedzip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.groupedzip" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for grouping multiple lists of data (stored in <code class="docutils literal notranslate"><span class="pre">datas_list</span></code>)
using <code class="docutils literal notranslate"><span class="pre">id_list</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>id_list</strong> (<em>list</em>) – </li>
<li><strong>datas_list</strong> (<em>list</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">_iter</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">iterator</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.clustering2 –test-groupedzip</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">id_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datas_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupxs</span><span class="p">,</span> <span class="n">grouped_iter</span> <span class="o">=</span> <span class="n">groupedzip</span><span class="p">(</span><span class="n">id_list</span><span class="p">,</span> <span class="n">datas_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_tuples</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">grouped_iter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">groupxs</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">grouped_tuples</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[</span>
<span class="go">    ([&#39;a&#39;, &#39;c&#39;, &#39;e&#39;], [&#39;A&#39;, &#39;C&#39;, &#39;E&#39;]),</span>
<span class="go">    ([&#39;b&#39;, &#39;d&#39;, &#39;f&#39;], [&#39;B&#39;, &#39;D&#39;, &#39;F&#39;]),</span>
<span class="go">    ([&#39;g&#39;], [&#39;G&#39;]),</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.haversine">
<code class="descclassname">vtool.</code><code class="descname">haversine</code><span class="sig-paren">(</span><em>latlon1</em>, <em>latlon2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#haversine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.haversine" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the great circle distance between two points
on the earth (specified in decimal degrees)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>latlon1</strong> (<em>ndarray</em>) – </li>
<li><strong>latlon2</strong> (<em>ndarray</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>en.wikipedia.org/wiki/Haversine_formula
gis.stackexchange.com/questions/81551/matching-gps-tracks
stackoverflow.com/questions/4913349/haversine-distance-gps-points</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance –exec-haversine</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.spatial.distance</span> <span class="k">as</span> <span class="nn">spdist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">functools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gpsarr_track_list_</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="o">-</span><span class="mf">80.21895315</span><span class="p">,</span> <span class="o">-</span><span class="mf">158.81099213</span><span class="p">],</span>
<span class="gp">... </span>             <span class="p">[</span> <span class="o">-</span><span class="mf">12.08338926</span><span class="p">,</span>   <span class="mf">67.50368014</span><span class="p">],</span>
<span class="gp">... </span>             <span class="p">[</span> <span class="o">-</span><span class="mf">11.08338926</span><span class="p">,</span>   <span class="mf">67.50368014</span><span class="p">],</span>
<span class="gp">... </span>             <span class="p">[</span> <span class="o">-</span><span class="mf">11.08338926</span><span class="p">,</span>   <span class="mf">67.50368014</span><span class="p">],]</span>
<span class="gp">... </span>   <span class="p">),</span>
<span class="gp">... </span>   <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>   <span class="mf">9.77816711</span><span class="p">,</span>  <span class="o">-</span><span class="mf">17.27471498</span><span class="p">],</span>
<span class="gp">... </span>             <span class="p">[</span> <span class="o">-</span><span class="mf">51.67678814</span><span class="p">,</span> <span class="o">-</span><span class="mf">158.91065495</span><span class="p">],])</span>
<span class="gp">... </span>   <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latlon1</span> <span class="o">=</span> <span class="n">gpsarr_track_list_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latlon2</span> <span class="o">=</span> <span class="n">gpsarr_track_list_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kilometers</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">haversine</span><span class="p">(</span><span class="n">latlon1</span><span class="p">,</span> <span class="n">latlon2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">haversin_pdist</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">spdist</span><span class="o">.</span><span class="n">pdist</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">vt</span><span class="o">.</span><span class="n">haversine</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_vector_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">haversin_pdist</span><span class="p">,</span> <span class="n">gpsarr_track_list_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_matrix_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">spdist</span><span class="o">.</span><span class="n">squareform</span><span class="p">,</span> <span class="n">dist_vector_list</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.hist_argmaxima">
<code class="descclassname">vtool.</code><code class="descname">hist_argmaxima</code><span class="sig-paren">(</span><em>hist</em>, <em>centers=None</em>, <em>maxima_thresh=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#hist_argmaxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.hist_argmaxima" title="Permalink to this definition">¶</a></dt>
<dd><p>must take positive only values</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram hist_argmaxima</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>    <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_x</span><span class="p">,</span> <span class="n">maxima_y</span><span class="p">,</span> <span class="n">argmaxima</span> <span class="o">=</span> <span class="n">hist_argmaxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">maxima_x</span><span class="p">,</span> <span class="n">maxima_y</span><span class="p">,</span> <span class="n">argmaxima</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.hist_argmaxima2">
<code class="descclassname">vtool.</code><code class="descname">hist_argmaxima2</code><span class="sig-paren">(</span><em>hist</em>, <em>maxima_thresh=0.8</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#hist_argmaxima2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.hist_argmaxima2" title="Permalink to this definition">¶</a></dt>
<dd><p>must take positive only values</p>
<dl class="docutils">
<dt>Setup:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
</pre></div>
</div>
</dd>
<dt>GridSearch:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argmaxima</span> <span class="o">=</span> <span class="n">hist_argmaxima2</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">argmaxima</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.hist_edges_to_centers">
<code class="descclassname">vtool.</code><code class="descname">hist_edges_to_centers</code><span class="sig-paren">(</span><em>edges</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#hist_edges_to_centers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.hist_edges_to_centers" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.79</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">1.57</span><span class="p">,</span> <span class="mf">2.36</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.93</span><span class="p">,</span> <span class="mf">4.71</span><span class="p">,</span> <span class="mf">5.50</span><span class="p">,</span> <span class="mf">6.28</span><span class="p">,</span> <span class="mf">7.07</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">hist_edges_to_centers</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[-0.395  0.395  1.18   1.965  2.75   3.535  4.32   5.105  5.89   6.675]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.hist_isect">
<code class="descclassname">vtool.</code><code class="descname">hist_isect</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#hist_isect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.hist_isect" title="Permalink to this definition">¶</a></dt>
<dd><p>returns histogram intersection distance between two histograms</p>
</dd></dl>

<dl class="function">
<dt id="vtool.homogenous_circle_pts">
<code class="descclassname">vtool.</code><code class="descname">homogenous_circle_pts</code><span class="sig-paren">(</span><em>nSamples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#homogenous_circle_pts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.homogenous_circle_pts" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a list of homogenous circle points</p>
</dd></dl>

<dl class="function">
<dt id="vtool.iceil">
<code class="descclassname">vtool.</code><code class="descname">iceil</code><span class="sig-paren">(</span><em>num</em>, <em>dtype=&lt;class 'numpy.int32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#iceil"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.iceil" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer ceiling. (because numpy doesn’t seem to have it!)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>num</strong> (<em>ndarray</em><em> or </em><em>scalar</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray or scalar</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –test-iceil</dd>
<dt>Setup:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
</pre></div>
</div>
</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">iceil</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">iceil</span><span class="p">(</span><span class="n">num</span><span class="p">),</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([2, 3], dtype=np.int32)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.imread">
<code class="descclassname">vtool.</code><code class="descname">imread</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>grayscale=False</em>, <em>orient=False</em>, <em>flags=None</em>, <em>force_pil=None</em>, <em>delete_if_corrupted=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imread"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.imread" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around the opencv imread function. Handles remote uris.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img_fpath</strong> (<em>str</em>) – file path string</li>
<li><strong>grayscale</strong> (<em>bool</em>) – (default = False)</li>
<li><strong>orient</strong> (<em>bool</em>) – (default = False)</li>
<li><strong>flags</strong> (<em>None</em>) – opencv flags (default = None)</li>
<li><strong>force_pil</strong> (<em>bool</em>) – (default = None)</li>
<li><strong>delete_if_corrupted</strong> (<em>bool</em>) – (default = False)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">imgBGR</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-imread
python -m vtool.image –test-imread:1
python -m vtool.image –test-imread:2</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/core/doc/utility_and_system_functions_and_macros.html#error">http://docs.opencv.org/modules/core/doc/utility_and_system_functions_and_macros.html#error</a>
<a class="reference external" href="http://stackoverflow.com/questions/23572241/cv2-threshold-error-210">http://stackoverflow.com/questions/23572241/cv2-threshold-error-210</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR1</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR2</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR3</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">imgBGR1</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">imgBGR2</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># assert np.all(imgBGR1 == imgBGR3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR3</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_url</span> <span class="o">=</span> <span class="s1">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="n">img_url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR1</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR2</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#imgBGR2 = imread(img_fpath, force_pil=False, flags=cv2.IMREAD_UNCHANGED)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;imgBGR.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">imgBGR1</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;imgBGR2.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">imgBGR2</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">imgBGR1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff_pxls</span> <span class="o">=</span> <span class="n">imgBGR1</span> <span class="o">!=</span> <span class="n">imgBGR2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_diff_pxls</span> <span class="o">=</span> <span class="n">diff_pxls</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;num_diff_pxls=</span><span class="si">%r</span><span class="s1">/</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">num_diff_pxls</span><span class="p">,</span> <span class="n">diff_pxls</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">num_diff_pxls</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diffMag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">imgBGR2</span> <span class="o">/</span> <span class="mf">255.</span> <span class="o">-</span> <span class="n">imgBGR1</span> <span class="o">/</span> <span class="mf">255.</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">diffMag</span> <span class="o">/</span> <span class="n">diffMag</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">(2736, 3648, 3)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://www.sherv.net/cm/emo/funny/2/big-dancing-banana-smiley-emoticon.gif&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_if_corrupted</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grayscale</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="n">grayscale</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.imread_remote_s3">
<code class="descclassname">vtool.</code><code class="descname">imread_remote_s3</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imread_remote_s3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.imread_remote_s3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.imread_remote_url">
<code class="descclassname">vtool.</code><code class="descname">imread_remote_url</code><span class="sig-paren">(</span><em>img_url</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imread_remote_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.imread_remote_url" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.imwrite">
<code class="descclassname">vtool.</code><code class="descname">imwrite</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>imgBGR</em>, <em>fallback=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imwrite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.imwrite" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/highgui/doc/reading_and_writing_images_and_video.html">http://docs.opencv.org/modules/highgui/doc/reading_and_writing_images_and_video.html</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img_fpath</strong> (<em>str</em>) – file path string</li>
<li><strong>imgBGR</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data in opencv format (blue, green, red)</li>
<li><strong>fallback</strong> (<em>bool</em>) – (default = False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –exec-imwrite</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;zebra.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_dpath</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">ensure_app_cache_dir</span><span class="p">(</span><span class="s1">&#39;vtool&#39;</span><span class="p">,</span> <span class="s1">&#39;testwrite&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">unixjoin</span><span class="p">(</span><span class="n">img_dpath</span><span class="p">,</span> <span class="s1">&#39;zebra.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fallback</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imwrite</span><span class="p">(</span><span class="n">img_fpath2</span><span class="p">,</span> <span class="n">imgBGR</span><span class="p">,</span> <span class="n">fallback</span><span class="o">=</span><span class="n">fallback</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">imgBGR2</span> <span class="o">==</span> <span class="n">imgBGR</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.imwrite_fallback">
<code class="descclassname">vtool.</code><code class="descname">imwrite_fallback</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>imgBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imwrite_fallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.imwrite_fallback" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.inbounds">
<code class="descclassname">vtool.</code><code class="descname">inbounds</code><span class="sig-paren">(</span><em>num</em>, <em>low</em>, <em>high</em>, <em>eq=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#inbounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inbounds" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>num</strong> (<em>scalar</em><em> or </em><em>ndarray</em>) – </li>
<li><strong>low</strong> (<em>scalar</em><em> or </em><em>ndarray</em>) – </li>
<li><strong>high</strong> (<em>scalar</em><em> or </em><em>ndarray</em>) – </li>
<li><strong>eq</strong> (<em>bool</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">is_inbounds</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">scalar or ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/other.py inbounds</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>   <span class="p">,</span>  <span class="mf">0.431</span><span class="p">,</span>  <span class="mf">0.279</span><span class="p">],</span>
<span class="gp">... </span>                <span class="p">[</span> <span class="mf">0.204</span><span class="p">,</span>  <span class="mf">0.352</span><span class="p">,</span>  <span class="mf">0.08</span> <span class="p">],</span>
<span class="gp">... </span>                <span class="p">[</span> <span class="mf">0.107</span><span class="p">,</span>  <span class="mf">0.325</span><span class="p">,</span>  <span class="mf">0.179</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">low</span>  <span class="o">=</span> <span class="o">.</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">high</span> <span class="o">=</span> <span class="o">.</span><span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_inbounds</span> <span class="o">=</span> <span class="n">inbounds</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">eq</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">is_inbounds</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.index_partition">
<code class="descclassname">vtool.</code><code class="descname">index_partition</code><span class="sig-paren">(</span><em>item_list</em>, <em>part1_items</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#index_partition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.index_partition" title="Permalink to this definition">¶</a></dt>
<dd><p>returns two lists. The first are the indecies of items in item_list that
are in part1_items. the second is the indices in item_list that are not
in part1_items. items in part1_items that are not in item_list are
ignored</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dist&#39;</span><span class="p">,</span> <span class="s1">&#39;fg&#39;</span><span class="p">,</span> <span class="s1">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fg&#39;</span><span class="p">,</span> <span class="s1">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_indexes</span><span class="p">,</span> <span class="n">part2_indexes</span> <span class="o">=</span> <span class="n">index_partition</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part1_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">part1_indexes</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">part2_indexes</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.index_to_boolmask">
<code class="descclassname">vtool.</code><code class="descname">index_to_boolmask</code><span class="sig-paren">(</span><em>index_list</em>, <em>maxval=None</em>, <em>isflat=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#index_to_boolmask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.index_to_boolmask" title="Permalink to this definition">¶</a></dt>
<dd><p>transforms a list of indicies into a boolean mask</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>index_list</strong> (<em>ndarray</em>) – </li>
<li><strong>maxval</strong> (<em>None</em>) – (default = None)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd>maxval</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mask</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_numpy index_to_boolmask</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_numpy</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxval</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">index_to_boolmask</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="n">maxval</span><span class="p">,</span> <span class="n">isflat</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mask =</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[1 0 0]</span>
<span class="go"> [0 1 0]</span>
<span class="go"> [0 1 0]]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_numpy</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxval</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">index_to_boolmask</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="n">maxval</span><span class="p">,</span> <span class="n">isflat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mask = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">mask = [1 1 0 0 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.infer_vert">
<code class="descclassname">vtool.</code><code class="descname">infer_vert</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>vert</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#infer_vert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.infer_vert" title="Permalink to this definition">¶</a></dt>
<dd><p>which is the better stack dimension</p>
</dd></dl>

<dl class="function">
<dt id="vtool.inspect_pdfs">
<code class="descclassname">vtool.</code><code class="descname">inspect_pdfs</code><span class="sig-paren">(</span><em>tn_support</em>, <em>tp_support</em>, <em>score_domain</em>, <em>p_tp_given_score</em>, <em>p_tn_given_score</em>, <em>p_score_given_tp</em>, <em>p_score_given_tn</em>, <em>p_score</em>, <em>prob_thresh=None</em>, <em>score_thresh=None</em>, <em>with_scores=False</em>, <em>with_roc=False</em>, <em>with_precision_recall=False</em>, <em>with_hist=False</em>, <em>fnum=None</em>, <em>figtitle=None</em>, <em>interactive=None</em>, <em>use_stems=None</em>, <em>part_attrs=None</em>, <em>thresh_kw=None</em>, <em>attr_callback=None</em>, <em>with_prebayes=True</em>, <em>with_postbayes=True</em>, <em>score_range=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#inspect_pdfs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inspect_pdfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows plots of learned thresholds</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –test-ScoreNormalizer –show
python -m vtool.score_normalization –exec-ScoreNormalizer.visualize –show</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.interact_roc_factory">
<code class="descclassname">vtool.</code><code class="descname">interact_roc_factory</code><span class="sig-paren">(</span><em>confusions</em>, <em>target_tpr=None</em>, <em>show_operating_point=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#interact_roc_factory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.interact_roc_factory" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>confusions</strong> (<em>Confusions</em>) – </td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.confusion –exec-interact_roc_factory –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;scores = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">make_csv_table</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="p">[</span><span class="n">confusions</span><span class="o">.</span><span class="n">fpr</span><span class="p">,</span> <span class="n">confusions</span><span class="o">.</span><span class="n">tpr</span><span class="p">,</span> <span class="n">confusions</span><span class="o">.</span><span class="n">thresholds</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="p">[</span><span class="s1">&#39;fpr&#39;</span><span class="p">,</span> <span class="s1">&#39;tpr&#39;</span><span class="p">,</span> <span class="s1">&#39;thresh&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ROCInteraction</span> <span class="o">=</span> <span class="n">interact_roc_factory</span><span class="p">(</span><span class="n">confusions</span><span class="p">,</span> <span class="n">target_tpr</span><span class="o">=.</span><span class="mi">4</span><span class="p">,</span> <span class="n">show_operating_point</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">ROCInteraction</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span><span class="o">.</span><span class="n">show_page</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.intern_warp_single_patch">
<code class="descclassname">vtool.</code><code class="descname">intern_warp_single_patch</code><span class="sig-paren">(</span><em>img</em>, <em>x</em>, <em>y</em>, <em>ori</em>, <em>V</em>, <em>patch_size</em>, <em>flags=2</em>, <em>borderMode=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#intern_warp_single_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.intern_warp_single_patch" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Sympy:</dt>
<dd><p class="first"># <a class="reference external" href="https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA">https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</a>
from vtool.patch import *  # NOQA
import sympy
from sympy.abc import theta
ori = theta
x, y, a, c, d, patch_size = sympy.symbols(‘x y a c d S’)
half_patch_size = patch_size / 2</p>
<dl class="docutils">
<dt>def sympy_rotation_mat3x3(radians):</dt>
<dd><p class="first"># TODO: handle array impouts
<a href="#id179"><span class="problematic" id="id180">sin_</span></a> = sympy.sin(radians)
<a href="#id181"><span class="problematic" id="id182">cos_</span></a> = sympy.cos(radians)
R = np.array(((<a href="#id183"><span class="problematic" id="id184">cos_</span></a>, -<a href="#id185"><span class="problematic" id="id186">sin_</span></a>,  0),</p>
<blockquote>
<div>(<a href="#id187"><span class="problematic" id="id188">sin_</span></a>,  <a href="#id189"><span class="problematic" id="id190">cos_</span></a>,  0),
(   0,     0,  1),))</div></blockquote>
<p class="last">return sympy.Matrix(R)</p>
</dd>
</dl>
<p>kpts = np.array([[x, y, a, c, d, ori]])
kp = ktool.get_invV_mats(kpts, with_trans=True)[0]
invV = sympy.Matrix(kp)
V = invV.inv()
ss = sympy.sqrt(patch_size) * 3.0
T = sympy.Matrix(ltool.translation_mat3x3(-x, -y, None))  # Center the patch
R = sympy_rotation_mat3x3(-ori)  # Rotate the centered unit circle patch
S = sympy.Matrix(ltool.scale_mat3x3(ss, dtype=None))  # scale from unit circle to the patch size
X = sympy.Matrix(ltool.translation_mat3x3(half_patch_size, half_patch_size, None))  # Translate back to patch-image coordinates</p>
<p>sympy.MatMul(X, S, hold=True)</p>
<dl class="docutils">
<dt>def add_matmul_hold_prop(mat):</dt>
<dd><p class="first">#import functools
def matmul_hold(other, hold=True):</p>
<blockquote>
<div>new = sympy.MatMul(mat, other, hold=hold)
add_matmul_hold_prop(new)
return new</div></blockquote>
<p class="last">#matmul_hold = functools.partial(sympy.MatMul, mat, hold=True)
setattr(mat, ‘matmul_hold’, matmul_hold)</p>
</dd>
</dl>
<p>add_matmul_hold_prop(X)
add_matmul_hold_prop(S)
add_matmul_hold_prop(R)
add_matmul_hold_prop(V)
add_matmul_hold_prop(T)</p>
<p>M = X.matmul_hold(S).matmul_hold(R).matmul_hold(V).matmul_hold(T)
#M = X.multiply(S).multiply(R).multiply(V).multiply(T)</p>
<p class="last">V_full = R.multiply(V).multiply(T)
sympy.latex(V_full)
print(sympy.latex(R.multiply(V).multiply(T)))
print(sympy.latex(X))
print(sympy.latex(S))
print(sympy.latex(R))
print(sympy.latex(invV) + ‘^{-1}’)
print(sympy.latex(T))</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.interpolate_between">
<code class="descclassname">vtool.</code><code class="descname">interpolate_between</code><span class="sig-paren">(</span><em>peak_list</em>, <em>nScales</em>, <em>high</em>, <em>low</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_between"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.interpolate_between" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.interpolate_maxima">
<code class="descclassname">vtool.</code><code class="descname">interpolate_maxima</code><span class="sig-paren">(</span><em>scalar_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_maxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.interpolate_maxima" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.interpolate_nans">
<code class="descclassname">vtool.</code><code class="descname">interpolate_nans</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#interpolate_nans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.interpolate_nans" title="Permalink to this definition">¶</a></dt>
<dd><p>replaces nans with interpolated values or 0</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arr</strong> (<em>ndarray</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">new_arr</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –exec-interpolate_nans</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_arr</span> <span class="o">=</span> <span class="n">interpolate_nans</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;new_arr = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">new_arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">new_arr = [ 0.  0.  0.  0.]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_arr</span> <span class="o">=</span> <span class="n">interpolate_nans</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;new_arr = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">new_arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">new_arr = [  1.    1.    2.8   4.6   6.4   8.2  10.    7.5   5. ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.interpolate_peaks">
<code class="descclassname">vtool.</code><code class="descname">interpolate_peaks</code><span class="sig-paren">(</span><em>x_data_list</em>, <em>y_data_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.interpolate_peaks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.interpolate_peaks2">
<code class="descclassname">vtool.</code><code class="descname">interpolate_peaks2</code><span class="sig-paren">(</span><em>x_data_list</em>, <em>y_data_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_peaks2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.interpolate_peaks2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.interpolate_precision_recall">
<code class="descclassname">vtool.</code><code class="descname">interpolate_precision_recall</code><span class="sig-paren">(</span><em>precision</em>, <em>recall</em>, <em>nSamples=11</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#interpolate_precision_recall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.interpolate_precision_recall" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates precision as a function of recall p_{interp}(r)</p>
<p>Reduce wiggles in average precision curve by taking interpolated values
along a uniform sample.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Information_retrieval#Average_precision">http://en.wikipedia.org/wiki/Information_retrieval#Average_precision</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Information_retrieval#Mean_Average_precision">http://en.wikipedia.org/wiki/Information_retrieval#Mean_Average_precision</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.confusion –test-interpolate_precision_recall –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nSamples</span> <span class="o">=</span> <span class="mi">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">precision</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">precision</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recall</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">recall</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recall_domain</span><span class="p">,</span> <span class="n">p_interp</span> <span class="o">=</span> <span class="n">interpolate_precision_recall</span><span class="p">(</span><span class="n">confusions</span><span class="o">.</span><span class="n">precision</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">nSamples</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">p_interp</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_precision_recall_curve</span><span class="p">(</span><span class="n">recall_domain</span><span class="p">,</span> <span class="n">p_interp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([ 1. ,  1. ,  1. ,  1. ,  1. ,  1. ,  1. ,  0.9,  0.9,  0.8,  0.6], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.interpolate_replbounds">
<code class="descclassname">vtool.</code><code class="descname">interpolate_replbounds</code><span class="sig-paren">(</span><em>xdata</em>, <em>ydata</em>, <em>pt</em>, <em>maximize=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#interpolate_replbounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.interpolate_replbounds" title="Permalink to this definition">¶</a></dt>
<dd><p>xdata = np.array([.1, .2, .3, .4, .5])
ydata = np.array([.1, .2, .3, .4, .5])
pt = .35</p>
<dl class="docutils">
<dt>FIXME:</dt>
<dd>if duplicate xdata is given bad things happen.</dd>
<dt>BUG:</dt>
<dd>in scipy.interpolate.interp1d
If there is a duplicate xdata, then assume_sorted=False will
sort ydata by xdata, but xdata should retain its initial ordering
in places of ambuguity. Currently it does not.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xdata</strong> (<em>ndarray</em>) – </li>
<li><strong>ydata</strong> (<em>ndarray</em>) – </li>
<li><strong>pt</strong> (<em>ndarray</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">interp_vals</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.confusion –exec-interpolate_replbounds</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tpr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#xdata = self.fpr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#ydata = self.thresholds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt = 0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="n">interpolate_replbounds</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">maximize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;thresh = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">thresh</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="n">interpolate_replbounds</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">maximize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;thresh = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">thresh</span><span class="p">,))</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.7</span><span class="p">,</span>  <span class="mf">0.8</span><span class="p">,</span>  <span class="mf">0.8</span><span class="p">,</span>  <span class="mf">0.9</span><span class="p">,</span>  <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">34</span><span class="p">,</span>    <span class="mi">26</span><span class="p">,</span>   <span class="mi">23</span><span class="p">,</span>   <span class="mi">22</span><span class="p">,</span>   <span class="mi">19</span><span class="p">,</span>  <span class="mi">17</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">85</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interp_vals</span> <span class="o">=</span> <span class="n">interpolate_replbounds</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;interp_vals = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">interp_vals</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">interp_vals = [ 22.5  17.   34. ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.interpolate_submaxima">
<code class="descclassname">vtool.</code><code class="descname">interpolate_submaxima</code><span class="sig-paren">(</span><em>argmaxima</em>, <em>hist_</em>, <em>centers=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#interpolate_submaxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.interpolate_submaxima" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>argmaxima</strong> (<em>ndarray</em>) – indicies into ydata / centers that are argmaxima</li>
<li><strong>hist</strong> (<em>ndarray</em>) – ydata, histogram frequencies</li>
<li><strong>centers</strong> (<em>ndarray</em>) – xdata, histogram labels</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>FIXME:</dt>
<dd>what happens when argmaxima[i] == len(<a href="#id191"><span class="problematic" id="id192">hist_</span></a>)</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram –test-interpolate_submaxima –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argmaxima</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>    <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span> <span class="o">=</span> <span class="n">interpolate_submaxima</span><span class="p">(</span><span class="n">argmaxima</span><span class="p">,</span> <span class="n">hist_</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">interpolate_submaxima</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                           <span class="n">key_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x123&#39;</span><span class="p">,</span> <span class="s1">&#39;y123&#39;</span><span class="p">,</span> <span class="s1">&#39;coeff_list&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x123</span><span class="p">,</span> <span class="n">y123</span><span class="p">,</span> <span class="n">coeff_list</span> <span class="o">=</span> <span class="n">locals_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ensure_fnum</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">hist_</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">centers</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">hist_</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;argmaxima&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;interp maxima&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Extract parabola points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x123</span><span class="p">,</span> <span class="n">y123</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;maxima neighbors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xpoints</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">)</span> <span class="ow">in</span> <span class="n">x123</span><span class="o">.</span><span class="n">T</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ypoints</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">x_pts</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_pts</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">coeff_list</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw Submax Parabola</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x_pts</span><span class="p">,</span> <span class="n">y_pts</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">ypoints</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_pts</span><span class="p">,</span> <span class="n">y_pts</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([ 0.15,  3.03,  5.11], dtype=np.float64),</span>
<span class="go">np.array([  9.2 ,  37.19,   0.  ], dtype=np.float64),</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argmaxima</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.interpolated_histogram">
<code class="descclassname">vtool.</code><code class="descname">interpolated_histogram</code><span class="sig-paren">(</span><em>data</em>, <em>weights</em>, <em>range_</em>, <em>bins</em>, <em>interpolation_wrap=True</em>, <em>_debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#interpolated_histogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.interpolated_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Follows np.histogram, but does interpolation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<em>ndarray</em>) – </li>
<li><strong>weights</strong> (<em>ndarray</em>) – </li>
<li><strong>range</strong> (<em>tuple</em>) – range from 0 to 1</li>
<li><strong>bins</strong> (<em>int</em>) – </li>
<li><strong>interpolation_wrap</strong> (<em>bool</em>) – (default = True)</li>
<li><strong>_debug</strong> (<em>bool</em>) – (default = False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram –test-interpolated_histogram</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">3.5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">range_</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interpolation_wrap</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">interpolated_histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">range_</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">interpolation_wrap</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">hist</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">1E-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">hist</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">edges</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_histinfo_str</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">3.5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">range_</span> <span class="o">=</span> <span class="p">(</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interpolation_wrap</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">interpolated_histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">range_</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">interpolation_wrap</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">hist</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">1E-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">hist</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">edges</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_histinfo_str</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.intersect1d_reduce">
<code class="descclassname">vtool.</code><code class="descname">intersect1d_reduce</code><span class="sig-paren">(</span><em>arr_list</em>, <em>assume_unique=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect1d_reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.intersect1d_reduce" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.intersect2d_flags">
<code class="descclassname">vtool.</code><code class="descname">intersect2d_flags</code><span class="sig-paren">(</span><em>A</em>, <em>B</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.intersect2d_flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks intersection of rows of A against rows of B</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>A</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </li>
<li><strong>B</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(flag_list1, flag_list2)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-intersect2d_flags</dd>
<dt>SeeAlso:</dt>
<dd>np.in1d - the one dimensional version</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">609</span><span class="p">,</span> <span class="mi">307</span><span class="p">],</span> <span class="p">[</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">344</span><span class="p">],</span> <span class="p">[</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">690</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">422</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">422</span><span class="p">,</span>  <span class="mi">968</span><span class="p">],</span> <span class="p">[</span> <span class="mi">481</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">1132</span><span class="p">],</span> <span class="p">[</span> <span class="mi">759</span><span class="p">,</span>  <span class="mi">159</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">flag_list1</span><span class="p">,</span> <span class="n">flag_list2</span><span class="p">)</span> <span class="o">=</span> <span class="n">intersect2d_flags</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">flag_list1</span><span class="p">,</span> <span class="n">flag_list2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.intersect2d_indices">
<code class="descclassname">vtool.</code><code class="descname">intersect2d_indices</code><span class="sig-paren">(</span><em>A</em>, <em>B</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.intersect2d_indices" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>A</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </li>
<li><strong>B</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(ax_list, bx_list)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-intersect2d_indices</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">158</span><span class="p">,</span>  <span class="mi">171</span><span class="p">],</span> <span class="p">[</span> <span class="mi">542</span><span class="p">,</span>  <span class="mi">297</span><span class="p">],</span> <span class="p">[</span> <span class="mi">955</span><span class="p">,</span> <span class="mi">1113</span><span class="p">],</span> <span class="p">[</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1254</span><span class="p">],</span> <span class="p">[</span> <span class="mi">976</span><span class="p">,</span> <span class="mi">1255</span><span class="p">],</span> <span class="p">[</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">1265</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">117</span><span class="p">,</span>  <span class="mi">211</span><span class="p">],</span> <span class="p">[</span> <span class="mi">158</span><span class="p">,</span>  <span class="mi">171</span><span class="p">],</span> <span class="p">[</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1254</span><span class="p">],</span> <span class="p">[</span> <span class="mi">309</span><span class="p">,</span>  <span class="mi">328</span><span class="p">],</span> <span class="p">[</span> <span class="mi">447</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">750</span><span class="p">,</span>  <span class="mi">357</span><span class="p">],</span> <span class="p">[</span> <span class="mi">976</span><span class="p">,</span> <span class="mi">1255</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">ax_list</span><span class="p">,</span> <span class="n">bx_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">intersect2d_indices</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">ax_list</span><span class="p">,</span> <span class="n">bx_list</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.intersect2d_numpy">
<code class="descclassname">vtool.</code><code class="descname">intersect2d_numpy</code><span class="sig-paren">(</span><em>A</em>, <em>B</em>, <em>assume_unique=False</em>, <em>return_indices=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_numpy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.intersect2d_numpy" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>References::</dt>
<dd><a class="reference external" href="http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays/8317155#8317155">http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays/8317155#8317155</a></dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>A</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </li>
<li><strong>B</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </li>
<li><strong>assume_unique</strong> (<em>bool</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">C</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[ndims=2]</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-intersect2d_numpy</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">78</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span> <span class="mi">283</span><span class="p">,</span> <span class="mi">396</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">403</span><span class="p">,</span> <span class="mi">412</span><span class="p">,</span> <span class="mi">535</span><span class="p">,</span> <span class="mi">552</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">152</span><span class="p">,</span>  <span class="mi">98</span><span class="p">,</span>  <span class="mi">32</span><span class="p">,</span> <span class="mi">260</span><span class="p">,</span> <span class="mi">387</span><span class="p">,</span> <span class="mi">285</span><span class="p">,</span>  <span class="mi">22</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span>  <span class="mi">55</span><span class="p">,</span> <span class="mi">261</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">403</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span> <span class="mi">412</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span> <span class="mi">815</span><span class="p">,</span> <span class="mi">463</span><span class="p">,</span> <span class="mi">613</span><span class="p">,</span> <span class="mi">552</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span> <span class="mi">22</span><span class="p">,</span>  <span class="mi">32</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">199</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">254</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assume_unique</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span> <span class="o">=</span> <span class="n">intersect2d_numpy</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">C</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([[ 85, 403, 412],</span>
<span class="go">       [ 32,  22, 103]]), array([2, 6, 7]), array([0, 1, 2]))</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span> <span class="o">=</span> <span class="n">intersect2d_numpy</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">C</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([[1, 2, 3]]), array([0]), array([0]))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.intersect2d_structured_numpy">
<code class="descclassname">vtool.</code><code class="descname">intersect2d_structured_numpy</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em>, <em>assume_unique=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_structured_numpy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.intersect2d_structured_numpy" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr1</strong> – unstructured 2d array</li>
<li><strong>arr2</strong> – unstructured 2d array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><a href="#id193"><span class="problematic" id="id194">A_</span></a>, <a href="#id195"><span class="problematic" id="id196">B_</span></a>, <a href="#id197"><span class="problematic" id="id198">C_</span></a> - structured versions of arr1, and arr2, and their structured intersection</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array">http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array</a>
<a class="reference external" href="http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays">http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.inv_ltri">
<code class="descclassname">vtool.</code><code class="descname">inv_ltri</code><span class="sig-paren">(</span><em>ltri</em>, <em>det</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#inv_ltri"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inv_ltri" title="Permalink to this definition">¶</a></dt>
<dd><p>Lower triangular inverse</p>
</dd></dl>

<dl class="function">
<dt id="vtool.invert_apply_grouping">
<code class="descclassname">vtool.</code><code class="descname">invert_apply_grouping</code><span class="sig-paren">(</span><em>grouped_items</em>, <em>groupxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#invert_apply_grouping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.invert_apply_grouping" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grouped_items</strong> (<em>list</em>) – of lists</li>
<li><strong>groupxs</strong> (<em>list</em>) – of lists</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">items</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.clustering2 –test-invert_apply_grouping</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_items</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span> <span class="o">=</span> <span class="n">invert_apply_grouping</span><span class="p">(</span><span class="n">grouped_items</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">items</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1, 8, 5, 5, 8, 6, 7, 5, 3, 0, 9]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_items</span><span class="p">,</span> <span class="n">groupxs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">invert_apply_grouping</span><span class="p">(</span><span class="n">grouped_items</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.invert_apply_grouping2">
<code class="descclassname">vtool.</code><code class="descname">invert_apply_grouping2</code><span class="sig-paren">(</span><em>grouped_items</em>, <em>groupxs</em>, <em>dtype=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#invert_apply_grouping2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.invert_apply_grouping2" title="Permalink to this definition">¶</a></dt>
<dd><p>use only when ungrouping will be complete</p>
</dd></dl>

<dl class="function">
<dt id="vtool.invert_apply_grouping3">
<code class="descclassname">vtool.</code><code class="descname">invert_apply_grouping3</code><span class="sig-paren">(</span><em>grouped_items</em>, <em>groupxs</em>, <em>maxval</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#invert_apply_grouping3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.invert_apply_grouping3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.invert_invV_mats">
<code class="descclassname">vtool.</code><code class="descname">invert_invV_mats</code><span class="sig-paren">(</span><em>invV_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#invert_invV_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.invert_invV_mats" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>invV_mats</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=3</em><em>]</em>) – keypoint shapes (possibly translation)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">V_mats</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray[float32_t, ndim=3]</td>
</tr>
</tbody>
</table>
<p># Ignore:
#     &gt;&gt;&gt; from vtool.keypoint import *
#     &gt;&gt;&gt; invV_mats  = np.array([[[ 18.00372824,   1.86434161,  32.        ],
#     &gt;&gt;&gt;                         [ -0.61356842,  16.02202028,  27.2       ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]],
#     &gt;&gt;&gt; #
#     &gt;&gt;&gt;                         [[ 17.41989015,   2.51145917,  61.        ],
#     &gt;&gt;&gt;                         [ -2.94649591,  24.02540959,  22.9       ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]],
#     &gt;&gt;&gt; #
#     &gt;&gt;&gt;                         [[ 20.38098025,   0.88070646,  93.1       ],
#     &gt;&gt;&gt;                         [ -0.93778675,  24.78261982,  23.6       ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]],
#     &gt;&gt;&gt; #
#     &gt;&gt;&gt;                         [[ 16.25114793,  -5.93213207, 120.        ],
#     &gt;&gt;&gt;                         [  4.71295477,  21.80597527,  29.5       ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]],
#     &gt;&gt;&gt; #
#     &gt;&gt;&gt;                         [[ 19.60863253, -11.43641248, 147.        ],
#     &gt;&gt;&gt;                         [  8.45128003,  10.69925072,  42.        ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]]])
#     &gt;&gt;&gt; ut.hash_data(invV_mats)
#     hcnoknyxgeecfyfrygblbvdeezmiulws
#     &gt;&gt;&gt; V_mats = npl.inv(invV_mats)
#     &gt;&gt;&gt; ut.hash_data(V_mats)
#     yooneahjgcifojzpovddeyhtkkyypldd</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_mats</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_invVR_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V_mats</span> <span class="o">=</span> <span class="n">invert_invV_mats</span><span class="p">(</span><span class="n">invV_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">matrix_multiply</span><span class="p">(</span><span class="n">invV_mats</span><span class="p">,</span> <span class="n">V_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This should give us identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.inverted_sift_patch">
<code class="descclassname">vtool.</code><code class="descname">inverted_sift_patch</code><span class="sig-paren">(</span><em>sift</em>, <em>dim=32</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#inverted_sift_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.inverted_sift_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Idea for inverted sift visualization</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch test_sift_viz –show –name=star
python -m vtool.patch test_sift_viz –show –name=star2
python -m vtool.patch test_sift_viz –show –name=cross
python -m vtool.patch test_sift_viz –show –name=stripe</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_test_patch</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--name&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;star&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sift</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">extract_feature_from_patch</span><span class="p">(</span><span class="n">patch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">siftimg</span> <span class="o">=</span> <span class="n">test_sift_viz</span><span class="p">(</span><span class="n">sift</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Need to do some image blending</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">mpl_sift</span><span class="o">.</span><span class="n">draw_sift_on_patch</span><span class="p">(</span><span class="n">siftimg</span><span class="p">,</span> <span class="n">sift</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch2</span> <span class="o">=</span> <span class="n">patch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_uint8</span><span class="p">(</span><span class="n">patch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_square</span><span class="p">(</span><span class="n">patch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">mpl_sift</span><span class="o">.</span><span class="n">draw_sift_on_patch</span><span class="p">(</span><span class="n">patch2</span><span class="p">,</span> <span class="n">sift</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.invertible_stack">
<code class="descclassname">vtool.</code><code class="descname">invertible_stack</code><span class="sig-paren">(</span><em>vecs_list</em>, <em>label_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#invertible_stack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.invertible_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Stacks descriptors into a flat structure and returns inverse mapping from
flat database descriptor indexes (dx) to annotation ids (label) and feature
indexes (fx). Feature indexes are w.r.t. annotation indexes.</p>
<dl class="docutils">
<dt>Output:</dt>
<dd>idx2_desc - flat descriptor stack
idx2_label  - inverted index into annotations
idx2_fx   - inverted index into features</dd>
</dl>
<p># Example with 2D Descriptors</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DESC_TYPE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label_list</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_vec</span><span class="p">,</span> <span class="n">idx2_label</span><span class="p">,</span> <span class="n">idx2_fx</span> <span class="o">=</span> <span class="n">invertible_stack</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">,</span> <span class="n">label_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">idx2_vec</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
<span class="go">array([[ 0,  0,  5,  2,  1,  5,  2,  1,  3, 42,  2],</span>
<span class="go">       [ 0,  1,  3, 30,  1,  3, 30,  1,  3, 42,  6]], dtype=uint8)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">idx2_label</span><span class="p">))</span>
<span class="go">array([1, 1, 2, 2, 2, 4, 4, 4, 5, 5, 5])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">idx2_fx</span><span class="p">))</span>
<span class="go">array([0, 1, 0, 1, 2, 0, 1, 2, 0, 1, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.invsum">
<code class="descclassname">vtool.</code><code class="descname">invsum</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#invsum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.invsum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.iround">
<code class="descclassname">vtool.</code><code class="descname">iround</code><span class="sig-paren">(</span><em>num</em>, <em>dtype=&lt;class 'numpy.int32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#iround"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.iround" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer round. (because numpy doesn’t seem to have it!)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.iter_reduce_ufunc">
<code class="descclassname">vtool.</code><code class="descname">iter_reduce_ufunc</code><span class="sig-paren">(</span><em>ufunc</em>, <em>arr_iter</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#iter_reduce_ufunc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.iter_reduce_ufunc" title="Permalink to this definition">¶</a></dt>
<dd><p>constant memory iteration and reduction</p>
<p>applys ufunc from left to right over the input arrays</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">memory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen_memory</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">arr_gen</span><span class="p">(</span><span class="n">arr_list</span><span class="p">,</span> <span class="n">gen_memory</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arr_list</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">gen_memory</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">arr</span>
<span class="gp">... </span>        <span class="k">yield</span> <span class="n">gen_memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gen_memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gen_memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ufunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res1</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">arr_list</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res2</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">arr_list</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res3</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">arr_gen</span><span class="p">(</span><span class="n">arr_list</span><span class="p">,</span> <span class="n">gen_memory</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res1       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res1</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res2       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res2</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res3       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;memory     = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gen_memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gen_memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">res1</span> <span class="o">==</span> <span class="n">res2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">res2</span> <span class="o">==</span> <span class="n">res3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">vtool.</code><code class="descname">iter_reduce_ufunc</code><span class="sig-paren">(</span><em>ufunc</em>, <em>arr_iter</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#iter_reduce_ufunc"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>constant memory iteration and reduction</p>
<p>applys ufunc from left to right over the input arrays</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">memory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen_memory</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">arr_gen</span><span class="p">(</span><span class="n">arr_list</span><span class="p">,</span> <span class="n">gen_memory</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arr_list</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">gen_memory</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">arr</span>
<span class="gp">... </span>        <span class="k">yield</span> <span class="n">gen_memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gen_memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gen_memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ufunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res1</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">arr_list</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res2</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">arr_list</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res3</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">arr_gen</span><span class="p">(</span><span class="n">arr_list</span><span class="p">,</span> <span class="n">gen_memory</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res1       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res1</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res2       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res2</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res3       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;memory     = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gen_memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gen_memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">res1</span> <span class="o">==</span> <span class="n">res2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">res2</span> <span class="o">==</span> <span class="n">res3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.jagged_group">
<code class="descclassname">vtool.</code><code class="descname">jagged_group</code><span class="sig-paren">(</span><em>groupids_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#jagged_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.jagged_group" title="Permalink to this definition">¶</a></dt>
<dd><p>flattens and returns group indexes into the flattened list</p>
</dd></dl>

<dl class="function">
<dt id="vtool.kp_cpp_infostr">
<code class="descclassname">vtool.</code><code class="descname">kp_cpp_infostr</code><span class="sig-paren">(</span><em>kp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#kp_cpp_infostr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.kp_cpp_infostr" title="Permalink to this definition">¶</a></dt>
<dd><p>mirrors c++ debug code</p>
</dd></dl>

<dl class="function">
<dt id="vtool.kpts_docrepr">
<code class="descclassname">vtool.</code><code class="descname">kpts_docrepr</code><span class="sig-paren">(</span><em>arr</em>, <em>name='arr'</em>, <em>indent=True</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#kpts_docrepr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.kpts_docrepr" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_docrepr</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.kpts_matrices">
<code class="descclassname">vtool.</code><code class="descname">kpts_matrices</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#kpts_matrices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.kpts_matrices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.kpts_repr">
<code class="descclassname">vtool.</code><code class="descname">kpts_repr</code><span class="sig-paren">(</span><em>arr</em>, <em>precision=2</em>, <em>suppress_small=True</em>, <em>linebreak=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#kpts_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.kpts_repr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.learn_score_normalization">
<code class="descclassname">vtool.</code><code class="descname">learn_score_normalization</code><span class="sig-paren">(</span><em>tp_support</em>, <em>tn_support</em>, <em>gridsize=1024</em>, <em>adjust=8</em>, <em>return_all=False</em>, <em>monotonize=True</em>, <em>clip_factor=2.6180339887499997</em>, <em>verbose=False</em>, <em>reverse=False</em>, <em>p_tp_method='eq'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#learn_score_normalization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.learn_score_normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes collected data and applys parzen window density estimation and bayes rule.</p>
<p>#True positive scores must be larger than true negative scores.
FIXME: might be an issue with pdfs summing to 1 here.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tp_support</strong> (<em>ndarray</em>) – </li>
<li><strong>tn_support</strong> (<em>ndarray</em>) – </li>
<li><strong>gridsize</strong> (<em>int</em>) – default 512</li>
<li><strong>adjust</strong> (<em>int</em>) – default 8</li>
<li><strong>return_all</strong> (<em>bool</em>) – default False</li>
<li><strong>monotonize</strong> (<em>bool</em>) – default True</li>
<li><strong>clip_factor</strong> (<em>float</em>) – default phi ** 2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(score_domain, p_tp_given_score, p_tn_given_score, p_score_given_tp, p_score_given_tn, p_score)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –test-learn_score_normalization</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsize</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adjust</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_all</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">monotonize</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clip_factor</span> <span class="o">=</span> <span class="mf">2.6180339887499997</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">score_domain</span><span class="p">,</span> <span class="n">p_tp_given_score</span><span class="p">)</span> <span class="o">=</span> <span class="n">learn_score_normalization</span><span class="p">(</span><span class="n">tp_support</span><span class="p">,</span> <span class="n">tn_support</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">p_tp_given_score</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">0.99</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.linear_interpolation">
<code class="descclassname">vtool.</code><code class="descname">linear_interpolation</code><span class="sig-paren">(</span><em>arr</em>, <em>subindices</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#linear_interpolation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linear_interpolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Does linear interpolation to lookup subindex values</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subindices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subvalues</span> <span class="o">=</span> <span class="n">linear_interpolation</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">subindices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">subindices</span><span class="p">,</span> <span class="n">subvalues</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="mf">2.3</span><span class="p">,</span> <span class="n">linear_interpolation</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.list_compress_">
<code class="descclassname">vtool.</code><code class="descname">list_compress_</code><span class="sig-paren">(</span><em>list_</em>, <em>flag_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#list_compress_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.list_compress_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.list_take_">
<code class="descclassname">vtool.</code><code class="descname">list_take_</code><span class="sig-paren">(</span><em>list_</em>, <em>index_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#list_take_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.list_take_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.logistic_01">
<code class="descclassname">vtool.</code><code class="descname">logistic_01</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#logistic_01"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.logistic_01" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> – </td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.util_math –exec-logistic_01 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">logistic_01</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.logit">
<code class="descclassname">vtool.</code><code class="descname">logit</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#logit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.logit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.make_channels_comparable">
<code class="descclassname">vtool.</code><code class="descname">make_channels_comparable</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#make_channels_comparable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.make_channels_comparable" title="Permalink to this definition">¶</a></dt>
<dd><p>Broadcasts image arrays so they can have elementwise operations applied</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image make_channels_comparable</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_basis</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">wh_basis</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">shape_basis</span> <span class="o">=</span> <span class="p">[(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Test all permutations of shap inputs</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">shape1</span><span class="p">,</span> <span class="n">shape2</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">shape_basis</span><span class="p">,</span> <span class="n">shape_basis</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*    input shapes: </span><span class="si">%r</span><span class="s1">, </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">shape1</span><span class="p">,</span> <span class="n">shape2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">img1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">img2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">make_channels_comparable</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;... output shapes: </span><span class="si">%r</span><span class="s1">, </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">img2</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">elem</span> <span class="o">=</span> <span class="p">(</span><span class="n">img1</span> <span class="o">+</span> <span class="n">img2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;... elem(+) shape: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">assert</span> <span class="n">elem</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">img1</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="s1">&#39;outputs should have same size&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">assert</span> <span class="n">img1</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">img2</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="s1">&#39;new imgs should have same size&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.make_dummy_fm">
<code class="descclassname">vtool.</code><code class="descname">make_dummy_fm</code><span class="sig-paren">(</span><em>nKpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#make_dummy_fm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.make_dummy_fm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.make_exif_dict_human_readable">
<code class="descclassname">vtool.</code><code class="descname">make_exif_dict_human_readable</code><span class="sig-paren">(</span><em>exif_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#make_exif_dict_human_readable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.make_exif_dict_human_readable" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.make_test_image_keypoints">
<code class="descclassname">vtool.</code><code class="descname">make_test_image_keypoints</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>scale=1.0</em>, <em>skew=0</em>, <em>theta=0</em>, <em>shift=(0</em>, <em>0)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#make_test_image_keypoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.make_test_image_keypoints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.make_video">
<code class="descclassname">vtool.</code><code class="descname">make_video</code><span class="sig-paren">(</span><em>images</em>, <em>outvid=None</em>, <em>fps=5</em>, <em>size=None</em>, <em>is_color=True</em>, <em>format='XVID'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#make_video"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.make_video" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a video from a list of images.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://www.xavierdupre.fr/blog/2016-03-30_nojs.html">http://www.xavierdupre.fr/blog/2016-03-30_nojs.html</a>
<a class="reference external" href="http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_gui/py_video_display/py_video_display.html">http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_gui/py_video_display/py_video_display.html</a></p>
<p>&#64;param      outvid      output video
&#64;param      images      list of images to use in the video
&#64;param      fps         frame per second
&#64;param      size        size of each frame
&#64;param      is_color    color
&#64;param      format      see <a class="reference external" href="http://www.fourcc.org/codecs.php">http://www.fourcc.org/codecs.php</a></p>
<p>The function relies on <a class="reference external" href="http://opencv-python-tutroals.readthedocs.org/en/latest/">http://opencv-python-tutroals.readthedocs.org/en/latest/</a>.
By default, the video will have the size of the first image.
It will resize every image to this size before adding them to the video.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.make_video2">
<code class="descclassname">vtool.</code><code class="descname">make_video2</code><span class="sig-paren">(</span><em>images</em>, <em>outdir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#make_video2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.make_video2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.make_white_transparent">
<code class="descclassname">vtool.</code><code class="descname">make_white_transparent</code><span class="sig-paren">(</span><em>imgBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#make_white_transparent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.make_white_transparent" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>imgBGR</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data (blue, green, red)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">imgBGRA</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image make_white_transparent –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fpath&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGRA</span> <span class="o">=</span> <span class="n">make_white_transparent</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;imgBGRA = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">imgBGRA</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.maxima_neighbors">
<code class="descclassname">vtool.</code><code class="descname">maxima_neighbors</code><span class="sig-paren">(</span><em>argmaxima</em>, <em>hist_</em>, <em>centers=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#maxima_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.maxima_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.maximum_parabola_point">
<code class="descclassname">vtool.</code><code class="descname">maximum_parabola_point</code><span class="sig-paren">(</span><em>A</em>, <em>B</em>, <em>C</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#maximum_parabola_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.maximum_parabola_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum x point is where the derivative is 0</p>
</dd></dl>

<dl class="function">
<dt id="vtool.median_abs_dev">
<code class="descclassname">vtool.</code><code class="descname">median_abs_dev</code><span class="sig-paren">(</span><em>arr_list</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#median_abs_dev"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.median_abs_dev" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Median_absolute_deviation">https://en.wikipedia.org/wiki/Median_absolute_deviation</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.montage">
<code class="descclassname">vtool.</code><code class="descname">montage</code><span class="sig-paren">(</span><em>img_list</em>, <em>dsize</em>, <em>rng=&lt;module 'numpy.random' from '/Users/jason.parham/virtualenv/wildme3/lib/python3.6/site-packages/numpy/random/__init__.py'&gt;</em>, <em>method='random'</em>, <em>return_debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#montage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.montage" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a montage / collage from a set of images</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –exec-montage:0 –show
python -m vtool.image –exec-montage:1</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list0</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list1</span> <span class="o">=</span> <span class="p">[</span><span class="n">resize_to_maxdims</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">img_list0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">flatten</span><span class="p">([</span><span class="n">img_list1</span><span class="p">]</span> <span class="o">*</span> <span class="n">num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="mi">700</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;unused&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#method = &#39;random&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dst</span><span class="p">,</span> <span class="n">debug_info</span> <span class="o">=</span> <span class="n">montage</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">dsize</span><span class="p">,</span> <span class="n">rng</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="n">return_debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">place_img</span> <span class="o">=</span> <span class="n">debug_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;place_img_&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">place_img</span> <span class="o">/</span> <span class="n">place_img</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="k">import</span> <span class="n">join</span><span class="p">,</span> <span class="n">expanduser</span><span class="p">,</span> <span class="n">abspath</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s1">&#39;GZC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gid_list0</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_gids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6000</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">try</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">gid</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">gid_list0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">image</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_images</span><span class="p">(</span><span class="n">gid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">image</span> <span class="o">=</span> <span class="n">resize_to_maxdims</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">img_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">19200</span><span class="p">,</span> <span class="mi">10800</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dst</span> <span class="o">=</span> <span class="n">montage</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">dsize</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filepath</span> <span class="o">=</span> <span class="n">abspath</span><span class="p">(</span><span class="n">expanduser</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">,</span> <span class="s1">&#39;Desktop&#39;</span><span class="p">,</span> <span class="s1">&#39;montage.jpg&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Writing to: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imwrite</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.mult_lists">
<code class="descclassname">vtool.</code><code class="descname">mult_lists</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#mult_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.mult_lists" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.multiaxis_reduce">
<code class="descclassname">vtool.</code><code class="descname">multiaxis_reduce</code><span class="sig-paren">(</span><em>ufunc</em>, <em>arr</em>, <em>startaxis=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#multiaxis_reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.multiaxis_reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>used to get max/min over all axes after &lt;startaxis&gt;</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.numpy_utils –test-multiaxis_reduce</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ufunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">startaxis</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_</span> <span class="o">=</span> <span class="n">multiaxis_reduce</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">startaxis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">out_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[182 245 236 249]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.multigroup_lookup">
<code class="descclassname">vtool.</code><code class="descname">multigroup_lookup</code><span class="sig-paren">(</span><em>lazydict</em>, <em>keys_list</em>, <em>subkeys_list</em>, <em>custom_func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#multigroup_lookup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.multigroup_lookup" title="Permalink to this definition">¶</a></dt>
<dd><p>Efficiently calls custom_func for each item in zip(keys_list, subkeys_list)
by grouping subkeys to minimize the number of calls to custom_func.</p>
<p>We are given multiple lists of keys, and subvals.
The goal is to group the subvals by keys and apply the subval lookups
(a call to a function) to the key only once and at the same time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lazydict</strong> (<em>dict of utool.LazyDict</em>) – </li>
<li><strong>keys_list</strong> (<em>list</em>) – </li>
<li><strong>subkeys_list</strong> (<em>list</em>) – </li>
<li><strong>custom_func</strong> (<em>func</em>) – must have signature custom_func(lazydict, key, subkeys)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>vt.multigroup_lookup_naive - unoptomized version, but simple to read</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpath_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">util_grabdata</span><span class="o">.</span><span class="n">get_valid_test_imgkeys</span><span class="p">()]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lazydict</span> <span class="o">=</span> <span class="p">{</span><span class="n">count</span><span class="p">:</span> <span class="n">vt</span><span class="o">.</span><span class="n">testdata_annot_metadata</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span> <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">fpath</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fpath_list</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aids_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fms</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">keys_list</span> <span class="o">=</span> <span class="n">aids_list</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subkeys_list</span> <span class="o">=</span> <span class="n">fms</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">custom_func</span><span class="p">(</span><span class="n">lazydict</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">subkeys</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">annot</span> <span class="o">=</span> <span class="n">lazydict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">kpts</span> <span class="o">=</span> <span class="n">annot</span><span class="p">[</span><span class="s1">&#39;kpts&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">rchip</span> <span class="o">=</span> <span class="n">annot</span><span class="p">[</span><span class="s1">&#39;rchip&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">kpts_m</span> <span class="o">=</span> <span class="n">kpts</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">subkeys</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">warped_patches</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_warped_patches</span><span class="p">(</span><span class="n">rchip</span><span class="p">,</span> <span class="n">kpts_m</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">warped_patches</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_lists1</span> <span class="o">=</span> <span class="n">multigroup_lookup</span><span class="p">(</span><span class="n">lazydict</span><span class="p">,</span> <span class="n">keys_list</span><span class="p">,</span> <span class="n">subkeys_list</span><span class="p">,</span> <span class="n">custom_func</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_lists2</span> <span class="o">=</span> <span class="n">multigroup_lookup_naive</span><span class="p">(</span><span class="n">lazydict</span><span class="p">,</span> <span class="n">keys_list</span><span class="p">,</span> <span class="n">subkeys_list</span><span class="p">,</span> <span class="n">custom_func</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">sver_c_wrapper</span><span class="o">.</span><span class="n">asserteq</span><span class="p">(</span><span class="n">data_lists1</span><span class="p">,</span> <span class="n">data_lists2</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">keys_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subkeys_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.multigroup_lookup_naive">
<code class="descclassname">vtool.</code><code class="descname">multigroup_lookup_naive</code><span class="sig-paren">(</span><em>lazydict</em>, <em>keys_list</em>, <em>subkeys_list</em>, <em>custom_func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#multigroup_lookup_naive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.multigroup_lookup_naive" title="Permalink to this definition">¶</a></dt>
<dd><p>Slow version of multigroup_lookup. Makes a call to custom_func for each
item in zip(keys_list, subkeys_list).</p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>vt.multigroup_lookup</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.nan_to_num">
<code class="descclassname">vtool.</code><code class="descname">nan_to_num</code><span class="sig-paren">(</span><em>arr</em>, <em>num</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#nan_to_num"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nan_to_num" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.nearest_point">
<code class="descclassname">vtool.</code><code class="descname">nearest_point</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>pts</em>, <em>mode='random'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#nearest_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_point" title="Permalink to this definition">¶</a></dt>
<dd><p>finds the nearest point(s) in pts to (x, y)</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">vtool.</code><code class="descname">nearest_point</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>pts</em>, <em>mode='random'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#nearest_point"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>finds the nearest point(s) in pts to (x, y)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.non_decreasing">
<code class="descclassname">vtool.</code><code class="descname">non_decreasing</code><span class="sig-paren">(</span><em>L</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#non_decreasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.non_decreasing" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.non_increasing">
<code class="descclassname">vtool.</code><code class="descname">non_increasing</code><span class="sig-paren">(</span><em>L</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#non_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.non_increasing" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.nonunique_row_flags">
<code class="descclassname">vtool.</code><code class="descname">nonunique_row_flags</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#nonunique_row_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nonunique_row_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.nonunique_row_indexes">
<code class="descclassname">vtool.</code><code class="descname">nonunique_row_indexes</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#nonunique_row_indexes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nonunique_row_indexes" title="Permalink to this definition">¶</a></dt>
<dd><p>rows that are not unique (does not include the first instance of each pattern)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arr</strong> (<em>ndarray</em>) – 2d array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">nonunique_rowx</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>unique_row_indexes
nonunique_row_flags</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-unique_row_indexes</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">534</span><span class="p">,</span> <span class="o">.</span><span class="mi">432</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">534</span><span class="p">,</span> <span class="o">.</span><span class="mi">432</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nonunique_rowx</span> <span class="o">=</span> <span class="n">unique_row_indexes</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;nonunique_rowx = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">nonunique_rowx</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">nonunique_rowx = np.array([4, 6, 7, 8], dtype=np.int64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.norm01">
<code class="descclassname">vtool.</code><code class="descname">norm01</code><span class="sig-paren">(</span><em>array</em>, <em>dim=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#norm01"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.norm01" title="Permalink to this definition">¶</a></dt>
<dd><p>normalizes a numpy array from 0 to 1 based in its extent</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>ndarray</em>) – </li>
<li><strong>dim</strong> (<em>int</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dim</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_norm</span> <span class="o">=</span> <span class="n">norm01</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">array_norm</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.normalize">
<code class="descclassname">vtool.</code><code class="descname">normalize</code><span class="sig-paren">(</span><em>arr</em>, <em>ord=None</em>, <em>axis=None</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all row vectors normalized by their magnitude.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arr</strong> (<em>ndarray</em>) – row vectors to normalize</li>
<li><strong>ord</strong> (<em>int</em>) – type of norm to use (defaults to 2-norm)
{non-zero int, inf, -inf}</li>
<li><strong>axis</strong> (<em>int</em>) – axis to normalize</li>
<li><strong>out</strong> (<em>ndarray</em>) – preallocated output</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>np.linalg.norm</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_normed</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;arr_normed = &#39;</span><span class="p">,</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_normed</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="n">arr_normed</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.6</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_normed</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;arr_normed = &#39;</span><span class="p">,</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_normed</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="n">arr_normed</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ord_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.6</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normed</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">ord</span><span class="p">,</span> <span class="n">normalize</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="nb">ord</span><span class="p">))</span> <span class="k">for</span> <span class="nb">ord</span> <span class="ow">in</span> <span class="n">ord_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">normed</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.normalize_rows">
<code class="descclassname">vtool.</code><code class="descname">normalize_rows</code><span class="sig-paren">(</span><em>arr</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#normalize_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.normalize_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRICATE</p>
</dd></dl>

<dl class="function">
<dt id="vtool.normalize_scores">
<code class="descclassname">vtool.</code><code class="descname">normalize_scores</code><span class="sig-paren">(</span><em>score_domain</em>, <em>p_tp_given_score</em>, <em>scores</em>, <em>interp_fn=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#normalize_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.normalize_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjusts a raw scores to a probabilities based on a learned normalizer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>score_domain</strong> (<em>ndarray</em>) – input score domain</li>
<li><strong>p_tp_given_score</strong> (<em>ndarray</em>) – learned probability mapping</li>
<li><strong>scores</strong> (<em>ndarray</em>) – raw scores</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">probabilities</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –test-normalize_scores</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_tp_given_score</span> <span class="o">=</span> <span class="p">(</span><span class="n">score_domain</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">score_domain</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">9.99</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">11.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prob</span> <span class="o">=</span> <span class="n">normalize_scores</span><span class="p">(</span><span class="n">score_domain</span><span class="p">,</span> <span class="n">p_tp_given_score</span><span class="p">,</span> <span class="n">scores</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#np.set_printoptions(suppress=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress_small</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">score_domain</span><span class="p">,</span> <span class="n">p_tp_given_score</span><span class="p">,</span> <span class="s1">&#39;r-x&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;learned probability&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="s1">&#39;yo&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Normalized scores&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;query points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([ 0.  ,  0.  ,  0.  ,  0.05,  0.64,  1.  ,  1.  ,  1.  ,  1.  ], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.normalized_nearest_neighbors">
<code class="descclassname">vtool.</code><code class="descname">normalized_nearest_neighbors</code><span class="sig-paren">(</span><em>flann1</em>, <em>vecs2</em>, <em>K</em>, <em>checks=800</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#normalized_nearest_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.normalized_nearest_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes matches from vecs2 to flann1.</p>
<p>uses flann index to return nearest neighbors with distances normalized
between 0 and 1 using sifts uint8 trick</p>
</dd></dl>

<dl class="function">
<dt id="vtool.offset_kpts">
<code class="descclassname">vtool.</code><code class="descname">offset_kpts</code><span class="sig-paren">(</span><em>kpts</em>, <em>offset=(0.0</em>, <em>0.0)</em>, <em>scale_factor=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#offset_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.offset_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Transfoms keypoints by a scale factor and a translation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>offset</strong> (<em>tuple</em>) – </li>
<li><strong>scale_factor</strong> (<em>float</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">kpts -  keypoints</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[float32_t, ndim=2]</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_factor</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts_</span> <span class="o">=</span> <span class="n">offset_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results (hack + 0. to fix negative 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">((</span><span class="n">kpts</span><span class="p">,</span> <span class="n">kpts_</span> <span class="o">+</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ORANGE</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts_</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">LIGHT_BLUE</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">union_extents</span><span class="p">([</span><span class="n">extent1</span><span class="p">,</span> <span class="n">extent2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_axis_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([[20.  , 25.  ,  5.22, -5.11, 24.15,  0.  ],</span>
<span class="go">          [29.  , 25.  ,  2.36, -5.11, 24.15,  0.  ],</span>
<span class="go">          [30.  , 30.  , 12.22, 12.02, 10.53,  0.  ],</span>
<span class="go">          [31.  , 29.  , 13.36, 17.63, 14.1 ,  0.  ],</span>
<span class="go">          [32.  , 31.  , 16.05,  3.41, 11.74,  0.  ]], dtype=np.float64),</span>
<span class="go">np.array([[30.  , 12.5 ,  7.82, -2.56, 12.07,  0.  ],</span>
<span class="go">          [43.5 , 12.5 ,  3.53, -2.56, 12.07,  0.  ],</span>
<span class="go">          [45.  , 15.  , 18.32,  6.01,  5.26,  0.  ],</span>
<span class="go">          [46.5 , 14.5 , 20.03,  8.82,  7.05,  0.  ],</span>
<span class="go">          [48.  , 15.5 , 24.08,  1.7 ,  5.87,  0.  ]], dtype=np.float64),</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.open_image_size">
<code class="descclassname">vtool.</code><code class="descname">open_image_size</code><span class="sig-paren">(</span><em>image_fpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#open_image_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.open_image_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets image size from an image on disk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_fpath</strong> (<em>str</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">size (width, height)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-open_image_size</dd>
<dt>Doctest:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;patsy.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="n">open_image_size</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;size = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">size = (800, 441)</span>
</pre></div>
</div>
</dd>
<dt>Ignore:</dt>
<dd><p class="first"># Confirm that Image.open is a lazy load
import vtool as vt
import utool as ut
import timeit
setup = ut.codeblock(</p>
<blockquote>
<div>‘’’
from PIL import Image
import utool as ut
import vtool as vt
image_fpath = ut.grab_test_imgpath(‘patsy.jpg’)
‘’‘</div></blockquote>
<p class="last">)
t1 = timeit.timeit(‘Image.open(image_fpath)’, setup, number=100)
t2 = timeit.timeit(‘Image.open(image_fpath).size’, setup, number=100)
t3 = timeit.timeit(‘vt.open_image_size(image_fpath)’, setup, number=100)
t4 = timeit.timeit(‘vt.imread(image_fpath).shape’, setup, number=100)
t5 = timeit.timeit(‘Image.open(image_fpath).getdata()’, setup, number=100)
print(‘t1 = %r’ % (t1,))
print(‘t2 = %r’ % (t2,))
print(‘t3 = %r’ % (t3,))
print(‘t4 = %r’ % (t4,))
print(‘t5 = %r’ % (t5,))
assert t2 &lt; t5
assert t3 &lt; t4</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.open_pil_image">
<code class="descclassname">vtool.</code><code class="descname">open_pil_image</code><span class="sig-paren">(</span><em>image_fpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_shared.html#open_pil_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.open_pil_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.or_lists">
<code class="descclassname">vtool.</code><code class="descname">or_lists</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#or_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.or_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Like np.logical_and, but can take more than 2 arguments</p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>and_lists</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.ori_distance">
<code class="descclassname">vtool.</code><code class="descname">ori_distance</code><span class="sig-paren">(</span><em>ori1</em>, <em>ori2</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#ori_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ori_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the unsigned distance between two angles</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/1878907/the-smallest-difference-between-2-angles">http://stackoverflow.com/questions/1878907/the-smallest-difference-between-2-angles</a></p>
<dl class="docutils">
<dt>Timeit:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#xdoctest: +SKIP</span>
</pre></div>
</div>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.3</span><span class="p">,</span>  <span class="mf">7.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">3.1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">6.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_</span> <span class="o">=</span> <span class="n">ori_distance</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">ori2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">dist_</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.overlay_alpha_images">
<code class="descclassname">vtool.</code><code class="descname">overlay_alpha_images</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#overlay_alpha_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.overlay_alpha_images" title="Permalink to this definition">¶</a></dt>
<dd><p>places img1 on top of img2 respecting alpha channels</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/25182421/overlay-numpy-alpha">http://stackoverflow.com/questions/25182421/overlay-numpy-alpha</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.pad_image">
<code class="descclassname">vtool.</code><code class="descname">pad_image</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>pad_</em>, <em>value=0</em>, <em>borderType=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#pad_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.pad_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.pad_image_ondisk">
<code class="descclassname">vtool.</code><code class="descname">pad_image_ondisk</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>pad_</em>, <em>out_fpath=None</em>, <em>value=0</em>, <em>borderType=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#pad_image_ondisk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.pad_image_ondisk" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">out_fpath -  file path string</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image pad_image_ondisk</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fpath&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pad_</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">borderType</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath</span> <span class="o">=</span> <span class="n">pad_image_ondisk</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">pad_</span><span class="p">,</span> <span class="n">out_fpath</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">borderType</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;out_fpath = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">out_fpath</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.pad_vstack">
<code class="descclassname">vtool.</code><code class="descname">pad_vstack</code><span class="sig-paren">(</span><em>arrs</em>, <em>fill_value=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#pad_vstack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.pad_vstack" title="Permalink to this definition">¶</a></dt>
<dd><p>Stacks values and pads arrays with different lengths with zeros</p>
</dd></dl>

<dl class="function">
<dt id="vtool.padded_resize">
<code class="descclassname">vtool.</code><code class="descname">padded_resize</code><span class="sig-paren">(</span><em>img</em>, <em>target_size=(64</em>, <em>64)</em>, <em>interpolation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#padded_resize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.padded_resize" title="Permalink to this definition">¶</a></dt>
<dd><p>makes the image resize to the target size and pads the rest of the area with a fill value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>target_size</strong> (<em>tuple</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-padded_resize –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgA</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;ada.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgC</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">),</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#target_size = (64, 64)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img3_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">padded_resize</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">target_size</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="p">[</span><span class="n">imgA</span><span class="p">,</span> <span class="n">imgB</span><span class="p">,</span> <span class="n">imgC</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">ut</span><span class="o">.</span><span class="n">allsame</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img3</span><span class="p">)</span> <span class="k">for</span> <span class="n">img3</span> <span class="ow">in</span> <span class="n">img3_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pnum_</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">make_pnum_nextgen</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.parse_exif_unixtime">
<code class="descclassname">vtool.</code><code class="descname">parse_exif_unixtime</code><span class="sig-paren">(</span><em>image_fpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#parse_exif_unixtime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.parse_exif_unixtime" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_fpath</strong> (<em>str</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">unixtime</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.exif –test-parse_exif_unixtime</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unixtime</span> <span class="o">=</span> <span class="n">parse_exif_unixtime</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">unixtime</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.parse_exif_unixtime_gps">
<code class="descclassname">vtool.</code><code class="descname">parse_exif_unixtime_gps</code><span class="sig-paren">(</span><em>image_fpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#parse_exif_unixtime_gps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.parse_exif_unixtime_gps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.partition_scores">
<code class="descclassname">vtool.</code><code class="descname">partition_scores</code><span class="sig-paren">(</span><em>X</em>, <em>y</em>, <em>attrs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#partition_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.partition_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>convinience helper to translate partitioned to unpartitioned data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tp_scores</strong> (<em>ndarray</em>) – </li>
<li><strong>tn_scores</strong> (<em>ndarray</em>) – </li>
<li><strong>attrs</strong> (<em>dict</em>) – (default = None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(scores, labels, attrs)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –test-partition_scores</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;qaid&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">21</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">])}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">partition_scores</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resdict</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">odict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="s1">&#39;tp_scores&#39;</span><span class="p">,</span> <span class="s1">&#39;tn_scores&#39;</span><span class="p">,</span> <span class="s1">&#39;part_attrs&#39;</span><span class="p">],</span> <span class="n">tup</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">resdict</span><span class="p">,</span> <span class="n">nobraces</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="n">explicit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">tp_scores=np.array([5, 6, 6, 7]),</span>
<span class="go">tn_scores=np.array([1, 2, 2]),</span>
<span class="go">part_attrs={</span>
<span class="go">    False: {&#39;qaid&#39;: np.array([11, 14, 15])},</span>
<span class="go">    True: {&#39;qaid&#39;: np.array([21, 24, 25, 26])},</span>
<span class="go">},</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch_gaussian_weighted_average_intensities">
<code class="descclassname">vtool.</code><code class="descname">patch_gaussian_weighted_average_intensities</code><span class="sig-paren">(</span><em>probchip</em>, <em>kpts_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_gaussian_weighted_average_intensities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch_gaussian_weighted_average_intensities" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch_gradient">
<code class="descclassname">vtool.</code><code class="descname">patch_gradient</code><span class="sig-paren">(</span><em>patch</em>, <em>ksize=1</em>, <em>gaussian_weighted=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_gradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch_gradient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch_mag">
<code class="descclassname">vtool.</code><code class="descname">patch_mag</code><span class="sig-paren">(</span><em>gradx</em>, <em>grady</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_mag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch_mag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch_ori">
<code class="descclassname">vtool.</code><code class="descname">patch_ori</code><span class="sig-paren">(</span><em>gradx</em>, <em>grady</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_ori"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch_ori" title="Permalink to this definition">¶</a></dt>
<dd><p>returns patch orientation relative to the x-axis</p>
</dd></dl>

<dl class="function">
<dt id="vtool.pdist_argsort">
<code class="descclassname">vtool.</code><code class="descname">pdist_argsort</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#pdist_argsort"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.pdist_argsort" title="Permalink to this definition">¶</a></dt>
<dd><p>Sorts 2d indicies by their distnace matrix output from scipy.spatial.distance
x = np.array([  3.05555556e-03,   1.47619797e+04,   1.47619828e+04])</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>ndarray</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">sortx_2d</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance –test-pdist_argsort</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">21695.78</span><span class="p">,</span> <span class="mf">10943.76</span><span class="p">,</span> <span class="mf">10941.44</span><span class="p">,</span> <span class="mf">25867.64</span><span class="p">,</span> <span class="mf">10752.03</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="mf">10754.35</span><span class="p">,</span> <span class="mf">4171.86</span><span class="p">,</span> <span class="mf">2.32</span><span class="p">,</span> <span class="mf">14923.89</span><span class="p">,</span> <span class="mf">14926.2</span> <span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>             <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sortx_2d</span> <span class="o">=</span> <span class="n">pdist_argsort</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;sortx_2d = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sortx_2d</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">sortx_2d = [(2, 3), (1, 4), (1, 2), (1, 3), (0, 3), (0, 2), (2, 4), (3, 4), (0, 1), (0, 4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.pdist_indicies">
<code class="descclassname">vtool.</code><code class="descname">pdist_indicies</code><span class="sig-paren">(</span><em>num</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#pdist_indicies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.pdist_indicies" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.perlin_noise">
<code class="descclassname">vtool.</code><code class="descname">perlin_noise</code><span class="sig-paren">(</span><em>size</em>, <em>scale=32.0</em>, <em>rng=&lt;module 'numpy.random' from '/Users/jason.parham/virtualenv/wildme3/lib/python3.6/site-packages/numpy/random/__init__.py'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#perlin_noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.perlin_noise" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://www.siafoo.net/snippet/229">http://www.siafoo.net/snippet/229</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image perlin_noise –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#size = (64, 64)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#scale = 32.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span> <span class="o">=</span> <span class="mf">64.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">perlin_noise</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.perterb_kpts">
<code class="descclassname">vtool.</code><code class="descname">perterb_kpts</code><span class="sig-paren">(</span><em>kpts</em>, <em>xy_std=None</em>, <em>invV_std=None</em>, <em>ori_std=None</em>, <em>damping=None</em>, <em>seed=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#perterb_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.perterb_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds normally distributed pertibations to keypoints</p>
</dd></dl>

<dl class="function">
<dt id="vtool.perterbed_grid_kpts">
<code class="descclassname">vtool.</code><code class="descname">perterbed_grid_kpts</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#perterbed_grid_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.perterbed_grid_kpts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.plot_centroids">
<code class="descclassname">vtool.</code><code class="descname">plot_centroids</code><span class="sig-paren">(</span><em>data</em>, <em>centroids</em>, <em>num_pca_dims=3</em>, <em>whiten=False</em>, <em>labels='centroids'</em>, <em>fnum=1</em>, <em>prefix=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#plot_centroids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.plot_centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots centroids and datapoints. Plots accurately up to 3 dimensions.
If there are more than 3 dimensions, PCA is used to recude the dimenionality
to the &lt;num_pca_dims&gt; principal components</p>
</dd></dl>

<dl class="function">
<dt id="vtool.plot_postbayes_pdf">
<code class="descclassname">vtool.</code><code class="descname">plot_postbayes_pdf</code><span class="sig-paren">(</span><em>score_domain</em>, <em>p_tn_given_score</em>, <em>p_tp_given_score</em>, <em>score_thresh=None</em>, <em>prob_thresh=None</em>, <em>cfgstr=''</em>, <em>fnum=None</em>, <em>pnum=(1</em>, <em>1</em>, <em>1)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#plot_postbayes_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.plot_postbayes_pdf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.plot_prebayes_pdf">
<code class="descclassname">vtool.</code><code class="descname">plot_prebayes_pdf</code><span class="sig-paren">(</span><em>score_domain</em>, <em>p_score_given_tn</em>, <em>p_score_given_tp</em>, <em>p_score</em>, <em>cfgstr=''</em>, <em>fnum=None</em>, <em>pnum=(1</em>, <em>1</em>, <em>1)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#plot_prebayes_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.plot_prebayes_pdf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.point_inside_bbox">
<code class="descclassname">vtool.</code><code class="descname">point_inside_bbox</code><span class="sig-paren">(</span><em>point</em>, <em>bbox</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#point_inside_bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.point_inside_bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Flags points that are strictly inside a bounding box.
Points on the boundary are not considered inside.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>point</strong> (<em>ndarray</em>) – one or more points to test (2xN)</li>
<li><strong>bbox</strong> (<em>tuple</em>) – a bounding box in  (x, y, w, h) format</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">True if the point is in the bbox</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool or ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.geometry point_inside_bbox –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flag</span> <span class="o">=</span> <span class="n">point_inside_bbox</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flag</span> <span class="o">=</span> <span class="n">flag</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;flag = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flag</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">verts_from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">flag</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">flag</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">~</span><span class="n">flag</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">~</span><span class="n">flag</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">flag = np.array([0, 0, 0, 0, 0, 0, 0, 0, 1, 0])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.print_image_checks">
<code class="descclassname">vtool.</code><code class="descname">print_image_checks</code><span class="sig-paren">(</span><em>img_fpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_shared.html#print_image_checks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.print_image_checks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.random_affine_args">
<code class="descclassname">vtool.</code><code class="descname">random_affine_args</code><span class="sig-paren">(</span><em>zoom_pdf=None</em>, <em>tx_pdf=None</em>, <em>ty_pdf=None</em>, <em>shear_pdf=None</em>, <em>theta_pdf=None</em>, <em>enable_flip=False</em>, <em>enable_stretch=False</em>, <em>default_distribution='uniform'</em>, <em>scalar_anchor='reflect'</em>, <em>txy_pdf=None</em>, <em>rng=&lt;module 'numpy.random' from '/Users/jason.parham/virtualenv/wildme3/lib/python3.6/site-packages/numpy/random/__init__.py'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#random_affine_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.random_affine_args" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: allow for a pdf of ranges for each dimension</p>
<p>If pdfs are tuples it is interpreted as a default (uniform) distribution between the
two points. A single scalar is a default distribution between -scalar and
scalar.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>zoom_range</strong> (<em>tuple</em>) – (default = (1.0, 1.0))</li>
<li><strong>tx_range</strong> (<em>tuple</em>) – (default = (0.0, 0.0))</li>
<li><strong>ty_range</strong> (<em>tuple</em>) – (default = (0.0, 0.0))</li>
<li><strong>shear_range</strong> (<em>tuple</em>) – (default = (0, 0))</li>
<li><strong>theta_range</strong> (<em>tuple</em>) – (default = (0, 0))</li>
<li><strong>enable_flip</strong> (<em>bool</em>) – (default = False)</li>
<li><strong>enable_stretch</strong> (<em>bool</em>) – (default = False)</li>
<li><strong>rng</strong> (<em>module</em>) – random number generator(default = numpy.random)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">affine_args</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/linalg.py random_affine_args</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zoom_range</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.9090909090909091</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_pdf</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ty_pdf</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shear_pdf</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_pdf</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enable_flip</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enable_stretch</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">affine_args</span> <span class="o">=</span> <span class="n">random_affine_args</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">zoom_range</span><span class="p">,</span> <span class="n">tx_pdf</span><span class="p">,</span> <span class="n">ty_pdf</span><span class="p">,</span> <span class="n">shear_pdf</span><span class="p">,</span> <span class="n">theta_pdf</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">enable_flip</span><span class="p">,</span> <span class="n">enable_stretch</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;affine_args = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">affine_args</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">)</span> <span class="o">=</span> <span class="n">affine_args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">affine_mat3x3</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">Aff</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[ 1.009, -0.   ,  1.695],</span>
<span class="go">          [ 0.   ,  1.042,  2.584],</span>
<span class="go">          [ 0.   ,  0.   ,  1.   ]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.random_affine_transform">
<code class="descclassname">vtool.</code><code class="descname">random_affine_transform</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#random_affine_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.random_affine_transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.read_all_exif_tags">
<code class="descclassname">vtool.</code><code class="descname">read_all_exif_tags</code><span class="sig-paren">(</span><em>pil_img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_all_exif_tags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.read_all_exif_tags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.read_exif">
<code class="descclassname">vtool.</code><code class="descname">read_exif</code><span class="sig-paren">(</span><em>fpath</em>, <em>tag=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_exif"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.read_exif" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.read_exif_tags">
<code class="descclassname">vtool.</code><code class="descname">read_exif_tags</code><span class="sig-paren">(</span><em>pil_img</em>, <em>exif_tagid_list</em>, <em>default_list=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_exif_tags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.read_exif_tags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.read_one_exif_tag">
<code class="descclassname">vtool.</code><code class="descname">read_one_exif_tag</code><span class="sig-paren">(</span><em>pil_img</em>, <em>tag</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_one_exif_tag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.read_one_exif_tag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.rebuild_partition">
<code class="descclassname">vtool.</code><code class="descname">rebuild_partition</code><span class="sig-paren">(</span><em>part1_vals</em>, <em>part2_vals</em>, <em>part1_indexes</em>, <em>part2_indexes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#rebuild_partition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.rebuild_partition" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverts work done by index_partition</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>part1_vals</strong> (<em>list</em>) – </li>
<li><strong>part2_vals</strong> (<em>list</em>) – </li>
<li><strong>part1_indexes</strong> (<em>dict</em>) – </li>
<li><strong>part2_indexes</strong> (<em>dict</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-rebuild_partition</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dist&#39;</span><span class="p">,</span> <span class="s1">&#39;fg&#39;</span><span class="p">,</span> <span class="s1">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fg&#39;</span><span class="p">,</span> <span class="s1">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_indexes</span><span class="p">,</span> <span class="n">part2_indexes</span> <span class="o">=</span> <span class="n">index_partition</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part1_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_vals</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part1_indexes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part2_vals</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part2_indexes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val_list</span> <span class="o">=</span> <span class="n">rebuild_partition</span><span class="p">(</span><span class="n">part1_vals</span><span class="p">,</span> <span class="n">part2_vals</span><span class="p">,</span> <span class="n">part1_indexes</span><span class="p">,</span> <span class="n">part2_indexes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">val_list</span> <span class="o">==</span> <span class="n">item_list</span><span class="p">,</span> <span class="s1">&#39;incorrect inversin&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">val_list</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.rectify_invV_mats_are_up">
<code class="descclassname">vtool.</code><code class="descname">rectify_invV_mats_are_up</code><span class="sig-paren">(</span><em>invVR_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#rectify_invV_mats_are_up"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.rectify_invV_mats_are_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Useful if invVR_mats is no longer lower triangular
rotates affine shape matrixes into downward (lower triangular) position</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint –exec-rectify_invV_mats_are_up –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Shrink x and y scales a bit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">3</span>  <span class="c1"># increase skew</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set random orientation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">get_invVR_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats2</span><span class="p">,</span> <span class="n">oris</span> <span class="o">=</span> <span class="n">rectify_invV_mats_are_up</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span> <span class="o">=</span> <span class="n">flatten_invV_mats_to_kpts</span><span class="p">(</span><span class="n">invVR_mats2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Scale down in y a bit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_kpts</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">kpts</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">]),</span> <span class="n">ori</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">eig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>             <span class="n">ori_color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Redraw oriented to show difference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">eig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ori_color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p>pt.figure(doclf=True, fnum=pt.ensure_fnum(None))
ax = pt.gca()
#ax.invert_yaxis()
#pt.draw_kpts2(kpts, color=’blue’, ell_linewidth=3, ori=1, eig=True, ori_color=’green’, rect=True)
pt.draw_kpts2(kpts2, color=’red’, ell_linewidth=2, ori=1, eig=True, ori_color=’green’, rect=True)
extents = np.array(vt.get_kpts_image_extent(np.vstack([kpts, kpts2])))
pt.set_axis_extent(extent, ax)
pt.dark_background()
ut.show_if_requested()</p>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">rectify_invV_mats_are_up</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
<span class="go">nbgarvieipbyfihtrhmeouosgehswvcr</span>
</pre></div>
</div>
</dd>
<dt>Ignore:</dt>
<dd><p class="first">_invRs_2x2 = invVR_mats[:, 0:2, 0:2][0:1]
A = _invRs_2x2[0]
Q, R = np.linalg.qr(A)</p>
<p>invVR_mats2, oris = rectify_invV_mats_are_up(_invRs_2x2[0:1])
L2, ori2 = invVR_mats2[0], oris[0]
Q2 = vt.rotation_mat2x2(ori2)</p>
<p>np.linalg.det(Q)</p>
<p>vecs = np.random.rand(2, 4)
Q2.dot(vecs)
Q.dot(vecs)</p>
<p class="last">np.linalg.cholesky(_invR_2x2)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.rectify_to_float01">
<code class="descclassname">vtool.</code><code class="descname">rectify_to_float01</code><span class="sig-paren">(</span><em>img</em>, <em>dtype=&lt;class 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rectify_to_float01"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.rectify_to_float01" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that an image is encoded using a float properly</p>
</dd></dl>

<dl class="function">
<dt id="vtool.rectify_to_square">
<code class="descclassname">vtool.</code><code class="descname">rectify_to_square</code><span class="sig-paren">(</span><em>img</em>, <em>extreme='max'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rectify_to_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.rectify_to_square" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.rectify_to_uint8">
<code class="descclassname">vtool.</code><code class="descname">rectify_to_uint8</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rectify_to_uint8"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.rectify_to_uint8" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that an image is encoded in uint8 properly</p>
</dd></dl>

<dl class="function">
<dt id="vtool.refine_inliers">
<code class="descclassname">vtool.</code><code class="descname">refine_inliers</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>aff_inliers</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh=2.0</em>, <em>ori_thresh=1.57</em>, <em>full_homog_checks=True</em>, <em>refine_method='homog'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#refine_inliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.refine_inliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a set of hypothesis inliers, computes a homography and refines inliers
returned homography maps image1 space into image2 space</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification –test-refine_inliers
python -m vtool.spatial_verification –test-refine_inliers:0
python -m vtool.spatial_verification –test-refine_inliers:1 –show</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">make_dummy_fm</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_inliers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="o">.</span><span class="mi">01</span> <span class="o">*</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_kpts_dlen_sqrd</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homogtup</span> <span class="o">=</span> <span class="n">refine_inliers</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refined_inliers</span><span class="p">,</span> <span class="n">refined_errors</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">homogtup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">homogtup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_small</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup1</span> <span class="o">=</span> <span class="n">refine_inliers</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">homog_tup1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">homog_tup1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">show_sv</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">homog_tup</span><span class="o">=</span><span class="n">homog_tup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.remove_homogenous_coordinate">
<code class="descclassname">vtool.</code><code class="descname">remove_homogenous_coordinate</code><span class="sig-paren">(</span><em>_xyzs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#remove_homogenous_coordinate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.remove_homogenous_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>normalizes 3d homogonous coordinates into 2d coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>_xyzs</strong> (<em>ndarray</em>) – of shape (3, N)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">_xys of shape (2, N)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.linalg –test-remove_homogenous_coordinate</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xyzs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">2.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">2.</span><span class="p">,</span>   <span class="mf">2.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">1.2</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xys</span> <span class="o">=</span> <span class="n">remove_homogenous_coordinate</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_xys</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xyzs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">140.</span><span class="p">,</span>  <span class="mf">167.</span><span class="p">,</span>  <span class="mf">185.</span><span class="p">,</span>  <span class="mf">185.</span><span class="p">,</span>  <span class="mf">194.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">121.</span><span class="p">,</span>  <span class="mf">139.</span><span class="p">,</span>  <span class="mf">156.</span><span class="p">,</span>  <span class="mf">155.</span><span class="p">,</span>  <span class="mf">163.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">47.</span><span class="p">,</span>   <span class="mf">56.</span><span class="p">,</span>   <span class="mf">62.</span><span class="p">,</span>   <span class="mf">62.</span><span class="p">,</span>   <span class="mf">65.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xys</span> <span class="o">=</span> <span class="n">remove_homogenous_coordinate</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_xys</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.resize">
<code class="descclassname">vtool.</code><code class="descname">resize</code><span class="sig-paren">(</span><em>img</em>, <em>dsize</em>, <em>interpolation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.resize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.resize_image_by_scale">
<code class="descclassname">vtool.</code><code class="descname">resize_image_by_scale</code><span class="sig-paren">(</span><em>img</em>, <em>scale</em>, <em>interpolation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_image_by_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.resize_image_by_scale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.resize_mask">
<code class="descclassname">vtool.</code><code class="descname">resize_mask</code><span class="sig-paren">(</span><em>mask</em>, <em>chip</em>, <em>interpolation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.resize_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.resize_thumb">
<code class="descclassname">vtool.</code><code class="descname">resize_thumb</code><span class="sig-paren">(</span><em>img</em>, <em>max_dsize=(64</em>, <em>64)</em>, <em>interpolation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_thumb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.resize_thumb" title="Permalink to this definition">¶</a></dt>
<dd><p>Resize an image such that its max width or height is:</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-resize_thumb –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">resize_thumb</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;img.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;img2.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img2</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.resize_to_maxdims">
<code class="descclassname">vtool.</code><code class="descname">resize_to_maxdims</code><span class="sig-paren">(</span><em>img</em>, <em>max_dsize=(64</em>, <em>64)</em>, <em>interpolation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_to_maxdims"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.resize_to_maxdims" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>max_dsize</strong> (<em>tuple</em>) – </li>
<li><strong>interpolation</strong> (<em>long</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-resize_to_maxdims –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">resize_to_maxdims</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;img.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;img2.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img2</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.resize_to_maxdims_ondisk">
<code class="descclassname">vtool.</code><code class="descname">resize_to_maxdims_ondisk</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>max_dsize</em>, <em>out_fpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_to_maxdims_ondisk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.resize_to_maxdims_ondisk" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img_fpath</strong> (<em>str</em>) – file path string</li>
<li><strong>max_dsize</strong> – </li>
<li><strong>out_fpath</strong> (<em>str</em>) – file path string(default = None)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormA.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormB.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormC.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormD.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormE.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormF.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormG.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormH.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormI.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormJ.png –dsize=417,None</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fpath&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--dsize&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resize_to_maxdims_ondisk</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">,</span> <span class="n">out_fpath</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.resized_clamped_thumb_dims">
<code class="descclassname">vtool.</code><code class="descname">resized_clamped_thumb_dims</code><span class="sig-paren">(</span><em>img_size</em>, <em>max_dsize</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resized_clamped_thumb_dims"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.resized_clamped_thumb_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.resized_dims_and_ratio">
<code class="descclassname">vtool.</code><code class="descname">resized_dims_and_ratio</code><span class="sig-paren">(</span><em>img_size</em>, <em>max_dsize</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resized_dims_and_ratio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.resized_dims_and_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>returns resized dimensions to get <code class="docutils literal notranslate"><span class="pre">img_size</span></code> to fit into <code class="docutils literal notranslate"><span class="pre">max_dsize</span></code></p>
<dl class="docutils">
<dt>FIXME:</dt>
<dd>Should specifying a None force the use of the original dim?</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img_size</strong> (<em>tuple</em>) – </li>
<li><strong>max_dsize</strong> (<em>tuple</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(dsize, ratio)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image resized_dims_and_ratio –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">=</span> <span class="n">resized_dims_and_ratio</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(dsize, ratio) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(dsize, ratio) = ((150, 75), 0.75)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">=</span> <span class="n">resized_dims_and_ratio</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(dsize, ratio) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(dsize, ratio) = ((2000, 1000), 10.0)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">=</span> <span class="n">resized_dims_and_ratio</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(dsize, ratio) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(dsize, ratio) = ((200, 100), 1.0)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">=</span> <span class="n">resized_dims_and_ratio</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(dsize, ratio) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(dsize, ratio) = ((200, 100), 1.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.rotate_image">
<code class="descclassname">vtool.</code><code class="descname">rotate_image</code><span class="sig-paren">(</span><em>img</em>, <em>theta</em>, <em>border_mode=None</em>, <em>interpolation=None</em>, <em>dsize=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rotate_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.rotate_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates an image around its center</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>theta</strong> – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-rotate_image</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_test_patch</span><span class="p">(</span><span class="s1">&#39;star2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">16.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR</span> <span class="o">=</span> <span class="n">rotate_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--show&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ut</span><span class="o">.</span><span class="n">inIPython</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span>  <span class="o">*</span> <span class="mi">255</span><span class="p">,</span>  <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.rotate_image_ondisk">
<code class="descclassname">vtool.</code><code class="descname">rotate_image_ondisk</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>theta</em>, <em>out_fpath=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rotate_image_ondisk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.rotate_image_ondisk" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates an image on disk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img_fpath</strong> – </li>
<li><strong>theta</strong> – </li>
<li><strong>out_fpath</strong> (<em>None</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-rotate_image_ondisk</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;star.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath_</span> <span class="o">=</span> <span class="n">rotate_image_ondisk</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">out_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">out_fpath_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--show&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ut</span><span class="o">.</span><span class="n">inIPython</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">out_fpath_</span><span class="p">,</span>  <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.rotation_around_bbox_mat3x3">
<code class="descclassname">vtool.</code><code class="descname">rotation_around_bbox_mat3x3</code><span class="sig-paren">(</span><em>theta</em>, <em>bbox0</em>, <em>bbox1=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_around_bbox_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.rotation_around_bbox_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.rotation_around_mat3x3">
<code class="descclassname">vtool.</code><code class="descname">rotation_around_mat3x3</code><span class="sig-paren">(</span><em>theta</em>, <em>x0</em>, <em>y0</em>, <em>x1=None</em>, <em>y1=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_around_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.rotation_around_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.rotation_mat2x2">
<code class="descclassname">vtool.</code><code class="descname">rotation_mat2x2</code><span class="sig-paren">(</span><em>theta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_mat2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.rotation_mat2x2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.rotation_mat3x3">
<code class="descclassname">vtool.</code><code class="descname">rotation_mat3x3</code><span class="sig-paren">(</span><em>radians</em>, <em>sin=&lt;ufunc 'sin'&gt;</em>, <em>cos=&lt;ufunc 'cos'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.rotation_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Rotation_matrix">https://en.wikipedia.org/wiki/Rotation_matrix</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.rowwise_operation">
<code class="descclassname">vtool.</code><code class="descname">rowwise_operation</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em>, <em>op</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#rowwise_operation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.rowwise_operation" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRICATE THIS IS POSSIBLE WITH STRICTLY BROADCASTING AND
USING np.newaxis</p>
<p>DEPRICATE, numpy has better ways of doing this.
Is the rowwise name correct? Should it be colwise?</p>
<p>performs an operation between an
(N x A x B … x Z) array with an
(N x 1) array</p>
</dd></dl>

<dl class="function">
<dt id="vtool.safe_argmax">
<code class="descclassname">vtool.</code><code class="descname">safe_argmax</code><span class="sig-paren">(</span><em>arr</em>, <em>fill=nan</em>, <em>finite=False</em>, <em>nans=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_argmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.safe_argmax" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Doctest:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">safe_argmax</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">safe_argmax</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">safe_argmax</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">safe_argmax</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">safe_argmax</span><span class="p">([]))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.safe_cat">
<code class="descclassname">vtool.</code><code class="descname">safe_cat</code><span class="sig-paren">(</span><em>tup</em>, <em>axis=0</em>, <em>default_shape=(0</em>, <em>)</em>, <em>default_dtype=&lt;class 'float'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_cat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.safe_cat" title="Permalink to this definition">¶</a></dt>
<dd><p>stacks a tuple even if it is empty
Also deals with numpy bug where cat fails if an element in sequence is empty</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">safe_cat</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">safe_cat</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;s = &#39;</span><span class="p">,</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">s</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">safe_cat</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;s = &#39;</span><span class="p">,</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">s</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">safe_cat</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;s = &#39;</span><span class="p">,</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">s</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.safe_div">
<code class="descclassname">vtool.</code><code class="descname">safe_div</code><span class="sig-paren">(</span><em>a</em>, <em>b</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_div"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.safe_div" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.safe_extreme">
<code class="descclassname">vtool.</code><code class="descname">safe_extreme</code><span class="sig-paren">(</span><em>arr</em>, <em>op</em>, <em>fill=nan</em>, <em>finite=False</em>, <em>nans=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_extreme"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.safe_extreme" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies an exterme operation to an 1d array (typically max/min) but ensures
a value is always returned even in operations without identities. The
default identity must be specified using the <cite>fill</cite> argument.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arr</strong> (<em>ndarray</em>) – 1d array to take extreme of</li>
<li><strong>op</strong> (<em>func</em>) – vectorized operation like np.max to apply to array</li>
<li><strong>fill</strong> (<em>float</em>) – return type if arr has no elements (default = nan)</li>
<li><strong>finite</strong> (<em>bool</em>) – if True ignores non-finite values (default = False)</li>
<li><strong>nans</strong> (<em>bool</em>) – if False ignores nans (default = True)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.safe_max">
<code class="descclassname">vtool.</code><code class="descname">safe_max</code><span class="sig-paren">(</span><em>arr</em>, <em>fill=nan</em>, <em>finite=False</em>, <em>nans=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_max"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.safe_max" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arr</strong> (<em>ndarray</em>) – 1d array to take max of</li>
<li><strong>fill</strong> (<em>float</em>) – return type if arr has no elements (default = nan)</li>
<li><strong>finite</strong> (<em>bool</em>) – if True ignores non-finite values (default = False)</li>
<li><strong>nans</strong> (<em>bool</em>) – if False ignores nans (default = True)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other safe_max –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results1</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_max</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results2</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_max</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results3</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_max</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results4</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_max</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">results1</span><span class="p">,</span> <span class="n">results2</span><span class="p">,</span> <span class="n">results3</span><span class="p">,</span> <span class="n">results4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;results = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">results = [</span>
<span class="go">    [nan, nan, nan, inf, inf, 1],</span>
<span class="go">    [nan, nan, nan, nan, 1.0, 1],</span>
<span class="go">    [nan, nan, nan, nan, 1.0, 1],</span>
<span class="go">    [nan, nan, inf, inf, inf, 1],</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.safe_min">
<code class="descclassname">vtool.</code><code class="descname">safe_min</code><span class="sig-paren">(</span><em>arr</em>, <em>fill=nan</em>, <em>finite=False</em>, <em>nans=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_min"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.safe_min" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results1</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_min</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results2</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_min</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results3</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_min</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results4</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_min</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">results1</span><span class="p">,</span> <span class="n">results2</span><span class="p">,</span> <span class="n">results3</span><span class="p">,</span> <span class="n">results4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;results = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">results = [</span>
<span class="go">    [nan, nan, nan, inf, 1.0, 0],</span>
<span class="go">    [nan, nan, nan, nan, 1.0, 0],</span>
<span class="go">    [nan, nan, nan, nan, 1.0, 0],</span>
<span class="go">    [nan, nan, -inf, inf, 1.0, 0],</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.safe_pdist">
<code class="descclassname">vtool.</code><code class="descname">safe_pdist</code><span class="sig-paren">(</span><em>arr</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#safe_pdist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.safe_pdist" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Kwargs:</dt>
<dd>metric = ut.absdiff</dd>
<dt>SeeAlso:</dt>
<dd>scipy.spatial.distance.pdist</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.safe_vstack">
<code class="descclassname">vtool.</code><code class="descname">safe_vstack</code><span class="sig-paren">(</span><em>tup</em>, <em>default_shape=(0</em>, <em>)</em>, <em>default_dtype=&lt;class 'float'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_vstack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.safe_vstack" title="Permalink to this definition">¶</a></dt>
<dd><p>stacks a tuple even if it is empty</p>
</dd></dl>

<dl class="function">
<dt id="vtool.sample_ell_border_pts">
<code class="descclassname">vtool.</code><code class="descname">sample_ell_border_pts</code><span class="sig-paren">(</span><em>expanded_kpts</em>, <em>nSamples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#sample_ell_border_pts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sample_ell_border_pts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.sample_ell_border_vals">
<code class="descclassname">vtool.</code><code class="descname">sample_ell_border_vals</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>expanded_kpts</em>, <em>nKp</em>, <em>nScales</em>, <em>nSamples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#sample_ell_border_vals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sample_ell_border_vals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.sample_uniform">
<code class="descclassname">vtool.</code><code class="descname">sample_uniform</code><span class="sig-paren">(</span><em>kpts</em>, <em>nSamples=128</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#sample_uniform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sample_uniform" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>SeeAlso:</dt>
<dd>python -m pyhesaff.tests.test_ellipse –test-in_depth_ellipse –show</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.scale_around_mat3x3">
<code class="descclassname">vtool.</code><code class="descname">scale_around_mat3x3</code><span class="sig-paren">(</span><em>sx</em>, <em>sy</em>, <em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#scale_around_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.scale_around_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.scale_bbox">
<code class="descclassname">vtool.</code><code class="descname">scale_bbox</code><span class="sig-paren">(</span><em>bbox</em>, <em>sx</em>, <em>sy=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#scale_bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.scale_bbox" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.scale_extents">
<code class="descclassname">vtool.</code><code class="descname">scale_extents</code><span class="sig-paren">(</span><em>extents</em>, <em>sx</em>, <em>sy=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#scale_extents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.scale_extents" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>extent</strong> (<em>ndarray</em>) – tl_x, br_x, tl_y, br_y</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.scale_mat3x3">
<code class="descclassname">vtool.</code><code class="descname">scale_mat3x3</code><span class="sig-paren">(</span><em>sx</em>, <em>sy=None</em>, <em>dtype=&lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#scale_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.scale_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.scaled_verts_from_bbox">
<code class="descclassname">vtool.</code><code class="descname">scaled_verts_from_bbox</code><span class="sig-paren">(</span><em>bbox</em>, <em>theta</em>, <em>sx</em>, <em>sy</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#scaled_verts_from_bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.scaled_verts_from_bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Helps with drawing scaled bbounding boxes on thumbnails</p>
</dd></dl>

<dl class="function">
<dt id="vtool.scaled_verts_from_bbox_gen">
<code class="descclassname">vtool.</code><code class="descname">scaled_verts_from_bbox_gen</code><span class="sig-paren">(</span><em>bbox_list</em>, <em>theta_list</em>, <em>sx=1</em>, <em>sy=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#scaled_verts_from_bbox_gen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.scaled_verts_from_bbox_gen" title="Permalink to this definition">¶</a></dt>
<dd><p>Helps with drawing scaled bbounding boxes on thumbnails</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>bbox_list</strong> (<em>list</em>) – bboxes in x,y,w,h format</li>
<li><strong>theta_list</strong> (<em>list</em>) – rotation of bounding boxes</li>
<li><strong>sx</strong> (<em>float</em>) – x scale factor</li>
<li><strong>sy</strong> (<em>float</em>) – y scale factor</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Yeilds:</dt>
<dd>new_verts - vertices of scaled bounding box for every input</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-scaled_verts_from_bbox_gen</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sy</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_verts_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scaled_verts_from_bbox_gen</span><span class="p">(</span><span class="n">bbox_list</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_verts_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[[5, 5], [55, 5], [55, 55], [5, 55], [5, 5]]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.shear">
<code class="descclassname">vtool.</code><code class="descname">shear</code><span class="sig-paren">(</span><em>img</em>, <em>x_shear</em>, <em>y_shear</em>, <em>dsize=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#shear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.shear" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>x_shear</strong> – </li>
<li><strong>y_shear</strong> – </li>
<li><strong>dsize</strong> (<em>tuple</em>) – width, height</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-shear –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_shear</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_shear</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgSh</span> <span class="o">=</span> <span class="n">shear</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">x_shear</span><span class="p">,</span> <span class="n">y_shear</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgSh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.shear_mat3x3">
<code class="descclassname">vtool.</code><code class="descname">shear_mat3x3</code><span class="sig-paren">(</span><em>shear_x</em>, <em>shear_y</em>, <em>dtype=&lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#shear_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.shear_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.show_gaussian_patch">
<code class="descclassname">vtool.</code><code class="descname">show_gaussian_patch</code><span class="sig-paren">(</span><em>shape</em>, <em>sigma1</em>, <em>sigma2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#show_gaussian_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.show_gaussian_patch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.show_hist_submaxima">
<code class="descclassname">vtool.</code><code class="descname">show_hist_submaxima</code><span class="sig-paren">(</span><em>hist_</em>, <em>edges=None</em>, <em>centers=None</em>, <em>maxima_thresh=0.8</em>, <em>pnum=(1</em>, <em>1</em>, <em>1)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#show_hist_submaxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.show_hist_submaxima" title="Permalink to this definition">¶</a></dt>
<dd><p>For C++ to show data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>hist</strong> – </li>
<li><strong>edges</strong> (<em>None</em>) – </li>
<li><strong>centers</strong> (<em>None</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram –test-show_hist_submaxima –show
python -m pyhesaff._pyhesaff –test-test_rot_invar –show
python -m vtool.histogram –test-show_hist_submaxima –dpath figures –save ~/latex/crall-candidacy-2015/figures/show_hist_submaxima.jpg</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--hist&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--edges&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--maxima_thresh&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=.</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_hist_submaxima</span><span class="p">(</span><span class="n">hist_</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.show_ori_image">
<code class="descclassname">vtool.</code><code class="descname">show_ori_image</code><span class="sig-paren">(</span><em>gori</em>, <em>weights</em>, <em>patch</em>, <em>gradx=None</em>, <em>grady=None</em>, <em>gauss=None</em>, <em>fnum=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#show_ori_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.show_ori_image" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m pyhesaff._pyhesaff –test-test_rot_invar –show –nocpp</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.show_ori_image_ondisk">
<code class="descclassname">vtool.</code><code class="descname">show_ori_image_ondisk</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#show_ori_image_ondisk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.show_ori_image_ondisk" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd><p class="first">python -m vtool.histogram –test-show_ori_image_ondisk –show</p>
<p>python -m vtool.histogram –test-show_ori_image_ondisk –show –patch_img_fpath patches/KP_0_PATCH.png –ori_img_fpath patches/KP_0_orientations01.png –weights_img_fpath patches/KP_0_WEIGHTS.png –grady_img_fpath patches/KP_0_ygradient.png –gradx_img_fpath patches/KP_0_xgradient.png –title cpp_show_ori_ondisk</p>
<p class="last">python -m pyhesaff._pyhesaff –test-test_rot_invar –show –rebuild-hesaff –no-rmbuild</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">show_ori_image_ondisk</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.show_patch_orientation_estimation">
<code class="descclassname">vtool.</code><code class="descname">show_patch_orientation_estimation</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>kpts</em>, <em>patch</em>, <em>gradx</em>, <em>grady</em>, <em>gmag</em>, <em>gori</em>, <em>hist</em>, <em>centers</em>, <em>gori_weights</em>, <em>fx=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#show_patch_orientation_estimation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.show_patch_orientation_estimation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.signed_cyclic_distance">
<code class="descclassname">vtool.</code><code class="descname">signed_cyclic_distance</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em>, <em>modulo</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#signed_cyclic_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.signed_cyclic_distance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.signed_ori_distance">
<code class="descclassname">vtool.</code><code class="descname">signed_ori_distance</code><span class="sig-paren">(</span><em>ori1</em>, <em>ori2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#signed_ori_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.signed_ori_distance" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ori1</strong> (<em>ndarray</em>) – </li>
<li><strong>ori2</strong> (<em>ndarray</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">ori_dist</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance –exec-signed_ori_distance</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="o">.</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_dist</span> <span class="o">=</span> <span class="n">signed_ori_distance</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">ori2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;ori_dist = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">ori_dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">),))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.significant_shape">
<code class="descclassname">vtool.</code><code class="descname">significant_shape</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#significant_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.significant_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>find the shape without trailing 1’s</p>
</dd></dl>

<dl class="function">
<dt id="vtool.sorted_indices_ranges">
<code class="descclassname">vtool.</code><code class="descname">sorted_indices_ranges</code><span class="sig-paren">(</span><em>groupids_sorted</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#sorted_indices_ranges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sorted_indices_ranges" title="Permalink to this definition">¶</a></dt>
<dd><p>Like group sorted indices but returns a list of slices</p>
</dd></dl>

<dl class="function">
<dt id="vtool.spatially_verify_kpts">
<code class="descclassname">vtool.</code><code class="descname">spatially_verify_kpts</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>xy_thresh=0.01</em>, <em>scale_thresh=2.0</em>, <em>ori_thresh=1.5707963267948966</em>, <em>dlen_sqrd2=None</em>, <em>min_nInliers=4</em>, <em>match_weights=None</em>, <em>returnAff=False</em>, <em>full_homog_checks=True</em>, <em>refine_method='homog'</em>, <em>max_nInliers=5000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#spatially_verify_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatially_verify_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Driver function
Spatially validates feature matches</p>
<p>FIXME: there is a non-determenism here</p>
<p>Returned homography maps image1 space into image2 space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts1</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – all keypoints in image 1</li>
<li><strong>kpts2</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – all keypoints in image 2</li>
<li><strong>fm</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – matching keypoint indexes […, (kp1x, kp2x), …]</li>
<li><strong>xy_thresh</strong> (<em>float</em>) – spatial distance threshold under affine transform to
be considered a match</li>
<li><strong>scale_thresh</strong> (<em>float</em>) – </li>
<li><strong>ori_thresh</strong> (<em>float</em>) – </li>
<li><strong>dlen_sqrd2</strong> (<em>float</em>) – diagonal length squared of image/chip 2</li>
<li><strong>min_nInliers</strong> (<em>int</em>) – default=4</li>
<li><strong>returnAff</strong> (<em>bool</em>) – returns best affine hypothesis as well</li>
<li><strong>max_nInliers</strong> (<em>int</em>) – homog is not considered after this threshold</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(refined_inliers, refined_errors, H, aff_inliers, aff_errors, Aff) if success else None</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m xdoctest vtool.spatial_verification spatially_verify_kpts:0 –show
python -m xdoctest vtool.spatial_verification spatially_verify_kpts:0 –show –refine-method=’affine’
python -m xdoctest vtool.spatial_verification spatially_verify_kpts:0 –dpath figures –show –save ~/latex/crall-candidacy-2015/figures/sver_kpts.jpg  # NOQA
python -m xdoctest vtool.spatial_verification spatially_verify_kpts:0</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname1&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname2&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;easy2.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_extract_features_default_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span><span class="p">[</span><span class="s1">&#39;ratio_thresh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">625</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">argparse_dict</span><span class="p">(</span><span class="n">default_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">)</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">testdata_ratio_matches</span><span class="p">(</span><span class="n">fname1</span><span class="p">,</span> <span class="n">fname2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dlen_sqrd2</span> <span class="o">=</span> <span class="mf">447271.015</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_thresh</span> <span class="o">=</span> <span class="mf">1.57</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_nInliers</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">returnAff</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refine_method</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--refine-method&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;homog&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svtup</span> <span class="o">=</span> <span class="n">spatially_verify_kpts</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">xy_thresh</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span><span class="p">,</span> <span class="n">dlen_sqrd2</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">min_nInliers</span><span class="p">,</span> <span class="n">match_weights</span><span class="p">,</span> <span class="n">returnAff</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">refine_method</span><span class="o">=</span><span class="n">refine_method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">svtup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">svtup</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;sver failed&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refined_inliers</span><span class="p">,</span> <span class="n">refined_errors</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">svtup</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_inliers</span><span class="p">,</span> <span class="n">aff_errors</span><span class="p">,</span> <span class="n">Aff</span> <span class="o">=</span> <span class="n">svtup</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print(&#39;aff_errors = %r&#39; % (aff_errors,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;aff_inliers = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">aff_inliers</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;refined_inliers = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">refined_inliers</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print(&#39;refined_errors = %r&#39; % (refined_errors,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_type_profile</span><span class="p">(</span><span class="n">svtup</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#result = ub.repr2(svtup, precision=3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">refined_inliers</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">aff_inliers</span><span class="p">,</span> <span class="n">Aff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">show_sv</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_tup</span><span class="o">=</span><span class="n">aff_tup</span><span class="p">,</span> <span class="n">homog_tup</span><span class="o">=</span><span class="n">homog_tup</span><span class="p">,</span> <span class="n">refine_method</span><span class="o">=</span><span class="n">refine_method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">tuple(numpy.ndarray, tuple(numpy.ndarray*3), numpy.ndarray, numpy.ndarray, tuple(numpy.ndarray*3), numpy.ndarray)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.stack_image_list">
<code class="descclassname">vtool.</code><code class="descname">stack_image_list</code><span class="sig-paren">(</span><em>img_list</em>, <em>return_offset=False</em>, <em>return_sf=False</em>, <em>return_info=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_image_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.stack_image_list" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-stack_image_list –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_offset</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modifysize</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_sf</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">modifysize</span><span class="o">=</span><span class="n">modifysize</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="n">vert</span><span class="p">,</span> <span class="n">use_larger</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span><span class="p">,</span> <span class="n">offset_list</span><span class="p">,</span> <span class="n">sf_list</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">return_offset</span><span class="o">=</span><span class="n">return_offset</span><span class="p">,</span> <span class="n">return_sf</span><span class="o">=</span><span class="n">return_sf</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">offset_list</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">img_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list_</span> <span class="o">=</span> <span class="n">wh_list</span> <span class="o">*</span> <span class="n">sf_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">offset</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">offset_list</span><span class="p">,</span> <span class="n">wh_list_</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">distinct_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">offset_list</span><span class="p">))):</span>
<span class="gp">... </span>   <span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#wh1 = img1.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#wh2 = img2.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_bbox((0, 0) + wh1, bbox_color=(1, 0, 0))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_bbox((woff, hoff) + wh2, bbox_color=(0, 1, 0))</span>
<span class="go">np.array([[   0.  ,   76.96,  141.08,  181.87,  246.  ],</span>
<span class="go">          [   0.  ,    0.  ,    0.  ,    0.  ,    0.  ]], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.stack_image_list_special">
<code class="descclassname">vtool.</code><code class="descname">stack_image_list_special</code><span class="sig-paren">(</span><em>img1</em>, <em>img_list</em>, <em>num=1</em>, <em>vert=True</em>, <em>use_larger=True</em>, <em>initial_sf=None</em>, <em>interpolation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_image_list_special"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.stack_image_list_special" title="Permalink to this definition">¶</a></dt>
<dd><p># TODO: add initial scale down factor?</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-stack_image_list_special –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list_</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">img_list_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="n">img_list_</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_offset</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_larger</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_bot</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_sf</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_sf</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span><span class="p">,</span> <span class="n">offset_list</span><span class="p">,</span> <span class="n">sf_list</span> <span class="o">=</span> <span class="n">stack_image_list_special</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img_list</span><span class="p">,</span> <span class="n">num_bot</span><span class="p">,</span> <span class="n">vert</span><span class="p">,</span> <span class="n">use_larger</span><span class="p">,</span> <span class="n">initial_sf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img1</span><span class="p">)]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">,</span> <span class="n">img_list</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list_</span> <span class="o">=</span> <span class="n">wh_list</span> <span class="o">*</span> <span class="n">sf_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;imgB.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">imgB</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">offset</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">offset_list</span><span class="p">,</span> <span class="n">wh_list_</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">distinct_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">offset_list</span><span class="p">))):</span>
<span class="gp">... </span>   <span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.stack_image_recurse">
<code class="descclassname">vtool.</code><code class="descname">stack_image_recurse</code><span class="sig-paren">(</span><em>img_list1</em>, <em>img_list2=None</em>, <em>vert=True</em>, <em>modifysize=False</em>, <em>return_offsets=False</em>, <em>interpolation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_image_recurse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.stack_image_recurse" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: return offsets as well</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img_list1</strong> (<em>list</em>) – </li>
<li><strong>img_list2</strong> (<em>list</em>) – </li>
<li><strong>vert</strong> (<em>bool</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">None</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-stack_image_recurse –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;astro.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img3</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;ada.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img4</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;jeff.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img5</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;star.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list1</span> <span class="o">=</span> <span class="p">[</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">img3</span><span class="p">,</span> <span class="n">img4</span><span class="p">,</span> <span class="n">img5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list2</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">stack_image_recurse</span><span class="p">(</span><span class="n">img_list1</span><span class="p">,</span> <span class="n">img_list2</span><span class="p">,</span> <span class="n">vert</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#wh1 = img1.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#wh2 = img2.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_bbox((0, 0) + wh1, bbox_color=(1, 0, 0))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_bbox((woff, hoff) + wh2, bbox_color=(0, 1, 0))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.stack_images">
<code class="descclassname">vtool.</code><code class="descname">stack_images</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>vert=None</em>, <em>modifysize=False</em>, <em>return_sf=False</em>, <em>use_larger=True</em>, <em>interpolation=None</em>, <em>white_background=False</em>, <em>overlap=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.stack_images" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-stack_images –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;astro.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modifysize</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_sf</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#(imgB, woff, hoff) = stack_images(img1, img2, vert, modifysize, return_sf=return_sf)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">overlap</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span><span class="p">,</span> <span class="n">offset2</span><span class="p">,</span> <span class="n">sf_tup</span> <span class="o">=</span> <span class="n">stack_images</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">vert</span><span class="p">,</span> <span class="n">modifysize</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">return_sf</span><span class="o">=</span><span class="n">return_sf</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span> <span class="o">=</span> <span class="n">offset2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">imgB</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img1</span><span class="p">),</span> <span class="n">sf_tup</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img2</span><span class="p">),</span> <span class="n">sf_tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wh1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh1</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">woff</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">hoff</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh2</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">((662, 512, 3), (0.0, 0.0), (0, 150))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.stack_multi_images">
<code class="descclassname">vtool.</code><code class="descname">stack_multi_images</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>offset_list1</em>, <em>sf_list1</em>, <em>offset_list2</em>, <em>sf_list2</em>, <em>vert=True</em>, <em>use_larger=False</em>, <em>modifysize=True</em>, <em>interpolation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_multi_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.stack_multi_images" title="Permalink to this definition">¶</a></dt>
<dd><p>combines images that are already stacked</p>
</dd></dl>

<dl class="function">
<dt id="vtool.stack_multi_images2">
<code class="descclassname">vtool.</code><code class="descname">stack_multi_images2</code><span class="sig-paren">(</span><em>multiimg_list</em>, <em>offsets_list</em>, <em>sfs_list</em>, <em>vert=True</em>, <em>modifysize=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_multi_images2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.stack_multi_images2" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>multiimg_list</strong> (<em>list</em>) – </li>
<li><strong>offset_lists</strong> – </li>
<li><strong>sfs_list</strong> – </li>
<li><strong>vert</strong> (<em>bool</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(stacked_img, stacked_img, stacked_sfs)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-stack_multi_images2 –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_stack1</span><span class="p">,</span> <span class="n">offset_list1</span><span class="p">,</span> <span class="n">sf_list1</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">vert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">modifysize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_stack2</span><span class="p">,</span> <span class="n">offset_list2</span><span class="p">,</span> <span class="n">sf_list2</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">modifysize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_stack3</span><span class="p">,</span> <span class="n">offset_list3</span><span class="p">,</span> <span class="n">sf_list3</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">modifysize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multiimg_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">img_stack1</span><span class="p">,</span> <span class="n">img_stack2</span><span class="p">,</span> <span class="n">img_stack3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offsets_list</span>  <span class="o">=</span> <span class="p">[</span><span class="n">offset_list1</span><span class="p">,</span> <span class="n">offset_list2</span><span class="p">,</span> <span class="n">offset_list3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sfs_list</span>      <span class="o">=</span> <span class="p">[</span><span class="n">sf_list1</span><span class="p">,</span> <span class="n">sf_list2</span><span class="p">,</span> <span class="n">sf_list3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">stack_multi_images2</span><span class="p">(</span><span class="n">multiimg_list</span><span class="p">,</span> <span class="n">offsets_list</span><span class="p">,</span> <span class="n">sfs_list</span><span class="p">,</span> <span class="n">vert</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">stacked_img</span><span class="p">,</span> <span class="n">stacked_offsets</span><span class="p">,</span> <span class="n">stacked_sfs</span><span class="p">)</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">remove_doublspaces</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">stacked_offsets</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">10000</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; ,&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">stacked_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">img_list</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">img_list</span> <span class="o">+</span> <span class="n">img_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list_</span> <span class="o">=</span> <span class="n">wh_list</span> <span class="o">*</span> <span class="n">stacked_sfs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">offset</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">stacked_offsets</span><span class="p">,</span> <span class="n">wh_list_</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">distinct_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stacked_offsets</span><span class="p">))):</span>
<span class="gp">... </span>   <span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([[ 0., 0., 0., 0., 0., 512., 512., 512., 512., 512., 1024., 1024., 1024., 1024., 1024. ],</span>
<span class="go"> [ 0., 512.12, 1024.25, 1827., 2339., 0., 427., 939., 1742., 2254., 0., 373.18, 1137.45, 2073.38, 2670.47]], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.stack_square_images">
<code class="descclassname">vtool.</code><code class="descname">stack_square_images</code><span class="sig-paren">(</span><em>img_list</em>, <em>return_info=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_square_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.stack_square_images" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>img_list</strong> (<em>list</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-stack_square_images</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">stack_square_images</span><span class="p">(</span><span class="n">img_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.strictly_decreasing">
<code class="descclassname">vtool.</code><code class="descname">strictly_decreasing</code><span class="sig-paren">(</span><em>L</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#strictly_decreasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.strictly_decreasing" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.strictly_increasing">
<code class="descclassname">vtool.</code><code class="descname">strictly_increasing</code><span class="sig-paren">(</span><em>L</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#strictly_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.strictly_increasing" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.structure_rows">
<code class="descclassname">vtool.</code><code class="descname">structure_rows</code><span class="sig-paren">(</span><em>*arrs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#structure_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.structure_rows" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other structure_rows</dd>
<dt>SeeAlso:</dt>
<dd>unstructure_rows</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">609</span><span class="p">,</span> <span class="mi">307</span><span class="p">],</span> <span class="p">[</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">344</span><span class="p">],</span> <span class="p">[</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">690</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">422</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">422</span><span class="p">,</span>  <span class="mi">968</span><span class="p">],</span> <span class="p">[</span> <span class="mi">481</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">1132</span><span class="p">],</span> <span class="p">[</span> <span class="mi">759</span><span class="p">,</span>  <span class="mi">159</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structured_arrs</span> <span class="o">=</span> <span class="n">structure_rows</span><span class="p">(</span><span class="o">*</span><span class="n">arrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unstructured_arrs</span> <span class="o">=</span> <span class="n">unstructure_rows</span><span class="p">(</span><span class="o">*</span><span class="n">structured_arrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">unstructured_arrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">arrs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">unstructured_arrs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">arrs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">union_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">union1d</span><span class="p">(</span><span class="o">*</span><span class="n">structured_arrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">union</span><span class="p">,</span> <span class="o">=</span> <span class="n">unstructure_rows</span><span class="p">(</span><span class="n">union_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">union</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.subbin_bounds">
<code class="descclassname">vtool.</code><code class="descname">subbin_bounds</code><span class="sig-paren">(</span><em>z</em>, <em>radius</em>, <em>low</em>, <em>high</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#subbin_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.subbin_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets quantized bounds of a sub-bin/pixel point and a radius.
Useful for cropping using subpixel points</p>
<dl class="docutils">
<dt>Illustration::</dt>
<dd><p class="first">(the bin edges are pipes)
(the bin centers are pluses)</p>
<p>Input = {‘z’: 1.5, ‘radius’:5.666, ‘low’:0, ‘high’:7}
Output = {‘z1’:0, ‘z2’: 7, ‘offst’: 5.66}</p>
<div class="line-block">
<div class="line">|   |   |   |   |   |   |   |</div>
</div>
<dl class="last docutils">
<dt><a href="#id25"><span class="problematic" id="id26">|_+_|_+_|_+_|_+_|_+_|_+_|_+_|_+_|</span></a></dt>
<dd><p class="first">^     ^                     ^
z1    z                     z2</p>
<blockquote>
<div>,.___.___.___.___.___.   &lt; radius (5.333)</div></blockquote>
<dl class="docutils">
<dt>.—.-,                        &lt; z_offset1 (1.6666)</dt>
<dd>,_.___.___.___.___.___.  &lt; z_offset2 (5.666)</dd>
</dl>
<p class="last">.—.-,                        &lt; z_offset1 (1.6666)</p>
</dd>
</dl>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>z</strong> (<em>float</em>) – center of a circle a 1d pixel array</li>
<li><strong>radius</strong> (<em>float</em>) – radius of the circle</li>
<li><strong>low</strong> (<em>int</em>) – minimum index of 1d pixel array</li>
<li><strong>high</strong> (<em>int</em>) – maximum index of 1d pixel array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>(iz1, iz2, z_offst) - quantized_bounds and subbin_offset</dt>
<dd><p class="first last">iz1 - low radius endpoint
iz2 - high radius endpoint
z_offst - subpixel offset
#Returns: quantized_bounds=(iz1, iz2), subbin_offset</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram –test-subbin_bounds</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius</span> <span class="o">=</span> <span class="mf">5.666</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">low</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">high</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">iz1</span><span class="p">,</span> <span class="n">iz2</span><span class="p">,</span> <span class="n">z_offst</span><span class="p">)</span> <span class="o">=</span> <span class="n">subbin_bounds</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">iz1</span><span class="p">,</span> <span class="n">iz2</span><span class="p">,</span> <span class="n">z_offst</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(0, 7, 1.5)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.subpixel_values">
<code class="descclassname">vtool.</code><code class="descname">subpixel_values</code><span class="sig-paren">(</span><em>img</em>, <em>pts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#subpixel_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.subpixel_values" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p>stackoverflow.com/uestions/12729228/simple-efficient-binlinear-interpolation-of-images-in-numpy-and-python</p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>cv2.getRectSubPix(image, patchSize, center[, patch[, patchType]])</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.subscale_peaks">
<code class="descclassname">vtool.</code><code class="descname">subscale_peaks</code><span class="sig-paren">(</span><em>border_vals_sum</em>, <em>kpts</em>, <em>nScales</em>, <em>low</em>, <em>high</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#subscale_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.subscale_peaks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.svd">
<code class="descclassname">vtool.</code><code class="descname">svd</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#svd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.svd" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>M</strong> (<em>ndarray</em>) – must be either float32 or float64</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(U, s, Vt)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.linalg –test-svd</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">20.5812</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.615</span><span class="p">,</span> <span class="mf">17.1295</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vt</span><span class="p">)</span> <span class="o">=</span> <span class="n">svd</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Timeit::</dt>
<dd>flags = cv2.SVD_FULL_UV
%timeit cv2.SVDecomp(M, flags=flags)
%timeit npl.svd(M)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.symbolic_randcheck">
<code class="descclassname">vtool.</code><code class="descname">symbolic_randcheck</code><span class="sig-paren">(</span><em>expr1</em>, <em>expr2</em>, <em>domain={}</em>, <em>n=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#symbolic_randcheck"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.symbolic_randcheck" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.symmetric_correspondence">
<code class="descclassname">vtool.</code><code class="descname">symmetric_correspondence</code><span class="sig-paren">(</span><em>annot1</em>, <em>annot2</em>, <em>K</em>, <em>Knorm</em>, <em>checks</em>, <em>allow_shrink=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#symmetric_correspondence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.symmetric_correspondence" title="Permalink to this definition">¶</a></dt>
<dd><p>Find symmetric feature corresopndences</p>
</dd></dl>

<dl class="function">
<dt id="vtool.sympy_latex_repr">
<code class="descclassname">vtool.</code><code class="descname">sympy_latex_repr</code><span class="sig-paren">(</span><em>expr1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#sympy_latex_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sympy_latex_repr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.sympy_mat">
<code class="descclassname">vtool.</code><code class="descname">sympy_mat</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#sympy_mat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sympy_mat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.sympy_numpy_repr">
<code class="descclassname">vtool.</code><code class="descname">sympy_numpy_repr</code><span class="sig-paren">(</span><em>expr1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#sympy_numpy_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sympy_numpy_repr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.take2">
<code class="descclassname">vtool.</code><code class="descname">take2</code><span class="sig-paren">(</span><em>arr</em>, <em>index_list</em>, <em>axis=None</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#take2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.take2" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around numpy compress that makes the signature more similar to take</p>
</dd></dl>

<dl class="function">
<dt id="vtool.take_col_per_row">
<code class="descclassname">vtool.</code><code class="descname">take_col_per_row</code><span class="sig-paren">(</span><em>arr</em>, <em>colx_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#take_col_per_row"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.take_col_per_row" title="Permalink to this definition">¶</a></dt>
<dd><p>takes a column from each row</p>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><p class="first">num_rows = 1000
num_cols = 4</p>
<p>arr = np.arange(10 * 4).reshape(10, 4)
colx_list = (np.random.rand(10) * 4).astype(np.int)</p>
<p class="last">%timeit np.array([row[cx] for (row, cx) in zip(arr, colx_list)])
%timeit arr.ravel().take(np.ravel_multi_index((np.arange(len(colx_list)), colx_list), arr.shape))
%timeit arr.ravel().take(colx_list + np.arange(arr.shape[0]) * arr.shape[1])</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.test_affine_errors">
<code class="descclassname">vtool.</code><code class="descname">test_affine_errors</code><span class="sig-paren">(</span><em>H</em>, <em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh_sqrd</em>, <em>ori_thresh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#test_affine_errors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_affine_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>used for refinement as opposed to initial estimation</p>
</dd></dl>

<dl class="function">
<dt id="vtool.test_annoy">
<code class="descclassname">vtool.</code><code class="descname">test_annoy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#test_annoy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_annoy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.test_cv2_flann">
<code class="descclassname">vtool.</code><code class="descname">test_cv2_flann</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#test_cv2_flann"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_cv2_flann" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Ignore:</dt>
<dd><p class="first">[name for name in dir(cv2) if ‘create’ in name.lower()]
[name for name in dir(cv2) if ‘stereo’ in name.lower()]</p>
<p class="last">ut.grab_zipped_url(‘<a class="reference external" href="https://priithon.googlecode.com/archive/a6117f5e81ec00abcfb037f0f9da2937bb2ea47f.tar.gz">https://priithon.googlecode.com/archive/a6117f5e81ec00abcfb037f0f9da2937bb2ea47f.tar.gz</a>’, download_dir=’.’)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.test_homog_errors">
<code class="descclassname">vtool.</code><code class="descname">test_homog_errors</code><span class="sig-paren">(</span><em>H</em>, <em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh</em>, <em>ori_thresh</em>, <em>full_homog_checks=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#test_homog_errors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_homog_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Test to see which keypoints the homography correctly maps</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>H</strong> (<em>ndarray</em><em>[</em><em>float64_t</em><em>, </em><em>ndim=2</em><em>]</em>) – homography/perspective matrix</li>
<li><strong>kpts1</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>kpts2</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>fm</strong> (<em>list</em>) – list of feature matches as tuples (qfx, dfx)</li>
<li><strong>xy_thresh_sqrd</strong> (<em>float</em>) – </li>
<li><strong>scale_thresh</strong> (<em>float</em>) – </li>
<li><strong>ori_thresh</strong> (<em>float</em>) – angle in radians</li>
<li><strong>full_homog_checks</strong> (<em>bool</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">homog_tup1</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification –test-test_homog_errors:0 –show
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –rotation_invariance
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –rotation_invariance –no-affine-invariance –xy-thresh=.001
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –rotation_invariance –no-affine-invariance –xy-thresh=.001 –no-full-homog-checks
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –no-full-homog-checks
# ————–
# Shows (sorta) how inliers are computed
python -m vtool.spatial_verification –test-test_homog_errors:1 –show
python -m vtool.spatial_verification –test-test_homog_errors:1 –show –rotation_invariance
python -m vtool.spatial_verification –test-test_homog_errors:1 –show –rotation_invariance –no-affine-invariance –xy-thresh=.001
python -m vtool.spatial_verification –test-test_homog_errors:1 –show –rotation_invariance –xy-thresh=.001
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –rotation_invariance –xy-thresh=.001</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">estimate_refined_transform</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.57</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">full_homog_checks</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--no-full-homog-checks&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup1</span> <span class="o">=</span> <span class="n">test_homog_errors</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">,</span> <span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span><span class="p">,</span> <span class="n">full_homog_checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">homog_tup1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">homog_tup1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">show_sv</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">homog_tup</span><span class="o">=</span><span class="n">homog_tup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm_</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">estimate_refined_transform</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm_</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.57</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">full_homog_checks</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--no-full-homog-checks&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ----------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Take subset of feature matches</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">fm_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_err</span><span class="p">,</span> <span class="n">xy_err</span><span class="p">,</span> <span class="n">ori_err</span> <span class="o">=</span> \
<span class="gp">... </span>    <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">test_homog_errors</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="s1">&#39;scale_err, xy_err, ori_err&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># we only care about checking out scale and orientation here. ignore bad xy points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_inliers_flag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">less</span><span class="p">(</span><span class="n">xy_err</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_err</span><span class="p">[</span><span class="o">~</span><span class="n">xy_inliers_flag</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">fm_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scale_err</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="mi">10</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">fm_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scale_err</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="mi">10</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Exec sourcecode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1_m</span><span class="p">,</span> <span class="n">kpts2_m</span><span class="p">,</span> <span class="n">off_xy1_m</span><span class="p">,</span> <span class="n">off_xy1_mt</span><span class="p">,</span> <span class="n">dxy1_m</span><span class="p">,</span> <span class="n">dxy1_mt</span><span class="p">,</span> <span class="n">xy2_m</span><span class="p">,</span> <span class="n">xy1_m</span><span class="p">,</span> <span class="n">xy1_mt</span><span class="p">,</span> <span class="n">scale_err</span><span class="p">,</span> <span class="n">xy_err</span><span class="p">,</span> <span class="n">ori_err</span> <span class="o">=</span> \
<span class="gp">... </span>    <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">test_homog_errors</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="s1">&#39;kpts1_m, kpts2_m, off_xy1_m, off_xy1_mt, dxy1_m, dxy1_mt, xy2_m, xy1_m, xy1_mt, scale_err, xy_err, ori_err&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;orig points and offset point&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy1_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">off_xy1_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">LIGHT_BLUE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;transformed points and matching points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># first have to make corresponding offset points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use reference point for scale and orientation tests</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oris2_m</span>   <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_oris</span><span class="p">(</span><span class="n">kpts2_m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scales2_m</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_scales</span><span class="p">(</span><span class="n">kpts2_m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dxy2_m</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">oris2_m</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">oris2_m</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaled_dxy2_m</span> <span class="o">=</span> <span class="n">dxy2_m</span> <span class="o">*</span> <span class="n">scales2_m</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">off_xy2_m</span> <span class="o">=</span> <span class="n">xy2_m</span> <span class="o">+</span> <span class="n">scaled_dxy2_m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw transformed semgents</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy2_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">off_xy2_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">GREEN</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw corresponding matches semgents</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy1_mt</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">off_xy1_mt</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw matches between correspondences</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy1_mt</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">xy2_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ORANGE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#vt.get _xy_axis_extents(kpts1_m)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_sv.show_sv(rchip1, rchip2, kpts1, kpts2, fm, homog_tup=homog_tup)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.test_language_modulus">
<code class="descclassname">vtool.</code><code class="descname">test_language_modulus</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#test_language_modulus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_language_modulus" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Modulo_operation">http://en.wikipedia.org/wiki/Modulo_operation</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.test_mser">
<code class="descclassname">vtool.</code><code class="descname">test_mser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#test_mser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_mser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.test_ondisk_find_patch_fpath_dominant_orientations">
<code class="descclassname">vtool.</code><code class="descname">test_ondisk_find_patch_fpath_dominant_orientations</code><span class="sig-paren">(</span><em>patch_fpath</em>, <em>bins=36</em>, <em>maxima_thresh=0.8</em>, <em>DEBUG_ROTINVAR=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#test_ondisk_find_patch_fpath_dominant_orientations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_ondisk_find_patch_fpath_dominant_orientations" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>patch_fpath</strong> – </li>
<li><strong>bins</strong> (<em>int</em>) – </li>
<li><strong>maxima_thresh</strong> (<em>float</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-test_ondisk_find_patch_fpath_dominant_orientations</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--patch-fpath&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;star.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_ondisk_find_patch_fpath_dominant_orientations</span><span class="p">(</span><span class="n">patch_fpath</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.test_score_normalization">
<code class="descclassname">vtool.</code><code class="descname">test_score_normalization</code><span class="sig-paren">(</span><em>tp_support</em>, <em>tn_support</em>, <em>with_scores=True</em>, <em>verbose=True</em>, <em>with_roc=True</em>, <em>with_precision_recall=False</em>, <em>figtitle=None</em>, <em>normkw_varydict=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#test_score_normalization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_score_normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives an overview of how well threshold can be learned from raw scores.</p>
<p>DEPRICATE</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.score_normalization –test-test_score_normalization –show</dd>
<dt>CommandLine:</dt>
<dd>xdoctest -m ~/code/vtool/vtool/score_normalization.py test_score_normalization</dd>
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># GUI_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Shows how score normalization works with gaussian noise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">randstate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get a training sample</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_support</span> <span class="o">=</span> <span class="n">randstate</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">6.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">256</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_support</span> <span class="o">=</span> <span class="n">randstate</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">256</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:plottool)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_score_normalization</span><span class="p">(</span><span class="n">tp_support</span><span class="p">,</span> <span class="n">tn_support</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.test_show_gaussian_patches">
<code class="descclassname">vtool.</code><code class="descname">test_show_gaussian_patches</code><span class="sig-paren">(</span><em>shape=(19</em>, <em>19)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#test_show_gaussian_patches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_show_gaussian_patches" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-test_show_gaussian_patches –show
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=7,7
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=17,17
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=41,41
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=29,29
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=41,7</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://matplotlib.org/examples/mplot3d/surface3d_demo.html">http://matplotlib.org/examples/mplot3d/surface3d_demo.html</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">((</span><span class="s1">&#39;--shape&#39;</span><span class="p">,),</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_show_gaussian_patches</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.test_show_gaussian_patches2">
<code class="descclassname">vtool.</code><code class="descname">test_show_gaussian_patches2</code><span class="sig-paren">(</span><em>shape=(19</em>, <em>19)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#test_show_gaussian_patches2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_show_gaussian_patches2" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch –test-test_show_gaussian_patches2 –show
python -m vtool.patch –test-test_show_gaussian_patches2 –show –shape=7,7
python -m vtool.patch –test-test_show_gaussian_patches2 –show –shape=19,19
python -m vtool.patch –test-test_show_gaussian_patches2 –show –shape=41,41
python -m vtool.patch –test-test_show_gaussian_patches2 –show –shape=41,7</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://matplotlib.org/examples/mplot3d/surface3d_demo.html">http://matplotlib.org/examples/mplot3d/surface3d_demo.html</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">((</span><span class="s1">&#39;--shape&#39;</span><span class="p">,),</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_show_gaussian_patches2</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.testdata_annot_metadata">
<code class="descclassname">vtool.</code><code class="descname">testdata_annot_metadata</code><span class="sig-paren">(</span><em>rchip_fpath</em>, <em>cfgdict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#testdata_annot_metadata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.testdata_annot_metadata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.testdata_binary_scores">
<code class="descclassname">vtool.</code><code class="descname">testdata_binary_scores</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_binary_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.testdata_binary_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.testdata_blend">
<code class="descclassname">vtool.</code><code class="descname">testdata_blend</code><span class="sig-paren">(</span><em>scale=128</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#testdata_blend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.testdata_blend" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.testdata_dummy_matches">
<code class="descclassname">vtool.</code><code class="descname">testdata_dummy_matches</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_dummy_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.testdata_dummy_matches" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">matches_testtup</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.demodata –test-testdata_dummy_matches –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matches_testtup</span> <span class="o">=</span> <span class="n">testdata_dummy_matches</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">)</span> <span class="o">=</span> <span class="n">matches_testtup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_chipmatch2</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_figtitle</span><span class="p">(</span><span class="s1">&#39;Dummy matches&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.testdata_dummy_sift">
<code class="descclassname">vtool.</code><code class="descname">testdata_dummy_sift</code><span class="sig-paren">(</span><em>nPts=10</em>, <em>asint=True</em>, <em>rng=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_dummy_sift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.testdata_dummy_sift" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a demodata sift descriptor that has the uint8 * 512 hack
like hesaff returns</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nPts</strong> (<em>int</em>) – (default = 10)</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.demodata –test-testdata_dummy_sift</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nPts</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sift</span> <span class="o">=</span> <span class="n">testdata_dummy_sift</span><span class="p">(</span><span class="n">nPts</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">vt</span><span class="o">.</span><span class="n">check_sift_validity</span><span class="p">(</span><span class="n">sift</span><span class="p">),</span> <span class="s1">&#39;bad SIFT properties&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#assert np.allclose(((sift / 512) ** 2).sum(axis=1), 1, rtol=.01), &#39;bad SIFT property&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#assert np.all(sift / 512 &lt; .2), &#39;bad SIFT property&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.testdata_hist">
<code class="descclassname">vtool.</code><code class="descname">testdata_hist</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#testdata_hist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.testdata_hist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.testdata_imglist">
<code class="descclassname">vtool.</code><code class="descname">testdata_imglist</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#testdata_imglist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.testdata_imglist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.testdata_matching_affine_inliers">
<code class="descclassname">vtool.</code><code class="descname">testdata_matching_affine_inliers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#testdata_matching_affine_inliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.testdata_matching_affine_inliers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.testdata_matching_affine_inliers_normalized">
<code class="descclassname">vtool.</code><code class="descname">testdata_matching_affine_inliers_normalized</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#testdata_matching_affine_inliers_normalized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.testdata_matching_affine_inliers_normalized" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.testdata_nonmonotonic">
<code class="descclassname">vtool.</code><code class="descname">testdata_nonmonotonic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_nonmonotonic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.testdata_nonmonotonic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.testdata_patch">
<code class="descclassname">vtool.</code><code class="descname">testdata_patch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#testdata_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.testdata_patch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.testdata_ratio_matches">
<code class="descclassname">vtool.</code><code class="descname">testdata_ratio_matches</code><span class="sig-paren">(</span><em>fname1='easy1.png'</em>, <em>fname2='easy2.png'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_ratio_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.testdata_ratio_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs simple ratio-test matching between two images.
Technically this is not demodata data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fname1</strong> (<em>str</em>) – </li>
<li><strong>fname2</strong> (<em>str</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">matches_testtup</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd><p class="first">python -m vtool.demodata –test-testdata_ratio_matches
python -m vtool.demodata –test-testdata_ratio_matches –help
python -m vtool.demodata –test-testdata_ratio_matches –show
python -m vtool.demodata –test-testdata_ratio_matches –show –ratio_thresh=1.1 –rotation_invariance</p>
<p class="last">python -m vtool.demodata –test-testdata_ratio_matches –show –ratio_thresh=.625 –rotation_invariance –fname1 easy1.png –fname2 easy3.png
python -m vtool.demodata –test-testdata_ratio_matches –show –ratio_thresh=.625 –no-rotation_invariance –fname1 easy1.png –fname2 easy3.png</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname1&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname2&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;easy2.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_extract_features_default_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span><span class="p">[</span><span class="s1">&#39;ratio_thresh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">625</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">argparse_dict</span><span class="p">(</span><span class="n">default_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matches_testtup</span> <span class="o">=</span> <span class="n">testdata_ratio_matches</span><span class="p">(</span><span class="n">fname1</span><span class="p">,</span> <span class="n">fname2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm_RAT</span><span class="p">,</span> <span class="n">fs_RAT</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">)</span> <span class="o">=</span> <span class="n">matches_testtup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_chipmatch2</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm_RAT</span><span class="p">,</span> <span class="n">fs_RAT</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_matches</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fm_RAT</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">fs_RAT</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Simple matches using the Lowe</span><span class="se">\&#39;</span><span class="s1">s ratio test&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">title</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> num_matches=</span><span class="si">%r</span><span class="s1">, score_sum=</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">num_matches</span><span class="p">,</span> <span class="n">score_sum</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_figtitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.testdata_score_normalier">
<code class="descclassname">vtool.</code><code class="descname">testdata_score_normalier</code><span class="sig-paren">(</span><em>tp_bumps=[(6.5, 256)], tn_bumps=[(3.5, 256)], tp_scale=1.0, tn_scale=1.0, min_clip=None, **kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#testdata_score_normalier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.testdata_score_normalier" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.testdata_scores_labels">
<code class="descclassname">vtool.</code><code class="descname">testdata_scores_labels</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#testdata_scores_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.testdata_scores_labels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.testdata_sift2">
<code class="descclassname">vtool.</code><code class="descname">testdata_sift2</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#testdata_sift2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.testdata_sift2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.testshow_extramargin_info">
<code class="descclassname">vtool.</code><code class="descname">testshow_extramargin_info</code><span class="sig-paren">(</span><em>gfpath</em>, <em>bbox_gs</em>, <em>theta</em>, <em>new_size</em>, <em>halfoffset_ms</em>, <em>mbbox_gs</em>, <em>margin_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#testshow_extramargin_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.testshow_extramargin_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.to_undirected_edges">
<code class="descclassname">vtool.</code><code class="descname">to_undirected_edges</code><span class="sig-paren">(</span><em>directed_edges</em>, <em>upper=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#to_undirected_edges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.to_undirected_edges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.transform_around">
<code class="descclassname">vtool.</code><code class="descname">transform_around</code><span class="sig-paren">(</span><em>M</em>, <em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#transform_around"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.transform_around" title="Permalink to this definition">¶</a></dt>
<dd><p>translates to origin, applies transform and then translates back</p>
</dd></dl>

<dl class="function">
<dt id="vtool.transform_kpts">
<code class="descclassname">vtool.</code><code class="descname">transform_kpts</code><span class="sig-paren">(</span><em>kpts</em>, <em>M</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#transform_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.transform_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>returns M.dot(kpts_mat)
Currently, only works if M is affine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>M</strong> (<em>ndarray</em>) – affine transform matrix</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a href="#id199"><span class="problematic" id="id200">kpts_</span></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">transform_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-0. &#39;</span><span class="p">,</span> <span class="s1">&#39; 0. &#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.transform_kpts_to_imgspace">
<code class="descclassname">vtool.</code><code class="descname">transform_kpts_to_imgspace</code><span class="sig-paren">(</span><em>kpts</em>, <em>bbox</em>, <em>bbox_theta</em>, <em>chipsz</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#transform_kpts_to_imgspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.transform_kpts_to_imgspace" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Transforms keypoints so they are plotable in imagespace</dt>
<dd>kpts   - xyacdo keypoints
bbox   - chip bounding boxes in image space
theta  - chip rotationsinvC
chipsz - chip extent (in keypoint / chip space)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.transform_kpts_xys">
<code class="descclassname">vtool.</code><code class="descname">transform_kpts_xys</code><span class="sig-paren">(</span><em>H</em>, <em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#transform_kpts_xys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.transform_kpts_xys" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</li>
<li><strong>H</strong> (<em>ndarray</em><em>[</em><em>float64_t</em><em>, </em><em>ndim=2</em><em>]</em>) – homography/perspective matrix</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">xy_t</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">3.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>  <span class="mf">5.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>  <span class="mf">6.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_t</span> <span class="o">=</span> <span class="n">transform_kpts_xys</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.transform_points_with_homography">
<code class="descclassname">vtool.</code><code class="descname">transform_points_with_homography</code><span class="sig-paren">(</span><em>H</em>, <em>_xys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#transform_points_with_homography"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.transform_points_with_homography" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>H</strong> (<em>ndarray</em><em>[</em><em>float64_t</em><em>, </em><em>ndim=2</em><em>]</em>) – homography/perspective matrix</li>
<li><strong>_xys</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – (2 x N) array</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.translation_mat3x3">
<code class="descclassname">vtool.</code><code class="descname">translation_mat3x3</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>dtype=&lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#translation_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.translation_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.try_svd">
<code class="descclassname">vtool.</code><code class="descname">try_svd</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#try_svd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.try_svd" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification try_svd</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">build_lstsqrs_Mx9</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">USV</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">compute_uv</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">USV</span> <span class="o">=</span> <span class="n">try_svd</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">(</span><span class="n">wh_num</span><span class="o">=</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">build_lstsqrs_Mx9</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">USV</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">compute_uv</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">USV</span> <span class="o">=</span> <span class="n">try_svd</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.trytake">
<code class="descclassname">vtool.</code><code class="descname">trytake</code><span class="sig-paren">(</span><em>list_</em>, <em>index_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#trytake"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.trytake" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.tune_flann">
<code class="descclassname">vtool.</code><code class="descname">tune_flann</code><span class="sig-paren">(</span><em>dpts</em>, <em>target_precision=0.9</em>, <em>build_weight=0.5</em>, <em>memory_weight=0.0</em>, <em>sample_fraction=0.01</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#tune_flann"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.tune_flann" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_pami2014.pdf">http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_pami2014.pdf</a>
<a class="reference external" href="http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf">http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf</a>
<a class="reference external" href="http://docs.opencv.org/trunk/modules/flann/doc/flann_fast_approximate_nearest_neighbor_search.html">http://docs.opencv.org/trunk/modules/flann/doc/flann_fast_approximate_nearest_neighbor_search.html</a></p>
<dl class="docutils">
<dt>Math::</dt>
<dd><p class="first">cost of an algorithm is:</p>
<dl class="last docutils">
<dt>LaTeX:</dt>
<dd><dl class="first last docutils">
<dt>cost = frac</dt>
<dd>{search + build_weight * build }
{ minoverparams( search + build_weight build)} +
memory_weight * memory</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dpts</strong> (<em>ndarray</em>) – </li>
<li><strong>target_precision</strong> (<em>float</em>) – number between 0 and 1 representing desired
accuracy. Higher values are more accurate.</li>
<li><strong>build_weight</strong> (<em>float</em>) – importance weight given to minimizing build time
relative to search time. This number can range from 0 to infinity.
typically because building is a more complex computation you want
to keep the number relatively low, (less than 1) otherwise you’ll
end up getting a linear search (no build time).</li>
<li><strong>memory_weight</strong> (<em>float</em>) – Importance of memory relative to total speed.
A value less than 1 gives more importance to the time spent and a
value greater than 1 gives more importance to the memory usage.</li>
<li><strong>sample_fraction</strong> (<em>float</em>) – number between 0 and 1 representing the
fraction of the input data to use in the optimization. A higher
number uses more data.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">tuned_params</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.nearest_neighbors –test-tune_flann</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.tune_flann2">
<code class="descclassname">vtool.</code><code class="descname">tune_flann2</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#tune_flann2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.tune_flann2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.understanding_pseudomax_props">
<code class="descclassname">vtool.</code><code class="descname">understanding_pseudomax_props</code><span class="sig-paren">(</span><em>mode=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#understanding_pseudomax_props"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.understanding_pseudomax_props" title="Permalink to this definition">¶</a></dt>
<dd><p>Function showing some properties of distances between normalized pseudomax vectors</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance –test-understanding_pseudomax_props</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;+---&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mode = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mode</span><span class="p">,))</span>
<span class="gp">... </span>    <span class="n">result</span> <span class="o">=</span> <span class="n">understanding_pseudomax_props</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;L___&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.uniform_sample_hypersphere">
<code class="descclassname">vtool.</code><code class="descname">uniform_sample_hypersphere</code><span class="sig-paren">(</span><em>num</em>, <em>ndim=2</em>, <em>only_quadrent_1=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#uniform_sample_hypersphere"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.uniform_sample_hypersphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Not quite done yet</p>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Regular_polytope">https://en.wikipedia.org/wiki/Regular_polytope</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Platonic_solid#Higher_dimensions">https://en.wikipedia.org/wiki/Platonic_solid#Higher_dimensions</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Cross-polytope">https://en.wikipedia.org/wiki/Cross-polytope</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>num</strong> – </li>
<li><strong>ndim</strong> (<em>int</em>) – (default = 2)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.clustering2 –test-uniform_sampe_hypersphere</dd>
<dt>Ignore:</dt>
<dd>#pip install polytope
sudo pip install cvxopt  –no-deps</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndim</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pts</span> <span class="o">=</span> <span class="n">uniform_sampe_hypersphere</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">ndim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;gx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">elif</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1">#pt.plot_surface3d(pts.T[0], pts.T[1], pts.T[2])</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fig</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">doclf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">docla</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">df2</span><span class="o">.</span><span class="n">dark_background</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.union_extents">
<code class="descclassname">vtool.</code><code class="descname">union_extents</code><span class="sig-paren">(</span><em>extents</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#union_extents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.union_extents" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.unique_row_indexes">
<code class="descclassname">vtool.</code><code class="descname">unique_row_indexes</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#unique_row_indexes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.unique_row_indexes" title="Permalink to this definition">¶</a></dt>
<dd><p>np.unique on rows</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arr</strong> (<em>ndarray</em>) – 2d array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">unique_rowx</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array">http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array</a></p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.numpy_utils –test-unique_row_indexes</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">534</span><span class="p">,</span> <span class="o">.</span><span class="mi">432</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">534</span><span class="p">,</span> <span class="o">.</span><span class="mi">432</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_rowx</span> <span class="o">=</span> <span class="n">unique_row_indexes</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;unique_rowx = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">unique_rowx</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">unique_rowx = np.array([0, 1, 2, 3, 5], dtype=np.int64)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd>%timeit unique_row_indexes(arr)
%timeit compute_unique_data_ids(arr)
%timeit compute_unique_integer_data_ids(arr)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.unique_rows">
<code class="descclassname">vtool.</code><code class="descname">unique_rows</code><span class="sig-paren">(</span><em>arr</em>, <em>directed=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#unique_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.unique_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Order or columns does not matter if directed = False</p>
</dd></dl>

<dl class="function">
<dt id="vtool.unnormalize_transform">
<code class="descclassname">vtool.</code><code class="descname">unnormalize_transform</code><span class="sig-paren">(</span><em>M_prime</em>, <em>T1</em>, <em>T2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#unnormalize_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.unnormalize_transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.unstructure_rows">
<code class="descclassname">vtool.</code><code class="descname">unstructure_rows</code><span class="sig-paren">(</span><em>*structured_arrs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#unstructure_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.unstructure_rows" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>SeeAlso:</dt>
<dd>structure_rows</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.unsupervised_multicut_labeling">
<code class="descclassname">vtool.</code><code class="descname">unsupervised_multicut_labeling</code><span class="sig-paren">(</span><em>cost_matrix</em>, <em>thresh=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#unsupervised_multicut_labeling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.unsupervised_multicut_labeling" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Notes</p>
<p>requires CPLEX</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.clustering2 unsupervised_multicut_labeling –show</dd>
</dl>
<p>Ignore:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># synthetic data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#np.random.rand(size, size)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">45</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#size = 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">443284320</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encounter_lbls</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separation</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separation</span> <span class="o">=</span> <span class="mf">1.10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">encounter_lbls</span><span class="p">,</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_match</span> <span class="o">=</span> <span class="n">grid1</span><span class="o">.</span><span class="n">T</span> <span class="o">==</span> <span class="n">grid1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">good_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">is_match</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bad_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">s_match</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix_</span><span class="p">[</span><span class="n">good_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">good_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="n">separation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix_</span><span class="p">[</span><span class="n">bad_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bad_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">-</span> <span class="n">separation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">false_val</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">-</span> <span class="n">separation</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">true_val</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span> <span class="o">+</span> <span class="n">separation</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">diag_indices_from</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="p">)]</span> <span class="o">=</span> <span class="n">true_val</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#cost_matrix_[np.diag_indices_from(cost_matrix_)] = np.inf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix</span> <span class="o">=</span> <span class="p">(</span><span class="n">cost_matrix_</span> <span class="o">-</span> <span class="n">false_val</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">true_val</span> <span class="o">-</span> <span class="n">false_val</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">cost_matrix</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">unsupervised_multicut_labeling</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">find_group_differences</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">list</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">group_items</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">encounter_lbls</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">list</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">group_items</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;diff = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">diff</span><span class="p">,))</span>
</pre></div>
</div>
<p>#gm, = ut.exec_func_src(vt.unsupervised_multicut_labeling,
#key_list=[‘gm’], sentinal=’inf = opengm’)
#parameter = opengm.InfParam()
#%timeit opengm.inference.Multicut(gm, parameter=parameter).infer()</p>
</div></blockquote>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">443284320</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">make_test_costmatrix</span><span class="p">(</span><span class="n">name_labels</span><span class="p">,</span> <span class="n">view_labels</span><span class="p">,</span> <span class="n">separation</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">is_same</span> <span class="o">=</span> <span class="n">name_labels</span> <span class="o">==</span> <span class="n">name_labels</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">is_comp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">view_labels</span> <span class="o">-</span> <span class="n">view_labels</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">good_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">is_same</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">bad_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">is_same</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">name_labels</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_labels</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span><span class="p">[</span><span class="n">good_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">good_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="n">separation</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span><span class="p">[</span><span class="n">bad_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bad_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">-</span> <span class="n">separation</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span> <span class="o">=</span> <span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">cost_matrix_</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">false_val</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">-</span> <span class="n">separation</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">true_val</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span> <span class="o">+</span> <span class="n">separation</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">diag_indices_from</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="p">)]</span> <span class="o">=</span> <span class="n">true_val</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix</span> <span class="o">=</span> <span class="p">(</span><span class="n">cost_matrix_</span> <span class="o">-</span> <span class="n">false_val</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">true_val</span> <span class="o">-</span> <span class="n">false_val</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">cost_matrix</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">is_comp</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">cost_matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#cost_matrix = make_test_costmatrix(name_labels, view_labels, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix</span> <span class="o">=</span> <span class="n">make_test_costmatrix</span><span class="p">(</span><span class="n">name_labels</span><span class="p">,</span> <span class="n">view_labels</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">multicut_value</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">name_labels</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">grid1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">name_labels</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">name_labels</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">isdiff</span> <span class="o">=</span> <span class="n">grid1</span><span class="o">.</span><span class="n">T</span> <span class="o">!=</span> <span class="n">grid1</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cut_value</span> <span class="o">=</span> <span class="n">cost_matrix</span><span class="p">[</span><span class="n">isdiff</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">cut_value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">name_labels</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">nx_from_matrix</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">floatfmt1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">map_vals</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;w=</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">floatfmt2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">map_vals</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;l=</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lens</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">map_vals</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">floatfmt1</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#labels = floatfmt2(lens)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span><span class="o">.</span><span class="n">set_edge_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#nx.set_edge_attributes(graph, name=&#39;len&#39;, values=lens)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;shape&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;ellipse&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encounter_lbls_str</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">name_labels</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node_name_lbls</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">encounter_lbls_str</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mcut_labels</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">unsupervised_multicut_labeling</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="n">vt</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">find_group_differences</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">list</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">group_items</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">name_labels</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">list</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">group_items</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">mcut_labels</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;diff = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">diff</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">node_name_lbls</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node_mcut_lbls</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">mcut_labels</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mcut_label&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">node_mcut_lbls</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mc_val(name) &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">multicut_value</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">name_labels</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mc_val(mcut) &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">multicut_value</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">mcut_labels</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">color_nodes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;mcut_label&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># remove noncomparable edges</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_comp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">view_labels</span> <span class="o">-</span> <span class="n">view_labels</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noncomp_edges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">is_comp</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="o">.</span><span class="n">remove_edges_from</span><span class="p">(</span><span class="n">noncomp_edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layoutkw</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;sep&#39;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;prog&#39;</span><span class="p">:</span> <span class="s1">&#39;neato&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;overlap&#39;</span><span class="p">:</span> <span class="s1">&#39;false&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;splines&#39;</span><span class="p">:</span> <span class="s1">&#39;spline&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_nx</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">layoutkw</span><span class="o">=</span><span class="n">layoutkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.verts_from_bbox">
<code class="descclassname">vtool.</code><code class="descname">verts_from_bbox</code><span class="sig-paren">(</span><em>bbox</em>, <em>close=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#verts_from_bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.verts_from_bbox" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bbox</strong> (<em>tuple</em>) – bounding box in the format (x, y, w, h)</li>
<li><strong>close</strong> (<em>bool</em>) – (default = False)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">verts</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.geometry –test-verts_from_bbox</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">close</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="n">verts_from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">close</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;verts = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">verts</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">verts = ((10, 10), (60, 10), (60, 60), (10, 60))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.verts_list_from_bboxes_list">
<code class="descclassname">vtool.</code><code class="descname">verts_list_from_bboxes_list</code><span class="sig-paren">(</span><em>bboxes_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#verts_list_from_bboxes_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.verts_list_from_bboxes_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a four-vertex polygon from the bounding rectangle</p>
</dd></dl>

<dl class="function">
<dt id="vtool.warpAffine">
<code class="descclassname">vtool.</code><code class="descname">warpAffine</code><span class="sig-paren">(</span><em>img</em>, <em>Aff</em>, <em>dsize</em>, <em>assume_float01=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#warpAffine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.warpAffine" title="Permalink to this definition">¶</a></dt>
<dd><p>dsize = (width, height) of return image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</li>
<li><strong>Aff</strong> (<em>ndarray</em>) – affine matrix</li>
<li><strong>dsize</strong> (<em>tuple</em>) – width, height</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">warped_img</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image –test-warpAffine –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rotation_mat3x3</span><span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warped_img</span> <span class="o">=</span> <span class="n">warpAffine</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">Aff</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">warped_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Timeit:</dt>
<dd><p class="first">import skimage.transform
%timeit cv2.warpAffine(img, Aff[0:2], tuple(dsize), <a href="#id19"><span class="problematic" id="id20">**</span></a>CV2_WARP_KWARGS)
100 loops, best of 3: 7.95 ms per loop
skimage.transform.AffineTransform
tf = skimage.transform.AffineTransform(rotation=TAU / 8)
<a href="#id201"><span class="problematic" id="id202">Aff_</span></a> = tf.params
out = skimage.transform._warps_cy._warp_fast(img[:, :, 0], <a href="#id203"><span class="problematic" id="id204">Aff_</span></a>, output_shape=dsize, mode=’constant’, order=1)
%timeit skimage.transform._warps_cy._warp_fast(img[:, :, 0], <a href="#id205"><span class="problematic" id="id206">Aff_</span></a>, output_shape=dsize, mode=’constant’, order=1)
100 loops, best of 3: 5.74 ms per loop
%timeit cv2.warpAffine(img[:, :, 0], Aff[0:2], tuple(dsize), <a href="#id21"><span class="problematic" id="id22">**</span></a>CV2_WARP_KWARGS)
100 loops, best of 3: 5.13 ms per loop</p>
<p class="last">CONCLUSION, cv2 transforms are better</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.warpHomog">
<code class="descclassname">vtool.</code><code class="descname">warpHomog</code><span class="sig-paren">(</span><em>img</em>, <em>Homog</em>, <em>dsize</em>, <em>assume_float01=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#warpHomog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.warpHomog" title="Permalink to this definition">¶</a></dt>
<dd><p>dsize = (width, height) of return image</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Homog</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warped_img</span> <span class="o">=</span> <span class="n">warpHomog</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">Homog</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.weighted_average_scoring">
<code class="descclassname">vtool.</code><code class="descname">weighted_average_scoring</code><span class="sig-paren">(</span><em>fsv</em>, <em>weight_filtxs</em>, <em>nonweight_filtxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#weighted_average_scoring"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.weighted_average_scoring" title="Permalink to this definition">¶</a></dt>
<dd><p>does frac{sum_i w^f_i * w^d_i * r_i}{sum_i w^f_i, w^d_i}
to get a weighed average of ratio scores</p>
<p>If we normalize the weight part to add to 1 then we can get per-feature
scores.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Weighted_arithmetic_mean">http://en.wikipedia.org/wiki/Weighted_arithmetic_mean</a></p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.82992172</span><span class="p">,</span>  <span class="mf">1.56136119</span><span class="p">,</span>  <span class="mf">0.66465378</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.8000412</span> <span class="p">,</span>  <span class="mf">2.14719748</span><span class="p">,</span>  <span class="mf">1.</span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.80848503</span><span class="p">,</span>  <span class="mf">2.6816361</span> <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.86761665</span><span class="p">,</span>  <span class="mf">2.70189977</span><span class="p">,</span>  <span class="mf">1.</span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.8004055</span> <span class="p">,</span>  <span class="mf">1.58753884</span><span class="p">,</span>  <span class="mf">0.92178345</span><span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weight_filtxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nonweight_filtxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_fs</span> <span class="o">=</span> <span class="n">weighted_average_scoring</span><span class="p">(</span><span class="n">fsv</span><span class="p">,</span> <span class="n">weight_filtxs</span><span class="p">,</span> <span class="n">nonweight_filtxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">new_fs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.weighted_geometic_mean">
<code class="descclassname">vtool.</code><code class="descname">weighted_geometic_mean</code><span class="sig-paren">(</span><em>data</em>, <em>weights</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#weighted_geometic_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.weighted_geometic_mean" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>list of ndarrays</em>) – </li>
<li><strong>weights</strong> (<em>ndarray</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a href="#id207"><span class="problematic" id="id208">gmean_</span></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –test-weighted_geometic_mean</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Weighted_geometric_mean">https://en.wikipedia.org/wiki/Weighted_geometric_mean</a></p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>scipy.stats.mstats.gmean</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gmean_</span> <span class="o">=</span> <span class="n">weighted_geometic_mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;gmean_ = </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gmean_</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">gmean_ = 0.740</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gmean_</span> <span class="o">=</span> <span class="n">weighted_geometic_mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;gmean_ = &#39;</span><span class="p">,</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">gmean_</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd>res1 = ((img1 ** .5 * img2 ** .5)) ** 1
res2 = np.sqrt(img1 * img2)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.weighted_geometic_mean_unnormalized">
<code class="descclassname">vtool.</code><code class="descname">weighted_geometic_mean_unnormalized</code><span class="sig-paren">(</span><em>data</em>, <em>weights</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#weighted_geometic_mean_unnormalized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.weighted_geometic_mean_unnormalized" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.whiten_xy_points">
<code class="descclassname">vtool.</code><code class="descname">whiten_xy_points</code><span class="sig-paren">(</span><em>xy_m</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#whiten_xy_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.whiten_xy_points" title="Permalink to this definition">¶</a></dt>
<dd><p>whitens points to mean=0, stddev=1 and returns transformation</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool</span> <span class="k">import</span> <span class="n">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_m</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_xy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">whiten_xy_points</span><span class="p">(</span><span class="n">xy_m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_norm</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">tup</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.wrap_histogram">
<code class="descclassname">vtool.</code><code class="descname">wrap_histogram</code><span class="sig-paren">(</span><em>hist_</em>, <em>edges_</em>, <em>_debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#wrap_histogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.wrap_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulates the first and last histogram bin being being adjacent to one another
by replicating those bins at the last and first positions respectively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hist</strong> (<em>ndarray</em>) – </li>
<li><strong>edges</strong> (<em>ndarray</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(hist_wrap, edge_wrap)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram –test-wrap_histogram</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">8.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">34.32</span><span class="p">,</span> <span class="mf">29.45</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.78539816</span><span class="p">,</span>  <span class="mf">1.57079633</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="mf">2.35619449</span><span class="p">,</span>  <span class="mf">3.14159265</span><span class="p">,</span>  <span class="mf">3.92699081</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="mf">4.71238898</span><span class="p">,</span>  <span class="mf">5.49778714</span><span class="p">,</span>  <span class="mf">6.2831853</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">hist_wrap</span><span class="p">,</span> <span class="n">edge_wrap</span><span class="p">)</span> <span class="o">=</span> <span class="n">wrap_histogram</span><span class="p">(</span><span class="n">hist_</span><span class="p">,</span> <span class="n">edges_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">hist_wrap</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">edge_wrap</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[6.73, 8.00, 0.00, 0.00, 34.32, 29.45, 0.00, 0.00, 6.73, 8.00],</span>
<span class="go">[-0.79, 0.00, 0.79, 1.57, 2.36, 3.14, 3.93, 4.71, 5.50, 6.28, 7.07],</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.wrapped_distance">
<code class="descclassname">vtool.</code><code class="descname">wrapped_distance</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em>, <em>base</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#wrapped_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.wrapped_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>base = TAU corresponds to ori diff</p>
</dd></dl>

<dl class="function">
<dt id="vtool.zipcat">
<code class="descclassname">vtool.</code><code class="descname">zipcat</code><span class="sig-paren">(</span><em>arr1_list</em>, <em>arr2_list</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#zipcat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.zipcat" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr1_list</strong> (<em>list</em>) – </li>
<li><strong>arr2_list</strong> (<em>list</em>) – </li>
<li><strong>axis</strong> (<em>None</em>) – (default = None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other –exec-zipcat –show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_list</span> <span class="o">=</span> <span class="n">zipcat</span><span class="p">(</span><span class="n">arr1_list</span><span class="p">,</span> <span class="n">arr2_list</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_list0</span> <span class="o">=</span> <span class="n">zipcat</span><span class="p">(</span><span class="n">arr1_list</span><span class="p">,</span> <span class="n">arr2_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_list1</span> <span class="o">=</span> <span class="n">zipcat</span><span class="p">(</span><span class="n">arr1_list</span><span class="p">,</span> <span class="n">arr2_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_list2</span> <span class="o">=</span> <span class="n">zipcat</span><span class="p">(</span><span class="n">arr1_list</span><span class="p">,</span> <span class="n">arr2_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr3_list = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">(</span><span class="n">arr3_list</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr3_list0 = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">(</span><span class="n">arr3_list0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr3_list2 = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">(</span><span class="n">arr3_list2</span><span class="p">),))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.zipcompress">
<code class="descclassname">vtool.</code><code class="descname">zipcompress</code><span class="sig-paren">(</span><em>arr_list</em>, <em>flags_list</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#zipcompress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.zipcompress" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.zipcompress_safe">
<code class="descclassname">vtool.</code><code class="descname">zipcompress_safe</code><span class="sig-paren">(</span><em>arr_list</em>, <em>flags_list</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#zipcompress_safe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.zipcompress_safe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ziptake">
<code class="descclassname">vtool.</code><code class="descname">ziptake</code><span class="sig-paren">(</span><em>arr_list</em>, <em>indices_list</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#ziptake"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ziptake" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.zstar_value">
<code class="descclassname">vtool.</code><code class="descname">zstar_value</code><span class="sig-paren">(</span><em>conf_level=0.95</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#zstar_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.zstar_value" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/28242593/correct-way-to-obtain-confidence-interval-with-scipy">http://stackoverflow.com/questions/28242593/correct-way-to-obtain-confidence-interval-with-scipy</a></p>
</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">wbia-vtool</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">vtool package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.__main__">vtool.__main__ module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vtool-grave-module">vtool._grave module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool._old_matching">vtool._old_matching module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool._pyflann_backend">vtool._pyflann_backend module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool._rhomb_dist">vtool._rhomb_dist module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.blend">vtool.blend module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.chip">vtool.chip module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.clustering2">vtool.clustering2 module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.confusion">vtool.confusion module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.coverage_grid">vtool.coverage_grid module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.coverage_kpts">vtool.coverage_kpts module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.demodata">vtool.demodata module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.depricated">vtool.depricated module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.distance">vtool.distance module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.ellipse">vtool.ellipse module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.exif">vtool.exif module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.features">vtool.features module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.fontdemo">vtool.fontdemo module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.geometry">vtool.geometry module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.histogram">vtool.histogram module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.image">vtool.image module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.image_filters">vtool.image_filters module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.image_shared">vtool.image_shared module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.inspect_matches">vtool.inspect_matches module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.keypoint">vtool.keypoint module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.linalg">vtool.linalg module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.matching">vtool.matching module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.nearest_neighbors">vtool.nearest_neighbors module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.numpy_utils">vtool.numpy_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.other">vtool.other module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.patch">vtool.patch module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.quality_classifier">vtool.quality_classifier module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.score_normalization">vtool.score_normalization module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.segmentation">vtool.segmentation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.spatial_verification">vtool.spatial_verification module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vtool-sver-c-wrapper-module">vtool.sver_c_wrapper module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.symbolic">vtool.symbolic module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.trig">vtool.trig module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.util_math">vtool.util_math module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool">Module contents</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to vtool’s documentation!</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Wild Me.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/vtool.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>