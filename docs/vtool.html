<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>vtool package &mdash; wbia-vtool 4.0.2.dev2+dirty documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to vtool’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> wbia-vtool
          </a>
              <div class="version">
                4.0.2.dev2+dirty
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">vtool package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.__main__">vtool.__main__ module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool._grave">vtool._grave module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool._old_matching">vtool._old_matching module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool._pyflann_backend">vtool._pyflann_backend module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool._rhomb_dist">vtool._rhomb_dist module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.blend">vtool.blend module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.chip">vtool.chip module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.clustering2">vtool.clustering2 module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.confusion">vtool.confusion module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.coverage_grid">vtool.coverage_grid module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.coverage_kpts">vtool.coverage_kpts module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.demodata">vtool.demodata module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.depricated">vtool.depricated module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.distance">vtool.distance module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.ellipse">vtool.ellipse module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.exif">vtool.exif module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.features">vtool.features module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.fontdemo">vtool.fontdemo module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.geometry">vtool.geometry module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.histogram">vtool.histogram module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.image">vtool.image module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.image_filters">vtool.image_filters module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.image_shared">vtool.image_shared module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.inspect_matches">vtool.inspect_matches module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.keypoint">vtool.keypoint module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.linalg">vtool.linalg module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.matching">vtool.matching module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.nearest_neighbors">vtool.nearest_neighbors module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.numpy_utils">vtool.numpy_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.other">vtool.other module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.patch">vtool.patch module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.quality_classifier">vtool.quality_classifier module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.score_normalization">vtool.score_normalization module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.segmentation">vtool.segmentation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.spatial_verification">vtool.spatial_verification module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.sver_c_wrapper">vtool.sver_c_wrapper module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.symbolic">vtool.symbolic module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.trig">vtool.trig module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.util_math">vtool.util_math module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">wbia-vtool</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>vtool package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/vtool.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="vtool-package">
<h1>vtool package<a class="headerlink" href="#vtool-package" title="Permalink to this headline"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline"></a></h2>
</section>
<section id="module-vtool.__main__">
<span id="vtool-main-module"></span><h2>vtool.__main__ module<a class="headerlink" href="#module-vtool.__main__" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.__main__.main">
<span class="sig-prename descclassname"><span class="pre">vtool.__main__.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/__main__.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.__main__.main" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool._grave">
<span id="vtool-grave-module"></span><h2>vtool._grave module<a class="headerlink" href="#module-vtool._grave" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vtool._grave.MultiMatchInspector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool._grave.</span></span><span class="sig-name descname"><span class="pre">MultiMatchInspector</span></span><a class="reference internal" href="_modules/vtool/_grave.html#MultiMatchInspector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool._grave.MultiMatchInspector" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vtool._grave.MultiMatchInspector.edge_doubleclick">
<span class="sig-name descname"><span class="pre">edge_doubleclick</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qtindex</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/_grave.html#MultiMatchInspector.edge_doubleclick"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool._grave.MultiMatchInspector.edge_doubleclick" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool._grave.MultiMatchInspector.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matches</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/_grave.html#MultiMatchInspector.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool._grave.MultiMatchInspector.initialize" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool._grave.MultiMatchInspector.populate_edge_model">
<span class="sig-name descname"><span class="pre">populate_edge_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/_grave.html#MultiMatchInspector.populate_edge_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool._grave.MultiMatchInspector.populate_edge_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtool._grave.ScoreNormalizerUnsupervised">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool._grave.</span></span><span class="sig-name descname"><span class="pre">ScoreNormalizerUnsupervised</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/_grave.html#ScoreNormalizerUnsupervised"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool._grave.ScoreNormalizerUnsupervised" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vtool._grave.ScoreNormalizerUnsupervised.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/_grave.html#ScoreNormalizerUnsupervised.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool._grave.ScoreNormalizerUnsupervised.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits estimator to data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool._grave.ScoreNormalizerUnsupervised.learn_probabilities">
<span class="sig-name descname"><span class="pre">learn_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/_grave.html#ScoreNormalizerUnsupervised.learn_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool._grave.ScoreNormalizerUnsupervised.learn_probabilities" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool._grave.ScoreNormalizerUnsupervised.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vtool._grave.ScoreNormalizerUnsupervised.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool._grave.ScoreNormalizerUnsupervised.visualize">
<span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/_grave.html#ScoreNormalizerUnsupervised.visualize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool._grave.ScoreNormalizerUnsupervised.visualize" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool._grave.bow_test">
<span class="sig-prename descclassname"><span class="pre">vtool._grave.</span></span><span class="sig-name descname"><span class="pre">bow_test</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/_grave.html#bow_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool._grave.bow_test" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool._grave.match_inspect_graph">
<span class="sig-prename descclassname"><span class="pre">vtool._grave.</span></span><span class="sig-name descname"><span class="pre">match_inspect_graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/_grave.html#match_inspect_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool._grave.match_inspect_graph" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.inspect_matches match_inspect_graph –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.inspect_matches</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.guitool</span> <span class="k">as</span> <span class="nn">gt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">ensure_qapp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">qtensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">match_inspect_graph</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">qtapp_loop</span><span class="p">(</span><span class="n">qwin</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-vtool._old_matching">
<span id="vtool-old-matching-module"></span><h2>vtool._old_matching module<a class="headerlink" href="#module-vtool._old_matching" title="Permalink to this headline"></a></h2>
</section>
<section id="module-vtool._pyflann_backend">
<span id="vtool-pyflann-backend-module"></span><h2>vtool._pyflann_backend module<a class="headerlink" href="#module-vtool._pyflann_backend" title="Permalink to this headline"></a></h2>
<p>abstract which pyflann implementation is used</p>
<p>from vtool._pyflann_backend import pyflann</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtool._pyflann_backend.FLANN_CLS">
<span class="sig-prename descclassname"><span class="pre">vtool._pyflann_backend.</span></span><span class="sig-name descname"><span class="pre">FLANN_CLS</span></span><a class="headerlink" href="#vtool._pyflann_backend.FLANN_CLS" title="Permalink to this definition"></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">pyflann.index.FLANN</span></code></p>
</dd></dl>

</section>
<section id="module-vtool._rhomb_dist">
<span id="vtool-rhomb-dist-module"></span><h2>vtool._rhomb_dist module<a class="headerlink" href="#module-vtool._rhomb_dist" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtool._rhomb_dist.RhombicuboctahedronDistanceDemo">
<span class="sig-prename descclassname"><span class="pre">vtool._rhomb_dist.</span></span><span class="sig-name descname"><span class="pre">RhombicuboctahedronDistanceDemo</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/_rhomb_dist.html#RhombicuboctahedronDistanceDemo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool._rhomb_dist.RhombicuboctahedronDistanceDemo" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool.blend">
<span id="vtool-blend-module"></span><h2>vtool.blend module<a class="headerlink" href="#module-vtool.blend" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.blend.blend_images">
<span class="sig-prename descclassname"><span class="pre">vtool.blend.</span></span><span class="sig-name descname"><span class="pre">blend_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'average'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.blend.blend_images" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img1</strong> (<em>np.ndarray</em>) – first image</p></li>
<li><p><strong>img2</strong> (<em>np.ndarray</em>) – second image</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – can be average, multiply, or overlay</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.blend.blend_images_average">
<span class="sig-prename descclassname"><span class="pre">vtool.blend.</span></span><span class="sig-name descname"><span class="pre">blend_images_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.blend.blend_images_average" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – (default = 0.5)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>imgB</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.blend blend_images_average:0 –show
python -m vtool.blend blend_images_average:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_average</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">blend_images_average</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s1">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="s1">&#39;alpha=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.blend.blend_images_average_stack">
<span class="sig-prename descclassname"><span class="pre">vtool.blend.</span></span><span class="sig-name descname"><span class="pre">blend_images_average_stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_average_stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.blend.blend_images_average_stack" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – (default = 0.5)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>imgB</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.blend –test-blend_images_average:0 –show
python -m vtool.blend –test-blend_images_average:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_average</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.blend.blend_images_mult_average">
<span class="sig-prename descclassname"><span class="pre">vtool.blend.</span></span><span class="sig-name descname"><span class="pre">blend_images_mult_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_mult_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.blend.blend_images_mult_average" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – (default = 0.5)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>imgB</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.blend –test-blend_images_mult_average:0 –show
python -m vtool.blend –test-blend_images_mult_average:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_mult_average</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">blend_images_mult_average</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s1">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="s1">&#39;alpha=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.blend.blend_images_multiply">
<span class="sig-prename descclassname"><span class="pre">vtool.blend.</span></span><span class="sig-name descname"><span class="pre">blend_images_multiply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_multiply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.blend.blend_images_multiply" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – (default = 0.5)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>imgB</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.blend –test-blend_images_multiply:0 –show
python -m vtool.blend –test-blend_images_multiply:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_multiply</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">blend_images_multiply</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s1">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="s1">&#39;alpha=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.blend.ensure_alpha_channel">
<span class="sig-prename descclassname"><span class="pre">vtool.blend.</span></span><span class="sig-name descname"><span class="pre">ensure_alpha_channel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#ensure_alpha_channel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.blend.ensure_alpha_channel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.blend.ensure_grayscale">
<span class="sig-prename descclassname"><span class="pre">vtool.blend.</span></span><span class="sig-name descname"><span class="pre">ensure_grayscale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorspace_hint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BGR'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#ensure_grayscale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.blend.ensure_grayscale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.blend.gamma_adjust">
<span class="sig-prename descclassname"><span class="pre">vtool.blend.</span></span><span class="sig-name descname"><span class="pre">gamma_adjust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#gamma_adjust"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.blend.gamma_adjust" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.blend –test-gamma_adjust:0 –show</p>
</dd>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">gamma_adjust</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_float01</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">img</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s1">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="s1">&#39;gamma=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.blend.gridsearch_addWeighted">
<span class="sig-prename descclassname"><span class="pre">vtool.blend.</span></span><span class="sig-name descname"><span class="pre">gridsearch_addWeighted</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#gridsearch_addWeighted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.blend.gridsearch_addWeighted" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/blend.py gridsearch_addWeighted</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.blend.gridsearch_image_function">
<span class="sig-prename descclassname"><span class="pre">vtool.blend.</span></span><span class="sig-name descname"><span class="pre">gridsearch_image_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#gridsearch_image_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.blend.gridsearch_image_function" title="Permalink to this definition"></a></dt>
<dd><p>gridsearch for a function that produces a single image</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.blend.overlay_alpha_images">
<span class="sig-prename descclassname"><span class="pre">vtool.blend.</span></span><span class="sig-name descname"><span class="pre">overlay_alpha_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#overlay_alpha_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.blend.overlay_alpha_images" title="Permalink to this definition"></a></dt>
<dd><p>places img1 on top of img2 respecting alpha channels</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/25182421/overlay-numpy-alpha">http://stackoverflow.com/questions/25182421/overlay-numpy-alpha</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.blend.testdata_blend">
<span class="sig-prename descclassname"><span class="pre">vtool.blend.</span></span><span class="sig-name descname"><span class="pre">testdata_blend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#testdata_blend"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.blend.testdata_blend" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool.chip">
<span id="vtool-chip-module"></span><h2>vtool.chip module<a class="headerlink" href="#module-vtool.chip" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vtool.chip.ScaleStrat">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.chip.</span></span><span class="sig-name descname"><span class="pre">ScaleStrat</span></span><a class="reference internal" href="_modules/vtool/chip.html#ScaleStrat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.chip.ScaleStrat" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Scaling strategies</p>
<dl class="py method">
<dt class="sig sig-object py" id="vtool.chip.ScaleStrat.area">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig_wh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#ScaleStrat.area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.chip.ScaleStrat.area" title="Permalink to this definition"></a></dt>
<dd><p>The area becomes target</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – target size</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="mi">800</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">)),</span> <span class="p">(</span><span class="mi">743</span><span class="p">,</span> <span class="mi">861</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="mi">800</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">190</span><span class="p">)),</span> <span class="p">(</span><span class="mi">861</span><span class="p">,</span> <span class="mi">743</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.chip.ScaleStrat.maxwh">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">maxwh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig_wh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#ScaleStrat.maxwh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.chip.ScaleStrat.maxwh" title="Permalink to this definition"></a></dt>
<dd><p>The maximum dimension becomes target</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – target size</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">maxwh</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="p">(</span><span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">)),</span> <span class="p">(</span><span class="mi">691</span><span class="p">,</span> <span class="mi">800</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">maxwh</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">190</span><span class="p">)),</span> <span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">691</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.chip.ScaleStrat.width">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">width</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig_wh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#ScaleStrat.width"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.chip.ScaleStrat.width" title="Permalink to this definition"></a></dt>
<dd><p>The width becomes target</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – target size</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="p">(</span><span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">)),</span> <span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">926</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">190</span><span class="p">)),</span> <span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">691</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.chip.apply_filter_funcs">
<span class="sig-prename descclassname"><span class="pre">vtool.chip.</span></span><span class="sig-name descname"><span class="pre">apply_filter_funcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chipBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_funcs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#apply_filter_funcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.chip.apply_filter_funcs" title="Permalink to this definition"></a></dt>
<dd><p>applies a list of preprocessing filters to a chip</p>
<p>DEPRICATE</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.chip.compute_chip">
<span class="sig-prename descclassname"><span class="pre">vtool.chip.</span></span><span class="sig-name descname"><span class="pre">compute_chip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gfpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#compute_chip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.chip.compute_chip" title="Permalink to this definition"></a></dt>
<dd><p>Extracts a chip and applies filters</p>
<p>DEPRICATE</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gfpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – image file path string</p></li>
<li><p><strong>bbox</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – bounding box in the format (x, y, w, h)</p></li>
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – angle in radians</p></li>
<li><p><strong>new_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – must maintain the same aspect ratio or else you will get weirdness</p></li>
<li><p><strong>filter_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>chipBGR -  cropped image</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.chip –test-compute_chip –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="n">TAU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gfpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filter_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR</span> <span class="o">=</span> <span class="n">compute_chip</span><span class="p">(</span><span class="n">gfpath</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">new_size</span><span class="p">,</span> <span class="n">filter_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">chipBGR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_size</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;did not resize correctly&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">draw_verts</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">gfpath</span><span class="p">),</span> <span class="n">vt</span><span class="o">.</span><span class="n">scaled_verts_from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.chip.extract_chip_from_gpath">
<span class="sig-prename descclassname"><span class="pre">vtool.chip.</span></span><span class="sig-name descname"><span class="pre">extract_chip_from_gpath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gfpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_from_gpath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.chip.extract_chip_from_gpath" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.chip.extract_chip_from_gpath_into_square">
<span class="sig-prename descclassname"><span class="pre">vtool.chip.</span></span><span class="sig-name descname"><span class="pre">extract_chip_from_gpath_into_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_from_gpath_into_square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.chip.extract_chip_from_gpath_into_square" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.chip.extract_chip_from_img">
<span class="sig-prename descclassname"><span class="pre">vtool.chip.</span></span><span class="sig-name descname"><span class="pre">extract_chip_from_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_from_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.chip.extract_chip_from_img" title="Permalink to this definition"></a></dt>
<dd><p>Crops chip from image ; Rotates and scales;</p>
<p>ibs.show_annot_image(aid)[0].pt_save_and_view()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gfpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – </p></li>
<li><p><strong>bbox</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – xywh</p></li>
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
<li><p><strong>new_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – wy</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>chipBGR</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.chip –test-extract_chip_from_img
python -m vtool.chip –test-extract_chip_from_img –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">gtool</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">58</span><span class="p">,</span> <span class="mi">34</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR</span> <span class="o">=</span> <span class="n">extract_chip_from_img</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">new_size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">chipBGR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_size</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;did not resize correctly&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.chip.extract_chip_into_square">
<span class="sig-prename descclassname"><span class="pre">vtool.chip.</span></span><span class="sig-name descname"><span class="pre">extract_chip_into_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_into_square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.chip.extract_chip_into_square" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.chip.get_extramargin_measures">
<span class="sig-prename descclassname"><span class="pre">vtool.chip.</span></span><span class="sig-name descname"><span class="pre">get_extramargin_measures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox_gs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halfoffset_ms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(64,</span> <span class="pre">64)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#get_extramargin_measures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.chip.get_extramargin_measures" title="Permalink to this definition"></a></dt>
<dd><p>Computes a detection chip with a bit of spatial context so the detection
algorithm doesn’t clip boundaries</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>mbbox_gs, margin_size -</dt><dd><p>margin bounding box in image size,
size of entire margined chip,</p>
</dd>
</dl>
</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.chip –test-get_extramargin_measures –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gfpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox_gs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="mf">.15</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">halfoffset_ms</span> <span class="o">=</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mbbox_gs</span><span class="p">,</span> <span class="n">margin_size</span> <span class="o">=</span> <span class="n">get_extramargin_measures</span><span class="p">(</span><span class="n">bbox_gs</span><span class="p">,</span> <span class="n">new_size</span><span class="p">,</span> <span class="n">halfoffset_ms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">testshow_extramargin_info</span><span class="p">(</span><span class="n">gfpath</span><span class="p">,</span> <span class="n">bbox_gs</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">new_size</span><span class="p">,</span> <span class="n">halfoffset_ms</span><span class="p">,</span> <span class="n">mbbox_gs</span><span class="p">,</span> <span class="n">margin_size</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.chip.get_image_to_chip_transform">
<span class="sig-prename descclassname"><span class="pre">vtool.chip.</span></span><span class="sig-name descname"><span class="pre">get_image_to_chip_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chipsz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#get_image_to_chip_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.chip.get_image_to_chip_transform" title="Permalink to this definition"></a></dt>
<dd><p>transforms image space into chipspace</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<em>bbox   - bounding box of chip in image</em>) – </p></li>
<li><p><strong>chip</strong> (<em>chipsz - size of the</em>) – </p></li>
<li><p><strong>box</strong> (<em>theta  - rotation of the bounding</em>) – </p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy.abc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">theta</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">target_area</span>  <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y w h, a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gx</span><span class="p">,</span> <span class="n">gy</span>  <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;gx, gy&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">floor</span>  <span class="c1"># hack</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ht</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">target_area</span> <span class="o">*</span> <span class="n">h</span> <span class="o">/</span> <span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wt</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">ht</span> <span class="o">/</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cw_</span><span class="p">,</span> <span class="n">ch_</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">wt</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">ht</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool</span> <span class="kn">import</span> <span class="n">ltool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T1</span> <span class="o">=</span> <span class="n">ltool</span><span class="o">.</span><span class="n">translation_mat3x3</span><span class="p">(</span><span class="n">tx1</span><span class="p">,</span> <span class="n">ty1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span>  <span class="o">=</span> <span class="n">ltool</span><span class="o">.</span><span class="n">scale_mat3x3</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span>  <span class="o">=</span> <span class="n">ltool</span><span class="o">.</span><span class="n">rotation_mat3x3</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">,</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T2</span> <span class="o">=</span> <span class="n">ltool</span><span class="o">.</span><span class="n">translation_mat3x3</span><span class="p">(</span><span class="n">tx2</span><span class="p">,</span> <span class="n">ty2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">add_matmul_hold_prop</span><span class="p">(</span><span class="n">mat</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1">#import functools</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">mat</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">matmul_hold</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">new</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">MatMul</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="n">hold</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">return</span> <span class="n">new</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">setattr</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="s1">&#39;matmul_hold&#39;</span><span class="p">,</span> <span class="n">matmul_hold</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">mat</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T1</span> <span class="o">=</span> <span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">T1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T2</span> <span class="o">=</span> <span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">T2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">T2</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">T1</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.chip.get_scaled_size_with_dlen">
<span class="sig-prename descclassname"><span class="pre">vtool.chip.</span></span><span class="sig-name descname"><span class="pre">get_scaled_size_with_dlen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dlen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#get_scaled_size_with_dlen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.chip.get_scaled_size_with_dlen" title="Permalink to this definition"></a></dt>
<dd><p>returns new_size which scales (w, h) as close to target_dlen as possible
and maintains aspect ratio</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.chip.gridsearch_chipextract">
<span class="sig-prename descclassname"><span class="pre">vtool.chip.</span></span><span class="sig-name descname"><span class="pre">gridsearch_chipextract</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#gridsearch_chipextract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.chip.gridsearch_chipextract" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/chip.py gridsearch_chipextract –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_chipextract</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.chip.testshow_extramargin_info">
<span class="sig-prename descclassname"><span class="pre">vtool.chip.</span></span><span class="sig-name descname"><span class="pre">testshow_extramargin_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gfpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_gs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halfoffset_ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mbbox_gs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">margin_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#testshow_extramargin_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.chip.testshow_extramargin_info" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool.clustering2">
<span id="vtool-clustering2-module"></span><h2>vtool.clustering2 module<a class="headerlink" href="#module-vtool.clustering2" title="Permalink to this headline"></a></h2>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Does HDBSCAN work on 128 dim vectors?
<a class="reference external" href="http://nbviewer.jupyter.org/github/lmcinnes/hdbscan/blob/master/notebooks/Comparing%20Clustering%20Algorithms.ipynb">http://nbviewer.jupyter.org/github/lmcinnes/hdbscan/blob/master/notebooks/Comparing%20Clustering%20Algorithms.ipynb</a></p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="vtool.clustering2.AnnoyWraper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">AnnoyWraper</span></span><a class="reference internal" href="_modules/vtool/clustering2.html#AnnoyWraper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.AnnoyWraper" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>flann-like interface to annnoy</p>
<dl class="py method">
<dt class="sig sig-object py" id="vtool.clustering2.AnnoyWraper.build_annoy">
<span class="sig-name descname"><span class="pre">build_annoy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centroids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#AnnoyWraper.build_annoy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.AnnoyWraper.build_annoy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.clustering2.AnnoyWraper.nn">
<span class="sig-name descname"><span class="pre">nn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_vecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_vecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#AnnoyWraper.nn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.AnnoyWraper.nn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.clustering2.AnnoyWraper.query_annoy">
<span class="sig-name descname"><span class="pre">query_annoy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_vecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#AnnoyWraper.query_annoy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.AnnoyWraper.query_annoy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.apply_grouping">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">apply_grouping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.apply_grouping" title="Permalink to this definition"></a></dt>
<dd><p>applies grouping from group_indicies
apply_grouping</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>items</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>groupxs</strong> (<em>list of ndarrays</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>grouped items</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of ndarrays</p>
</dd>
</dl>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>group_indices
invert_apply_grouping</p>
</dd>
<dt>CommandLine:</dt><dd><p>python -m vtool.clustering2 –test-apply_grouping</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_items</span> <span class="o">=</span> <span class="n">apply_grouping</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">grouped_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[array([8, 5, 6]), array([1, 5, 8, 7]), array([5, 3, 0, 9])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.apply_grouping_">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">apply_grouping_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupxs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.apply_grouping_" title="Permalink to this definition"></a></dt>
<dd><p>non-optimized version</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.apply_grouping_iter">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">apply_grouping_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupxs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping_iter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.apply_grouping_iter" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.apply_grouping_iter2">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">apply_grouping_iter2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupxs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping_iter2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.apply_grouping_iter2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.apply_jagged_grouping">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">apply_jagged_grouping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unflat_items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupxs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_jagged_grouping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.apply_jagged_grouping" title="Permalink to this definition"></a></dt>
<dd><p>takes unflat_list and flat group indices. Returns the unflat grouping</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.example_binary">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">example_binary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#example_binary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.example_binary" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.find_duplicate_items">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">find_duplicate_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item_arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#find_duplicate_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.find_duplicate_items" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>item_arr</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>duplicate_items</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><p>?</p>
</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.clustering2 –test-find_duplicate_items</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/21888406/getting-the-indexes-to-the-duplicate-columns-of-a-numpy-array">http://stackoverflow.com/questions/21888406/getting-the-indexes-to-the-duplicate-columns-of-a-numpy-array</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">duplicate_items</span> <span class="o">=</span> <span class="n">find_duplicate_items</span><span class="p">(</span><span class="n">item_arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">duplicate_items</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="n">six</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">find_duplicate_items</span><span class="p">(</span><span class="n">item_arr</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">duplicate_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[9, 67, 87, 88]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.group_indices">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">group_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx2_groupid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#group_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.group_indices" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>idx2_groupid</strong> (<em>ndarray</em>) – numpy array of group ids (must be numeric)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(keys, groupxs)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a> (ndarray, list of ndarrays)</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/clustering2.py group_indices
xdoctest -m ~/code/vtool/vtool/clustering2.py group_indices:0
xdoctest -m ~/code/vtool/vtool/clustering2.py group_indices:1</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([1, 2, 3], dtype=np.int64),</span>
<span class="go">[</span>
<span class="go">    np.array([1, 3, 5], dtype=np.int64),</span>
<span class="go">    np.array([0, 2, 4, 6], dtype=np.int64),</span>
<span class="go">    np.array([ 7,  8,  9, 10], dtype=np.int64),</span>
<span class="go">],</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mi">24</span><span class="p">],</span> <span class="p">[</span> <span class="mi">129</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">24</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span><span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">822</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span><span class="mi">24</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2d arrays must be flattened before coming into this function so</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># information is on the last axis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([ 24, 129, 659, 822], dtype=np.int64),</span>
<span class="go">[</span>
<span class="go">    np.array([ 0,  4, 10], dtype=np.int64),</span>
<span class="go">    np.array([1], dtype=np.int64),</span>
<span class="go">    np.array([2, 3, 5, 6, 8, 9], dtype=np.int64),</span>
<span class="go">    np.array([7], dtype=np.int64),</span>
<span class="go">],</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([False,  True], dtype=np.bool),</span>
<span class="go">[</span>
<span class="go">    np.array([2, 4, 5], dtype=np.int64),</span>
<span class="go">    np.array([0, 1, 3, 6], dtype=np.int64),</span>
<span class="go">],</span>
</pre></div>
</div>
<dl>
<dt>Time:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">extract_timeit_setup</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">group_indices</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;groupxs =&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">setup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="go">        [sortx[lx:rx] for lx, rx in ut.itertwo(idxs)]</span>
<span class="go">        [sortx[lx:rx] for lx, rx in zip(idxs, idxs[1:])]</span>
<span class="go">        #[sortx[lx:rx] for lx, rx in ut.iter_window(idxs)]</span>
<span class="go">        #[sortx[slice(*_)] for _ in ut.itertwo(idxs)]</span>
<span class="go">        #[sortx[slice(lr, lx)] for lr, lx in ut.itertwo(idxs)]</span>
<span class="go">        #np.split(sortx, idxs[1:-1])</span>
<span class="go">        #np.hsplit(sortx, idxs[1:-1])</span>
<span class="go">        np.array_split(sortx, idxs[1:-1])</span>
<span class="go">        &#39;&#39;&#39;).split(&#39;\n&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stmt_list</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">passed</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="go">        np.diff(groupids_sorted)</span>
<span class="go">        np.ediff1d(groupids_sorted)</span>
<span class="go">        np.subtract(groupids_sorted[1:], groupids_sorted[:-1])</span>
<span class="go">        &#39;&#39;&#39;).split(&#39;\n&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stmt_list</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">passed</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Ignore:</dt><dd><p>import numba
group_indices_numba = numba.jit(group_indices)
group_indices_numba(idx2_groupid)</p>
</dd>
<dt>SeeAlso:</dt><dd><p>apply_grouping</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4651683/">http://stackoverflow.com/questions/4651683/</a>
numpy-grouping-using-itertools-groupby-performance</p>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>Look into np.split
<a class="reference external" href="http://stackoverflow.com/questions/21888406/">http://stackoverflow.com/questions/21888406/</a>
getting-the-indexes-to-the-duplicate-columns-of-a-numpy-array</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.groupby">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">groupby</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx2_groupid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupby"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.groupby" title="Permalink to this definition"></a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">items</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span> <span class="o">=</span> <span class="n">idx2_groupid</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.groupby_dict">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">groupby_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx2_groupid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupby_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.groupby_dict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.groupby_gen">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">groupby_gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx2_groupid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupby_gen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.groupby_gen" title="Permalink to this definition"></a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">items</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.groupedzip">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">groupedzip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datas_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupedzip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.groupedzip" title="Permalink to this definition"></a></dt>
<dd><p>Function for grouping multiple lists of data (stored in <code class="docutils literal notranslate"><span class="pre">datas_list</span></code>)
using <code class="docutils literal notranslate"><span class="pre">id_list</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>datas_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>_iter</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>iterator</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.clustering2 –test-groupedzip</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">id_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datas_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupxs</span><span class="p">,</span> <span class="n">grouped_iter</span> <span class="o">=</span> <span class="n">groupedzip</span><span class="p">(</span><span class="n">id_list</span><span class="p">,</span> <span class="n">datas_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_tuples</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">grouped_iter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">groupxs</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">grouped_tuples</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[</span>
<span class="go">    ([&#39;a&#39;, &#39;c&#39;, &#39;e&#39;], [&#39;A&#39;, &#39;C&#39;, &#39;E&#39;]),</span>
<span class="go">    ([&#39;b&#39;, &#39;d&#39;, &#39;f&#39;], [&#39;B&#39;, &#39;D&#39;, &#39;F&#39;]),</span>
<span class="go">    ([&#39;g&#39;], [&#39;G&#39;]),</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.invert_apply_grouping">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">invert_apply_grouping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grouped_items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupxs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#invert_apply_grouping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.invert_apply_grouping" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grouped_items</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – of lists</p></li>
<li><p><strong>groupxs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – of lists</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>items</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.clustering2 –test-invert_apply_grouping</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_items</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span> <span class="o">=</span> <span class="n">invert_apply_grouping</span><span class="p">(</span><span class="n">grouped_items</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">items</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1, 8, 5, 5, 8, 6, 7, 5, 3, 0, 9]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_items</span><span class="p">,</span> <span class="n">groupxs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">invert_apply_grouping</span><span class="p">(</span><span class="n">grouped_items</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.invert_apply_grouping2">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">invert_apply_grouping2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grouped_items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#invert_apply_grouping2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.invert_apply_grouping2" title="Permalink to this definition"></a></dt>
<dd><p>use only when ungrouping will be complete</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.invert_apply_grouping3">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">invert_apply_grouping3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grouped_items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxval</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#invert_apply_grouping3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.invert_apply_grouping3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.jagged_group">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">jagged_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">groupids_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#jagged_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.jagged_group" title="Permalink to this definition"></a></dt>
<dd><p>flattens and returns group indexes into the flattened list</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.plot_centroids">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">plot_centroids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centroids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_pca_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whiten</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'centroids'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#plot_centroids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.plot_centroids" title="Permalink to this definition"></a></dt>
<dd><p>Plots centroids and datapoints. Plots accurately up to 3 dimensions.
If there are more than 3 dimensions, PCA is used to recude the dimenionality
to the &lt;num_pca_dims&gt; principal components</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.sorted_indices_ranges">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">sorted_indices_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">groupids_sorted</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#sorted_indices_ranges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.sorted_indices_ranges" title="Permalink to this definition"></a></dt>
<dd><p>Like group sorted indices but returns a list of slices</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.tune_flann2">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">tune_flann2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#tune_flann2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.tune_flann2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.uniform_sample_hypersphere">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">uniform_sample_hypersphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_quadrent_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#uniform_sample_hypersphere"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.uniform_sample_hypersphere" title="Permalink to this definition"></a></dt>
<dd><p>Not quite done yet</p>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Regular_polytope">https://en.wikipedia.org/wiki/Regular_polytope</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Platonic_solid#Higher_dimensions">https://en.wikipedia.org/wiki/Platonic_solid#Higher_dimensions</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Cross-polytope">https://en.wikipedia.org/wiki/Cross-polytope</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num</strong> – </p></li>
<li><p><strong>ndim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – (default = 2)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.clustering2 –test-uniform_sampe_hypersphere</p>
</dd>
<dt>Ignore:</dt><dd><p>#pip install polytope
sudo pip install cvxopt  –no-deps</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndim</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pts</span> <span class="o">=</span> <span class="n">uniform_sampe_hypersphere</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">ndim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;gx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">elif</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1">#pt.plot_surface3d(pts.T[0], pts.T[1], pts.T[2])</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fig</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">doclf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">docla</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">df2</span><span class="o">.</span><span class="n">dark_background</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clustering2.unsupervised_multicut_labeling">
<span class="sig-prename descclassname"><span class="pre">vtool.clustering2.</span></span><span class="sig-name descname"><span class="pre">unsupervised_multicut_labeling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cost_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#unsupervised_multicut_labeling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clustering2.unsupervised_multicut_labeling" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Notes</p>
<p>requires CPLEX</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.clustering2 unsupervised_multicut_labeling –show</p>
</dd>
</dl>
<p>Ignore:</p>
<blockquote>
<div><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># synthetic data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#np.random.rand(size, size)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">45</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#size = 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">443284320</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encounter_lbls</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separation</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separation</span> <span class="o">=</span> <span class="mf">1.10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">encounter_lbls</span><span class="p">,</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_match</span> <span class="o">=</span> <span class="n">grid1</span><span class="o">.</span><span class="n">T</span> <span class="o">==</span> <span class="n">grid1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">good_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">is_match</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bad_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">s_match</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix_</span><span class="p">[</span><span class="n">good_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">good_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="n">separation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix_</span><span class="p">[</span><span class="n">bad_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bad_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">-</span> <span class="n">separation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">false_val</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">-</span> <span class="n">separation</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">true_val</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span> <span class="o">+</span> <span class="n">separation</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">diag_indices_from</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="p">)]</span> <span class="o">=</span> <span class="n">true_val</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#cost_matrix_[np.diag_indices_from(cost_matrix_)] = np.inf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix</span> <span class="o">=</span> <span class="p">(</span><span class="n">cost_matrix_</span> <span class="o">-</span> <span class="n">false_val</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">true_val</span> <span class="o">-</span> <span class="n">false_val</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">cost_matrix</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">unsupervised_multicut_labeling</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">find_group_differences</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">list</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">group_items</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">encounter_lbls</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">list</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">group_items</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;diff = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">diff</span><span class="p">,))</span>
</pre></div>
</div>
<p>#gm, = ut.exec_func_src(vt.unsupervised_multicut_labeling,
#key_list=[‘gm’], sentinal=’inf = opengm’)
#parameter = opengm.InfParam()
#%timeit opengm.inference.Multicut(gm, parameter=parameter).infer()</p>
</div></blockquote>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">443284320</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">make_test_costmatrix</span><span class="p">(</span><span class="n">name_labels</span><span class="p">,</span> <span class="n">view_labels</span><span class="p">,</span> <span class="n">separation</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">is_same</span> <span class="o">=</span> <span class="n">name_labels</span> <span class="o">==</span> <span class="n">name_labels</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">is_comp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">view_labels</span> <span class="o">-</span> <span class="n">view_labels</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">good_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">is_same</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">bad_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">is_same</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">name_labels</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_labels</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span><span class="p">[</span><span class="n">good_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">good_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="n">separation</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span><span class="p">[</span><span class="n">bad_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bad_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">-</span> <span class="n">separation</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span> <span class="o">=</span> <span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">cost_matrix_</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">false_val</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">-</span> <span class="n">separation</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">true_val</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span> <span class="o">+</span> <span class="n">separation</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">diag_indices_from</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="p">)]</span> <span class="o">=</span> <span class="n">true_val</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix</span> <span class="o">=</span> <span class="p">(</span><span class="n">cost_matrix_</span> <span class="o">-</span> <span class="n">false_val</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">true_val</span> <span class="o">-</span> <span class="n">false_val</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">cost_matrix</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">is_comp</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">cost_matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#cost_matrix = make_test_costmatrix(name_labels, view_labels, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix</span> <span class="o">=</span> <span class="n">make_test_costmatrix</span><span class="p">(</span><span class="n">name_labels</span><span class="p">,</span> <span class="n">view_labels</span><span class="p">,</span> <span class="mf">.9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">multicut_value</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">name_labels</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">grid1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">name_labels</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">name_labels</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">isdiff</span> <span class="o">=</span> <span class="n">grid1</span><span class="o">.</span><span class="n">T</span> <span class="o">!=</span> <span class="n">grid1</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cut_value</span> <span class="o">=</span> <span class="n">cost_matrix</span><span class="p">[</span><span class="n">isdiff</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">cut_value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">name_labels</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">nx_from_matrix</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">floatfmt1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">map_vals</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;w=</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">floatfmt2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">map_vals</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;l=</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lens</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">map_vals</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">floatfmt1</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#labels = floatfmt2(lens)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span><span class="o">.</span><span class="n">set_edge_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#nx.set_edge_attributes(graph, name=&#39;len&#39;, values=lens)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;shape&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;ellipse&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encounter_lbls_str</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">name_labels</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node_name_lbls</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">encounter_lbls_str</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mcut_labels</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">unsupervised_multicut_labeling</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="n">vt</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">find_group_differences</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">list</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">group_items</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">name_labels</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">list</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">group_items</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">mcut_labels</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;diff = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">diff</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">node_name_lbls</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node_mcut_lbls</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">mcut_labels</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mcut_label&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">node_mcut_lbls</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mc_val(name) &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">multicut_value</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">name_labels</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mc_val(mcut) &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">multicut_value</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">mcut_labels</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">color_nodes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;mcut_label&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># remove noncomparable edges</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_comp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">view_labels</span> <span class="o">-</span> <span class="n">view_labels</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noncomp_edges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">is_comp</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="o">.</span><span class="n">remove_edges_from</span><span class="p">(</span><span class="n">noncomp_edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layoutkw</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;sep&#39;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;prog&#39;</span><span class="p">:</span> <span class="s1">&#39;neato&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;overlap&#39;</span><span class="p">:</span> <span class="s1">&#39;false&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;splines&#39;</span><span class="p">:</span> <span class="s1">&#39;spline&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_nx</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">layoutkw</span><span class="o">=</span><span class="n">layoutkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-vtool.confusion">
<span id="vtool-confusion-module"></span><h2>vtool.confusion module<a class="headerlink" href="#module-vtool.confusion" title="Permalink to this headline"></a></h2>
<p>Module for – Confusion matrix, contingency, error matrix,</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Confusion_matrix">http://en.wikipedia.org/wiki/Confusion_matrix</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.confusion.</span></span><span class="sig-name descname"><span class="pre">ConfusionMetrics</span></span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ubelt.util_mixins.NiceRepr</span></code></p>
<p>Can compute average percision using the PASCAL definition</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://www.flinders.edu.au/science_engineering/fms/School-CSEM/publications/tech_reps-research_artfcts/TRRA_2007.pdf">http://www.flinders.edu.au/science_engineering/fms/School-CSEM/publications/tech_reps-research_artfcts/TRRA_2007.pdf</a>
<a class="reference external" href="http://www.alta.asn.au/events/altss_w2003_proc/altss/courses/powers/Bookmaker-all/200302-ICCS-Bookmaker.pdfcs">http://www.alta.asn.au/events/altss_w2003_proc/altss/courses/powers/Bookmaker-all/200302-ICCS-Bookmaker.pdfcs</a>
<a class="reference external" href="http://www.cs.bris.ac.uk/Publications/Papers/1000704.pdf">http://www.cs.bris.ac.uk/Publications/Papers/1000704.pdf</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Information_retrieval">http://en.wikipedia.org/wiki/Information_retrieval</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Precision_and_recall">http://en.wikipedia.org/wiki/Precision_and_recall</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Confusion_matrix">https://en.wikipedia.org/wiki/Confusion_matrix</a>
<a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_curve.html#sklearn.metrics.roc_curve">http://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_curve.html#sklearn.metrics.roc_curve</a></p>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>sklearn.metrics.ranking._binary_clf_curve</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>From oxford:
Precision is defined as the ratio of retrieved positive images to the
total number retrieved.
Recall is defined as the ratio of the number of retrieved positive
images to the total number of positive images in the corpus.</p>
<dl class="simple">
<dt>Ignore:</dt><dd><p>varname_list = ‘tp, fp, fn, tn, fpr, tpr, tpa’.split(’, ‘)
lines = [‘self.{varname} = {varname}’.format(varname=varname) for varname in varname_list]
print(ut.indent(’n’.join(lines)))</p>
</dd>
<dt>CommandLine:</dt><dd><p>python -m vtool.confusion ConfusionMetrics –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">=</span> <span class="n">confusions</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">n_pos</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">n_tp</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">n_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">n_neg</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">n_tn</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">n_fp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">rp</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">rn</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">pp</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">pn</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">fpr</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">tnr</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">fnr</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">tpr</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tpr</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">tp</span> <span class="o">/</span> <span class="n">c</span><span class="o">.</span><span class="n">rp</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tpa</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">tp</span> <span class="o">/</span> <span class="n">c</span><span class="o">.</span><span class="n">pp</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">jacc</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">tp</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tp</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">fn</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">fp</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">mcc</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">mk</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="n">bm</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">c</span><span class="o">.</span><span class="n">acc</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tpr</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">fpr</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">c</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ppv</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">recall</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="n">prev</span> <span class="o">/</span> <span class="n">c</span><span class="o">.</span><span class="n">bias</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">c</span><span class="o">.</span><span class="n">wracc</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tpr</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">fpr</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span><span class="o">.</span><span class="n">draw_roc_curve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.acc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">acc</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.acc" title="Permalink to this definition"></a></dt>
<dd><p>accuracy</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.aliases">
<span class="sig-name descname"><span class="pre">aliases</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'acc':</span> <span class="pre">{'accuracy',</span> <span class="pre">'rand_accuracy',</span> <span class="pre">'tea',</span> <span class="pre">'ter'},</span> <span class="pre">'bm':</span> <span class="pre">{'bookmaker_informedness',</span> <span class="pre">&quot;deltaP'&quot;,</span> <span class="pre">'informedness',</span> <span class="pre">'r_R'},</span> <span class="pre">'cn':</span> <span class="pre">{'cost_neg'},</span> <span class="pre">'cp':</span> <span class="pre">{'cost_pos'},</span> <span class="pre">'cs':</span> <span class="pre">{'class_odds',</span> <span class="pre">'skew'},</span> <span class="pre">'cv':</span> <span class="pre">{'cost_ratio'},</span> <span class="pre">'fn':</span> <span class="pre">{'false_neg',</span> <span class="pre">'miss',</span> <span class="pre">'type2_error'},</span> <span class="pre">'fnr':</span> <span class="pre">{'false_neg_rate',</span> <span class="pre">'miss_rate'},</span> <span class="pre">'fp':</span> <span class="pre">{'false_alarm',</span> <span class="pre">'false_pos',</span> <span class="pre">'type1_error'},</span> <span class="pre">'fpr':</span> <span class="pre">{'fallout',</span> <span class="pre">'false_pos_rate'},</span> <span class="pre">'jacc':</span> <span class="pre">{'jaccard_coefficient'},</span> <span class="pre">'mcc':</span> <span class="pre">{'matthews_correlation_coefficient'},</span> <span class="pre">'mk':</span> <span class="pre">{'deltaP',</span> <span class="pre">'markedness',</span> <span class="pre">'r_P'},</span> <span class="pre">'n_fn':</span> <span class="pre">{'n_false_neg',</span> <span class="pre">'n_miss'},</span> <span class="pre">'n_fp':</span> <span class="pre">{'n_false_alarm',</span> <span class="pre">'n_false_pos'},</span> <span class="pre">'n_tn':</span> <span class="pre">{'n_reject',</span> <span class="pre">'n_true_neg'},</span> <span class="pre">'n_tp':</span> <span class="pre">{'n_hit',</span> <span class="pre">'n_true_pos'},</span> <span class="pre">'pn':</span> <span class="pre">{'pred_neg'},</span> <span class="pre">'pp':</span> <span class="pre">{'bias',</span> <span class="pre">'pred_pos'},</span> <span class="pre">'rn':</span> <span class="pre">{'real_neg'},</span> <span class="pre">'rp':</span> <span class="pre">{'prev',</span> <span class="pre">'prevalence',</span> <span class="pre">'real_pos'},</span> <span class="pre">'tn':</span> <span class="pre">{'reject',</span> <span class="pre">'true_neg'},</span> <span class="pre">'tna':</span> <span class="pre">{'inv_precision',</span> <span class="pre">'neg_predict_value',</span> <span class="pre">'npv',</span> <span class="pre">'true_neg_acc'},</span> <span class="pre">'tnr':</span> <span class="pre">{'inv_recall,</span> <span class="pre">specificity',</span> <span class="pre">'true_neg_rate'},</span> <span class="pre">'tp':</span> <span class="pre">{'hit',</span> <span class="pre">'true_pos'},</span> <span class="pre">'tpa':</span> <span class="pre">{'pos_predict_value',</span> <span class="pre">'ppv',</span> <span class="pre">'precision',</span> <span class="pre">'true_pos_acc'},</span> <span class="pre">'tpr':</span> <span class="pre">{'hit_rate',</span> <span class="pre">'recall',</span> <span class="pre">'sensitivity',</span> <span class="pre">'true_pos_rate'},</span> <span class="pre">'wracc':</span> <span class="pre">{'weighted_relative_accuracy'}}</span></em><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.aliases" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.auc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">auc</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.auc" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>The AUC is a standard measure used to evaluate a binary classifier and</dt><dd><p>represents the probability that a random correct case will
receive a higher score than a random incorrect case.</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic#Area_under_the_curve">https://en.wikipedia.org/wiki/Receiver_operating_characteristic#Area_under_the_curve</a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.auc_trap">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">auc_trap</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.auc_trap" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.bm">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bm</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.bm" title="Permalink to this definition"></a></dt>
<dd><p>bookmaker informedness</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.c">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">c</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.c" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.cs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cs</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.cs" title="Permalink to this definition"></a></dt>
<dd><p>class ratio</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.cv">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cv</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.cv" title="Permalink to this definition"></a></dt>
<dd><p>ratio of cost of making a mistake</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.draw_precision_recall_curve">
<span class="sig-name descname"><span class="pre">draw_precision_recall_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nSamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.draw_precision_recall_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.draw_precision_recall_curve" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.draw_roc_curve">
<span class="sig-name descname"><span class="pre">draw_roc_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.draw_roc_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.draw_roc_curve" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.fit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.fn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fn</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.fn" title="Permalink to this definition"></a></dt>
<dd><p>false negative probability</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.fnr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fnr</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.fnr" title="Permalink to this definition"></a></dt>
<dd><p>miss rate, false negative rate</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.fp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fp</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.fp" title="Permalink to this definition"></a></dt>
<dd><p>false positive probability</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.fpr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fpr</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.fpr" title="Permalink to this definition"></a></dt>
<dd><p>fallout, false positive rate</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.from_tp_and_tn_scores">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_tp_and_tn_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tp_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.from_tp_and_tn_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.from_tp_and_tn_scores" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.get_ave_precision">
<span class="sig-name descname"><span class="pre">get_ave_precision</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_ave_precision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_ave_precision" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.get_fpr_at_recall">
<span class="sig-name descname"><span class="pre">get_fpr_at_recall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_recall</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_fpr_at_recall"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_fpr_at_recall" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.get_index_at_metric">
<span class="sig-name descname"><span class="pre">get_index_at_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">at_metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">at_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subindex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tiebreaker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'maxthresh'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_index_at_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_index_at_metric" title="Permalink to this definition"></a></dt>
<dd><p>Finds the index that is closet to the metric at a given value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tiebreaker</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – either ‘minimize’ or ‘maximize’
if ‘maximize’, then a larger threshold is considered better
when resolving ambiguities. Otherwise a smaller thresh is
better.</p>
</dd>
</dl>
<dl>
<dt>Doctest:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pat1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pat2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pat3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pat4</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pats</span> <span class="o">=</span> <span class="p">[</span><span class="n">pat1</span><span class="p">,</span> <span class="n">pat2</span><span class="p">,</span> <span class="n">pat3</span><span class="p">,</span> <span class="n">pat4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">itertools</span> <span class="k">as</span> <span class="nn">it</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create places of ambiguitiy and unambiguity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">flatten</span><span class="p">([[</span><span class="nb">next</span><span class="p">(</span><span class="n">s</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">pat</span><span class="p">)</span> <span class="k">for</span> <span class="n">pat</span> <span class="ow">in</span> <span class="n">pats</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">flatten</span><span class="p">([</span><span class="n">pat</span> <span class="k">for</span> <span class="n">pat</span> <span class="ow">in</span> <span class="n">pats</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">at_metric</span> <span class="o">=</span> <span class="s1">&#39;n_false_pos&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">at_value</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subindex</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index_at_metric</span><span class="p">(</span><span class="n">at_metric</span><span class="p">,</span> <span class="n">at_value</span><span class="p">,</span> <span class="n">subindex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tiebreaker</span><span class="o">=</span><span class="s1">&#39;minthresh&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index_at_metric</span><span class="p">(</span><span class="n">at_metric</span><span class="p">,</span> <span class="n">at_value</span><span class="p">,</span> <span class="n">subindex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tiebreaker</span><span class="o">=</span> <span class="s1">&#39;maxthresh&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">idx1</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">idx2</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.get_metric_at_index">
<span class="sig-name descname"><span class="pre">get_metric_at_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subindex</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_metric_at_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_metric_at_index" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.get_metric_at_metric">
<span class="sig-name descname"><span class="pre">get_metric_at_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">get_metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">at_metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">at_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subindex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tiebreaker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'maxthresh'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_metric_at_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_metric_at_metric" title="Permalink to this definition"></a></dt>
<dd><p>Finds the corresponding value of <cite>get_metric</cite> at a specific value of
<cite>at_metric</cite>.</p>
<p>get_metric = ‘fpr’
at_metric = ‘tpr’
at_value = .25
self.rrr()</p>
<p>self.get_metric_at_metric(‘fpr’, ‘tpr’, .25)
self.get_metric_at_metric(‘n_false_pos’, ‘tpr’, .25)
self.get_metric_at_metric(‘n_true_pos’, ‘tpr’, .25)</p>
<p>get_metric = ‘n_true_pos’
at_metric = ‘n_false_pos’
at_value = 0
subindex = False</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.get_metric_at_thresh">
<span class="sig-name descname"><span class="pre">get_metric_at_thresh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_metric_at_thresh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_metric_at_thresh" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – name of a metric</p></li>
<li><p><strong>thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – desired threshold</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>value - metric value</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
<dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.confusion –exec-get_metric_at_threshold</p>
</dd>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">cfms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;fpr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;tpr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metric_at_thresh</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(None, None) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">((</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.get_recall_at_fpr">
<span class="sig-name descname"><span class="pre">get_recall_at_fpr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_fpr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_recall_at_fpr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_recall_at_fpr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.get_thresh_at_metric">
<span class="sig-name descname"><span class="pre">get_thresh_at_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_thresh_at_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_thresh_at_metric" title="Permalink to this definition"></a></dt>
<dd><p>Gets a threshold for a binary classifier using a target metric and value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – name of metric like tpr or fpr</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – corresponding numeric value</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>thresh</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.confusion get_thresh_at_metric
python -m vtool.confusion –exec-interact_roc_factory –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;tpr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="mf">.85</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_thresh_at_metric</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">value</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;thresh = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">thresh</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">thresh = 22.5</span>
</pre></div>
</div>
<dl class="simple">
<dt>Ignore:</dt><dd><p>metric = ‘fpr’
value = 1e-4
self = cfms
maximize = False</p>
</dd>
</dl>
<p>interpolate_replbounds(metric_values, self.thresholds, 0, maximize=maximize)
interpolate_replbounds(metric_values, self.thresholds, 1e-4, maximize=maximize)
interpolate_replbounds(metric_values, self.thresholds, 1e-3, maximize=maximize)
interpolate_replbounds(metric_values, self.thresholds, 1e-2, maximize=maximize)
interpolate_replbounds(metric_values, self.thresholds, 1e-2, maximize=maximize)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.get_thresh_at_metric_max">
<span class="sig-name descname"><span class="pre">get_thresh_at_metric_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_thresh_at_metric_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_thresh_at_metric_max" title="Permalink to this definition"></a></dt>
<dd><p>metric = ‘mcc’
metric = ‘fnr’</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.inv_aliases">
<span class="sig-name descname"><span class="pre">inv_aliases</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'acc':</span> <span class="pre">'acc',</span> <span class="pre">'accuracy':</span> <span class="pre">'acc',</span> <span class="pre">'bias':</span> <span class="pre">'pp',</span> <span class="pre">'bm':</span> <span class="pre">'bm',</span> <span class="pre">'bookmaker_informedness':</span> <span class="pre">'bm',</span> <span class="pre">'class_odds':</span> <span class="pre">'cs',</span> <span class="pre">'cn':</span> <span class="pre">'cn',</span> <span class="pre">'cost_neg':</span> <span class="pre">'cn',</span> <span class="pre">'cost_pos':</span> <span class="pre">'cp',</span> <span class="pre">'cost_ratio':</span> <span class="pre">'cv',</span> <span class="pre">'cp':</span> <span class="pre">'cp',</span> <span class="pre">'cs':</span> <span class="pre">'cs',</span> <span class="pre">'cv':</span> <span class="pre">'cv',</span> <span class="pre">'deltaP':</span> <span class="pre">'mk',</span> <span class="pre">&quot;deltaP'&quot;:</span> <span class="pre">'bm',</span> <span class="pre">'fallout':</span> <span class="pre">'fpr',</span> <span class="pre">'false_alarm':</span> <span class="pre">'fp',</span> <span class="pre">'false_neg':</span> <span class="pre">'fn',</span> <span class="pre">'false_neg_rate':</span> <span class="pre">'fnr',</span> <span class="pre">'false_pos':</span> <span class="pre">'fp',</span> <span class="pre">'false_pos_rate':</span> <span class="pre">'fpr',</span> <span class="pre">'fn':</span> <span class="pre">'fn',</span> <span class="pre">'fnr':</span> <span class="pre">'fnr',</span> <span class="pre">'fp':</span> <span class="pre">'fp',</span> <span class="pre">'fpr':</span> <span class="pre">'fpr',</span> <span class="pre">'hit':</span> <span class="pre">'tp',</span> <span class="pre">'hit_rate':</span> <span class="pre">'tpr',</span> <span class="pre">'informedness':</span> <span class="pre">'bm',</span> <span class="pre">'inv_precision':</span> <span class="pre">'tna',</span> <span class="pre">'inv_recall,</span> <span class="pre">specificity':</span> <span class="pre">'tnr',</span> <span class="pre">'jacc':</span> <span class="pre">'jacc',</span> <span class="pre">'jaccard_coefficient':</span> <span class="pre">'jacc',</span> <span class="pre">'markedness':</span> <span class="pre">'mk',</span> <span class="pre">'matthews_correlation_coefficient':</span> <span class="pre">'mcc',</span> <span class="pre">'mcc':</span> <span class="pre">'mcc',</span> <span class="pre">'miss':</span> <span class="pre">'fn',</span> <span class="pre">'miss_rate':</span> <span class="pre">'fnr',</span> <span class="pre">'mk':</span> <span class="pre">'mk',</span> <span class="pre">'n_false_alarm':</span> <span class="pre">'n_fp',</span> <span class="pre">'n_false_neg':</span> <span class="pre">'n_fn',</span> <span class="pre">'n_false_pos':</span> <span class="pre">'n_fp',</span> <span class="pre">'n_fn':</span> <span class="pre">'n_fn',</span> <span class="pre">'n_fp':</span> <span class="pre">'n_fp',</span> <span class="pre">'n_hit':</span> <span class="pre">'n_tp',</span> <span class="pre">'n_miss':</span> <span class="pre">'n_fn',</span> <span class="pre">'n_reject':</span> <span class="pre">'n_tn',</span> <span class="pre">'n_tn':</span> <span class="pre">'n_tn',</span> <span class="pre">'n_tp':</span> <span class="pre">'n_tp',</span> <span class="pre">'n_true_neg':</span> <span class="pre">'n_tn',</span> <span class="pre">'n_true_pos':</span> <span class="pre">'n_tp',</span> <span class="pre">'neg_predict_value':</span> <span class="pre">'tna',</span> <span class="pre">'npv':</span> <span class="pre">'tna',</span> <span class="pre">'pn':</span> <span class="pre">'pn',</span> <span class="pre">'pos_predict_value':</span> <span class="pre">'tpa',</span> <span class="pre">'pp':</span> <span class="pre">'pp',</span> <span class="pre">'ppv':</span> <span class="pre">'tpa',</span> <span class="pre">'precision':</span> <span class="pre">'tpa',</span> <span class="pre">'pred_neg':</span> <span class="pre">'pn',</span> <span class="pre">'pred_pos':</span> <span class="pre">'pp',</span> <span class="pre">'prev':</span> <span class="pre">'rp',</span> <span class="pre">'prevalence':</span> <span class="pre">'rp',</span> <span class="pre">'r_P':</span> <span class="pre">'mk',</span> <span class="pre">'r_R':</span> <span class="pre">'bm',</span> <span class="pre">'rand_accuracy':</span> <span class="pre">'acc',</span> <span class="pre">'real_neg':</span> <span class="pre">'rn',</span> <span class="pre">'real_pos':</span> <span class="pre">'rp',</span> <span class="pre">'recall':</span> <span class="pre">'tpr',</span> <span class="pre">'reject':</span> <span class="pre">'tn',</span> <span class="pre">'rn':</span> <span class="pre">'rn',</span> <span class="pre">'rp':</span> <span class="pre">'rp',</span> <span class="pre">'sensitivity':</span> <span class="pre">'tpr',</span> <span class="pre">'skew':</span> <span class="pre">'cs',</span> <span class="pre">'tea':</span> <span class="pre">'acc',</span> <span class="pre">'ter':</span> <span class="pre">'acc',</span> <span class="pre">'tn':</span> <span class="pre">'tn',</span> <span class="pre">'tna':</span> <span class="pre">'tna',</span> <span class="pre">'tnr':</span> <span class="pre">'tnr',</span> <span class="pre">'tp':</span> <span class="pre">'tp',</span> <span class="pre">'tpa':</span> <span class="pre">'tpa',</span> <span class="pre">'tpr':</span> <span class="pre">'tpr',</span> <span class="pre">'true_neg':</span> <span class="pre">'tn',</span> <span class="pre">'true_neg_acc':</span> <span class="pre">'tna',</span> <span class="pre">'true_neg_rate':</span> <span class="pre">'tnr',</span> <span class="pre">'true_pos':</span> <span class="pre">'tp',</span> <span class="pre">'true_pos_acc':</span> <span class="pre">'tpa',</span> <span class="pre">'true_pos_rate':</span> <span class="pre">'tpr',</span> <span class="pre">'type1_error':</span> <span class="pre">'fp',</span> <span class="pre">'type2_error':</span> <span class="pre">'fn',</span> <span class="pre">'weighted_relative_accuracy':</span> <span class="pre">'wracc',</span> <span class="pre">'wracc':</span> <span class="pre">'wracc'}</span></em><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.inv_aliases" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.jacc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">jacc</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.jacc" title="Permalink to this definition"></a></dt>
<dd><p>jaccard coefficient</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.mcc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mcc</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.mcc" title="Permalink to this definition"></a></dt>
<dd><p>matthews correlation coefficient</p>
<dl class="simple">
<dt>Also true that:</dt><dd><p>mcc == np.sqrt(self.bm * self.mk)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.minimizing_metrics">
<span class="sig-name descname"><span class="pre">minimizing_metrics</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'fn',</span> <span class="pre">'fnr',</span> <span class="pre">'fp',</span> <span class="pre">'fpr'}</span></em><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.minimizing_metrics" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.mk">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mk</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.mk" title="Permalink to this definition"></a></dt>
<dd><p>markedness</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.paper_alias">
<span class="sig-name descname"><span class="pre">paper_alias</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[['dtp',</span> <span class="pre">'determinant'],</span> <span class="pre">['lr',</span> <span class="pre">'liklihood-ratio'],</span> <span class="pre">['nlr',</span> <span class="pre">'negative-liklihood-ratio'],</span> <span class="pre">['bmg',</span> <span class="pre">'bookmarkG',</span> <span class="pre">'bookmark_geometric_mean',</span> <span class="pre">'mcc?'],</span> <span class="pre">['evenness_R',</span> <span class="pre">'PrevG2'],</span> <span class="pre">['evenness_P',</span> <span class="pre">'BiasG2'],</span> <span class="pre">['rh',</span> <span class="pre">'real_harmonic_mean'],</span> <span class="pre">['ph',</span> <span class="pre">'pred_harminic_mean']]</span></em><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.paper_alias" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.paper_relations">
<span class="sig-name descname"><span class="pre">paper_relations</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'BMG':</span> <span class="pre">['dtp</span> <span class="pre">/</span> <span class="pre">evenness_G'],</span> <span class="pre">'BiasG2':</span> <span class="pre">['bias</span> <span class="pre">*</span> <span class="pre">1</span> <span class="pre">-</span> <span class="pre">bias'],</span> <span class="pre">'IBias':</span> <span class="pre">['1</span> <span class="pre">-</span> <span class="pre">Bias'],</span> <span class="pre">'N':</span> <span class="pre">['A</span> <span class="pre">+</span> <span class="pre">B</span> <span class="pre">+</span> <span class="pre">C</span> <span class="pre">+</span> <span class="pre">D'],</span> <span class="pre">'bm':</span> <span class="pre">['dtp</span> <span class="pre">/</span> <span class="pre">(prev</span> <span class="pre">*</span> <span class="pre">(1</span> <span class="pre">-</span> <span class="pre">prev))'],</span> <span class="pre">'deltap':</span> <span class="pre">['dtp</span> <span class="pre">-</span> <span class="pre">dtn',</span> <span class="pre">'2</span> <span class="pre">*</span> <span class="pre">dp'],</span> <span class="pre">'dp':</span> <span class="pre">['tp</span> <span class="pre">-</span> <span class="pre">etp',</span> <span class="pre">'dtp',</span> <span class="pre">'-dtn',</span> <span class="pre">'-(tn</span> <span class="pre">-</span> <span class="pre">etn)'],</span> <span class="pre">'dtp':</span> <span class="pre">['A</span> <span class="pre">*</span> <span class="pre">D</span> <span class="pre">-</span> <span class="pre">B</span> <span class="pre">*</span> <span class="pre">C'],</span> <span class="pre">'etn':</span> <span class="pre">['rn</span> <span class="pre">*</span> <span class="pre">pn',</span> <span class="pre">'expected_true_negatives'],</span> <span class="pre">'etp':</span> <span class="pre">['rp</span> <span class="pre">*</span> <span class="pre">pp',</span> <span class="pre">'expected_true_positives'],</span> <span class="pre">'kappa':</span> <span class="pre">['deltap</span> <span class="pre">/</span> <span class="pre">(deltap</span> <span class="pre">+</span> <span class="pre">(fp</span> <span class="pre">+</span> <span class="pre">fn)</span> <span class="pre">/</span> <span class="pre">2)'],</span> <span class="pre">'lr':</span> <span class="pre">['tpr</span> <span class="pre">/</span> <span class="pre">(1</span> <span class="pre">-</span> <span class="pre">tnr)'],</span> <span class="pre">'mk':</span> <span class="pre">['dtp</span> <span class="pre">/</span> <span class="pre">(bias</span> <span class="pre">*</span> <span class="pre">(1</span> <span class="pre">-</span> <span class="pre">bias))',</span> <span class="pre">'dtp</span> <span class="pre">/</span> <span class="pre">biasG</span> <span class="pre">**</span> <span class="pre">2'],</span> <span class="pre">'nlr':</span> <span class="pre">['tnr</span> <span class="pre">/</span> <span class="pre">(1</span> <span class="pre">-</span> <span class="pre">tpr)'],</span> <span class="pre">'ph':</span> <span class="pre">['2</span> <span class="pre">*</span> <span class="pre">pp</span> <span class="pre">*</span> <span class="pre">pn</span> <span class="pre">/</span> <span class="pre">(pp</span> <span class="pre">+</span> <span class="pre">pn)',</span> <span class="pre">'pred_harminic_mean'],</span> <span class="pre">'rh':</span> <span class="pre">['2</span> <span class="pre">*</span> <span class="pre">rp</span> <span class="pre">*</span> <span class="pre">rn</span> <span class="pre">/</span> <span class="pre">(rp</span> <span class="pre">+</span> <span class="pre">rn)',</span> <span class="pre">'real_harmonic_mean']}</span></em><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.paper_relations" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.plot_metrics">
<span class="sig-name descname"><span class="pre">plot_metrics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.plot_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.plot_metrics" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.plot_vs">
<span class="sig-name descname"><span class="pre">plot_vs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_metric</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.plot_vs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.plot_vs" title="Permalink to this definition"></a></dt>
<dd><p>x_metric = ‘thresholds’
y_metric = ‘fpr’</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.pn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pn</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.pn" title="Permalink to this definition"></a></dt>
<dd><p>predicted negative probability</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.pp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pp</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.pp" title="Permalink to this definition"></a></dt>
<dd><p>predicted positive probability</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.rn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rn</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.rn" title="Permalink to this definition"></a></dt>
<dd><p>real negative probability</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.rp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rp</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.rp" title="Permalink to this definition"></a></dt>
<dd><p>real positive probability</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.show_mcc">
<span class="sig-name descname"><span class="pre">show_mcc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.show_mcc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.show_mcc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.sqrd_error">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sqrd_error</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.sqrd_error" title="Permalink to this definition"></a></dt>
<dd><p>squared error</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.thresh">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">thresh</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.thresh" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.tn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tn</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.tn" title="Permalink to this definition"></a></dt>
<dd><p>true negative probability</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.tna">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tna</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.tna" title="Permalink to this definition"></a></dt>
<dd><p>negative predictive value, inverse precision</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.tnr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tnr</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.tnr" title="Permalink to this definition"></a></dt>
<dd><p>true negative rate, inverse recall</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.tp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tp</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.tp" title="Permalink to this definition"></a></dt>
<dd><p>true positive probability</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.tpa">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tpa</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.tpa" title="Permalink to this definition"></a></dt>
<dd><p>miss rate, false negative rate</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.tpr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tpr</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.tpr" title="Permalink to this definition"></a></dt>
<dd><p>sensitivity, recall, hit rate, tpr</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.confusion.ConfusionMetrics.wracc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wracc</span></span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.wracc" title="Permalink to this definition"></a></dt>
<dd><p>weighted relative accuracy</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.confusion.draw_precision_recall_curve">
<span class="sig-prename descclassname"><span class="pre">vtool.confusion.</span></span><span class="sig-name descname"><span class="pre">draw_precision_recall_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recall_domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_interp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_pref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#draw_precision_recall_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.draw_precision_recall_curve" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.confusion.draw_roc_curve">
<span class="sig-prename descclassname"><span class="pre">vtool.confusion.</span></span><span class="sig-name descname"><span class="pre">draw_roc_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tpr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_tpr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_fpr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_operating_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#draw_roc_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.draw_roc_curve" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fpr</strong> – </p></li>
<li><p><strong>tpr</strong> – </p></li>
<li><p><strong>fnum</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – figure number(default = None)</p></li>
<li><p><strong>pnum</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – plot number(default = None)</p></li>
<li><p><strong>marker</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – (default = ‘-x’)</p></li>
<li><p><strong>target_tpr</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>target_fpr</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>thresholds</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>color</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>show_operating_point</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.confusion –exec-draw_roc_curve –show –lightbg</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpr</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">fpr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tpr</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">tpr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresholds</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">thresholds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fnum</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pnum</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_tpr</span> <span class="o">=</span> <span class="mf">.85</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_fpr</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_operating_point</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_roc_curve</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">target_tpr</span><span class="p">,</span> <span class="n">target_fpr</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">thresholds</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">show_operating_point</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.confusion.interact_roc_factory">
<span class="sig-prename descclassname"><span class="pre">vtool.confusion.</span></span><span class="sig-name descname"><span class="pre">interact_roc_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">confusions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_tpr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_operating_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#interact_roc_factory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.interact_roc_factory" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>confusions</strong> (<em>Confusions</em>) – </p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.confusion –exec-interact_roc_factory –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;scores = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">make_csv_table</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="p">[</span><span class="n">confusions</span><span class="o">.</span><span class="n">fpr</span><span class="p">,</span> <span class="n">confusions</span><span class="o">.</span><span class="n">tpr</span><span class="p">,</span> <span class="n">confusions</span><span class="o">.</span><span class="n">thresholds</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="p">[</span><span class="s1">&#39;fpr&#39;</span><span class="p">,</span> <span class="s1">&#39;tpr&#39;</span><span class="p">,</span> <span class="s1">&#39;thresh&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ROCInteraction</span> <span class="o">=</span> <span class="n">interact_roc_factory</span><span class="p">(</span><span class="n">confusions</span><span class="p">,</span> <span class="n">target_tpr</span><span class="o">=</span><span class="mf">.4</span><span class="p">,</span> <span class="n">show_operating_point</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">ROCInteraction</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span><span class="o">.</span><span class="n">show_page</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.confusion.interpolate_precision_recall">
<span class="sig-prename descclassname"><span class="pre">vtool.confusion.</span></span><span class="sig-name descname"><span class="pre">interpolate_precision_recall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">precision</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#interpolate_precision_recall"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.interpolate_precision_recall" title="Permalink to this definition"></a></dt>
<dd><p>Interpolates precision as a function of recall p_{interp}(r)</p>
<p>Reduce wiggles in average precision curve by taking interpolated values
along a uniform sample.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Information_retrieval#Average_precision">http://en.wikipedia.org/wiki/Information_retrieval#Average_precision</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Information_retrieval#Mean_Average_precision">http://en.wikipedia.org/wiki/Information_retrieval#Mean_Average_precision</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.confusion –test-interpolate_precision_recall –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nSamples</span> <span class="o">=</span> <span class="mi">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">precision</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">precision</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recall</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">recall</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recall_domain</span><span class="p">,</span> <span class="n">p_interp</span> <span class="o">=</span> <span class="n">interpolate_precision_recall</span><span class="p">(</span><span class="n">confusions</span><span class="o">.</span><span class="n">precision</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">nSamples</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">p_interp</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_precision_recall_curve</span><span class="p">(</span><span class="n">recall_domain</span><span class="p">,</span> <span class="n">p_interp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([ 1. ,  1. ,  1. ,  1. ,  1. ,  1. ,  1. ,  0.9,  0.9,  0.8,  0.6], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.confusion.interpolate_replbounds">
<span class="sig-prename descclassname"><span class="pre">vtool.confusion.</span></span><span class="sig-name descname"><span class="pre">interpolate_replbounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#interpolate_replbounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.interpolate_replbounds" title="Permalink to this definition"></a></dt>
<dd><p>xdata = np.array([.1, .2, .3, .4, .5])
ydata = np.array([.1, .2, .3, .4, .5])
pt = .35</p>
<dl class="simple">
<dt>FIXME:</dt><dd><p>if duplicate xdata is given bad things happen.</p>
</dd>
<dt>BUG:</dt><dd><p>in scipy.interpolate.interp1d
If there is a duplicate xdata, then assume_sorted=False will
sort ydata by xdata, but xdata should retain its initial ordering
in places of ambuguity. Currently it does not.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xdata</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>ydata</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>pt</strong> (<em>ndarray</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>interp_vals</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.confusion –exec-interpolate_replbounds</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tpr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#xdata = self.fpr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#ydata = self.thresholds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt = 0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="n">interpolate_replbounds</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">maximize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;thresh = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">thresh</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="n">interpolate_replbounds</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">maximize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;thresh = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">thresh</span><span class="p">,))</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.7</span><span class="p">,</span>  <span class="mf">0.8</span><span class="p">,</span>  <span class="mf">0.8</span><span class="p">,</span>  <span class="mf">0.9</span><span class="p">,</span>  <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">34</span><span class="p">,</span>    <span class="mi">26</span><span class="p">,</span>   <span class="mi">23</span><span class="p">,</span>   <span class="mi">22</span><span class="p">,</span>   <span class="mi">19</span><span class="p">,</span>  <span class="mi">17</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.85</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interp_vals</span> <span class="o">=</span> <span class="n">interpolate_replbounds</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;interp_vals = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">interp_vals</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">interp_vals = [ 22.5  17.   34. ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.confusion.nan_to_num">
<span class="sig-prename descclassname"><span class="pre">vtool.confusion.</span></span><span class="sig-name descname"><span class="pre">nan_to_num</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#nan_to_num"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.nan_to_num" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.confusion.testdata_scores_labels">
<span class="sig-prename descclassname"><span class="pre">vtool.confusion.</span></span><span class="sig-name descname"><span class="pre">testdata_scores_labels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#testdata_scores_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.confusion.testdata_scores_labels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool.coverage_grid">
<span id="vtool-coverage-grid-module"></span><h2>vtool.coverage_grid module<a class="headerlink" href="#module-vtool.coverage_grid" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_grid.compute_subbin_to_bins_dist">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_grid.</span></span><span class="sig-name descname"><span class="pre">compute_subbin_to_bins_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neighbor_bin_centers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subbin_xy_arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#compute_subbin_to_bins_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_grid.compute_subbin_to_bins_dist" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_grid.get_coverage_grid_gridsearch_configs">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_grid.</span></span><span class="sig-name descname"><span class="pre">get_coverage_grid_gridsearch_configs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#get_coverage_grid_gridsearch_configs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_grid.get_coverage_grid_gridsearch_configs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_grid.get_subbin_xy_neighbors">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_grid.</span></span><span class="sig-name descname"><span class="pre">get_subbin_xy_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subbin_index00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rows</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#get_subbin_xy_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_grid.get_subbin_xy_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>Generate all neighbor of a bin
subbin_index00 = left and up subbin index</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_grid.gridsearch_coverage_grid">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_grid.</span></span><span class="sig-name descname"><span class="pre">gridsearch_coverage_grid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#gridsearch_coverage_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_grid.gridsearch_coverage_grid" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.coverage_grid –test-gridsearch_coverage_grid –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_grid</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_coverage_grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_grid.gridsearch_coverage_grid_mask">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_grid.</span></span><span class="sig-name descname"><span class="pre">gridsearch_coverage_grid_mask</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#gridsearch_coverage_grid_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_grid.gridsearch_coverage_grid_mask" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.coverage_grid –test-gridsearch_coverage_grid_mask –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_grid</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_coverage_grid_mask</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_grid.make_grid_coverage_mask">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_grid.</span></span><span class="sig-name descname"><span class="pre">make_grid_coverage_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chipsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pxl_per_bin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.6</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#make_grid_coverage_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_grid.make_grid_coverage_mask" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoint</p></li>
<li><p><strong>chipsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – width, height</p></li>
<li><p><strong>weights</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=1</em><em>]</em>) – </p></li>
<li><p><strong>pxl_per_bin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
<li><p><strong>grid_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weightgrid</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.coverage_grid –test-make_grid_coverage_mask –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_grid</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">coverage_kpts</span><span class="o">.</span><span class="n">testdata_coverage</span><span class="p">(</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pxl_per_bin</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid_steps</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weightgrid</span> <span class="o">=</span> <span class="n">make_grid_coverage_mask</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">pxl_per_bin</span><span class="p">,</span> <span class="n">grid_steps</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify result</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">weightgrid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">weightgrid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_grid.show_coverage_grid">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_grid.</span></span><span class="sig-name descname"><span class="pre">show_coverage_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subbin_xy_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_bin_centers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_bin_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_bin_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#show_coverage_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_grid.show_coverage_grid" title="Permalink to this definition"></a></dt>
<dd><p>visualizes the voting scheme on the grid. (not a mask, and no max)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_grid.sparse_grid_coverage">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_grid.</span></span><span class="sig-name descname"><span class="pre">sparse_grid_coverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chipsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pxl_per_bin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.6</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#sparse_grid_coverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_grid.sparse_grid_coverage" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoint</p></li>
<li><p><strong>chipsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – </p></li>
<li><p><strong>weights</strong> (<em>ndarray</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.coverage_grid –test-sparse_grid_coverage –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_grid</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">coverage_kpts</span><span class="o">.</span><span class="n">testdata_coverage</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">chipsize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">50</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pxl_per_bin</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid_steps</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid_sigma</span> <span class="o">=</span> <span class="mf">1.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coverage_gridtup</span> <span class="o">=</span> <span class="n">sparse_grid_coverage</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">pxl_per_bin</span><span class="p">,</span> <span class="n">grid_steps</span><span class="p">,</span> <span class="n">grid_sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_coverage_grid</span><span class="p">(</span><span class="o">*</span><span class="n">coverage_gridtup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_grid.weighted_gaussian_falloff">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_grid.</span></span><span class="sig-name descname"><span class="pre">weighted_gaussian_falloff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neighbor_subbin_sqrddist_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#weighted_gaussian_falloff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_grid.weighted_gaussian_falloff" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool.coverage_kpts">
<span id="vtool-coverage-kpts-module"></span><h2>vtool.coverage_kpts module<a class="headerlink" href="#module-vtool.coverage_kpts" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_kpts.get_coverage_kpts_gridsearch_configs">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_kpts.</span></span><span class="sig-name descname"><span class="pre">get_coverage_kpts_gridsearch_configs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#get_coverage_kpts_gridsearch_configs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_kpts.get_coverage_kpts_gridsearch_configs" title="Permalink to this definition"></a></dt>
<dd><p>testing function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_kpts.get_gaussian_weight_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_kpts.</span></span><span class="sig-name descname"><span class="pre">get_gaussian_weight_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gauss_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(19,</span> <span class="pre">19)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gauss_sigma_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gauss_norm_01</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#get_gaussian_weight_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_kpts.get_gaussian_weight_patch" title="Permalink to this definition"></a></dt>
<dd><p>2d gaussian image useful for plotting</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>patch</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.coverage_kpts –test-get_gaussian_weight_patch</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">get_gaussian_weight_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">patch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_kpts.gridsearch_kpts_coverage_mask">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_kpts.</span></span><span class="sig-name descname"><span class="pre">gridsearch_kpts_coverage_mask</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#gridsearch_kpts_coverage_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_kpts.gridsearch_kpts_coverage_mask" title="Permalink to this definition"></a></dt>
<dd><p>testing function</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.coverage_kpts –test-gridsearch_kpts_coverage_mask –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_kpts_coverage_mask</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_kpts.make_heatmask">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_kpts.</span></span><span class="sig-name descname"><span class="pre">make_heatmask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plasma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#make_heatmask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_kpts.make_heatmask" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_kpts.make_kpts_coverage_mask">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_kpts.</span></span><span class="sig-name descname"><span class="pre">make_kpts_coverage_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chipsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_patch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_blur_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_disk_hack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_blur_ksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(17,</span> <span class="pre">17)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_blur_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_gauss_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(19,</span> <span class="pre">19)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_gauss_sigma_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_agg_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_remove_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_remove_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_size_penalty_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_size_penalty_power</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_size_penalty_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#make_kpts_coverage_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_kpts.make_kpts_coverage_mask" title="Permalink to this definition"></a></dt>
<dd><p>Returns a intensity image denoting which pixels are covered by the input
keypoints</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em><em>[</em><em>ndims=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>chipsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – width height of the underlying image</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dstimg, patch</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a> (ndarray, ndarray)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:wbia)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyhesaff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyhesaff</span><span class="o">.</span><span class="n">detect_feats</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[::</span><span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipsize</span> <span class="o">=</span> <span class="n">chip</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dstimg</span><span class="p">,</span> <span class="n">patch</span> <span class="o">=</span> <span class="n">make_kpts_coverage_mask</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_patch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cov_size_penalty_on</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cov_blur_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># show results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">dstimg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_coverage_map</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">patch</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_kpts.make_kpts_heatmask">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_kpts.</span></span><span class="sig-name descname"><span class="pre">make_kpts_heatmask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chipsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plasma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#make_kpts_heatmask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_kpts.make_kpts_heatmask" title="Permalink to this definition"></a></dt>
<dd><p>makes a heatmap overlay for keypoints</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.coverage_kpts make_kpts_heatmask –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:wbia)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyhesaff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyhesaff</span><span class="o">.</span><span class="n">detect_feats</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipsize</span> <span class="o">=</span> <span class="n">chip</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">heatmask</span> <span class="o">=</span> <span class="n">make_kpts_heatmask</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">heatmask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">chip</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">qtensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img3</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">overlay_alpha_images</span><span class="p">(</span><span class="n">heatmask</span><span class="p">,</span> <span class="n">chip</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.imshow(heatmask)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_kpts2(kpts)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_kpts.show_coverage_map">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_kpts.</span></span><span class="sig-name descname"><span class="pre">show_coverage_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ell_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_mask_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#show_coverage_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_kpts.show_coverage_map" title="Permalink to this definition"></a></dt>
<dd><p>testing function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_kpts.testdata_coverage">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_kpts.</span></span><span class="sig-name descname"><span class="pre">testdata_coverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#testdata_coverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_kpts.testdata_coverage" title="Permalink to this definition"></a></dt>
<dd><p>testing function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_kpts.warp_patch_onto_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_kpts.</span></span><span class="sig-name descname"><span class="pre">warp_patch_onto_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chipshape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_agg_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_remove_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_remove_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_size_penalty_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_size_penalty_power</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_size_penalty_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#warp_patch_onto_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_kpts.warp_patch_onto_kpts" title="Permalink to this definition"></a></dt>
<dd><p>Overlays the source image onto a destination image in each keypoint location</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>patch</strong> (<em>ndarray</em>) – patch to warp (like gaussian)</p></li>
<li><p><strong>chipshape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – </p></li>
<li><p><strong>weights</strong> (<em>ndarray</em>) – score for every keypoint</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>cov_scale_factor (float):</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>mask</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.coverage_kpts –test-warp_patch_onto_kpts
python -m vtool.coverage_kpts –test-warp_patch_onto_kpts –show
python -m vtool.coverage_kpts –test-warp_patch_onto_kpts –show –hole
python -m vtool.coverage_kpts –test-warp_patch_onto_kpts –show –square
python -m vtool.coverage_kpts –test-warp_patch_onto_kpts –show –square –hole</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:wbia)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyhesaff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span>    <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyhesaff</span><span class="o">.</span><span class="n">detect_feats</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[::</span><span class="mi">15</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipshape</span> <span class="o">=</span> <span class="n">chip</span><span class="o">.</span><span class="n">shape</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cov_scale_factor</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">srcshape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius</span> <span class="o">=</span> <span class="n">srcshape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="n">radius</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SQUARE</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">argflag</span><span class="p">(</span><span class="s1">&#39;--square&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">HOLE</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">argflag</span><span class="p">(</span><span class="s1">&#39;--hole&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">SQUARE</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">patch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">srcshape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">patch</span> <span class="o">=</span> <span class="n">ptool</span><span class="o">.</span><span class="n">gaussian_patch</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">srcshape</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span> <span class="c1">#, norm_01=False)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">patch</span> <span class="o">=</span> <span class="n">patch</span> <span class="o">/</span> <span class="n">patch</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">HOLE</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">patch</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">patch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">patch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dstimg</span> <span class="o">=</span> <span class="n">warp_patch_onto_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">patch</span><span class="p">,</span> <span class="n">chipshape</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">cov_scale_factor</span><span class="o">=</span><span class="n">cov_scale_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dstimg stats </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_stats_str</span><span class="p">(</span><span class="n">dstimg</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;patch stats </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_stats_str</span><span class="p">(</span><span class="n">patch</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print(patch.sum())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">inbounds</span><span class="p">(</span><span class="n">dstimg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">eq</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># show results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">dstimg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_coverage_map</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">patch</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.coverage_kpts.warped_patch_generator">
<span class="sig-prename descclassname"><span class="pre">vtool.coverage_kpts.</span></span><span class="sig-name descname"><span class="pre">warped_patch_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affmat_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_size_penalty_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_size_penalty_power</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_size_penalty_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#warped_patch_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.coverage_kpts.warped_patch_generator" title="Permalink to this definition"></a></dt>
<dd><p>generator that warps the patches (like gaussian) onto an image with dsize
using constant memory.</p>
<p>output must be used or copied on every iteration otherwise the next output
will clobber the previous</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html#warpaffine">http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html#warpaffine</a></p>
</dd></dl>

</section>
<section id="module-vtool.demodata">
<span id="vtool-demodata-module"></span><h2>vtool.demodata module<a class="headerlink" href="#module-vtool.demodata" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.dummy_img">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">dummy_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#dummy_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.dummy_img" title="Permalink to this definition"></a></dt>
<dd><p>Creates a demodata test image</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.dummy_seed">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">dummy_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#dummy_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.dummy_seed" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.force_kpts_feasibility">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">force_kpts_feasibility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xys_nonneg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#force_kpts_feasibility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.force_kpts_feasibility" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.get_dummy_dpts">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">get_dummy_dpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.uint8'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_dpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.get_dummy_dpts" title="Permalink to this definition"></a></dt>
<dd><p>Random SIFTish keypoints</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.get_dummy_invV_mats">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">get_dummy_invV_mats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_invV_mats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.get_dummy_invV_mats" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.get_dummy_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">get_dummy_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.get_dummy_kpts" title="Permalink to this definition"></a></dt>
<dd><p>Some testing data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – number of times to duplicate</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.10)"><em>type</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>kpts -  keypoints</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float32_t, ndim=2][ndims=2]</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/demodata.py get_dummy_kpts</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">get_dummy_kpts</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.get_dummy_kpts_pair">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">get_dummy_kpts_pair</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wh_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(30,</span> <span class="pre">30)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wh_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_kpts_pair"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.get_dummy_kpts_pair" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.get_dummy_matching_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">get_dummy_matching_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_matching_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.get_dummy_matching_kpts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.get_dummy_xy">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">get_dummy_xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_xy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.get_dummy_xy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.get_kpts_dummy_img">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">get_kpts_dummy_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_kpts_dummy_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.get_kpts_dummy_img" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>sf</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>img</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sf</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span>  <span class="n">get_kpts_dummy_img</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">sf</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.get_testdata_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">get_testdata_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_vecs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_testdata_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.get_testdata_kpts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.make_dummy_fm">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">make_dummy_fm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nKpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#make_dummy_fm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.make_dummy_fm" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.perterb_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">perterb_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invV_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#perterb_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.perterb_kpts" title="Permalink to this definition"></a></dt>
<dd><p>Adds normally distributed pertibations to keypoints</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.perterbed_grid_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">perterbed_grid_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#perterbed_grid_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.perterbed_grid_kpts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.testdata_binary_scores">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">testdata_binary_scores</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_binary_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.testdata_binary_scores" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.testdata_dummy_matches">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">testdata_dummy_matches</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_dummy_matches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.testdata_dummy_matches" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>matches_testtup</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.demodata –test-testdata_dummy_matches –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matches_testtup</span> <span class="o">=</span> <span class="n">testdata_dummy_matches</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">)</span> <span class="o">=</span> <span class="n">matches_testtup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_chipmatch2</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_figtitle</span><span class="p">(</span><span class="s1">&#39;Dummy matches&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.testdata_dummy_sift">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">testdata_dummy_sift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nPts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_dummy_sift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.testdata_dummy_sift" title="Permalink to this definition"></a></dt>
<dd><p>Makes a demodata sift descriptor that has the uint8 * 512 hack
like hesaff returns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nPts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – (default = 10)</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.demodata –test-testdata_dummy_sift</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nPts</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sift</span> <span class="o">=</span> <span class="n">testdata_dummy_sift</span><span class="p">(</span><span class="n">nPts</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">vt</span><span class="o">.</span><span class="n">check_sift_validity</span><span class="p">(</span><span class="n">sift</span><span class="p">),</span> <span class="s1">&#39;bad SIFT properties&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#assert np.allclose(((sift / 512) ** 2).sum(axis=1), 1, rtol=.01), &#39;bad SIFT property&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#assert np.all(sift / 512 &lt; .2), &#39;bad SIFT property&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.testdata_nonmonotonic">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">testdata_nonmonotonic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_nonmonotonic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.testdata_nonmonotonic" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata.testdata_ratio_matches">
<span class="sig-prename descclassname"><span class="pre">vtool.demodata.</span></span><span class="sig-name descname"><span class="pre">testdata_ratio_matches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'easy1.png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'easy2.png'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_ratio_matches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata.testdata_ratio_matches" title="Permalink to this definition"></a></dt>
<dd><p>Runs simple ratio-test matching between two images.
Technically this is not demodata data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – </p></li>
<li><p><strong>fname2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>matches_testtup</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.demodata –test-testdata_ratio_matches
python -m vtool.demodata –test-testdata_ratio_matches –help
python -m vtool.demodata –test-testdata_ratio_matches –show
python -m vtool.demodata –test-testdata_ratio_matches –show –ratio_thresh=1.1 –rotation_invariance</p>
<p>python -m vtool.demodata –test-testdata_ratio_matches –show –ratio_thresh=.625 –rotation_invariance –fname1 easy1.png –fname2 easy3.png
python -m vtool.demodata –test-testdata_ratio_matches –show –ratio_thresh=.625 –no-rotation_invariance –fname1 easy1.png –fname2 easy3.png</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname1&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname2&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;easy2.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_extract_features_default_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span><span class="p">[</span><span class="s1">&#39;ratio_thresh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">.625</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">argparse_dict</span><span class="p">(</span><span class="n">default_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matches_testtup</span> <span class="o">=</span> <span class="n">testdata_ratio_matches</span><span class="p">(</span><span class="n">fname1</span><span class="p">,</span> <span class="n">fname2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm_RAT</span><span class="p">,</span> <span class="n">fs_RAT</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">)</span> <span class="o">=</span> <span class="n">matches_testtup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_chipmatch2</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm_RAT</span><span class="p">,</span> <span class="n">fs_RAT</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_matches</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fm_RAT</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">fs_RAT</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Simple matches using the Lowe</span><span class="se">\&#39;</span><span class="s1">s ratio test&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">title</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> num_matches=</span><span class="si">%r</span><span class="s1">, score_sum=</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">num_matches</span><span class="p">,</span> <span class="n">score_sum</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_figtitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-vtool.depricated">
<span id="vtool-depricated-module"></span><h2>vtool.depricated module<a class="headerlink" href="#module-vtool.depricated" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vtool.depricated.ThumbnailCacheContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.depricated.</span></span><span class="sig-name descname"><span class="pre">ThumbnailCacheContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uuid_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asrgb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thumb_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thumb_dpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">appname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vtool'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/depricated.html#ThumbnailCacheContext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.depricated.ThumbnailCacheContext" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Lazy computation of of images as thumbnails.</p>
<p>DEPRICATED</p>
<p>Just pass a list of uuids corresponding to the images. Then compute images
flagged as dirty and give them back to the context.  thumbs_list will be
populated on contex exit</p>
<dl class="py method">
<dt class="sig sig-object py" id="vtool.depricated.ThumbnailCacheContext.filter_dirty_items">
<span class="sig-name descname"><span class="pre">filter_dirty_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/depricated.html#ThumbnailCacheContext.filter_dirty_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.depricated.ThumbnailCacheContext.filter_dirty_items" title="Permalink to this definition"></a></dt>
<dd><p>Returns only items marked by the context as dirty</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.depricated.ThumbnailCacheContext.save_dirty_thumbs_from_images">
<span class="sig-name descname"><span class="pre">save_dirty_thumbs_from_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/depricated.html#ThumbnailCacheContext.save_dirty_thumbs_from_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.depricated.ThumbnailCacheContext.save_dirty_thumbs_from_images" title="Permalink to this definition"></a></dt>
<dd><p>Pass in any images marked by the context as dirty here</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-vtool.distance">
<span id="vtool-distance-module"></span><h2>vtool.distance module<a class="headerlink" href="#module-vtool.distance" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.L1">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">L1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float64'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.L1" title="Permalink to this definition"></a></dt>
<dd><p>returns L1 (aka manhatten or grid) distance between two histograms</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.L2">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">L2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.L2" title="Permalink to this definition"></a></dt>
<dd><p>returns L2 (aka euclidean or standard) distance between two histograms</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.L2_root_sift">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">L2_root_sift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2_root_sift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.L2_root_sift" title="Permalink to this definition"></a></dt>
<dd><p>Normalized Root-SIFT L2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist1</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</p></li>
<li><p><strong>hist2</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>euclidean distance between 0-1 normalized sift descriptors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.L2_sift">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">L2_sift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2_sift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.L2_sift" title="Permalink to this definition"></a></dt>
<dd><p>Normalized SIFT L2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist1</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</p></li>
<li><p><strong>hist2</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>euclidean distance between 0-1 normalized sift descriptors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –test-L2_sift</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sift1</span><span class="p">,</span> <span class="n">sift2</span><span class="p">,</span> <span class="n">sift3</span><span class="p">,</span> <span class="n">sift4</span><span class="p">,</span> <span class="n">sift5</span> <span class="o">=</span> <span class="n">testdata_sift2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2_dist</span> <span class="o">=</span> <span class="n">L2_sift</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dist</span> <span class="o">=</span> <span class="n">L2_sift</span><span class="p">(</span><span class="n">sift4</span><span class="p">,</span> <span class="n">sift5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">max_dist</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">l2_dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.L2_sift_sqrd">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">L2_sift_sqrd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2_sift_sqrd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.L2_sift_sqrd" title="Permalink to this definition"></a></dt>
<dd><p>Normalized SIFT L2**2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist1</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</p></li>
<li><p><strong>hist2</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>squared euclidean distance between 0-1 normalized sift descriptors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.L2_sqrd">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">L2_sqrd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float64'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2_sqrd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.L2_sqrd" title="Permalink to this definition"></a></dt>
<dd><p>returns the squared L2 distance</p>
<dl class="simple">
<dt># FIXME:</dt><dd><p>if hist1.shape = (0,) and hist.shape = (0,) then result=0.0</p>
</dd>
<dt>SeeAlso:</dt><dd><p>L2</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">exec_funckw</span><span class="p">(</span><span class="n">L2_sqrd</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2dist</span> <span class="o">=</span> <span class="n">L2_sqrd</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">l2dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.bar_L2_sift">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">bar_L2_sift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#bar_L2_sift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.bar_L2_sift" title="Permalink to this definition"></a></dt>
<dd><p>Normalized SIFT L2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist1</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</p></li>
<li><p><strong>hist2</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –test-bar_L2_sift</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">barl2_dist</span> <span class="o">=</span> <span class="n">bar_L2_sift</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">barl2_dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.bar_cos_sift">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">bar_cos_sift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#bar_cos_sift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.bar_cos_sift" title="Permalink to this definition"></a></dt>
<dd><p>1 - cos dist</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.closest_point">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">closest_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distfunc=&lt;function</span> <span class="pre">L2_sqrd&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#closest_point"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.closest_point" title="Permalink to this definition"></a></dt>
<dd><p>finds the nearest point(s) in pts to (x, y)
pt = np.array([1])
pt_arr = np.array([1.1, 2, .95, 20])[:, None]
distfunc = vt.L2_sqrd</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.compute_distances">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">compute_distances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['L1',</span> <span class="pre">'L2']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#compute_distances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.compute_distances" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist1</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>hist2</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>dist_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – (default = [‘L1’, ‘L2’])</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dist_dict</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –test-compute_distances</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">,</span> <span class="s1">&#39;L2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_dict</span> <span class="o">=</span> <span class="n">compute_distances</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">,</span> <span class="n">dist_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">dist_dict</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.cos_sift">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">cos_sift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#cos_sift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.cos_sift" title="Permalink to this definition"></a></dt>
<dd><p>cos dist</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –test-cos_sift</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2_dist</span> <span class="o">=</span> <span class="n">cos_sift</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.cosine_dist">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">cosine_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#cosine_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.cosine_dist" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.cyclic_distance">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">cyclic_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modulo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#cyclic_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.cyclic_distance" title="Permalink to this definition"></a></dt>
<dd><p>returns an unsigned distance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr1</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>arr2</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>modulo</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
<li><p><strong>out</strong> (<em>ndarray</em>) – (default = None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>arr_dist</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance cyclic_distance</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modulo</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># doesnt matter what offset is</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">modulo</span> <span class="o">+</span> <span class="n">offset</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">arr1</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_dist</span> <span class="o">=</span> <span class="n">cyclic_distance</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="n">modulo</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;arr_dist =</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_dist</span><span class="p">),))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.det_distance">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">det_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">det1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">det2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#det_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.det_distance" title="Permalink to this definition"></a></dt>
<dd><p>Returns how far off determinants are from one another</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaledist</span> <span class="o">=</span> <span class="n">det_distance</span><span class="p">(</span><span class="n">det1</span><span class="p">,</span> <span class="n">det2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">scaledist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.emd">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">emd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cost_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sift'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#emd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.emd" title="Permalink to this definition"></a></dt>
<dd><p>earth mover’s distance by robjects(lpSovle::lp.transport)
require: lpsolve55-5.5.0.9.win32-py2.7.exe</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –test-emd</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emd_dists</span> <span class="o">=</span> <span class="n">emd</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">emd_dists</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.haversine">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">haversine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latlon1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latlon2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#haversine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.haversine" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the great circle distance between two points
on the earth (specified in decimal degrees)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latlon1</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>latlon2</strong> (<em>ndarray</em>) – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>en.wikipedia.org/wiki/Haversine_formula
gis.stackexchange.com/questions/81551/matching-gps-tracks
stackoverflow.com/questions/4913349/haversine-distance-gps-points</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –exec-haversine</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.spatial.distance</span> <span class="k">as</span> <span class="nn">spdist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">functools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gpsarr_track_list_</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="o">-</span><span class="mf">80.21895315</span><span class="p">,</span> <span class="o">-</span><span class="mf">158.81099213</span><span class="p">],</span>
<span class="gp">... </span>             <span class="p">[</span> <span class="o">-</span><span class="mf">12.08338926</span><span class="p">,</span>   <span class="mf">67.50368014</span><span class="p">],</span>
<span class="gp">... </span>             <span class="p">[</span> <span class="o">-</span><span class="mf">11.08338926</span><span class="p">,</span>   <span class="mf">67.50368014</span><span class="p">],</span>
<span class="gp">... </span>             <span class="p">[</span> <span class="o">-</span><span class="mf">11.08338926</span><span class="p">,</span>   <span class="mf">67.50368014</span><span class="p">],]</span>
<span class="gp">... </span>   <span class="p">),</span>
<span class="gp">... </span>   <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>   <span class="mf">9.77816711</span><span class="p">,</span>  <span class="o">-</span><span class="mf">17.27471498</span><span class="p">],</span>
<span class="gp">... </span>             <span class="p">[</span> <span class="o">-</span><span class="mf">51.67678814</span><span class="p">,</span> <span class="o">-</span><span class="mf">158.91065495</span><span class="p">],])</span>
<span class="gp">... </span>   <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latlon1</span> <span class="o">=</span> <span class="n">gpsarr_track_list_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latlon2</span> <span class="o">=</span> <span class="n">gpsarr_track_list_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kilometers</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">haversine</span><span class="p">(</span><span class="n">latlon1</span><span class="p">,</span> <span class="n">latlon2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">haversin_pdist</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">spdist</span><span class="o">.</span><span class="n">pdist</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">vt</span><span class="o">.</span><span class="n">haversine</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_vector_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">haversin_pdist</span><span class="p">,</span> <span class="n">gpsarr_track_list_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_matrix_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">spdist</span><span class="o">.</span><span class="n">squareform</span><span class="p">,</span> <span class="n">dist_vector_list</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.hist_isect">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">hist_isect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#hist_isect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.hist_isect" title="Permalink to this definition"></a></dt>
<dd><p>returns histogram intersection distance between two histograms</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.nearest_point">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">nearest_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conflict_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'next'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">__next_counter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#nearest_point"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.nearest_point" title="Permalink to this definition"></a></dt>
<dd><p>finds the nearest point(s) in pts to (x, y)</p>
<p>TODO: depricate</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.ori_distance">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">ori_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ori1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#ori_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.ori_distance" title="Permalink to this definition"></a></dt>
<dd><p>Returns the unsigned distance between two angles</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/1878907/the-smallest-difference-between-2-angles">http://stackoverflow.com/questions/1878907/the-smallest-difference-between-2-angles</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –test-ori_distance</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori1</span> <span class="o">=</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">TAU</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori2</span> <span class="o">=</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">TAU</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_</span> <span class="o">=</span> <span class="n">ori_distance</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">ori2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">ori2</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">dist_</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori1</span> <span class="o">=</span> <span class="mf">.3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori2</span> <span class="o">=</span> <span class="mf">6.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_</span> <span class="o">=</span> <span class="n">ori_distance</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">ori2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">dist_</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.pdist_argsort">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">pdist_argsort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#pdist_argsort"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.pdist_argsort" title="Permalink to this definition"></a></dt>
<dd><p>Sorts 2d indicies by their distnace matrix output from scipy.spatial.distance
x = np.array([  3.05555556e-03,   1.47619797e+04,   1.47619828e+04])</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>ndarray</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sortx_2d</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –test-pdist_argsort</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">21695.78</span><span class="p">,</span> <span class="mf">10943.76</span><span class="p">,</span> <span class="mf">10941.44</span><span class="p">,</span> <span class="mf">25867.64</span><span class="p">,</span> <span class="mf">10752.03</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="mf">10754.35</span><span class="p">,</span> <span class="mf">4171.86</span><span class="p">,</span> <span class="mf">2.32</span><span class="p">,</span> <span class="mf">14923.89</span><span class="p">,</span> <span class="mf">14926.2</span> <span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>             <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sortx_2d</span> <span class="o">=</span> <span class="n">pdist_argsort</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;sortx_2d = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sortx_2d</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">sortx_2d = [(2, 3), (1, 4), (1, 2), (1, 3), (0, 3), (0, 2), (2, 4), (3, 4), (0, 1), (0, 4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.pdist_indicies">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">pdist_indicies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#pdist_indicies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.pdist_indicies" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.safe_pdist">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">safe_pdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#safe_pdist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.safe_pdist" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Kwargs:</dt><dd><p>metric = ut.absdiff</p>
</dd>
<dt>SeeAlso:</dt><dd><p>scipy.spatial.distance.pdist</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.signed_cyclic_distance">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">signed_cyclic_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modulo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#signed_cyclic_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.signed_cyclic_distance" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.signed_ori_distance">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">signed_ori_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ori1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#signed_ori_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.signed_ori_distance" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ori1</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>ori2</strong> (<em>ndarray</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ori_dist</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –exec-signed_ori_distance</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="mf">.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_dist</span> <span class="o">=</span> <span class="n">signed_ori_distance</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">ori2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;ori_dist = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">ori_dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">),))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.testdata_hist">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">testdata_hist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#testdata_hist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.testdata_hist" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.testdata_sift2">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">testdata_sift2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#testdata_sift2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.testdata_sift2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.understanding_pseudomax_props">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">understanding_pseudomax_props</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#understanding_pseudomax_props"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.understanding_pseudomax_props" title="Permalink to this definition"></a></dt>
<dd><p>Function showing some properties of distances between normalized pseudomax vectors</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –test-understanding_pseudomax_props</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;+---&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mode = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mode</span><span class="p">,))</span>
<span class="gp">... </span>    <span class="n">result</span> <span class="o">=</span> <span class="n">understanding_pseudomax_props</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;L___&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance.wrapped_distance">
<span class="sig-prename descclassname"><span class="pre">vtool.distance.</span></span><span class="sig-name descname"><span class="pre">wrapped_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#wrapped_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance.wrapped_distance" title="Permalink to this definition"></a></dt>
<dd><p>base = TAU corresponds to ori diff</p>
</dd></dl>

</section>
<section id="module-vtool.ellipse">
<span id="vtool-ellipse-module"></span><h2>vtool.ellipse module<a class="headerlink" href="#module-vtool.ellipse" title="Permalink to this headline"></a></h2>
<p>OLD MODULE, needs reimplemenetation of select features and deprication</p>
<p>This module should handle all things elliptical</p>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.adaptive_scale">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">adaptive_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nScales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#adaptive_scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.adaptive_scale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.check_kpts_in_bounds">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">check_kpts_in_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#check_kpts_in_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.check_kpts_in_bounds" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.circular_distance">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">circular_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#circular_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.circular_distance" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.expand_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">expand_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#expand_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.expand_kpts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.expand_scales">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">expand_scales</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nScales</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#expand_scales"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.expand_scales" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.expand_subscales">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">expand_subscales</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subscale_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#expand_subscales"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.expand_subscales" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.extrema_neighbors">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">extrema_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extrema_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nBins</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#extrema_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.extrema_neighbors" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.find_maxima">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">find_maxima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#find_maxima"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.find_maxima" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.find_maxima_with_neighbors">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">find_maxima_with_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scalar_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#find_maxima_with_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.find_maxima_with_neighbors" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.gradient_magnitude">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">gradient_magnitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#gradient_magnitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.gradient_magnitude" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.homogenous_circle_pts">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">homogenous_circle_pts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nSamples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#homogenous_circle_pts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.homogenous_circle_pts" title="Permalink to this definition"></a></dt>
<dd><p>Make a list of homogenous circle points</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.interpolate_between">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">interpolate_between</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peak_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nScales</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_between"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.interpolate_between" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.interpolate_maxima">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">interpolate_maxima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scalar_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_maxima"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.interpolate_maxima" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.interpolate_peaks">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">interpolate_peaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_data_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_data_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_peaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.interpolate_peaks" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.interpolate_peaks2">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">interpolate_peaks2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_data_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_data_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_peaks2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.interpolate_peaks2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.kpts_matrices">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">kpts_matrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#kpts_matrices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.kpts_matrices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.sample_ell_border_pts">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">sample_ell_border_pts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expanded_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#sample_ell_border_pts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.sample_ell_border_pts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.sample_ell_border_vals">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">sample_ell_border_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expanded_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nKp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nScales</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#sample_ell_border_vals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.sample_ell_border_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.sample_uniform">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">sample_uniform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#sample_uniform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.sample_uniform" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>SeeAlso:</dt><dd><p>python -m pyhesaff.tests.test_ellipse –test-in_depth_ellipse –show</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ellipse.subscale_peaks">
<span class="sig-prename descclassname"><span class="pre">vtool.ellipse.</span></span><span class="sig-name descname"><span class="pre">subscale_peaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">border_vals_sum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nScales</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#subscale_peaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ellipse.subscale_peaks" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool.exif">
<span id="vtool-exif-module"></span><h2>vtool.exif module<a class="headerlink" href="#module-vtool.exif" title="Permalink to this headline"></a></h2>
<p class="rubric">References</p>
<p><a class="reference external" href="http://www.exiv2.org/tags.html">http://www.exiv2.org/tags.html</a></p>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p><a class="reference external" href="https://github.com/recurser/exif-orientation-examples">https://github.com/recurser/exif-orientation-examples</a></p>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.exif.check_exif_keys">
<span class="sig-prename descclassname"><span class="pre">vtool.exif.</span></span><span class="sig-name descname"><span class="pre">check_exif_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pil_img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#check_exif_keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.exif.check_exif_keys" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.exif.convert_degrees">
<span class="sig-prename descclassname"><span class="pre">vtool.exif.</span></span><span class="sig-name descname"><span class="pre">convert_degrees</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#convert_degrees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.exif.convert_degrees" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to convert the GPS coordinates stored in the EXIF to degress in float format</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Geographic_coordinate_conversion">http://en.wikipedia.org/wiki/Geographic_coordinate_conversion</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.exif.get_exif_dict">
<span class="sig-prename descclassname"><span class="pre">vtool.exif.</span></span><span class="sig-name descname"><span class="pre">get_exif_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pil_img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exif_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.exif.get_exif_dict" title="Permalink to this definition"></a></dt>
<dd><p>Returns exif dictionary by TAGID</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.exif.get_exif_dict2">
<span class="sig-prename descclassname"><span class="pre">vtool.exif.</span></span><span class="sig-name descname"><span class="pre">get_exif_dict2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pil_img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exif_dict2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.exif.get_exif_dict2" title="Permalink to this definition"></a></dt>
<dd><p>Returns exif dictionary by TAG (less efficient)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.exif.get_exif_tagids">
<span class="sig-prename descclassname"><span class="pre">vtool.exif.</span></span><span class="sig-name descname"><span class="pre">get_exif_tagids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tag_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exif_tagids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.exif.get_exif_tagids" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.exif.get_exist">
<span class="sig-prename descclassname"><span class="pre">vtool.exif.</span></span><span class="sig-name descname"><span class="pre">get_exist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.exif.get_exist" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.exif.get_lat_lon">
<span class="sig-prename descclassname"><span class="pre">vtool.exif.</span></span><span class="sig-name descname"><span class="pre">get_lat_lon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exif_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">1,</span> <span class="pre">-</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_lat_lon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.exif.get_lat_lon" title="Permalink to this definition"></a></dt>
<dd><p>Returns the latitude and longitude, if available, from the provided
exif_data2 (obtained through exif_data2 above)</p>
<p class="rubric">Notes</p>
<p>Might need to downgrade to Pillow 2.9.0 to solve a bug with getting GPS
<a class="reference external" href="https://github.com/python-pillow/Pillow/issues/1477">https://github.com/python-pillow/Pillow/issues/1477</a></p>
<p>python -c “from PIL import Image; print(Image.PILLOW_VERSION)”</p>
<p>pip uninstall Pillow
pip install Pillow==2.9</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.exif –test-get_lat_lon</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exif_dict</span> <span class="o">=</span> <span class="n">get_exif_dict</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latlon</span> <span class="o">=</span> <span class="n">get_lat_lon</span><span class="p">(</span><span class="n">exif_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">latlon</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.exif.get_orientation">
<span class="sig-prename descclassname"><span class="pre">vtool.exif.</span></span><span class="sig-name descname"><span class="pre">get_orientation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exif_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'warn'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_orientation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.exif.get_orientation" title="Permalink to this definition"></a></dt>
<dd><p>Returns the image orientation, if available, from the provided
exif_data2 (obtained through exif_data2 above)</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.exif –test-get_orientation</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://wildbookiarepository.azureedge.net/models/orientation.zip&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">images_path</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_zipped_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">image_filename</span> <span class="o">=</span> <span class="s1">&#39;orientation_</span><span class="si">%05d</span><span class="s1">.JPG&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">images_path</span><span class="p">,</span> <span class="n">image_filename</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">exif_dict</span> <span class="o">=</span> <span class="n">get_exif_dict</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">orient</span> <span class="o">=</span> <span class="n">get_orientation</span><span class="p">(</span><span class="n">exif_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pil_img</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">orient</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1, 6, 8]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.exif.get_orientation_str">
<span class="sig-prename descclassname"><span class="pre">vtool.exif.</span></span><span class="sig-name descname"><span class="pre">get_orientation_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exif_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_orientation_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.exif.get_orientation_str" title="Permalink to this definition"></a></dt>
<dd><p>Returns the image orientation strings, if available, from the provided
exif_data2 (obtained through exif_data2 above)</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.exif –test-get_orientation_str</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://wildbookiarepository.azureedge.net/models/orientation.zip&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">images_path</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_zipped_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">image_filename</span> <span class="o">=</span> <span class="s1">&#39;orientation_</span><span class="si">%05d</span><span class="s1">.JPG&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">images_path</span><span class="p">,</span> <span class="n">image_filename</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">exif_dict</span> <span class="o">=</span> <span class="n">get_exif_dict</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">orient_str</span> <span class="o">=</span> <span class="n">get_orientation_str</span><span class="p">(</span><span class="n">exif_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pil_img</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">orient_str</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[&#39;Normal&#39;, &#39;90 Clockwise&#39;, &#39;90 Counter-Clockwise&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.exif.get_unixtime">
<span class="sig-prename descclassname"><span class="pre">vtool.exif.</span></span><span class="sig-name descname"><span class="pre">get_unixtime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exif_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_unixtime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.exif.get_unixtime" title="Permalink to this definition"></a></dt>
<dd><p>TODO: Exif.Image.TimeZoneOffset</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exif_dict</span> <span class="o">=</span> <span class="n">get_exif_dict</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pil_img</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.exif.get_unixtime_gps">
<span class="sig-prename descclassname"><span class="pre">vtool.exif.</span></span><span class="sig-name descname"><span class="pre">get_unixtime_gps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exif_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_unixtime_gps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.exif.get_unixtime_gps" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.exif.make_exif_dict_human_readable">
<span class="sig-prename descclassname"><span class="pre">vtool.exif.</span></span><span class="sig-name descname"><span class="pre">make_exif_dict_human_readable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exif_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#make_exif_dict_human_readable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.exif.make_exif_dict_human_readable" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.exif.parse_exif_unixtime">
<span class="sig-prename descclassname"><span class="pre">vtool.exif.</span></span><span class="sig-name descname"><span class="pre">parse_exif_unixtime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#parse_exif_unixtime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.exif.parse_exif_unixtime" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>image_fpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>unixtime</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.exif –test-parse_exif_unixtime</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unixtime</span> <span class="o">=</span> <span class="n">parse_exif_unixtime</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">unixtime</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.exif.parse_exif_unixtime_gps">
<span class="sig-prename descclassname"><span class="pre">vtool.exif.</span></span><span class="sig-name descname"><span class="pre">parse_exif_unixtime_gps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#parse_exif_unixtime_gps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.exif.parse_exif_unixtime_gps" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.exif.read_all_exif_tags">
<span class="sig-prename descclassname"><span class="pre">vtool.exif.</span></span><span class="sig-name descname"><span class="pre">read_all_exif_tags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pil_img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_all_exif_tags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.exif.read_all_exif_tags" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.exif.read_exif">
<span class="sig-prename descclassname"><span class="pre">vtool.exif.</span></span><span class="sig-name descname"><span class="pre">read_exif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_exif"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.exif.read_exif" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.exif.read_exif_tags">
<span class="sig-prename descclassname"><span class="pre">vtool.exif.</span></span><span class="sig-name descname"><span class="pre">read_exif_tags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pil_img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exif_tagid_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_exif_tags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.exif.read_exif_tags" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.exif.read_one_exif_tag">
<span class="sig-prename descclassname"><span class="pre">vtool.exif.</span></span><span class="sig-name descname"><span class="pre">read_one_exif_tag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pil_img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_one_exif_tag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.exif.read_one_exif_tag" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool.features">
<span id="vtool-features-module"></span><h2>vtool.features module<a class="headerlink" href="#module-vtool.features" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.features.detect_opencv_keypoints">
<span class="sig-prename descclassname"><span class="pre">vtool.features.</span></span><span class="sig-name descname"><span class="pre">detect_opencv_keypoints</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#detect_opencv_keypoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.features.detect_opencv_keypoints" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.features.extract_feature_from_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.features.</span></span><span class="sig-name descname"><span class="pre">extract_feature_from_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#extract_feature_from_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.features.extract_feature_from_patch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.features.extract_features">
<span class="sig-prename descclassname"><span class="pre">vtool.features.</span></span><span class="sig-name descname"><span class="pre">extract_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_or_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hesaff+sift'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#extract_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.features.extract_features" title="Permalink to this definition"></a></dt>
<dd><p>calls pyhesaff’s main driver function for detecting hessian affine keypoints.
extra parameters can be passed to the hessian affine detector by using
kwargs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_or_fpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – image file path on disk</p></li>
<li><p><strong>use_adaptive_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
<li><p><strong>nogravity_hack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(kpts, vecs)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.features –test-extract_features
python -m vtool.features –test-extract_features –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.features</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;lena.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat_type</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">argval</span><span class="p">(</span><span class="s1">&#39;--feat_type&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;hesaff+sift&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyhesaff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">parse_dict_from_argv</span><span class="p">(</span><span class="n">pyhesaff</span><span class="o">.</span><span class="n">get_hesaff_default_params</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#(kpts, vecs) = extract_features(img_fpath)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">extract_features</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">feat_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Show keypoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.figure(fnum=1, doclf=True, docla=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.imshow(imgBGR)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_kpts2(kpts, ori=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">interact_keypoints</span><span class="o">.</span><span class="n">ishow_keypoints</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ell_alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;distinct&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.features.get_extract_features_default_params">
<span class="sig-prename descclassname"><span class="pre">vtool.features.</span></span><span class="sig-name descname"><span class="pre">get_extract_features_default_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#get_extract_features_default_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.features.get_extract_features_default_params" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.features –test-get_extract_features_default_params</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.features</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_dict</span> <span class="o">=</span> <span class="n">get_extract_features_default_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">param_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.features.test_mser">
<span class="sig-prename descclassname"><span class="pre">vtool.features.</span></span><span class="sig-name descname"><span class="pre">test_mser</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#test_mser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.features.test_mser" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool.fontdemo">
<span id="vtool-fontdemo-module"></span><h2>vtool.fontdemo module<a class="headerlink" href="#module-vtool.fontdemo" title="Permalink to this headline"></a></h2>
<p class="rubric">References</p>
<p><a class="reference external" href="https://dbader.org/blog/monochrome-font-rendering-with-freetype-and-python">https://dbader.org/blog/monochrome-font-rendering-with-freetype-and-python</a>
<a class="reference external" href="https://gist.github.com/dbader/5488053#file-fontdemo-py-L244">https://gist.github.com/dbader/5488053#file-fontdemo-py-L244</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="vtool.fontdemo.Bitmap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.fontdemo.</span></span><span class="sig-name descname"><span class="pre">Bitmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Bitmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.fontdemo.Bitmap" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A 2D bitmap image represented as a list of byte values. Each byte indicates the state
of a single pixel in the bitmap. A value of 0 indicates that the pixel is <cite>off</cite>
and any other value indicates that it is <cite>on</cite>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="vtool.fontdemo.Bitmap.bitblt">
<span class="sig-name descname"><span class="pre">bitblt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Bitmap.bitblt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.fontdemo.Bitmap.bitblt" title="Permalink to this definition"></a></dt>
<dd><p>Copy all pixels from <cite>src</cite> into this bitmap</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtool.fontdemo.Font">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.fontdemo.</span></span><span class="sig-name descname"><span class="pre">Font</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Font"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.fontdemo.Font" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vtool.fontdemo.Font.glyph_for_character">
<span class="sig-name descname"><span class="pre">glyph_for_character</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">char</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Font.glyph_for_character"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.fontdemo.Font.glyph_for_character" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.fontdemo.Font.kerning_offset">
<span class="sig-name descname"><span class="pre">kerning_offset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">previous_char</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">char</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Font.kerning_offset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.fontdemo.Font.kerning_offset" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.fontdemo.Font.render_character">
<span class="sig-name descname"><span class="pre">render_character</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">char</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Font.render_character"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.fontdemo.Font.render_character" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.fontdemo.Font.render_text">
<span class="sig-name descname"><span class="pre">render_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Font.render_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.fontdemo.Font.render_text" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.fontdemo.Font.text_dimensions">
<span class="sig-name descname"><span class="pre">text_dimensions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Font.text_dimensions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.fontdemo.Font.text_dimensions" title="Permalink to this definition"></a></dt>
<dd><p>Return (width, height, baseline) of <cite>text</cite> rendered in the current
font.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtool.fontdemo.Glyph">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.fontdemo.</span></span><span class="sig-name descname"><span class="pre">Glyph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pixels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">advance_width</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Glyph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.fontdemo.Glyph" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="vtool.fontdemo.Glyph.from_glyphslot">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_glyphslot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Glyph.from_glyphslot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.fontdemo.Glyph.from_glyphslot" title="Permalink to this definition"></a></dt>
<dd><p>Construct and return a Glyph object from a FreeType GlyphSlot.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.fontdemo.Glyph.height">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">height</span></span><a class="headerlink" href="#vtool.fontdemo.Glyph.height" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.fontdemo.Glyph.unpack_mono_bitmap">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unpack_mono_bitmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bitmap</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#Glyph.unpack_mono_bitmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.fontdemo.Glyph.unpack_mono_bitmap" title="Permalink to this definition"></a></dt>
<dd><p>Unpack a freetype FT_LOAD_TARGET_MONO glyph bitmap into a bytearray where each
pixel is represented by a single byte.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.fontdemo.Glyph.width">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">width</span></span><a class="headerlink" href="#vtool.fontdemo.Glyph.width" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.fontdemo.font_demo">
<span class="sig-prename descclassname"><span class="pre">vtool.fontdemo.</span></span><span class="sig-name descname"><span class="pre">font_demo</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#font_demo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.fontdemo.font_demo" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.fontdemo font_demo –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.fontdemo</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">font_demo</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.fontdemo.get_text_test_img">
<span class="sig-prename descclassname"><span class="pre">vtool.fontdemo.</span></span><span class="sig-name descname"><span class="pre">get_text_test_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/fontdemo.html#get_text_test_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.fontdemo.get_text_test_img" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>text</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – </p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.fontdemo get_text_test_img –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.fontdemo</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A012&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text_img</span> <span class="o">=</span> <span class="n">get_text_test_img</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;text_img = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">text_img</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">text_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-vtool.geometry">
<span id="vtool-geometry-module"></span><h2>vtool.geometry module<a class="headerlink" href="#module-vtool.geometry" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.bbox_center">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">bbox_center</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_center"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.bbox_center" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.bbox_from_center_wh">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">bbox_from_center_wh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center_xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_from_center_wh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.bbox_from_center_wh" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.bbox_from_extent">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">bbox_from_extent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extent</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_from_extent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.bbox_from_extent" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>extent</strong> (<em>ndarray</em>) – tl_x, br_x, tl_y, br_y</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tl_x, tl_y, w, h</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bbox (ndarray)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="n">bbox_from_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;bbox = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">bbox = [0, 0, 10, 10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.bbox_from_verts">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">bbox_from_verts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">castint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_from_verts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.bbox_from_verts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.bbox_from_xywh">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">bbox_from_xywh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_rel_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">0]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_from_xywh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.bbox_from_xywh" title="Permalink to this definition"></a></dt>
<dd><p>need to specify xy_rel_pos if xy is not in tl already</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.bboxes_from_vert_list">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">bboxes_from_vert_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verts_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">castint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bboxes_from_vert_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.bboxes_from_vert_list" title="Permalink to this definition"></a></dt>
<dd><p>Fit the bounding polygon inside a rectangle</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.closest_point_on_bbox">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">closest_point_on_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#closest_point_on_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.closest_point_on_bbox" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">21</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">closest_point_on_bbox</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_list</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.closest_point_on_line">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">closest_point_on_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#closest_point_on_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.closest_point_on_line" title="Permalink to this definition"></a></dt>
<dd><p>e1 and e2 define two points on the line.
Does not clip to the segment.</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.geometry closest_point_on_line –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">21.83012702</span><span class="p">,</span>  <span class="mf">13.16987298</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">16.83012702</span><span class="p">,</span>  <span class="mf">21.83012702</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span>  <span class="mf">8.16987298</span><span class="p">,</span>  <span class="mf">16.83012702</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">13.16987298</span><span class="p">,</span>   <span class="mf">8.16987298</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">21.83012702</span><span class="p">,</span>  <span class="mf">13.16987298</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_list</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">close_pts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_list</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">closest_point_on_line</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span> <span class="k">for</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">itertwo</span><span class="p">(</span><span class="n">verts</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">L2_sqrd</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">new_pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">new_pt</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">close_pts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidates</span><span class="p">[</span><span class="n">dists</span><span class="o">.</span><span class="n">argmin</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">close_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">close_pts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original point&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">close_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">close_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;closest point on shape&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">p_list</span><span class="p">,</span> <span class="n">close_pts</span><span class="p">)):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.closest_point_on_line_segment">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">closest_point_on_line_segment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#closest_point_on_line_segment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.closest_point_on_line_segment" title="Permalink to this definition"></a></dt>
<dd><p>Finds the closet point from p on line segment (e1, e2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>ndarray</em>) – and xy point</p></li>
<li><p><strong>e1</strong> (<em>ndarray</em>) – the first xy endpoint of the segment</p></li>
<li><p><strong>e2</strong> (<em>ndarray</em>) – the second xy endpoint of the segment</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pt_on_seg - the closest xy point on (e1, e2) from p</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line">http://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line</a>
<a class="reference external" href="http://stackoverflow.com/questions/849211/shortest-distance-between-a-point-and-a-line-segment">http://stackoverflow.com/questions/849211/shortest-distance-between-a-point-and-a-line-segment</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.geometry –exec-closest_point_on_line_segment –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#bbox = np.array([10, 10, 10, 10], dtype=np.float)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#verts_ = np.array(vt.verts_from_bbox(bbox, close=True))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#R = vt.rotation_around_bbox_mat3x3(vt.TAU / 3, bbox)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#verts = vt.transform_points_with_homography(R, verts_.T).T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">21.83012702</span><span class="p">,</span>  <span class="mf">13.16987298</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">16.83012702</span><span class="p">,</span>  <span class="mf">21.83012702</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span>  <span class="mf">8.16987298</span><span class="p">,</span>  <span class="mf">16.83012702</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">13.16987298</span><span class="p">,</span>   <span class="mf">8.16987298</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">21.83012702</span><span class="p">,</span>  <span class="mf">13.16987298</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_list</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">close_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">closest_point_on_vert_segments</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">verts</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original point&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">close_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">close_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;closest point on shape&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">p_list</span><span class="p">,</span> <span class="n">close_pts</span><span class="p">)):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.closest_point_on_vert_segments">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">closest_point_on_vert_segments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#closest_point_on_vert_segments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.closest_point_on_vert_segments" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.cvt_bbox_xywh_to_pt1pt2">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">cvt_bbox_xywh_to_pt1pt2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xywh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">round_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#cvt_bbox_xywh_to_pt1pt2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.cvt_bbox_xywh_to_pt1pt2" title="Permalink to this definition"></a></dt>
<dd><p>Converts bbox to thumb format with a scale factor</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.distance_to_lineseg">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">distance_to_lineseg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#distance_to_lineseg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.distance_to_lineseg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.draw_border">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">draw_border</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">128,</span> <span class="pre">255)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thickness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#draw_border"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.draw_border" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_in</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>color</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – in bgr</p></li>
<li><p><strong>thickness</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
<li><p><strong>out</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.geometry –test-draw_border –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_in</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:plottool)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">draw_border</span><span class="p">(</span><span class="n">img_in</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.draw_verts">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">draw_verts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">128,</span> <span class="pre">255)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thickness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#draw_verts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.draw_verts" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_in</strong> – </p></li>
<li><p><strong>verts</strong> – </p></li>
<li><p><strong>color</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – </p></li>
<li><p><strong>thickness</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>img -  image data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[uint8_t, ndim=2]</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.geometry –test-draw_verts –show
python -m vtool.geometry –test-draw_verts:0 –show
python -m vtool.geometry –test-draw_verts:1 –show</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/core/doc/drawing_functions.html#line">http://docs.opencv.org/modules/core/doc/drawing_functions.html#line</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_in</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">draw_verts</span><span class="p">(</span><span class="n">img_in</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_in</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">img</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">img</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">img_in</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_in</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">img_in</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">draw_verts</span><span class="p">(</span><span class="n">img_in</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_in</span> <span class="ow">is</span> <span class="n">img</span><span class="p">,</span> <span class="s1">&#39;should be in place&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">out</span> <span class="ow">is</span> <span class="n">img</span><span class="p">,</span> <span class="s1">&#39;should be in place&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p>out = img_in = np.zeros((500, 500, 3), dtype=np.uint8)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.extent_from_bbox">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">extent_from_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#extent_from_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.extent_from_bbox" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bbox</strong> (<em>ndarray</em>) – tl_x, tl_y, w, h</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tl_x, br_x, tl_y, br_y</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>extent (ndarray)</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/geometry.py extent_from_bbox</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">extent_from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;extent = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">extent = [0, 10, 0, 10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.extent_from_verts">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">extent_from_verts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#extent_from_verts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.extent_from_verts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.get_pointset_extent_wh">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">get_pointset_extent_wh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#get_pointset_extent_wh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.get_pointset_extent_wh" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.get_pointset_extents">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">get_pointset_extents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#get_pointset_extents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.get_pointset_extents" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.point_inside_bbox">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">point_inside_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#point_inside_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.point_inside_bbox" title="Permalink to this definition"></a></dt>
<dd><p>Flags points that are strictly inside a bounding box.
Points on the boundary are not considered inside.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point</strong> (<em>ndarray</em>) – one or more points to test (2xN)</p></li>
<li><p><strong>bbox</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – a bounding box in  (x, y, w, h) format</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if the point is in the bbox</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a> or ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.geometry point_inside_bbox –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flag</span> <span class="o">=</span> <span class="n">point_inside_bbox</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flag</span> <span class="o">=</span> <span class="n">flag</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;flag = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flag</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">verts_from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">flag</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">flag</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">~</span><span class="n">flag</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">~</span><span class="n">flag</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">flag = np.array([0, 0, 0, 0, 0, 0, 0, 0, 1, 0])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.scale_bbox">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">scale_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#scale_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.scale_bbox" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.scale_extents">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">scale_extents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extents</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#scale_extents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.scale_extents" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>extent</strong> (<em>ndarray</em>) – tl_x, br_x, tl_y, br_y</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.scaled_verts_from_bbox">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">scaled_verts_from_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#scaled_verts_from_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.scaled_verts_from_bbox" title="Permalink to this definition"></a></dt>
<dd><p>Helps with drawing scaled bbounding boxes on thumbnails</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.scaled_verts_from_bbox_gen">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">scaled_verts_from_bbox_gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#scaled_verts_from_bbox_gen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.scaled_verts_from_bbox_gen" title="Permalink to this definition"></a></dt>
<dd><p>Helps with drawing scaled bbounding boxes on thumbnails</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bbox_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – bboxes in x,y,w,h format</p></li>
<li><p><strong>theta_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – rotation of bounding boxes</p></li>
<li><p><strong>sx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – x scale factor</p></li>
<li><p><strong>sy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – y scale factor</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Yeilds:</dt><dd><p>new_verts - vertices of scaled bounding box for every input</p>
</dd>
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-scaled_verts_from_bbox_gen</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span> <span class="o">=</span> <span class="mf">.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sy</span> <span class="o">=</span> <span class="mf">.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_verts_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scaled_verts_from_bbox_gen</span><span class="p">(</span><span class="n">bbox_list</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_verts_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[[5, 5], [55, 5], [55, 55], [5, 55], [5, 5]]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.union_extents">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">union_extents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extents</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#union_extents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.union_extents" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.verts_from_bbox">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">verts_from_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">close</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#verts_from_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.verts_from_bbox" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bbox</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – bounding box in the format (x, y, w, h)</p></li>
<li><p><strong>close</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>verts</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.geometry –test-verts_from_bbox</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">close</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="n">verts_from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">close</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;verts = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">verts</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">verts = ((10, 10), (60, 10), (60, 60), (10, 60))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.geometry.verts_list_from_bboxes_list">
<span class="sig-prename descclassname"><span class="pre">vtool.geometry.</span></span><span class="sig-name descname"><span class="pre">verts_list_from_bboxes_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bboxes_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#verts_list_from_bboxes_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.geometry.verts_list_from_bboxes_list" title="Permalink to this definition"></a></dt>
<dd><p>Create a four-vertex polygon from the bounding rectangle</p>
</dd></dl>

</section>
<section id="module-vtool.histogram">
<span id="vtool-histogram-module"></span><h2>vtool.histogram module<a class="headerlink" href="#module-vtool.histogram" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.argsubextrema2">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">argsubextrema2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xdata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubextrema2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.argsubextrema2" title="Permalink to this definition"></a></dt>
<dd><p>Determines approximate maxima values to subindex accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ydata</strong> (<em>ndarray</em>) – ydata, histogram frequencies</p></li>
<li><p><strong>xdata</strong> (<em>ndarray</em>) – xdata, histogram labels</p></li>
<li><p><strong>thresh_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – cutoff point for labeing a value as a maxima</p></li>
<li><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if True allows for flat extrema to be found.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(submaxima_x, submaxima_y)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.histogram argsubmaxima
python -m vtool.histogram argsubmaxima –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh_factor</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">op</span> <span class="o">=</span> <span class="s1">&#39;min&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">argsubextrema2</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="p">,</span> <span class="n">thresh_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_hist_subbin_maxima</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl>
<dt>Doctest:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh_factor</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">op</span> <span class="o">=</span> <span class="s1">&#39;max&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh_factor</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">argsubextrema2</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">thresh_factor</span><span class="o">=</span><span class="n">thresh_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">qtensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">doclf</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.argsubmax">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">argsubmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xdata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.argsubmax" title="Permalink to this definition"></a></dt>
<dd><p>Finds a single submaximum value to subindex accuracy.
If xdata is not specified, submax_x is a fractional index.
Otherwise, submax_x is sub-xdata (essentially doing the index interpolation
for you)</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span>  <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="p">[</span><span class="mi">00</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span>  <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">argsubmax</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">argsubmax</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="n">xdata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">([</span><span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">],</span> <span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">2.1667, 2.0208,</span>
<span class="go">21.6667, 2.0208,</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span><span class="o">=</span><span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argsubmax</span><span class="p">(</span><span class="n">hist_</span><span class="p">)</span>
<span class="go">(4.0, 4.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.argsubmax2">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">argsubmax2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xdata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmax2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.argsubmax2" title="Permalink to this definition"></a></dt>
<dd><p>Finds a single submaximum value to subindex accuracy.
If xdata is not specified, submax_x is a fractional index.
This version always normalizes x-coordinates.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span>  <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="p">[</span><span class="mi">00</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span>  <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">argsubmax</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">argsubmax</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="n">xdata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">([</span><span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">],</span> <span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">2.1667, 2.0208,</span>
<span class="go">21.6667, 2.0208,</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh_factor</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argsubmax</span><span class="p">(</span><span class="n">hist_</span><span class="p">)</span>
<span class="go">(4.0, 4.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.argsubmaxima">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">argsubmaxima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxima_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmaxima"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.argsubmaxima" title="Permalink to this definition"></a></dt>
<dd><p>Determines approximate maxima values to subindex accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist_</strong> (<em>ndarray</em>) – ydata, histogram frequencies</p></li>
<li><p><strong>centers</strong> (<em>ndarray</em>) – xdata, histogram labels</p></li>
<li><p><strong>maxima_thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – cutoff point for labeing a value as a maxima</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(submaxima_x, submaxima_y)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.histogram argsubmaxima
python -m vtool.histogram argsubmaxima –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">argsubmaxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_hist_subbin_maxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">(array([ 3.0318792]), array([ 37.19208239]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.argsubmaxima2">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">argsubmaxima2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xdata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmaxima2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.argsubmaxima2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.argsubmin2">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">argsubmin2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xdata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmin2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.argsubmin2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.argsubminima2">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">argsubminima2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xdata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubminima2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.argsubminima2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.get_histinfo_str">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">get_histinfo_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#get_histinfo_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.get_histinfo_str" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.hist_argmaxima">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">hist_argmaxima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxima_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#hist_argmaxima"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.hist_argmaxima" title="Permalink to this definition"></a></dt>
<dd><p>must take positive only values</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.histogram hist_argmaxima</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>    <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_x</span><span class="p">,</span> <span class="n">maxima_y</span><span class="p">,</span> <span class="n">argmaxima</span> <span class="o">=</span> <span class="n">hist_argmaxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">maxima_x</span><span class="p">,</span> <span class="n">maxima_y</span><span class="p">,</span> <span class="n">argmaxima</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.hist_argmaxima2">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">hist_argmaxima2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxima_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#hist_argmaxima2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.hist_argmaxima2" title="Permalink to this definition"></a></dt>
<dd><p>must take positive only values</p>
<dl>
<dt>Setup:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
</pre></div>
</div>
</dd>
<dt>GridSearch:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argmaxima</span> <span class="o">=</span> <span class="n">hist_argmaxima2</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">argmaxima</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.hist_edges_to_centers">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">hist_edges_to_centers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#hist_edges_to_centers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.hist_edges_to_centers" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.79</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">1.57</span><span class="p">,</span> <span class="mf">2.36</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.93</span><span class="p">,</span> <span class="mf">4.71</span><span class="p">,</span> <span class="mf">5.50</span><span class="p">,</span> <span class="mf">6.28</span><span class="p">,</span> <span class="mf">7.07</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">hist_edges_to_centers</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[-0.395  0.395  1.18   1.965  2.75   3.535  4.32   5.105  5.89   6.675]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.interpolate_submaxima">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">interpolate_submaxima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argmaxima</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#interpolate_submaxima"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.interpolate_submaxima" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>argmaxima</strong> (<em>ndarray</em>) – indicies into ydata / centers that are argmaxima</p></li>
<li><p><strong>hist_</strong> (<em>ndarray</em>) – ydata, histogram frequencies</p></li>
<li><p><strong>centers</strong> (<em>ndarray</em>) – xdata, histogram labels</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>FIXME:</dt><dd><p>what happens when argmaxima[i] == len(hist_)</p>
</dd>
<dt>CommandLine:</dt><dd><p>python -m vtool.histogram –test-interpolate_submaxima –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argmaxima</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>    <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span> <span class="o">=</span> <span class="n">interpolate_submaxima</span><span class="p">(</span><span class="n">argmaxima</span><span class="p">,</span> <span class="n">hist_</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">interpolate_submaxima</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                           <span class="n">key_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x123&#39;</span><span class="p">,</span> <span class="s1">&#39;y123&#39;</span><span class="p">,</span> <span class="s1">&#39;coeff_list&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x123</span><span class="p">,</span> <span class="n">y123</span><span class="p">,</span> <span class="n">coeff_list</span> <span class="o">=</span> <span class="n">locals_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ensure_fnum</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">hist_</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">centers</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">hist_</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;argmaxima&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;interp maxima&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Extract parabola points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x123</span><span class="p">,</span> <span class="n">y123</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;maxima neighbors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xpoints</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">)</span> <span class="ow">in</span> <span class="n">x123</span><span class="o">.</span><span class="n">T</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ypoints</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">x_pts</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_pts</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">coeff_list</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw Submax Parabola</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x_pts</span><span class="p">,</span> <span class="n">y_pts</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">ypoints</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_pts</span><span class="p">,</span> <span class="n">y_pts</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([ 0.15,  3.03,  5.11], dtype=np.float64),</span>
<span class="go">np.array([  9.2 ,  37.19,   0.  ], dtype=np.float64),</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argmaxima</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.interpolated_histogram">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">interpolated_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_wrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#interpolated_histogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.interpolated_histogram" title="Permalink to this definition"></a></dt>
<dd><p>Follows np.histogram, but does interpolation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>weights</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – range from 0 to 1</p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
<li><p><strong>interpolation_wrap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = True)</p></li>
<li><p><strong>_debug</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.histogram –test-interpolated_histogram</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">3.5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">range_</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interpolation_wrap</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">interpolated_histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">range_</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">interpolation_wrap</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">hist</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">1E-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">hist</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">edges</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_histinfo_str</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">3.5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">range_</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interpolation_wrap</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">interpolated_histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">range_</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">interpolation_wrap</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">hist</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">1E-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">hist</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">edges</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_histinfo_str</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.linear_interpolation">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">linear_interpolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subindices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#linear_interpolation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.linear_interpolation" title="Permalink to this definition"></a></dt>
<dd><p>Does linear interpolation to lookup subindex values</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subindices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subvalues</span> <span class="o">=</span> <span class="n">linear_interpolation</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">subindices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">subindices</span><span class="p">,</span> <span class="n">subvalues</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="mf">2.3</span><span class="p">,</span> <span class="n">linear_interpolation</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.maxima_neighbors">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">maxima_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argmaxima</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#maxima_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.maxima_neighbors" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.maximum_parabola_point">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">maximum_parabola_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#maximum_parabola_point"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.maximum_parabola_point" title="Permalink to this definition"></a></dt>
<dd><p>Maximum x point is where the derivative is 0</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.show_hist_submaxima">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">show_hist_submaxima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxima_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#show_hist_submaxima"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.show_hist_submaxima" title="Permalink to this definition"></a></dt>
<dd><p>For C++ to show data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist</strong> – </p></li>
<li><p><strong>edges</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – </p></li>
<li><p><strong>centers</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.histogram –test-show_hist_submaxima –show
python -m pyhesaff._pyhesaff –test-test_rot_invar –show
python -m vtool.histogram –test-show_hist_submaxima –dpath figures –save ~/latex/crall-candidacy-2015/figures/show_hist_submaxima.jpg</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:wbia)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--hist&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--edges&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--maxima_thresh&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_hist_submaxima</span><span class="p">(</span><span class="n">hist_</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.show_ori_image">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">show_ori_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grady</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gauss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#show_ori_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.show_ori_image" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m pyhesaff._pyhesaff –test-test_rot_invar –show –nocpp</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.show_ori_image_ondisk">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">show_ori_image_ondisk</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#show_ori_image_ondisk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.show_ori_image_ondisk" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.histogram –test-show_ori_image_ondisk –show</p>
<p>python -m vtool.histogram –test-show_ori_image_ondisk –show –patch_img_fpath patches/KP_0_PATCH.png –ori_img_fpath patches/KP_0_orientations01.png –weights_img_fpath patches/KP_0_WEIGHTS.png –grady_img_fpath patches/KP_0_ygradient.png –gradx_img_fpath patches/KP_0_xgradient.png –title cpp_show_ori_ondisk</p>
<p>python -m pyhesaff._pyhesaff –test-test_rot_invar –show –rebuild-hesaff –no-rmbuild</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">show_ori_image_ondisk</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.subbin_bounds">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">subbin_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#subbin_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.subbin_bounds" title="Permalink to this definition"></a></dt>
<dd><p>Gets quantized bounds of a sub-bin/pixel point and a radius.
Useful for cropping using subpixel points</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – center of a circle a 1d pixel array</p></li>
<li><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – radius of the circle</p></li>
<li><p><strong>low</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – minimum index of 1d pixel array</p></li>
<li><p><strong>high</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – maximum index of 1d pixel array</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(iz1, iz2, z_offst) - quantized_bounds and subbin_offset</dt><dd><p>iz1 - low radius endpoint
iz2 - high radius endpoint
z_offst - subpixel offset
#Returns: quantized_bounds=(iz1, iz2), subbin_offset</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.histogram –test-subbin_bounds</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius</span> <span class="o">=</span> <span class="mf">5.666</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">low</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">high</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">iz1</span><span class="p">,</span> <span class="n">iz2</span><span class="p">,</span> <span class="n">z_offst</span><span class="p">)</span> <span class="o">=</span> <span class="n">subbin_bounds</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">iz1</span><span class="p">,</span> <span class="n">iz2</span><span class="p">,</span> <span class="n">z_offst</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(0, 7, 1.5)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.histogram.wrap_histogram">
<span class="sig-prename descclassname"><span class="pre">vtool.histogram.</span></span><span class="sig-name descname"><span class="pre">wrap_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#wrap_histogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.histogram.wrap_histogram" title="Permalink to this definition"></a></dt>
<dd><p>Simulates the first and last histogram bin being being adjacent to one another
by replicating those bins at the last and first positions respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>edges</strong> (<em>ndarray</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(hist_wrap, edge_wrap)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.histogram –test-wrap_histogram</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">8.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">34.32</span><span class="p">,</span> <span class="mf">29.45</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.78539816</span><span class="p">,</span>  <span class="mf">1.57079633</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="mf">2.35619449</span><span class="p">,</span>  <span class="mf">3.14159265</span><span class="p">,</span>  <span class="mf">3.92699081</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="mf">4.71238898</span><span class="p">,</span>  <span class="mf">5.49778714</span><span class="p">,</span>  <span class="mf">6.2831853</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">hist_wrap</span><span class="p">,</span> <span class="n">edge_wrap</span><span class="p">)</span> <span class="o">=</span> <span class="n">wrap_histogram</span><span class="p">(</span><span class="n">hist_</span><span class="p">,</span> <span class="n">edges_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">hist_wrap</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">edge_wrap</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">6.73, 8.00, 0.00, 0.00, 34.32, 29.45, 0.00, 0.00, 6.73, 8.00,</span>
<span class="go">-0.79, 0.00, 0.79, 1.57, 2.36, 3.14, 3.93, 4.71, 5.50, 6.28, 7.07,</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-vtool.image">
<span id="vtool-image-module"></span><h2>vtool.image module<a class="headerlink" href="#module-vtool.image" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.affine_warp_around_center">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">affine_warp_around_center</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borderMode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#affine_warp_around_center"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.affine_warp_around_center" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-affine_warp_around_center –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shear</span> <span class="o">=</span> <span class="mf">.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ty</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sy</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">borderMode</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_CONSTANT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">INTER_LANCZOS4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_warped</span> <span class="o">=</span> <span class="n">affine_warp_around_center</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">sx</span><span class="o">=</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="o">=</span><span class="n">sy</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">theta</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="o">=</span><span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="o">=</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="o">=</span><span class="n">ty</span><span class="p">,</span> <span class="n">dsize</span><span class="o">=</span><span class="n">dsize</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">borderMode</span><span class="o">=</span><span class="n">borderMode</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span> <span class="n">borderValue</span><span class="o">=</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">img_warped</span> <span class="o">*</span> <span class="mf">255.0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.clipwhite">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">clipwhite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#clipwhite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.clipwhite" title="Permalink to this definition"></a></dt>
<dd><p>Strips white borders off an image</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.clipwhite_ondisk">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">clipwhite_ondisk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpath_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#clipwhite_ondisk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.clipwhite_ondisk" title="Permalink to this definition"></a></dt>
<dd><p>Strips white borders off an image on disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fpath_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – </p></li>
<li><p><strong>fpath_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – verbosity flag(default = True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>fpath_out</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image clipwhite_ondisk</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.combine_offset_lists">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">combine_offset_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offsets_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfs_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_tups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sf_tups</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#combine_offset_lists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.combine_offset_lists" title="Permalink to this definition"></a></dt>
<dd><p>Helper for stacking</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.convert_colorspace">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">convert_colorspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_colorspace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BGR'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#convert_colorspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.convert_colorspace" title="Permalink to this definition"></a></dt>
<dd><p>Converts colorspace of img.
Convinience function around cv2.cvtColor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>colorspace</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – RGB, LAB, etc</p></li>
<li><p><strong>src_colorspace</strong> (<em>unicode</em>) – (default = u’BGR’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>img -  image data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[uint8_t, ndim=2]</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image convert_colorspace –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;zebra.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://itsnasb.com/wp-content/uploads/2013/03/lisa-frank-logo1.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_float</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_float01</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">colorspace</span> <span class="o">=</span> <span class="s1">&#39;LAB&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">src_colorspace</span> <span class="o">=</span> <span class="s1">&#39;BGR&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgLAB</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgL</span> <span class="o">=</span> <span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillL</span> <span class="o">=</span> <span class="n">imgL</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillAB</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">is_float</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">else</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgAB_LAB</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">fillL</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgA_LAB</span>  <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="n">fillL</span><span class="p">,</span> <span class="n">fillAB</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB_LAB</span>  <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="n">fillL</span><span class="p">,</span> <span class="n">fillAB</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgAB_BGR</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">imgAB_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgA_BGR</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">imgA_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB_BGR</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">imgB_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#imgAB_HSV = convert_colorspace(convert_colorspace(imgAB_LAB, &#39;LAB&#39;, &#39;BGR&#39;), &#39;BGR&#39;, &#39;HSV&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgAB_HSV</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="s1">&#39;HSV&#39;</span><span class="p">,</span> <span class="s1">&#39;BGR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgAB_HSV</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mf">.6</span> <span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">is_float</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">else</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgCOLOR_BRG</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">imgAB_HSV</span><span class="p">,</span> <span class="s1">&#39;BGR&#39;</span><span class="p">,</span> <span class="s1">&#39;HSV&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;L (lightness)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A (grayscale)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B (grayscale)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgCOLOR_BRG</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Hue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgAB_BGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A+B (color overlay)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgA_BGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A (Red-Green)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB_BGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B (Blue-Yellow)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgblind_LAB</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">fillAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgblind_BRG</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">rgblind_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">byblind_LAB</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">fillAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">byblind_BGR</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">byblind_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">byblind_BGR</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;colorblind B-Y&#39;</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rgblind_BRG</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;colorblind R-G&#39;</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.convert_image_list_colorspace">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">convert_image_list_colorspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_colorspace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BGR'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#convert_image_list_colorspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.convert_image_list_colorspace" title="Permalink to this definition"></a></dt>
<dd><p>converts a list of images from &lt;src_colorspace&gt; to &lt;colorspace&gt;</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.crop_out_imgfill">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">crop_out_imgfill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#crop_out_imgfill"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.crop_out_imgfill" title="Permalink to this definition"></a></dt>
<dd><p>Crops image to remove fillval</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>fillval</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – (default = 0)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cropped_img</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –exec-crop_out_imgfill</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_stripe_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="n">img</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_GRAY2RGB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_img</span> <span class="o">=</span> <span class="n">crop_out_imgfill</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">fillval</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_img2</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">cropped_img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_RGB2GRAY</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;cropped_img2 = </span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cropped_img2</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_stripe_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="n">img</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillval</span> <span class="o">=</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_img</span> <span class="o">=</span> <span class="n">crop_out_imgfill</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">fillval</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;cropped_img = </span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cropped_img</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.cvt_BGR2L">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">cvt_BGR2L</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#cvt_BGR2L"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.cvt_BGR2L" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.cvt_BGR2RGB">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">cvt_BGR2RGB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#cvt_BGR2RGB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.cvt_BGR2RGB" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.draw_text">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">draw_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">textcolor_rgb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontScale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thickness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontFace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineType</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottomLeftOrigin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#draw_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.draw_text" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-draw_text:0 –show
python -m vtool.image –test-draw_text:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">font_names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cv2</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;FONT_H&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;opencv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">400</span><span class="p">,</span> <span class="mi">1024</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fontScale</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CV_AA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">font_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">font_names</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">font_name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fontFace</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">font_name</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">count</span> <span class="o">*</span> <span class="mi">45</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;opencv - &#39;</span> <span class="o">+</span> <span class="n">font_name</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">draw_text</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">org</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">fontFace</span><span class="o">=</span><span class="n">fontFace</span><span class="p">,</span> <span class="n">textcolor_rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="n">fontScale</span><span class="o">=</span><span class="n">fontScale</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">font_names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cv2</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;FONT_H&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;opencv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">400</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span> <span class="p">:</span><span class="mi">512</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">200</span><span class="p">:,</span> <span class="mi">512</span><span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fontScale</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CV_AA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">font_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">font_names</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">font_name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fontFace</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">font_name</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">count</span> <span class="o">*</span> <span class="mi">45</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;opencv - &#39;</span> <span class="o">+</span> <span class="n">font_name</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">draw_text</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">org</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">fontFace</span><span class="o">=</span><span class="n">fontFace</span><span class="p">,</span> <span class="n">textcolor_rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="n">fontScale</span><span class="o">=</span><span class="n">fontScale</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p>where each of the font IDs can be combined with FONT_ITALIC to get the slanted letters.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.embed_channels">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">embed_channels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nchannels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#embed_channels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.embed_channels" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>input_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – (default = (0,))</p></li>
<li><p><strong>nchannels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – (default = 3)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image embed_channels –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Embed a (N,M,2) image into an (N,M,3) image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_channels</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nchannels</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newimg</span> <span class="o">=</span> <span class="n">embed_channels</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">input_channels</span><span class="p">,</span> <span class="n">nchannels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">newimg</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">newimg</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">input_channels</span><span class="p">]</span> <span class="o">==</span> <span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.embed_in_square_image">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">embed_in_square_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_origin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_origin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#embed_in_square_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.embed_in_square_image" title="Permalink to this definition"></a></dt>
<dd><p>Embeds an image in the center of an empty image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>target_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – </p></li>
<li><p><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – position of</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>img_sqare</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image embed_in_square_image –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_size</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">))</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_origin</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_origin</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_square</span> <span class="o">=</span> <span class="n">embed_in_square_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">target_size</span><span class="p">,</span> <span class="n">img_origin</span><span class="p">,</span> <span class="n">target_origin</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_square</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="n">img</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img_square</span><span class="p">)</span> <span class="o">==</span> <span class="n">target_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_origin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_origin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_square2</span> <span class="o">=</span> <span class="n">embed_in_square_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">target_size</span><span class="p">,</span> <span class="n">img_origin</span><span class="p">,</span> <span class="n">target_origin</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_square</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="n">img</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img_square</span><span class="p">)</span> <span class="o">==</span> <span class="n">target_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_square</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_square2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.ensure_3channel">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">ensure_3channel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#ensure_3channel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.ensure_3channel" title="Permalink to this definition"></a></dt>
<dd><p>DEPRICATE IN FAVOR OF atleast_3channels?</p>
<p>Ensures that there are 3 channels in the image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>patch</strong> (<em>ndarray</em><em>[</em><em>N</em><em>, </em><em>M</em><em>, </em><em>...</em><em>]</em>) – the image</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[N, M, 3]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –exec-ensure_3channel –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch1</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;astro.png&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">:</span><span class="mi">512</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span> <span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;ada.jpg&#39;</span><span class="p">))[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch3</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;jeff.png&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">:</span><span class="mi">390</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">400</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res1</span> <span class="o">=</span> <span class="n">ensure_3channel</span><span class="p">(</span><span class="n">patch1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res2</span> <span class="o">=</span> <span class="n">ensure_3channel</span><span class="p">(</span><span class="n">patch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res3</span> <span class="o">=</span> <span class="n">ensure_3channel</span><span class="p">(</span><span class="n">patch3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">patch1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;failed test1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">patch2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;failed test2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">patch3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;failed test3&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.ensure_4channel">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">ensure_4channel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#ensure_4channel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.ensure_4channel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.filterflags_valid_images">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">filterflags_valid_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gpaths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_formats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invalid_formats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#filterflags_valid_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.filterflags_valid_images" title="Permalink to this definition"></a></dt>
<dd><p>Flags images with a format that disagrees with its extension</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gpaths</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of image paths</p></li>
<li><p><strong>valid_formats</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>invalid_formats</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – verbosity flag(default = True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>isvalid_flags</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image filterflags_valid_images –show</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>An MPO (Multi Picture Object) file is a stereoscopic image and contains
two JPG images side-by-side, and allows them to be viewed as a single
3D image.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gpaths</span> <span class="o">=</span> <span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;astro.png&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">filterflags_valid_images</span><span class="p">(</span><span class="n">gpaths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.find_pixel_value_index">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">find_pixel_value_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#find_pixel_value_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.find_pixel_value_index" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>pixel</strong> (<em>ndarray</em><em> or </em><em>scalar</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –test-find_pixel_value_index</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/21407815/get-column-row-index-from-numpy-array-that-meets-a-boolean-condition">http://stackoverflow.com/questions/21407815/get-column-row-index-from-numpy-array-that-meets-a-boolean-condition</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pixel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">find_pixel_value_index</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pixel</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[0 0]</span>
<span class="go"> [1 1]</span>
<span class="go"> [2 0]</span>
<span class="go"> [2 3]</span>
<span class="go"> [5 5]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.get_num_channels">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">get_num_channels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_num_channels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.get_num_channels" title="Permalink to this definition"></a></dt>
<dd><p>Returns the number of color channels</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.get_pixel_dist">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">get_pixel_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_pixel_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.get_pixel_dist" title="Permalink to this definition"></a></dt>
<dd><p>pixel = fillval
isfill = mask2d</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.get_round_scaled_dsize">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">get_round_scaled_dsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_round_scaled_dsize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.get_round_scaled_dsize" title="Permalink to this definition"></a></dt>
<dd><p>Returns an integer size and scale that best approximates
the floating point scale on the original size</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – original width height</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – desired floating point scale factor</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.get_scale_factor">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">get_scale_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_scale_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.get_scale_factor" title="Permalink to this definition"></a></dt>
<dd><p>returns scale factor from one image to the next</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.get_size">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">get_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.get_size" title="Permalink to this definition"></a></dt>
<dd><p>Returns the image size in (width, height)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.imread">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">imread</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grayscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_pil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_if_corrupted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imread"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.imread" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper around the opencv imread function. Handles remote uris.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_fpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – file path string</p></li>
<li><p><strong>grayscale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
<li><p><strong>orient</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
<li><p><strong>flags</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – opencv flags (default = None)</p></li>
<li><p><strong>force_pil</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = None)</p></li>
<li><p><strong>delete_if_corrupted</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>imgBGR</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-imread
python -m vtool.image –test-imread:1
python -m vtool.image –test-imread:2</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/core/doc/utility_and_system_functions_and_macros.html#error">http://docs.opencv.org/modules/core/doc/utility_and_system_functions_and_macros.html#error</a>
<a class="reference external" href="http://stackoverflow.com/questions/23572241/cv2-threshold-error-210">http://stackoverflow.com/questions/23572241/cv2-threshold-error-210</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR1</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR2</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR3</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">imgBGR1</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">imgBGR2</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># assert np.all(imgBGR1 == imgBGR3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR3</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_url</span> <span class="o">=</span> <span class="s1">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="n">img_url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR1</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR2</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#imgBGR2 = imread(img_fpath, force_pil=False, flags=cv2.IMREAD_UNCHANGED)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;imgBGR.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">imgBGR1</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;imgBGR2.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">imgBGR2</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">imgBGR1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff_pxls</span> <span class="o">=</span> <span class="n">imgBGR1</span> <span class="o">!=</span> <span class="n">imgBGR2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_diff_pxls</span> <span class="o">=</span> <span class="n">diff_pxls</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;num_diff_pxls=</span><span class="si">%r</span><span class="s1">/</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">num_diff_pxls</span><span class="p">,</span> <span class="n">diff_pxls</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">num_diff_pxls</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diffMag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">imgBGR2</span> <span class="o">/</span> <span class="mf">255.</span> <span class="o">-</span> <span class="n">imgBGR1</span> <span class="o">/</span> <span class="mf">255.</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">diffMag</span> <span class="o">/</span> <span class="n">diffMag</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">(2736, 3648, 3)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://www.sherv.net/cm/emo/funny/2/big-dancing-banana-smiley-emoticon.gif&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_if_corrupted</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grayscale</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="n">grayscale</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.imread_remote_s3">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">imread_remote_s3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imread_remote_s3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.imread_remote_s3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.imread_remote_url">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">imread_remote_url</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_url</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imread_remote_url"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.imread_remote_url" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.imwrite">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">imwrite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fallback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imwrite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.imwrite" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/highgui/doc/reading_and_writing_images_and_video.html">http://docs.opencv.org/modules/highgui/doc/reading_and_writing_images_and_video.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_fpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – file path string</p></li>
<li><p><strong>imgBGR</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data in opencv format (blue, green, red)</p></li>
<li><p><strong>fallback</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –exec-imwrite</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;zebra.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_dpath</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">ensure_app_cache_dir</span><span class="p">(</span><span class="s1">&#39;vtool&#39;</span><span class="p">,</span> <span class="s1">&#39;testwrite&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">unixjoin</span><span class="p">(</span><span class="n">img_dpath</span><span class="p">,</span> <span class="s1">&#39;zebra.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fallback</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imwrite</span><span class="p">(</span><span class="n">img_fpath2</span><span class="p">,</span> <span class="n">imgBGR</span><span class="p">,</span> <span class="n">fallback</span><span class="o">=</span><span class="n">fallback</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">imgBGR2</span> <span class="o">==</span> <span class="n">imgBGR</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.imwrite_fallback">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">imwrite_fallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imwrite_fallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.imwrite_fallback" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.infer_vert">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">infer_vert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vert</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#infer_vert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.infer_vert" title="Permalink to this definition"></a></dt>
<dd><p>which is the better stack dimension</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.make_channels_comparable">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">make_channels_comparable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#make_channels_comparable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.make_channels_comparable" title="Permalink to this definition"></a></dt>
<dd><p>Broadcasts image arrays so they can have elementwise operations applied</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image make_channels_comparable</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_basis</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">wh_basis</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">shape_basis</span> <span class="o">=</span> <span class="p">[(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Test all permutations of shap inputs</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">shape1</span><span class="p">,</span> <span class="n">shape2</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">shape_basis</span><span class="p">,</span> <span class="n">shape_basis</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*    input shapes: </span><span class="si">%r</span><span class="s1">, </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">shape1</span><span class="p">,</span> <span class="n">shape2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">img1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">img2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">make_channels_comparable</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;... output shapes: </span><span class="si">%r</span><span class="s1">, </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">img2</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">elem</span> <span class="o">=</span> <span class="p">(</span><span class="n">img1</span> <span class="o">+</span> <span class="n">img2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;... elem(+) shape: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">assert</span> <span class="n">elem</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">img1</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="s1">&#39;outputs should have same size&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">assert</span> <span class="n">img1</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">img2</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="s1">&#39;new imgs should have same size&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.make_white_transparent">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">make_white_transparent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#make_white_transparent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.make_white_transparent" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>imgBGR</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data (blue, green, red)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>imgBGRA</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image make_white_transparent –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fpath&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGRA</span> <span class="o">=</span> <span class="n">make_white_transparent</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;imgBGRA = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">imgBGRA</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.montage">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">montage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng=&lt;module</span> <span class="pre">'numpy.random'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/numpy/random/__init__.py'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method='random'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_debug=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#montage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.montage" title="Permalink to this definition"></a></dt>
<dd><p>Creates a montage / collage from a set of images</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –exec-montage:0 –show
python -m vtool.image –exec-montage:1</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list0</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list1</span> <span class="o">=</span> <span class="p">[</span><span class="n">resize_to_maxdims</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">img_list0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">flatten</span><span class="p">([</span><span class="n">img_list1</span><span class="p">]</span> <span class="o">*</span> <span class="n">num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="mi">700</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;unused&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#method = &#39;random&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dst</span><span class="p">,</span> <span class="n">debug_info</span> <span class="o">=</span> <span class="n">montage</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">dsize</span><span class="p">,</span> <span class="n">rng</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="n">return_debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">place_img</span> <span class="o">=</span> <span class="n">debug_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;place_img_&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">place_img</span> <span class="o">/</span> <span class="n">place_img</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span><span class="p">,</span> <span class="n">expanduser</span><span class="p">,</span> <span class="n">abspath</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s1">&#39;GZC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gid_list0</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_gids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6000</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">try</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">gid</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">gid_list0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">image</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_images</span><span class="p">(</span><span class="n">gid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">image</span> <span class="o">=</span> <span class="n">resize_to_maxdims</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">img_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">19200</span><span class="p">,</span> <span class="mi">10800</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dst</span> <span class="o">=</span> <span class="n">montage</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">dsize</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filepath</span> <span class="o">=</span> <span class="n">abspath</span><span class="p">(</span><span class="n">expanduser</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">,</span> <span class="s1">&#39;Desktop&#39;</span><span class="p">,</span> <span class="s1">&#39;montage.jpg&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Writing to: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imwrite</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.open_image_size">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">open_image_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#open_image_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.open_image_size" title="Permalink to this definition"></a></dt>
<dd><p>Gets image size from an image on disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>image_fpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>size (width, height)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-open_image_size</p>
</dd>
<dt>Doctest:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;patsy.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="n">open_image_size</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;size = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">size = (800, 441)</span>
</pre></div>
</div>
</dd>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Confirm that Image.open is a lazy load</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">timeit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="sd">&#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sd">    from PIL import Image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sd">    import utool as ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sd">    import vtool as vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sd">    image_fpath = ut.grab_test_imgpath(&#39;patsy.jpg&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sd">    &#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;Image.open(image_fpath)&#39;</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;Image.open(image_fpath).size&#39;</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;vt.open_image_size(image_fpath)&#39;</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t4</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;vt.imread(image_fpath).shape&#39;</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t5</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;Image.open(image_fpath).getdata()&#39;</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1 = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t1</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t2 = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t2</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t3 = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t4 = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t4</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t5 = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t5</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">t2</span> <span class="o">&lt;</span> <span class="n">t5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">t3</span> <span class="o">&lt;</span> <span class="n">t4</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.pad_image">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">pad_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borderType</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#pad_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.pad_image" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.pad_image_ondisk">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">pad_image_ondisk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borderType</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#pad_image_ondisk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.pad_image_ondisk" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>out_fpath -  file path string</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image pad_image_ondisk</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fpath&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pad_</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">borderType</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath</span> <span class="o">=</span> <span class="n">pad_image_ondisk</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">pad_</span><span class="p">,</span> <span class="n">out_fpath</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">borderType</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;out_fpath = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">out_fpath</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.padded_resize">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">padded_resize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(64,</span> <span class="pre">64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#padded_resize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.padded_resize" title="Permalink to this definition"></a></dt>
<dd><p>makes the image resize to the target size and pads the rest of the area with a fill value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>target_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-padded_resize –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgA</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;ada.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgC</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">),</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#target_size = (64, 64)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img3_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">padded_resize</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">target_size</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="p">[</span><span class="n">imgA</span><span class="p">,</span> <span class="n">imgB</span><span class="p">,</span> <span class="n">imgC</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">ut</span><span class="o">.</span><span class="n">allsame</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img3</span><span class="p">)</span> <span class="k">for</span> <span class="n">img3</span> <span class="ow">in</span> <span class="n">img3_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pnum_</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">make_pnum_nextgen</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.perlin_noise">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">perlin_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale=32.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng=&lt;module</span> <span class="pre">'numpy.random'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/numpy/random/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#perlin_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.perlin_noise" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://www.siafoo.net/snippet/229">http://www.siafoo.net/snippet/229</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image perlin_noise –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#size = (64, 64)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#scale = 32.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span> <span class="o">=</span> <span class="mf">64.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">perlin_noise</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.rectify_to_float01">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">rectify_to_float01</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rectify_to_float01"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.rectify_to_float01" title="Permalink to this definition"></a></dt>
<dd><p>Ensure that an image is encoded using a float properly</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.rectify_to_square">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">rectify_to_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extreme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rectify_to_square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.rectify_to_square" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.rectify_to_uint8">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">rectify_to_uint8</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rectify_to_uint8"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.rectify_to_uint8" title="Permalink to this definition"></a></dt>
<dd><p>Ensure that an image is encoded in uint8 properly</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.resize">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">resize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.resize" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.resize_image_by_scale">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">resize_image_by_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_image_by_scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.resize_image_by_scale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.resize_mask">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">resize_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.resize_mask" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.resize_thumb">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">resize_thumb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(64,</span> <span class="pre">64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_thumb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.resize_thumb" title="Permalink to this definition"></a></dt>
<dd><p>Resize an image such that its max width or height is:</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-resize_thumb –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">resize_thumb</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;img.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;img2.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img2</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.resize_to_maxdims">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">resize_to_maxdims</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(64,</span> <span class="pre">64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_to_maxdims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.resize_to_maxdims" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>max_dsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – </p></li>
<li><p><strong>interpolation</strong> (<em>long</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-resize_to_maxdims –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">resize_to_maxdims</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;img.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;img2.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img2</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.resize_to_maxdims_ondisk">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">resize_to_maxdims_ondisk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_to_maxdims_ondisk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.resize_to_maxdims_ondisk" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_fpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – file path string</p></li>
<li><p><strong>max_dsize</strong> – </p></li>
<li><p><strong>out_fpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – file path string(default = None)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormA.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormB.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormC.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormD.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormE.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormF.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormG.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormH.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormI.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormJ.png –dsize=417,None</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fpath&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--dsize&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resize_to_maxdims_ondisk</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">,</span> <span class="n">out_fpath</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.resized_clamped_thumb_dims">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">resized_clamped_thumb_dims</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dsize</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resized_clamped_thumb_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.resized_clamped_thumb_dims" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.resized_dims_and_ratio">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">resized_dims_and_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dsize</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resized_dims_and_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.resized_dims_and_ratio" title="Permalink to this definition"></a></dt>
<dd><p>returns resized dimensions to get <code class="docutils literal notranslate"><span class="pre">img_size</span></code> to fit into <code class="docutils literal notranslate"><span class="pre">max_dsize</span></code></p>
<dl class="simple">
<dt>FIXME:</dt><dd><p>Should specifying a None force the use of the original dim?</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – </p></li>
<li><p><strong>max_dsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(dsize, ratio)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image resized_dims_and_ratio –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">=</span> <span class="n">resized_dims_and_ratio</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(dsize, ratio) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(dsize, ratio) = ((150, 75), 0.75)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">=</span> <span class="n">resized_dims_and_ratio</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(dsize, ratio) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(dsize, ratio) = ((2000, 1000), 10.0)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">=</span> <span class="n">resized_dims_and_ratio</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(dsize, ratio) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(dsize, ratio) = ((200, 100), 1.0)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">=</span> <span class="n">resized_dims_and_ratio</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(dsize, ratio) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(dsize, ratio) = ((200, 100), 1.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.rotate_image">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">rotate_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">border_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rotate_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.rotate_image" title="Permalink to this definition"></a></dt>
<dd><p>Rotates an image around its center</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>theta</strong> – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-rotate_image</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_test_patch</span><span class="p">(</span><span class="s1">&#39;star2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">16.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR</span> <span class="o">=</span> <span class="n">rotate_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--show&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ut</span><span class="o">.</span><span class="n">inIPython</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span>  <span class="o">*</span> <span class="mi">255</span><span class="p">,</span>  <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.rotate_image_ondisk">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">rotate_image_ondisk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rotate_image_ondisk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.rotate_image_ondisk" title="Permalink to this definition"></a></dt>
<dd><p>Rotates an image on disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_fpath</strong> – </p></li>
<li><p><strong>theta</strong> – </p></li>
<li><p><strong>out_fpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-rotate_image_ondisk</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;star.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath_</span> <span class="o">=</span> <span class="n">rotate_image_ondisk</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">out_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">out_fpath_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--show&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ut</span><span class="o">.</span><span class="n">inIPython</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">out_fpath_</span><span class="p">,</span>  <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.shear">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">shear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_shear</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_shear</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#shear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.shear" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>x_shear</strong> – </p></li>
<li><p><strong>y_shear</strong> – </p></li>
<li><p><strong>dsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – width, height</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-shear –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_shear</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_shear</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgSh</span> <span class="o">=</span> <span class="n">shear</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">x_shear</span><span class="p">,</span> <span class="n">y_shear</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgSh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.stack_image_list">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">stack_image_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_image_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.stack_image_list" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-stack_image_list –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_offset</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modifysize</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_sf</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">modifysize</span><span class="o">=</span><span class="n">modifysize</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="n">vert</span><span class="p">,</span> <span class="n">use_larger</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span><span class="p">,</span> <span class="n">offset_list</span><span class="p">,</span> <span class="n">sf_list</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">return_offset</span><span class="o">=</span><span class="n">return_offset</span><span class="p">,</span> <span class="n">return_sf</span><span class="o">=</span><span class="n">return_sf</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">offset_list</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">img_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list_</span> <span class="o">=</span> <span class="n">wh_list</span> <span class="o">*</span> <span class="n">sf_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">offset</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">offset_list</span><span class="p">,</span> <span class="n">wh_list_</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">distinct_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">offset_list</span><span class="p">))):</span>
<span class="gp">... </span>   <span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#wh1 = img1.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#wh2 = img2.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_bbox((0, 0) + wh1, bbox_color=(1, 0, 0))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_bbox((woff, hoff) + wh2, bbox_color=(0, 1, 0))</span>
<span class="go">np.array([[   0.  ,   76.96,  141.08,  181.87,  246.  ],</span>
<span class="go">          [   0.  ,    0.  ,    0.  ,    0.  ,    0.  ]], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.stack_image_list_special">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">stack_image_list_special</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_larger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_sf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_image_list_special"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.stack_image_list_special" title="Permalink to this definition"></a></dt>
<dd><p># TODO: add initial scale down factor?</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-stack_image_list_special –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list_</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">img_list_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="n">img_list_</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_offset</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_larger</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_bot</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_sf</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_sf</span> <span class="o">=</span> <span class="mf">.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span><span class="p">,</span> <span class="n">offset_list</span><span class="p">,</span> <span class="n">sf_list</span> <span class="o">=</span> <span class="n">stack_image_list_special</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img_list</span><span class="p">,</span> <span class="n">num_bot</span><span class="p">,</span> <span class="n">vert</span><span class="p">,</span> <span class="n">use_larger</span><span class="p">,</span> <span class="n">initial_sf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img1</span><span class="p">)]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">,</span> <span class="n">img_list</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list_</span> <span class="o">=</span> <span class="n">wh_list</span> <span class="o">*</span> <span class="n">sf_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;imgB.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">imgB</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">offset</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">offset_list</span><span class="p">,</span> <span class="n">wh_list_</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">distinct_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">offset_list</span><span class="p">))):</span>
<span class="gp">... </span>   <span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.stack_image_recurse">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">stack_image_recurse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_list1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_list2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modifysize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_image_recurse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.stack_image_recurse" title="Permalink to this definition"></a></dt>
<dd><p>TODO: return offsets as well</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_list1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>img_list2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>vert</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-stack_image_recurse –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;astro.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img3</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;ada.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img4</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;jeff.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img5</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;star.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list1</span> <span class="o">=</span> <span class="p">[</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">img3</span><span class="p">,</span> <span class="n">img4</span><span class="p">,</span> <span class="n">img5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list2</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">stack_image_recurse</span><span class="p">(</span><span class="n">img_list1</span><span class="p">,</span> <span class="n">img_list2</span><span class="p">,</span> <span class="n">vert</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#wh1 = img1.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#wh2 = img2.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_bbox((0, 0) + wh1, bbox_color=(1, 0, 0))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_bbox((woff, hoff) + wh2, bbox_color=(0, 1, 0))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.stack_images">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">stack_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modifysize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_larger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">white_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.stack_images" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-stack_images –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;astro.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modifysize</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_sf</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#(imgB, woff, hoff) = stack_images(img1, img2, vert, modifysize, return_sf=return_sf)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">overlap</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span><span class="p">,</span> <span class="n">offset2</span><span class="p">,</span> <span class="n">sf_tup</span> <span class="o">=</span> <span class="n">stack_images</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">vert</span><span class="p">,</span> <span class="n">modifysize</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">return_sf</span><span class="o">=</span><span class="n">return_sf</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span> <span class="o">=</span> <span class="n">offset2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">imgB</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img1</span><span class="p">),</span> <span class="n">sf_tup</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img2</span><span class="p">),</span> <span class="n">sf_tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wh1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh1</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">woff</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">hoff</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh2</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">((662, 512, 3), (0.0, 0.0), (0, 150))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.stack_multi_images">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">stack_multi_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_list1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sf_list1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_list2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sf_list2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_larger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modifysize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_multi_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.stack_multi_images" title="Permalink to this definition"></a></dt>
<dd><p>combines images that are already stacked</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.stack_multi_images2">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">stack_multi_images2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multiimg_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsets_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfs_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modifysize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_multi_images2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.stack_multi_images2" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>multiimg_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>offset_lists</strong> – </p></li>
<li><p><strong>sfs_list</strong> – </p></li>
<li><p><strong>vert</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(stacked_img, stacked_img, stacked_sfs)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-stack_multi_images2 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_stack1</span><span class="p">,</span> <span class="n">offset_list1</span><span class="p">,</span> <span class="n">sf_list1</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">vert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">modifysize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_stack2</span><span class="p">,</span> <span class="n">offset_list2</span><span class="p">,</span> <span class="n">sf_list2</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">modifysize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_stack3</span><span class="p">,</span> <span class="n">offset_list3</span><span class="p">,</span> <span class="n">sf_list3</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">modifysize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multiimg_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">img_stack1</span><span class="p">,</span> <span class="n">img_stack2</span><span class="p">,</span> <span class="n">img_stack3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offsets_list</span>  <span class="o">=</span> <span class="p">[</span><span class="n">offset_list1</span><span class="p">,</span> <span class="n">offset_list2</span><span class="p">,</span> <span class="n">offset_list3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sfs_list</span>      <span class="o">=</span> <span class="p">[</span><span class="n">sf_list1</span><span class="p">,</span> <span class="n">sf_list2</span><span class="p">,</span> <span class="n">sf_list3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">stack_multi_images2</span><span class="p">(</span><span class="n">multiimg_list</span><span class="p">,</span> <span class="n">offsets_list</span><span class="p">,</span> <span class="n">sfs_list</span><span class="p">,</span> <span class="n">vert</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">stacked_img</span><span class="p">,</span> <span class="n">stacked_offsets</span><span class="p">,</span> <span class="n">stacked_sfs</span><span class="p">)</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">remove_doublspaces</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">stacked_offsets</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">10000</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; ,&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">stacked_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">img_list</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">img_list</span> <span class="o">+</span> <span class="n">img_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list_</span> <span class="o">=</span> <span class="n">wh_list</span> <span class="o">*</span> <span class="n">stacked_sfs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">offset</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">stacked_offsets</span><span class="p">,</span> <span class="n">wh_list_</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">distinct_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stacked_offsets</span><span class="p">))):</span>
<span class="gp">... </span>   <span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([[ 0., 0., 0., 0., 0., 512., 512., 512., 512., 512., 1024., 1024., 1024., 1024., 1024. ],</span>
<span class="go"> [ 0., 512.12, 1024.25, 1827., 2339., 0., 427., 939., 1742., 2254., 0., 373.18, 1137.45, 2073.38, 2670.47]], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.stack_square_images">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">stack_square_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_square_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.stack_square_images" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>img_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-stack_square_images</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">stack_square_images</span><span class="p">(</span><span class="n">img_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.subpixel_values">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">subpixel_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#subpixel_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.subpixel_values" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p>stackoverflow.com/uestions/12729228/simple-efficient-binlinear-interpolation-of-images-in-numpy-and-python</p>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>cv2.getRectSubPix(image, patchSize, center[, patch[, patchType]])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.testdata_imglist">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">testdata_imglist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#testdata_imglist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.testdata_imglist" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.warpAffine">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">warpAffine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Aff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_float01</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#warpAffine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.warpAffine" title="Permalink to this definition"></a></dt>
<dd><p>dsize = (width, height) of return image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>Aff</strong> (<em>ndarray</em>) – affine matrix</p></li>
<li><p><strong>dsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – width, height</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>warped_img</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-warpAffine –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rotation_mat3x3</span><span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warped_img</span> <span class="o">=</span> <span class="n">warpAffine</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">Aff</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">warped_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">skimage.transform</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">timeit</span> <span class="n">cv2</span><span class="o">.</span><span class="n">warpAffine</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">Aff</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dsize</span><span class="p">),</span> <span class="o">**</span><span class="n">CV2_WARP_KWARGS</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">100</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">7.95</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">skimage</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">AffineTransform</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tf</span> <span class="o">=</span> <span class="n">skimage</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">AffineTransform</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff_</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">params</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">skimage</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">_warps_cy</span><span class="o">.</span><span class="n">_warp_fast</span><span class="p">(</span><span class="n">img</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Aff_</span><span class="p">,</span> <span class="n">output_shape</span><span class="o">=</span><span class="n">dsize</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">timeit</span> <span class="n">skimage</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">_warps_cy</span><span class="o">.</span><span class="n">_warp_fast</span><span class="p">(</span><span class="n">img</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Aff_</span><span class="p">,</span> <span class="n">output_shape</span><span class="o">=</span><span class="n">dsize</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">100</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">5.74</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">timeit</span> <span class="n">cv2</span><span class="o">.</span><span class="n">warpAffine</span><span class="p">(</span><span class="n">img</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Aff</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dsize</span><span class="p">),</span> <span class="o">**</span><span class="n">CV2_WARP_KWARGS</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">100</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">5.13</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CONCLUSION</span><span class="p">,</span> <span class="n">cv2</span> <span class="n">transforms</span> <span class="n">are</span> <span class="n">better</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image.warpHomog">
<span class="sig-prename descclassname"><span class="pre">vtool.image.</span></span><span class="sig-name descname"><span class="pre">warpHomog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Homog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_float01</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#warpHomog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image.warpHomog" title="Permalink to this definition"></a></dt>
<dd><p>dsize = (width, height) of return image</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Homog</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warped_img</span> <span class="o">=</span> <span class="n">warpHomog</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">Homog</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-vtool.image_filters">
<span id="vtool-image-filters-module"></span><h2>vtool.image_filters module<a class="headerlink" href="#module-vtool.image_filters" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vtool.image_filters.IntensityPreproc">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.image_filters.</span></span><span class="sig-name descname"><span class="pre">IntensityPreproc</span></span><a class="reference internal" href="_modules/vtool/image_filters.html#IntensityPreproc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image_filters.IntensityPreproc" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Prefered over old methods</p>
<dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.image_filters IntensityPreproc –show</p>
</dd>
<dt>Doctest:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image_filters</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://i.imgur.com/qVWQaex.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filter_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;medianblur&#39;</span><span class="p">,</span> <span class="p">{}),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;adapteq&#39;</span><span class="p">,</span> <span class="p">{}),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">IntensityPreproc</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">,</span> <span class="n">filter_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chipBGR2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="vtool.image_filters.IntensityPreproc.adapteq">
<span class="sig-name descname"><span class="pre">adapteq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tileGridSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(8,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clipLimit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#IntensityPreproc.adapteq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image_filters.IntensityPreproc.adapteq" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.image_filters.IntensityPreproc.histeq">
<span class="sig-name descname"><span class="pre">histeq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#IntensityPreproc.histeq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image_filters.IntensityPreproc.histeq" title="Permalink to this definition"></a></dt>
<dd><p>Histogram equalization of a grayscale image.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.image_filters.IntensityPreproc.medianblur">
<span class="sig-name descname"><span class="pre">medianblur</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ksize1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ksize2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#IntensityPreproc.medianblur"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image_filters.IntensityPreproc.medianblur" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.image_filters.IntensityPreproc.preprocess">
<span class="sig-name descname"><span class="pre">preprocess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chipBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#IntensityPreproc.preprocess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image_filters.IntensityPreproc.preprocess" title="Permalink to this definition"></a></dt>
<dd><p>filter_list is a list of (name, config) tuples for preforming filter ops</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image_filters.adapteq_fn">
<span class="sig-prename descclassname"><span class="pre">vtool.image_filters.</span></span><span class="sig-name descname"><span class="pre">adapteq_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chipBGR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#adapteq_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image_filters.adapteq_fn" title="Permalink to this definition"></a></dt>
<dd><p>adaptive histogram equalization with CLAHE</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image_filters</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://i.imgur.com/qVWQaex.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip2</span> <span class="o">=</span> <span class="n">adapteq_fn</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chip2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image_filters.clean_mask">
<span class="sig-prename descclassname"><span class="pre">vtool.image_filters.</span></span><span class="sig-name descname"><span class="pre">clean_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_dilate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_erode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.025</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#clean_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image_filters.clean_mask" title="Permalink to this definition"></a></dt>
<dd><p>Clean the mask
(num_erode, num_dilate) = (1, 1)
(w, h) = (10, 10)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image_filters.grabcut_fn">
<span class="sig-prename descclassname"><span class="pre">vtool.image_filters.</span></span><span class="sig-name descname"><span class="pre">grabcut_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chipBGR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#grabcut_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image_filters.grabcut_fn" title="Permalink to this definition"></a></dt>
<dd><p>naively segments a chip</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image_filters.histeq_fn">
<span class="sig-prename descclassname"><span class="pre">vtool.image_filters.</span></span><span class="sig-name descname"><span class="pre">histeq_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chipBGR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#histeq_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image_filters.histeq_fn" title="Permalink to this definition"></a></dt>
<dd><p>Histogram equalization of a grayscale image.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image_filters.manta_matcher_filters">
<span class="sig-prename descclassname"><span class="pre">vtool.image_filters.</span></span><span class="sig-name descname"><span class="pre">manta_matcher_filters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chipBGR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#manta_matcher_filters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image_filters.manta_matcher_filters" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://onlinelibrary.wiley.com/doi/10.1002/ece3.587/full">http://onlinelibrary.wiley.com/doi/10.1002/ece3.587/full</a></p>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia.core_annots</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s1">&#39;Mantas&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://i.imgur.com/qVWQaex.jpg&#39;</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image_filters.medianfilter_fn">
<span class="sig-prename descclassname"><span class="pre">vtool.image_filters.</span></span><span class="sig-name descname"><span class="pre">medianfilter_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chipBGR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#medianfilter_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image_filters.medianfilter_fn" title="Permalink to this definition"></a></dt>
<dd><p>median filtering</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image_filters</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://i.imgur.com/qVWQaex.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip2</span> <span class="o">=</span> <span class="n">adapteq_fn</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chip2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-vtool.image_shared">
<span id="vtool-image-shared-module"></span><h2>vtool.image_shared module<a class="headerlink" href="#module-vtool.image_shared" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.image_shared.open_pil_image">
<span class="sig-prename descclassname"><span class="pre">vtool.image_shared.</span></span><span class="sig-name descname"><span class="pre">open_pil_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_shared.html#open_pil_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image_shared.open_pil_image" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.image_shared.print_image_checks">
<span class="sig-prename descclassname"><span class="pre">vtool.image_shared.</span></span><span class="sig-name descname"><span class="pre">print_image_checks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_shared.html#print_image_checks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.image_shared.print_image_checks" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool.inspect_matches">
<span id="vtool-inspect-matches-module"></span><h2>vtool.inspect_matches module<a class="headerlink" href="#module-vtool.inspect_matches" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vtool.inspect_matches.MatchInspector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.inspect_matches.</span></span><span class="sig-name descname"><span class="pre">MatchInspector</span></span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl>
<dt>A widget that contains</dt><dd><ol class="arabic simple">
<li><p>a viewport that displays an annotation pair with matches overlayed.</p></li>
<li><p>a control panel for tuning matching parameters</p></li>
<li><p>a text area displaying information about the match vector</p></li>
</ol>
</dd>
<dt>CommandLine:</dt><dd><p>python -m vtool.inspect_matches MatchInspector:0 –show
python -m vtool.inspect_matches MatchInspector:1 –show</p>
<p>python -m vtool.inspect_matches MatchInspector:1 –db GZ_Master1 –aids=1041,1045 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.inspect_matches</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">ensure_qapp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">qtensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot1</span> <span class="o">=</span> <span class="n">lazy_test_annot</span><span class="p">(</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot2</span> <span class="o">=</span> <span class="n">lazy_test_annot</span><span class="p">(</span><span class="s1">&#39;easy2.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">PairwiseMatch</span><span class="p">(</span><span class="n">annot1</span><span class="p">,</span> <span class="n">annot2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">MatchInspector</span><span class="p">(</span><span class="n">match</span><span class="o">=</span><span class="n">match</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#self.update()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">qtapp_loop</span><span class="p">(</span><span class="n">qwin</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.inspect_matches</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">ensure_qapp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">qtensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s1">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aids</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">argval</span><span class="p">(</span><span class="s1">&#39;--aids&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;aids = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">aids</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annots</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">annots</span><span class="p">(</span><span class="n">aids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot1</span> <span class="o">=</span> <span class="n">annots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_make_lazy_dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot2</span> <span class="o">=</span> <span class="n">annots</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">_make_lazy_dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="n">MatchDisplayConfig</span><span class="p">()</span><span class="o">.</span><span class="n">asdict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">argparse_dict</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">PairwiseMatch</span><span class="p">(</span><span class="n">annot1</span><span class="p">,</span> <span class="n">annot2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">MatchInspector</span><span class="p">(</span><span class="n">match</span><span class="o">=</span><span class="n">match</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#self.update()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">qtapp_loop</span><span class="p">(</span><span class="n">qwin</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="vtool.inspect_matches.MatchInspector.closeEvent">
<span class="sig-name descname"><span class="pre">closeEvent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.closeEvent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.closeEvent" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.inspect_matches.MatchInspector.draw_pair">
<span class="sig-name descname"><span class="pre">draw_pair</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.draw_pair"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.draw_pair" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.inspect_matches.MatchInspector.draw_vsone">
<span class="sig-name descname"><span class="pre">draw_vsone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.draw_vsone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.draw_vsone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.inspect_matches.MatchInspector.embed">
<span class="sig-name descname"><span class="pre">embed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.embed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.embed" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.inspect_matches.MatchInspector.execContextMenu">
<span class="sig-name descname"><span class="pre">execContextMenu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.execContextMenu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.execContextMenu" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.inspect_matches.MatchInspector.execute_vsone">
<span class="sig-name descname"><span class="pre">execute_vsone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.execute_vsone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.execute_vsone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.inspect_matches.MatchInspector.first_show">
<span class="sig-name descname"><span class="pre">first_show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.first_show"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.first_show" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.inspect_matches.MatchInspector.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">match</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autoupdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info_text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.initialize" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.inspect_matches.MatchInspector.on_cfg_changed">
<span class="sig-name descname"><span class="pre">on_cfg_changed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.on_cfg_changed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.on_cfg_changed" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.inspect_matches.MatchInspector.on_chip_cfg_changed">
<span class="sig-name descname"><span class="pre">on_chip_cfg_changed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.on_chip_cfg_changed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.on_chip_cfg_changed" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.inspect_matches.MatchInspector.on_feat_cfg_changed">
<span class="sig-name descname"><span class="pre">on_feat_cfg_changed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.on_feat_cfg_changed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.on_feat_cfg_changed" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.inspect_matches.MatchInspector.screenshot">
<span class="sig-name descname"><span class="pre">screenshot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.screenshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.screenshot" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.inspect_matches.MatchInspector.set_match">
<span class="sig-name descname"><span class="pre">set_match</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">match</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info_text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.set_match"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.set_match" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.inspect_matches.MatchInspector.showEvent">
<span class="sig-name descname"><span class="pre">showEvent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.showEvent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.showEvent" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.inspect_matches.MatchInspector.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#MatchInspector.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.MatchInspector.update" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.inspect_matches.lazy_test_annot">
<span class="sig-prename descclassname"><span class="pre">vtool.inspect_matches.</span></span><span class="sig-name descname"><span class="pre">lazy_test_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#lazy_test_annot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.lazy_test_annot" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.inspect_matches.make_match_interaction">
<span class="sig-prename descclassname"><span class="pre">vtool.inspect_matches.</span></span><span class="sig-name descname"><span class="pre">make_match_interaction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matches</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RAT+SV'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#make_match_interaction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.make_match_interaction" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.inspect_matches.show_matching_dict">
<span class="sig-prename descclassname"><span class="pre">vtool.inspect_matches.</span></span><span class="sig-name descname"><span class="pre">show_matching_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matches</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/inspect_matches.html#show_matching_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_matches.show_matching_dict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool.keypoint">
<span id="vtool-keypoint-module"></span><h2>vtool.keypoint module<a class="headerlink" href="#module-vtool.keypoint" title="Permalink to this headline"></a></h2>
<p>Keypoints are stored in the invA format by default.
Unfortunately many places in the code reference this as A instead of invA
because I was confused when I first started writing this.</p>
<p>to rectify this I am changing terminology.</p>
<dl>
<dt>Variables:</dt><dd><dl class="simple">
<dt>invV<span class="classifier">maps from ucircle onto an ellipse (perdoch.invA)</span></dt><dd><p>V : maps from ellipse to ucircle      (perdoch.A)
Z : the conic matrix                  (perdoch.E)</p>
</dd>
</dl>
</dd>
<dt>Representation:</dt><dd><dl class="simple">
<dt>kpts (ndarray)<span class="classifier">[x, y, iv11, iv21, iv22, ori]</span></dt><dd><p>a flat on disk representation of the keypoint</p>
</dd>
<dt>invV (ndarray):</dt><dd><p>[(iv11, iv12, x),
(iv21, iv22, y),
(   0,    0, 1),]
a more conceptually useful representation mapp;ing a
unit circle onto an ellipse (without any rotation)</p>
</dd>
<dt>invVR (ndarray):</dt><dd><p>[(iv11, iv12, x),
(iv21, iv22, y),
(   0,    0, 1),].dot(R)
same as invV but it is rotated before warping a unit circle
into an ellipse.</p>
</dd>
</dl>
</dd>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori</span> <span class="o">=</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">iv11</span><span class="p">,</span> <span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span> <span class="n">patch_size</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y iv11 iv21 iv22 S&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;sx, sy, w1, w2, tx, ty&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">iv11</span><span class="p">,</span> <span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span> <span class="n">ori</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kp</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_invV_mats</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">with_trans</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">kp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">(</span><span class="s1">&#39;invV = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">invV</span><span class="p">),</span> <span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span><span class="n">iv11</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>   <span class="n">x</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span><span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span>   <span class="n">y</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">rotation_mat3x3</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">sin</span><span class="o">=</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="o">=</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trans</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>   <span class="n">x</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span>   <span class="n">y</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Hypoth</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>    <span class="n">sx</span><span class="p">,</span>    <span class="n">w1</span><span class="p">,</span>   <span class="n">tx</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>    <span class="n">w2</span><span class="p">,</span>    <span class="n">sy</span><span class="p">,</span>   <span class="n">ty</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>     <span class="mi">0</span><span class="p">,</span>     <span class="mi">0</span><span class="p">,</span>    <span class="mi">1</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyz</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_2x2</span> <span class="o">=</span> <span class="n">invV</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Hypoth_2x2</span> <span class="o">=</span> <span class="n">Hypoth</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_t</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">Hypoth</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">invV</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyz_t</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">Hypoth</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">xyz</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_2x2_t</span> <span class="o">=</span> <span class="n">Hypoth_2x2</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">invV_2x2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">----&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invV_t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;xyz_t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invV_2x2_t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--- CHECKING 3x3 ---&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">check_expr_eq</span><span class="p">(</span><span class="n">invV_t</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">xyz_t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--- CHECKING 2x2 ---&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">check_expr_eq</span><span class="p">(</span><span class="n">invV_t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">invV_2x2_t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># CHeck with rotation component as well (probably ok)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_2x2</span> <span class="o">=</span> <span class="n">invVR</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_t</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">Hypoth</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">invVR</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_2x2_t</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">Hypoth_2x2</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">invVR_2x2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">----&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invVR_t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">----&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;invVR_2x2_t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--- CHECKING ROTATION + TRANSLATION 3x3 ---&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">check_expr_eq</span><span class="p">(</span><span class="n">invVR_t</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">xyz_t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--- CHECKING ROTATION 2x2 ---&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">check_expr_eq</span><span class="p">(</span><span class="n">invVR_t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">invVR_2x2_t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">####</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">####</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">####</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Checking orientation property</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[[</span><span class="n">ivr11</span><span class="p">,</span> <span class="n">ivr12</span><span class="p">,</span> <span class="n">ivr13</span><span class="p">],</span> <span class="p">[</span><span class="n">ivr21</span><span class="p">,</span> <span class="n">ivr22</span><span class="p">,</span> <span class="n">ivr23</span><span class="p">],</span> <span class="p">[</span><span class="n">ivr31</span><span class="p">,</span> <span class="n">ivr32</span><span class="p">,</span> <span class="n">ivr33</span><span class="p">],]</span> <span class="o">=</span> <span class="n">invVR</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">ivr12</span><span class="p">,</span> <span class="n">ivr11</span><span class="p">)</span>  <span class="c1"># outputs from -TAU/2 to TAU/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">ori</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">iv11</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#_oris = np.arctan2(_iv12s, _iv11s)  # outputs from -TAU/2 to TAU/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># OLD STUFF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">(</span><span class="s1">&#39;V = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">V</span><span class="p">),</span> <span class="p">)))</span>
<span class="go">V = Matrix([</span>
<span class="go">    [          1/iv11,     0,                -1.0*x/iv11],</span>
<span class="go">    [-iv21/(iv11*iv22), 1/iv22, -1.0*(y - iv21*x/iv11)/iv22],</span>
<span class="go">    [               0,     0,                        1.0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">(</span><span class="s1">&#39;V = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">invV</span><span class="o">.</span><span class="n">inv</span><span class="p">())),</span> <span class="p">)))</span>
<span class="go">V = Matrix([</span>
<span class="go">    [          1/iv11,     0,                       -1.0*x/iv11],</span>
<span class="go">    [-iv21/(iv11*iv22), 1/iv22, 1.0*(-iv11*y + iv21*x)/(iv11*iv22)],</span>
<span class="go">    [               0,     0,                               1.0]])</span>
</pre></div>
</div>
</dd>
<dt>Efficiency Notes:</dt><dd><p>single index indexing is very fast</p>
<p>slicing seems to be very fast.</p>
<p>fancy indexing with __getitem__ is very slow
using np.take is a better idea, but its a bit harder
to use with multidimensional arrays (nope use axis=x)</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.augment_2x2_with_translation">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">augment_2x2_with_translation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_mat2x2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#augment_2x2_with_translation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.augment_2x2_with_translation" title="Permalink to this definition"></a></dt>
<dd><p>helper function to augment shape matrix with a translation component.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.cast_split">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">cast_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#cast_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.cast_split" title="Permalink to this definition"></a></dt>
<dd><p>breakup keypoints into location, shape, and orientation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.convert_kptsZ_to_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">convert_kptsZ_to_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts_Z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#convert_kptsZ_to_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.convert_kptsZ_to_kpts" title="Permalink to this definition"></a></dt>
<dd><p>Convert keypoints in Z format to invV format</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.decompose_Z_to_RV_mats2x2">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">decompose_Z_to_RV_mats2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z_mats2x2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#decompose_Z_to_RV_mats2x2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.decompose_Z_to_RV_mats2x2" title="Permalink to this definition"></a></dt>
<dd><p>A, B, C = [0.016682, 0.001693, 0.014927]
# A, B, C = [0.010141, -1.1e-05, 0.02863]
Z = np.array([[A, B], [B, C]])</p>
<p>A, B, C = 0.010141, -1.1e-05, 0.02863</p>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Working on figuring relationship between us and VGG</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">Z_mats2x2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">circle_xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">invV_mats</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">circle_xy</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">invV</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">],</span> <span class="p">[</span><span class="n">_</span><span class="p">,</span> <span class="n">C</span><span class="p">]]</span> <span class="o">=</span> <span class="n">E</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[[</span><span class="n">A_</span><span class="p">,</span> <span class="n">B_</span><span class="p">],</span> <span class="p">[</span><span class="n">_</span><span class="p">,</span> <span class="n">C_</span><span class="p">]]</span> <span class="o">=</span> <span class="n">E</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">X</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">X</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">Y</span><span class="p">)</span> <span class="o">+</span> <span class="n">C</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">Y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z_mats2x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[[</span> <span class="mf">.016682</span><span class="p">,</span> <span class="mf">.001693</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span> <span class="mf">.001693</span><span class="p">,</span> <span class="mf">.014927</span><span class="p">]],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[[</span> <span class="mf">.01662</span><span class="p">,</span> <span class="mf">.001693</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span> <span class="mf">.001693</span><span class="p">,</span> <span class="mf">.014927</span><span class="p">]],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[[</span> <span class="mf">.016682</span><span class="p">,</span> <span class="mf">.00193</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span> <span class="mf">.00193</span><span class="p">,</span> <span class="mf">.01492</span><span class="p">]],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.linalg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">timeit</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">sqrtm</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="k">for</span> <span class="n">Z</span> <span class="ow">in</span> <span class="n">Z_mats2x2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">timeit</span> <span class="n">decompose_Z_to_VR_mats2x2</span><span class="p">(</span><span class="n">Z_mats2x2</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.decompose_Z_to_V_2x2">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">decompose_Z_to_V_2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z_2x2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#decompose_Z_to_V_2x2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.decompose_Z_to_V_2x2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.decompose_Z_to_invV_2x2">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">decompose_Z_to_invV_2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z_2x2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#decompose_Z_to_invV_2x2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.decompose_Z_to_invV_2x2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.decompose_Z_to_invV_mats2x2">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">decompose_Z_to_invV_mats2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z_mats2x2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#decompose_Z_to_invV_mats2x2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.decompose_Z_to_invV_mats2x2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.flatten_invV_mats_to_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">flatten_invV_mats_to_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">invV_mats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#flatten_invV_mats_to_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.flatten_invV_mats_to_kpts" title="Permalink to this definition"></a></dt>
<dd><p>flattens invV matrices into kpts format</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_RV_mats2x2">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_RV_mats2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_RV_mats2x2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_RV_mats2x2" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>sequence of matrices that transform an ellipse to unit circle</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>V_mats (ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_RV_mats_3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_RV_mats_3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_RV_mats_3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_RV_mats_3x3" title="Permalink to this definition"></a></dt>
<dd><p>prefered over get_invV_mats</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>sequence of matrices that transform an ellipse to unit circle</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>V_mats (ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_V_mats">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_V_mats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_V_mats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_V_mats" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>sequence of matrices that transform an ellipse to unit circle</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>V_mats (ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_Z_mats">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_Z_mats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V_mats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_Z_mats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_Z_mats" title="Permalink to this definition"></a></dt>
<dd><p>transform into conic matrix Z
Z = (V.T).dot(V)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Z is a conic representation of an ellipse</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Z_mats (ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_even_point_sample">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_even_point_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_even_point_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_even_point_sample" title="Permalink to this definition"></a></dt>
<dd><p>gets even points sample along the boundary of the ellipse</p>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>pyhesaff.tests.test_ellipse</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ell_border_pts_list</span> <span class="o">=</span> <span class="n">get_even_point_sample</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">ell_border_pts_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;even sample points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_grid_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_grid_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wh=(300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">300)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wh_stride=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale=20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wh_num=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_grid_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_grid_kpts" title="Permalink to this definition"></a></dt>
<dd><p>Returns a regular grid of keypoints</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wh</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – (default = (300, 300))</p></li>
<li><p><strong>wh_stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – stride of keypoints (defaults to (50, 50))</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – (default = 20)</p></li>
<li><p><strong>wh_num</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – desired number of keypoints in x and y direction.
(incompatible with stride).</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.10)"><em>type</em></a>) – (default = &lt;type ‘numpy.float32’&gt;)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>kpts -  keypoints</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float32_t, ndim=2]</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.keypoint get_grid_kpts –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh</span> <span class="o">=</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_stride</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_num</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">get_grid_kpts</span><span class="p">(</span><span class="n">wh</span><span class="p">,</span> <span class="n">wh_num</span><span class="o">=</span><span class="n">wh_num</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">wh_num</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;kpts = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">kpts</span><span class="o">.</span><span class="n">shape</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_invVR_mats2x2">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_invVR_mats2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats2x2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats2x2" title="Permalink to this definition"></a></dt>
<dd><p>Returns the keypoint shape+rotation matrix (from unit circle to ellipse)
Ignores translation component</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em><em>[</em><em>ndims=2</em><em>]</em>) – keypoints</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>invVR_mats</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.keypoint –test-get_invVR_mats2x2</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats2x2</span> <span class="o">=</span> <span class="n">get_invVR_mats2x2</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invVR_mats2x2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats2x2</span> <span class="o">=</span> <span class="n">get_invVR_mats2x2</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">invVR_mats2x2</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_invVR_mats3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_invVR_mats3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats3x3" title="Permalink to this definition"></a></dt>
<dd><p>NEWER FUNCTION</p>
<p>Returns full keypoint transform matricies from a unit circle to an
ellipse that has been rotated, scaled, skewed, and translated. Into
the image keypoint position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>invVR_mats</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float32_t, ndim=3]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats3x3</span> <span class="o">=</span> <span class="n">get_invVR_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invVR_mats3x3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[ 1.,  0., 10.],</span>
<span class="go">        [ 2.,  3., 20.],</span>
<span class="go">        [ 0.,  0.,  1.]],</span>
<span class="go">       [[ 0., -1., 30.],</span>
<span class="go">        [ 3., -2., 40.],</span>
<span class="go">        [ 0.,  0.,  1.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_invVR_mats_oris">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_invVR_mats_oris</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">invVR_mats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_oris"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats_oris" title="Permalink to this definition"></a></dt>
<dd><p>extracts orientation from matrix encoding, this is a bit tricker
can use -arctan2 or (0, 0) and (0, 1), but then have to normalize</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">get_invVR_mats_oris</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_invVR_mats_shape">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_invVR_mats_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">invVR_mats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats_shape" title="Permalink to this definition"></a></dt>
<dd><p>Extracts keypoint shape components</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">get_invVR_mats_shape</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">pibujdiaimwcnmomserkcytyyikahjmp</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p>TODO
(a.ravel()[(cols + (rows * a.shape[1]).reshape((-1,1))).ravel()]).reshape(rows.size, cols.size)
<a class="reference external" href="http://stackoverflow.com/questions/14386822/fast-numpy-fancy-indexing">http://stackoverflow.com/questions/14386822/fast-numpy-fancy-indexing</a>
# So, this doesn’t work
# Try this instead
<a class="reference external" href="http://docs.cython.org/src/userguide/memoryviews.html#memoryviews">http://docs.cython.org/src/userguide/memoryviews.html#memoryviews</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_invVR_mats_sqrd_scale">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_invVR_mats_sqrd_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">invVR_mats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_sqrd_scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats_sqrd_scale" title="Permalink to this definition"></a></dt>
<dd><p>Returns the squared scale of the invVR keyponts</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det_arr</span> <span class="o">=</span> <span class="n">get_invVR_mats_sqrd_scale</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">det_arr</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([-0.16, -0.09, -0.34, 0.59, -0.2 , 0.18, 0.06], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_invVR_mats_xys">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_invVR_mats_xys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">invVR_mats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_xys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats_xys" title="Permalink to this definition"></a></dt>
<dd><p>extracts locations
extracts xys from matrix encoding, Its just the (0, 2), and (1, 2) components</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>invVR_mats</strong> (<em>ndarray</em>) – list of matrices mapping ucircles to ellipses</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the xy location</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;&#39;&#39;</span>
<span class="go">        import numpy as np</span>
<span class="go">        np.random.seed(0)</span>
<span class="go">        invVR_mats = np.random.rand(1000, 3, 3).astype(np.float64)</span>
<span class="go">        &#39;&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;&#39;&#39;</span>
<span class="go">        invVR_mats[:, 0:2, 2].T</span>
<span class="go">        invVR_mats.T[2, 0:2]</span>
<span class="go">        invVR_mats.T.take(2, axis=0).take([0, 1], axis=0)</span>
<span class="go">        invVR_mats.T.take(2, axis=0)[0:2]</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">util_dev</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1E5</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_invV_mats">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_invV_mats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_trans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_ori</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ashomog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascontiguous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_mats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_invV_mats" title="Permalink to this definition"></a></dt>
<dd><p>TODO: DEPRICATE. too many conditionals</p>
<p>packs keypoint shapes into affine invV matrixes
(default is just the 2x2 shape. But translation, orientation,
homogonous, and contiguous flags can be set.)</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">with_trans</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">with_ori</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ashomog</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascontiguous</span><span class="o">=</span><span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">innVR_mats</span> <span class="o">=</span> <span class="n">get_invV_mats</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">with_trans</span><span class="p">,</span> <span class="n">with_ori</span><span class="p">,</span> <span class="n">ashomog</span><span class="p">,</span> <span class="n">ascontiguous</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">innVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[ 1.,  0., 10.],</span>
<span class="go">        [ 2.,  3., 20.],</span>
<span class="go">        [ 0.,  0.,  1.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_invV_mats2x2">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_invV_mats2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_mats2x2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_invV_mats2x2" title="Permalink to this definition"></a></dt>
<dd><p>Returns the keypoint shape (from unit circle to ellipse)
Ignores translation and rotation component</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>invV_mats</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float32_t, ndim=3]</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.keypoint –test-get_invV_mats2x2</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_mats2x2</span> <span class="o">=</span> <span class="n">get_invV_mats2x2</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invV_mats2x2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_invV_mats3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_invV_mats3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_mats3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_invV_mats3x3" title="Permalink to this definition"></a></dt>
<dd><p>NEWER FUNCTION</p>
<p>Returns full keypoint transform matricies from a unit circle to an
ellipse that has been scaled, skewed, and translated. Into
the image keypoint position.</p>
<p>DOES NOT INCLUDE ROTATION</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>invVR_mats -  keypoint shape and rotations (possibly translation)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float32_t, ndim=3]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_arrs3x3</span> <span class="o">=</span> <span class="n">get_invV_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invV_arrs3x3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_invVs">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_invVs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_invVs" title="Permalink to this definition"></a></dt>
<dd><p>Keypoint shapes (oriented with the gravity vector)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_kpts_dlen_sqrd">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_kpts_dlen_sqrd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_dlen_sqrd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_kpts_dlen_sqrd" title="Permalink to this definition"></a></dt>
<dd><p>returns diagonal length squared of keypoint extent</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>outer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – loose if False tight if True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dlen_sqrd</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dlen_sqrd</span> <span class="o">=</span> <span class="n">get_kpts_dlen_sqrd</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">dlen_sqrd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">3735.01</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_kpts_eccentricity">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_kpts_eccentricity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_eccentricity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_kpts_eccentricity" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>SeeAlso:</dt><dd><p>pyhesaff.tests.test_ellipse</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Eccentricity_(mathematics">https://en.wikipedia.org/wiki/Eccentricity_(mathematics</a>)</p>
<p class="rubric">Notes</p>
<p>For an ellipse/hyperbola the eccentricity is
sqrt(1 - (b ** 2 / a ** 2))</p>
<p>Eccentricity is undefined for parabolas</p>
<p>where a is the lenth of the semi-major axis and b is the length of the
semi minor axis. The length of the semi-major axis is 2 time the
largest eigenvalue.  And the length of the semi-minor axis is 2 times
the smallest eigenvalue.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – (default = (0.0, 0.0))</p></li>
<li><p><strong>scale_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – (default = 1.0)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.keypoint –exec-get_kpts_eccentricity –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts_</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kpts_</span><span class="p">,</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ecc</span> <span class="o">=</span> <span class="n">get_kpts_eccentricity</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;ecc = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">ecc</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">colors</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">scores_to_color</span><span class="p">(</span><span class="n">ecc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_axis_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ecc</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">ecc = np.array([ 0.96, 0.99, 0.87, 0.91, 0.55, 0.  ])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_kpts_image_extent">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_kpts_image_extent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_image_extent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_kpts_image_extent" title="Permalink to this definition"></a></dt>
<dd><p>returns the width and height of keypoint bounding box
This combines xy and shape information
Does not take into account if keypoint extent goes under (0, 0)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em><em>[</em><em>ndims=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>outer</strong> – uses outer rectangle if True. Set to false for a
tighter extent.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(minx, maxx, miny, maxy)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">outer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">extent</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_axis_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([ 14.78, 48.05,  0.32, 51.58])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_kpts_strs">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_kpts_strs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_strs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_kpts_strs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_kpts_wh">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_kpts_wh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_wh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_kpts_wh" title="Permalink to this definition"></a></dt>
<dd><p>Gets the width / height diameter of a keypoint
ie the diameter of the xaxis and yaxis of the keypoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em><em>[</em><em>ndims=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>outer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if True returns wh of bounding box.
This is useful because extracting a patch needs a rectangle.
If false it returns the otherwise gets the extent of the ellipse.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(2xN) column1 is X extent and column2 is Y extent</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Determine formula for min/maxing x and y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, y&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a, d&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nonnegative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xeqn</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yeqn</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">c</span> <span class="o">*</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="n">v</span> <span class="o">*</span> <span class="n">d</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dxdt</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">xeqn</span><span class="p">,</span> <span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dydt</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">yeqn</span><span class="p">,</span> <span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Ugg, cant get sympy to do trig derivative, do it manually</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dxdt</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dydt</span> <span class="o">=</span> <span class="n">d</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">-</span> <span class="n">c</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">critical_thetas</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">dxdt</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">critical_thetas</span> <span class="o">+=</span> <span class="n">solve</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">dydt</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">critical_thetas</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">((</span><span class="n">c</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">d</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="n">d</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">((</span><span class="n">c</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">d</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="n">d</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">critical_uvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">critical_thetas</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">critical_thetas</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">critical_xys</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">critical_uvs</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>SeeAlso:</dt><dd><p>get_kpts_major_minor</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span> <span class="o">*</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span> <span class="o">*</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyexnts</span> <span class="o">=</span> <span class="n">get_kpts_wh</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">xyexnts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">scale_extents</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_axis_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radii</span> <span class="o">=</span> <span class="n">xyexnts</span> <span class="o">/</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">horiz_pts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">xs</span> <span class="o">-</span> <span class="n">radii</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ys</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">horiz_pts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">xs</span> <span class="o">+</span> <span class="n">radii</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ys</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert_pts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xs</span><span class="p">,</span> <span class="p">(</span><span class="n">ys</span> <span class="o">-</span> <span class="n">radii</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert_pts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xs</span><span class="p">,</span> <span class="p">(</span><span class="n">ys</span> <span class="o">+</span> <span class="n">radii</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments2</span><span class="p">(</span><span class="n">horiz_pts1</span><span class="p">,</span> <span class="n">horiz_pts2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments2</span><span class="p">(</span><span class="n">vert_pts1</span><span class="p">,</span> <span class="n">vert_pts2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([[10.43315411, 58.5216589 ],</span>
<span class="go">          [ 4.71017647, 58.5216589 ],</span>
<span class="go">          [24.43314171, 45.09558868],</span>
<span class="go">          [26.71114159, 63.47679138],</span>
<span class="go">          [32.10540009, 30.28536987]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_match_spatial_squared_error">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_match_spatial_squared_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx2_to_fx1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_match_spatial_squared_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_match_spatial_squared_error" title="Permalink to this definition"></a></dt>
<dd><p>transforms img2 to img2 and finds squared spatial error</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts1</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>kpts2</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>H</strong> (<em>ndarray</em><em>[</em><em>float64_t</em><em>, </em><em>ndim=2</em><em>]</em>) – homography/perspective matrix mapping image 1 to image 2 space</p></li>
<li><p><strong>fx2_to_fx1</strong> (<em>ndarray</em>) – has shape (nMatch, K)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>fx2_to_xyerr_sqrd has shape (nMatch, K)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">129.83</span><span class="p">,</span>  <span class="mf">46.97</span><span class="p">,</span>  <span class="mf">15.84</span><span class="p">,</span>   <span class="mf">4.66</span><span class="p">,</span>   <span class="mf">7.24</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">137.88</span><span class="p">,</span>  <span class="mf">49.87</span><span class="p">,</span>  <span class="mf">20.09</span><span class="p">,</span>   <span class="mf">5.76</span><span class="p">,</span>   <span class="mf">6.2</span> <span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">115.95</span><span class="p">,</span>  <span class="mf">53.13</span><span class="p">,</span>  <span class="mf">12.96</span><span class="p">,</span>   <span class="mf">1.73</span><span class="p">,</span>   <span class="mf">8.77</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">324.88</span><span class="p">,</span> <span class="mf">172.58</span><span class="p">,</span> <span class="mf">127.69</span><span class="p">,</span>  <span class="mf">41.29</span><span class="p">,</span>  <span class="mf">50.5</span> <span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">285.44</span><span class="p">,</span> <span class="mf">254.61</span><span class="p">,</span> <span class="mf">136.06</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.77</span><span class="p">,</span>  <span class="mf">76.69</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">367.72</span><span class="p">,</span> <span class="mf">140.81</span><span class="p">,</span> <span class="mf">172.13</span><span class="p">,</span>  <span class="mf">12.99</span><span class="p">,</span>  <span class="mf">96.15</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">318.93</span><span class="p">,</span>  <span class="mf">11.98</span><span class="p">,</span>  <span class="mf">12.11</span><span class="p">,</span>   <span class="mf">0.38</span><span class="p">,</span>   <span class="mf">8.04</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">509.47</span><span class="p">,</span>  <span class="mf">12.53</span><span class="p">,</span>  <span class="mf">22.4</span> <span class="p">,</span>   <span class="mf">1.31</span><span class="p">,</span>   <span class="mf">5.04</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">514.03</span><span class="p">,</span>  <span class="mf">13.04</span><span class="p">,</span>  <span class="mf">19.25</span><span class="p">,</span>   <span class="mf">1.74</span><span class="p">,</span>   <span class="mf">4.72</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">490.19</span><span class="p">,</span> <span class="mf">185.49</span><span class="p">,</span>  <span class="mf">95.67</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.84</span><span class="p">,</span>  <span class="mf">88.23</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">316.97</span><span class="p">,</span> <span class="mf">206.07</span><span class="p">,</span>  <span class="mf">90.87</span><span class="p">,</span>   <span class="mf">0.07</span><span class="p">,</span>  <span class="mf">80.45</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">366.07</span><span class="p">,</span> <span class="mf">140.05</span><span class="p">,</span> <span class="mf">161.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">47.01</span><span class="p">,</span>  <span class="mf">85.62</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="o">-</span><span class="mf">0.70098</span><span class="p">,</span>  <span class="mf">0.12273</span><span class="p">,</span>  <span class="mf">5.18734</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mf">0.12444</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.63474</span><span class="p">,</span> <span class="mf">14.13995</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mf">0.00004</span><span class="p">,</span>  <span class="mf">0.00025</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.64873</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr_sqrd</span> <span class="o">=</span> <span class="n">get_match_spatial_squared_error</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">fx2_to_fx1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fx2_to_xyerr_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fx2_to_xyerr</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">6.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">,</span>  <span class="mf">15.84</span><span class="p">,</span>   <span class="mf">4.66</span><span class="p">,</span>   <span class="mf">7.24</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">9.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>  <span class="mf">20.09</span><span class="p">,</span>   <span class="mf">5.76</span><span class="p">,</span>   <span class="mf">6.2</span> <span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">12.96</span><span class="p">,</span>   <span class="mf">1.73</span><span class="p">,</span>   <span class="mf">8.77</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">12.11</span><span class="p">,</span>   <span class="mf">0.38</span><span class="p">,</span>   <span class="mf">8.04</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">5.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">22.4</span> <span class="p">,</span>   <span class="mf">1.31</span><span class="p">,</span>   <span class="mf">5.04</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">6.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">19.25</span><span class="p">,</span>   <span class="mf">1.74</span><span class="p">,</span>   <span class="mf">4.72</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr_sqrd</span> <span class="o">=</span> <span class="n">get_match_spatial_squared_error</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">fx2_to_fx1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fx2_to_xyerr_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fx2_to_xyerr</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_ori_mats">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_ori_mats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_ori_mats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_ori_mats" title="Permalink to this definition"></a></dt>
<dd><p>Returns keypoint orientation matrixes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_ori_strs">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_ori_strs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_ori_strs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_ori_strs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_oris">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_oris</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_oris"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_oris" title="Permalink to this definition"></a></dt>
<dd><p>Extracts keypoint orientations for kpts array</p>
<p>(in isotropic guassian space relative to the gravity vector)
(in simpler words: the orientation is is taken from keypoints warped to the unit circle)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpts</strong> (<em>ndarray</em>) – (N x 6) [x, y, a, c, d, theta]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(ndarray) theta</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_scales">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_scales</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_scales"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_scales" title="Permalink to this definition"></a></dt>
<dd><p>Gets average scale (does not take into account elliptical shape</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_shape_strs">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_shape_strs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_shape_strs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_shape_strs" title="Permalink to this definition"></a></dt>
<dd><p>strings debugging and output</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_sqrd_scales">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_sqrd_scales</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_sqrd_scales"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_sqrd_scales" title="Permalink to this definition"></a></dt>
<dd><p>gets average squared scale (does not take into account elliptical shape</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_scales_sqrd</span> <span class="o">=</span> <span class="n">get_sqrd_scales</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_scales_sqrd</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_scales_sqrd</span> <span class="o">=</span> <span class="n">get_sqrd_scales</span><span class="p">([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_scales_sqrd</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_transforms_from_patch_image_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_transforms_from_patch_image_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_transforms_from_patch_image_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_transforms_from_patch_image_kpts" title="Permalink to this definition"></a></dt>
<dd><p>Given some patch (like a gaussian patch) transforms a patch to be overlayed
on top of each keypoint in the image (adjusted for a scale factor)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>patch_shape</strong> – </p></li>
<li><p><strong>scale_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of 3x3 tranformation matricies for each keypoint</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>M_list</p>
</dd>
</dl>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_factor</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M_list</span> <span class="o">=</span> <span class="n">get_transforms_from_patch_image_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">patch_shape</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">M_list</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_uneven_point_sample">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_uneven_point_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_uneven_point_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_uneven_point_sample" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>for each keypoint returns an uneven sample of points along the ellipical</dt><dd><p>boundries.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p>
</dd>
</dl>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>pyhesaff.tests.test_ellipse
python -m pyhesaff.tests.test_ellipse –test-in_depth_ellipse –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ellipse_pts1</span> <span class="o">=</span> <span class="n">get_uneven_point_sample</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">ellipse_pts1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;uneven sample points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_xy_strs">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_xy_strs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_xy_strs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_xy_strs" title="Permalink to this definition"></a></dt>
<dd><p>strings debugging and output</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.get_xys">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">get_xys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_xys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.get_xys" title="Permalink to this definition"></a></dt>
<dd><p>Keypoint locations in chip space</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.invert_invV_mats">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">invert_invV_mats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">invV_mats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#invert_invV_mats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.invert_invV_mats" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>invV_mats</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=3</em><em>]</em>) – keypoint shapes (possibly translation)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>V_mats</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float32_t, ndim=3]</p>
</dd>
</dl>
<p># Ignore:
#     &gt;&gt;&gt; from vtool.keypoint import *
#     &gt;&gt;&gt; invV_mats  = np.array([[[ 18.00372824,   1.86434161,  32.        ],
#     &gt;&gt;&gt;                         [ -0.61356842,  16.02202028,  27.2       ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]],
#     &gt;&gt;&gt; #
#     &gt;&gt;&gt;                         [[ 17.41989015,   2.51145917,  61.        ],
#     &gt;&gt;&gt;                         [ -2.94649591,  24.02540959,  22.9       ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]],
#     &gt;&gt;&gt; #
#     &gt;&gt;&gt;                         [[ 20.38098025,   0.88070646,  93.1       ],
#     &gt;&gt;&gt;                         [ -0.93778675,  24.78261982,  23.6       ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]],
#     &gt;&gt;&gt; #
#     &gt;&gt;&gt;                         [[ 16.25114793,  -5.93213207, 120.        ],
#     &gt;&gt;&gt;                         [  4.71295477,  21.80597527,  29.5       ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]],
#     &gt;&gt;&gt; #
#     &gt;&gt;&gt;                         [[ 19.60863253, -11.43641248, 147.        ],
#     &gt;&gt;&gt;                         [  8.45128003,  10.69925072,  42.        ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]]])
#     &gt;&gt;&gt; ut.hash_data(invV_mats)
#     hcnoknyxgeecfyfrygblbvdeezmiulws
#     &gt;&gt;&gt; V_mats = npl.inv(invV_mats)
#     &gt;&gt;&gt; ut.hash_data(V_mats)
#     yooneahjgcifojzpovddeyhtkkyypldd</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_mats</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_invVR_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V_mats</span> <span class="o">=</span> <span class="n">invert_invV_mats</span><span class="p">(</span><span class="n">invV_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">invV_mats</span><span class="p">,</span> <span class="n">V_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This should give us identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.kp_cpp_infostr">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">kp_cpp_infostr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#kp_cpp_infostr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.kp_cpp_infostr" title="Permalink to this definition"></a></dt>
<dd><p>mirrors c++ debug code</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.kpts_docrepr">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">kpts_docrepr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'arr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#kpts_docrepr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.kpts_docrepr" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_docrepr</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.kpts_repr">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">kpts_repr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_small</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linebreak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#kpts_repr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.kpts_repr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.offset_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">offset_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#offset_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.offset_kpts" title="Permalink to this definition"></a></dt>
<dd><p>Transfoms keypoints by a scale factor and a translation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – </p></li>
<li><p><strong>scale_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>kpts -  keypoints</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float32_t, ndim=2]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_factor</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts_</span> <span class="o">=</span> <span class="n">offset_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results (hack + 0. to fix negative 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">((</span><span class="n">kpts</span><span class="p">,</span> <span class="n">kpts_</span> <span class="o">+</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ORANGE</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts_</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">LIGHT_BLUE</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">union_extents</span><span class="p">([</span><span class="n">extent1</span><span class="p">,</span> <span class="n">extent2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_axis_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([[20.  , 25.  ,  5.22, -5.11, 24.15,  0.  ],</span>
<span class="go">          [29.  , 25.  ,  2.36, -5.11, 24.15,  0.  ],</span>
<span class="go">          [30.  , 30.  , 12.22, 12.02, 10.53,  0.  ],</span>
<span class="go">          [31.  , 29.  , 13.36, 17.63, 14.1 ,  0.  ],</span>
<span class="go">          [32.  , 31.  , 16.05,  3.41, 11.74,  0.  ]], dtype=np.float64),</span>
<span class="go">np.array([[30.  , 12.5 ,  7.82, -2.56, 12.07,  0.  ],</span>
<span class="go">          [43.5 , 12.5 ,  3.53, -2.56, 12.07,  0.  ],</span>
<span class="go">          [45.  , 15.  , 18.32,  6.01,  5.26,  0.  ],</span>
<span class="go">          [46.5 , 14.5 , 20.03,  8.82,  7.05,  0.  ],</span>
<span class="go">          [48.  , 15.5 , 24.08,  1.7 ,  5.87,  0.  ]], dtype=np.float64),</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.rectify_invV_mats_are_up">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">rectify_invV_mats_are_up</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">invVR_mats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#rectify_invV_mats_are_up"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.rectify_invV_mats_are_up" title="Permalink to this definition"></a></dt>
<dd><p>Useful if invVR_mats is no longer lower triangular
rotates affine shape matrixes into downward (lower triangular) position</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.keypoint –exec-rectify_invV_mats_are_up –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Shrink x and y scales a bit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">3</span>  <span class="c1"># increase skew</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set random orientation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.2</span><span class="p">,</span> <span class="mf">.6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">get_invVR_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats2</span><span class="p">,</span> <span class="n">oris</span> <span class="o">=</span> <span class="n">rectify_invV_mats_are_up</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span> <span class="o">=</span> <span class="n">flatten_invV_mats_to_kpts</span><span class="p">(</span><span class="n">invVR_mats2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Scale down in y a bit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_kpts</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">kpts</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">]),</span> <span class="n">ori</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">eig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>             <span class="n">ori_color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Redraw oriented to show difference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">eig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ori_color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p>pt.figure(doclf=True, fnum=pt.ensure_fnum(None))
ax = pt.gca()
#ax.invert_yaxis()
#pt.draw_kpts2(kpts, color=’blue’, ell_linewidth=3, ori=1, eig=True, ori_color=’green’, rect=True)
pt.draw_kpts2(kpts2, color=’red’, ell_linewidth=2, ori=1, eig=True, ori_color=’green’, rect=True)
extents = np.array(vt.get_kpts_image_extent(np.vstack([kpts, kpts2])))
pt.set_axis_extent(extent, ax)
pt.dark_background()
ut.show_if_requested()</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">rectify_invV_mats_are_up</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
<span class="go">oxvrkuiaffukpyalgxyhqikxgbuesutz</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><p>_invRs_2x2 = invVR_mats[:, 0:2, 0:2][0:1]
A = _invRs_2x2[0]
Q, R = np.linalg.qr(A)</p>
<p>invVR_mats2, oris = rectify_invV_mats_are_up(_invRs_2x2[0:1])
L2, ori2 = invVR_mats2[0], oris[0]
Q2 = vt.rotation_mat2x2(ori2)</p>
<p>np.linalg.det(Q)</p>
<p>vecs = np.random.rand(2, 4)
Q2.dot(vecs)
Q.dot(vecs)</p>
<p>np.linalg.cholesky(_invR_2x2)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.transform_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">transform_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#transform_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.transform_kpts" title="Permalink to this definition"></a></dt>
<dd><p>returns M.dot(kpts_mat)
Currently, only works if M is affine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>M</strong> (<em>ndarray</em>) – affine transform matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">transform_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-0. &#39;</span><span class="p">,</span> <span class="s1">&#39; 0. &#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.transform_kpts_to_imgspace">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">transform_kpts_to_imgspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chipsz</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#transform_kpts_to_imgspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.transform_kpts_to_imgspace" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Transforms keypoints so they are plotable in imagespace</dt><dd><p>kpts   - xyacdo keypoints
bbox   - chip bounding boxes in image space
theta  - chip rotationsinvC
chipsz - chip extent (in keypoint / chip space)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.keypoint.transform_kpts_xys">
<span class="sig-prename descclassname"><span class="pre">vtool.keypoint.</span></span><span class="sig-name descname"><span class="pre">transform_kpts_xys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#transform_kpts_xys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.keypoint.transform_kpts_xys" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>H</strong> (<em>ndarray</em><em>[</em><em>float64_t</em><em>, </em><em>ndim=2</em><em>]</em>) – homography/perspective matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>xy_t</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">3.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>  <span class="mf">5.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>  <span class="mf">6.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_t</span> <span class="o">=</span> <span class="n">transform_kpts_xys</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-vtool.linalg">
<span id="vtool-linalg-module"></span><h2>vtool.linalg module<a class="headerlink" href="#module-vtool.linalg" title="Permalink to this headline"></a></h2>
<dl class="simple">
<dt>TODO: Look at this file</dt><dd><p><a class="reference external" href="http://www.lfd.uci.edu/~gohlke/code/transformations.py.html">http://www.lfd.uci.edu/~gohlke/code/transformations.py.html</a></p>
</dd>
</dl>
<p># Ignore:
#     &gt;&gt;&gt; # <a class="reference external" href="https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA">https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</a>
#     &gt;&gt;&gt; import vtool as vt
#     &gt;&gt;&gt; import sympy
#     &gt;&gt;&gt; from sympy.abc import theta
#     &gt;&gt;&gt; x, y, a, c, d, sx, sy  = sympy.symbols(‘x y a c d, sx, sy’)
#     &gt;&gt;&gt; R = vt.sympy_mat(vt.rotation_mat3x3(theta, sin=sympy.sin, cos=sympy.cos))
#     &gt;&gt;&gt; vt.evalprint(‘R’)
#     &gt;&gt;&gt; #evalprint(‘R.inv()’)
#     &gt;&gt;&gt; vt.evalprint(‘sympy.simplify(R.inv())’)
#     &gt;&gt;&gt; #evalprint(‘sympy.simplify(R.inv().subs(theta, 4))’)
#     &gt;&gt;&gt; #print(’——-‘)
#     &gt;&gt;&gt; #invR = sympy_mat(vt.rotation_mat3x3(-theta, sin=sympy.sin, cos=sympy.cos))
#     &gt;&gt;&gt; #evalprint(‘invR’)
#     &gt;&gt;&gt; #evalprint(‘invR.inv()’)
#     &gt;&gt;&gt; #evalprint(‘sympy.simplify(invR)’)
#     &gt;&gt;&gt; #evalprint(‘sympy.simplify(invR.subs(theta, 4))’)
#     &gt;&gt;&gt; print(’——-‘)
#     &gt;&gt;&gt; T = vt.sympy_mat(vt.translation_mat3x3(x, y, None))
#     &gt;&gt;&gt; vt.evalprint(‘T’)
#     &gt;&gt;&gt; vt.evalprint(‘T.inv()’)
#     &gt;&gt;&gt; print(’——-‘)
#     &gt;&gt;&gt; S = vt.sympy_mat(vt.scale_mat3x3(sx, sy, dtype=None))
#     &gt;&gt;&gt; vt.evalprint(‘S’)
#     &gt;&gt;&gt; vt.evalprint(‘S.inv()’)
#     &gt;&gt;&gt; print(’——-‘)
#     &gt;&gt;&gt; print(‘LaTeX’)
#     &gt;&gt;&gt; print(ut.align(’\\n’.join(sympy.latex(R).split(r’\’)).replace(‘{matrix}’, ‘{matrix}n’), ‘&amp;’)</p>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.add_homogenous_coordinate">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">add_homogenous_coordinate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">_xys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#add_homogenous_coordinate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.add_homogenous_coordinate" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.linalg –test-add_homogenous_coordinate</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xyzs</span> <span class="o">=</span> <span class="n">add_homogenous_coordinate</span><span class="p">(</span><span class="n">_xys</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">_xys</span> <span class="o">==</span> <span class="n">remove_homogenous_coordinate</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.affine_around_mat3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">affine_around_mat3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#affine_around_mat3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.affine_around_mat3x3" title="Permalink to this definition"></a></dt>
<dd><p>Executes an affine transform around center point (x, y).
Equivalent to translation.dot(affine).dot(inv(translation))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – center x location in input space</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – center y location in input space</p></li>
<li><p><strong>sx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – x scale factor (default = 1)</p></li>
<li><p><strong>sy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – y scale factor (default = 1)</p></li>
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – counter-clockwise rotation angle in radians(default = 0)</p></li>
<li><p><strong>shear</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – counter-clockwise shear angle in radians(default = 0)</p></li>
<li><p><strong>tx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – x-translation (default = 0)</p></li>
<li><p><strong>ty</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – y-translation (default = 0)</p></li>
<li><p><strong>x2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – center y location in output space (default = x)</p></li>
<li><p><strong>y2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – center y location in output space (default = y)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.linalg affine_around_mat3x3 –show</p>
</dd>
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/linalg.py affine_around_mat3x3</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orig_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">verts_from_bbox</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">bbox_center</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">bbox_from_verts</span><span class="p">(</span><span class="n">orig_pts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shear</span> <span class="o">=</span> <span class="mf">.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff</span> <span class="o">=</span> <span class="n">affine_around_mat3x3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                           <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trans_pts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">transform_points_with_homography</span><span class="p">(</span><span class="n">Aff</span><span class="p">,</span> <span class="n">orig_pts</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoc: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;bx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">orig_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">orig_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trans_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trans_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;transformed&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Demo of affine_around_mat3x3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">256.0</span><span class="p">,</span> <span class="mf">256.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">timer</span> <span class="ow">in</span> <span class="n">ub</span><span class="o">.</span><span class="n">Timerit</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;old&#39;</span><span class="p">):</span>  <span class="c1"># 19.0697 µs</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">with</span> <span class="n">timer</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">tr1_</span> <span class="o">=</span> <span class="n">translation_mat3x3</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">Aff_</span> <span class="o">=</span> <span class="n">affine_mat3x3</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">tr2_</span> <span class="o">=</span> <span class="n">translation_mat3x3</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">Aff1</span> <span class="o">=</span> <span class="n">tr2_</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Aff_</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">tr1_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">timer</span> <span class="ow">in</span> <span class="n">ub</span><span class="o">.</span><span class="n">Timerit</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">):</span>  <span class="c1"># 11.0242 µs</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">with</span> <span class="n">timer</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">Aff2</span> <span class="o">=</span> <span class="n">affine_around_mat3x3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                    <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">Aff2</span><span class="p">,</span> <span class="n">Aff1</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Shows the symbolic construction of the code</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;x, y, sx, sy, theta, shear, tx, ty, x2, y2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">sx</span> <span class="o">=</span> <span class="n">sy</span> <span class="o">=</span> <span class="n">tx</span> <span class="o">=</span> <span class="n">ty</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># move to center xy, apply affine transform, move center xy2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr1_</span> <span class="o">=</span> <span class="n">translation_mat3x3</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff_</span> <span class="o">=</span> <span class="n">affine_mat3x3</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">trig</span><span class="o">=</span><span class="n">sympy</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr2_</span> <span class="o">=</span> <span class="n">translation_mat3x3</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># combine transformations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">(</span><span class="n">tr2_</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Aff_</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">tr1_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;Aff&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Numpy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">sympy_numpy_repr</span><span class="p">(</span><span class="n">Aff</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.affine_mat3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">affine_mat3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sx=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shear=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tx=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ty=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trig=&lt;module</span> <span class="pre">'numpy'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/numpy/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#affine_mat3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.affine_mat3x3" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – x scale factor (default = 1)</p></li>
<li><p><strong>sy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – y scale factor (default = 1)</p></li>
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – rotation angle (radians) in counterclockwise direction</p></li>
<li><p><strong>shear</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – shear angle (radians) in counterclockwise directions</p></li>
<li><p><strong>tx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – x-translation (default = 0)</p></li>
<li><p><strong>ty</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – y-translation (default = 0)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://github.com/scikit-image/scikit-image/blob/master/skimage/transform/_geometric.py">https://github.com/scikit-image/scikit-image/blob/master/skimage/transform/_geometric.py</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.det_ltri">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">det_ltri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ltri</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#det_ltri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.det_ltri" title="Permalink to this definition"></a></dt>
<dd><p>Lower triangular determinant</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.dot_ltri">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">dot_ltri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ltri1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ltri2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#dot_ltri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.dot_ltri" title="Permalink to this definition"></a></dt>
<dd><p>Lower triangular dot product</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.gauss2d_pdf">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">gauss2d_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#gauss2d_pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.gauss2d_pdf" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – x cooordinate of a 2D Gaussian</p></li>
<li><p><strong>y</strong> – y cooordinate of a 2D Gaussian</p></li>
<li><p><strong>sigma</strong> – covariance of vector</p></li>
<li><p><strong>mu</strong> – mean of vector</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>float - The probability density at that point</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.inv_ltri">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">inv_ltri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ltri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#inv_ltri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.inv_ltri" title="Permalink to this definition"></a></dt>
<dd><p>Lower triangular inverse</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.normalize">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.normalize" title="Permalink to this definition"></a></dt>
<dd><p>Returns all row vectors normalized by their magnitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>ndarray</em>) – row vectors to normalize</p></li>
<li><p><strong>ord</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – type of norm to use (defaults to 2-norm)
{non-zero int, inf, -inf}</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – axis to normalize</p></li>
<li><p><strong>out</strong> (<em>ndarray</em>) – preallocated output</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>np.linalg.norm</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_normed</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;arr_normed = &#39;</span><span class="p">,</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_normed</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="n">arr_normed</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.6</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_normed</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;arr_normed = &#39;</span><span class="p">,</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_normed</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="n">arr_normed</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ord_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.6</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normed</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">ord</span><span class="p">,</span> <span class="n">normalize</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="nb">ord</span><span class="p">))</span> <span class="k">for</span> <span class="nb">ord</span> <span class="ow">in</span> <span class="n">ord_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">normed</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.normalize_rows">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">normalize_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#normalize_rows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.normalize_rows" title="Permalink to this definition"></a></dt>
<dd><p>DEPRICATE</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.random_affine_args">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">random_affine_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zoom_pdf=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tx_pdf=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ty_pdf=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shear_pdf=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_pdf=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_flip=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_stretch=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_distribution='uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalar_anchor='reflect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">txy_pdf=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng=&lt;module</span> <span class="pre">'numpy.random'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/numpy/random/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#random_affine_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.random_affine_args" title="Permalink to this definition"></a></dt>
<dd><p>TODO: allow for a pdf of ranges for each dimension</p>
<p>If pdfs are tuples it is interpreted as a default (uniform) distribution between the
two points. A single scalar is a default distribution between -scalar and
scalar.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zoom_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – (default = (1.0, 1.0))</p></li>
<li><p><strong>tx_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – (default = (0.0, 0.0))</p></li>
<li><p><strong>ty_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – (default = (0.0, 0.0))</p></li>
<li><p><strong>shear_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – (default = (0, 0))</p></li>
<li><p><strong>theta_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – (default = (0, 0))</p></li>
<li><p><strong>enable_flip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
<li><p><strong>enable_stretch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
<li><p><strong>rng</strong> (<em>module</em>) – random number generator(default = numpy.random)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>affine_args</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/linalg.py random_affine_args</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zoom_range</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.9090909090909091</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_pdf</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ty_pdf</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shear_pdf</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_pdf</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enable_flip</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enable_stretch</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">affine_args</span> <span class="o">=</span> <span class="n">random_affine_args</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">zoom_range</span><span class="p">,</span> <span class="n">tx_pdf</span><span class="p">,</span> <span class="n">ty_pdf</span><span class="p">,</span> <span class="n">shear_pdf</span><span class="p">,</span> <span class="n">theta_pdf</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">enable_flip</span><span class="p">,</span> <span class="n">enable_stretch</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;affine_args = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">affine_args</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">)</span> <span class="o">=</span> <span class="n">affine_args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">affine_mat3x3</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">Aff</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[ 1.009, -0.   ,  1.695],</span>
<span class="go">          [ 0.   ,  1.042,  2.584],</span>
<span class="go">          [ 0.   ,  0.   ,  1.   ]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.random_affine_transform">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">random_affine_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#random_affine_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.random_affine_transform" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.remove_homogenous_coordinate">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">remove_homogenous_coordinate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">_xyzs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#remove_homogenous_coordinate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.remove_homogenous_coordinate" title="Permalink to this definition"></a></dt>
<dd><p>normalizes 3d homogonous coordinates into 2d coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>_xyzs</strong> (<em>ndarray</em>) – of shape (3, N)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>_xys of shape (2, N)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.linalg –test-remove_homogenous_coordinate</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xyzs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">2.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">2.</span><span class="p">,</span>   <span class="mf">2.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">1.2</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xys</span> <span class="o">=</span> <span class="n">remove_homogenous_coordinate</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_xys</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xyzs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">140.</span><span class="p">,</span>  <span class="mf">167.</span><span class="p">,</span>  <span class="mf">185.</span><span class="p">,</span>  <span class="mf">185.</span><span class="p">,</span>  <span class="mf">194.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">121.</span><span class="p">,</span>  <span class="mf">139.</span><span class="p">,</span>  <span class="mf">156.</span><span class="p">,</span>  <span class="mf">155.</span><span class="p">,</span>  <span class="mf">163.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">47.</span><span class="p">,</span>   <span class="mf">56.</span><span class="p">,</span>   <span class="mf">62.</span><span class="p">,</span>   <span class="mf">62.</span><span class="p">,</span>   <span class="mf">65.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xys</span> <span class="o">=</span> <span class="n">remove_homogenous_coordinate</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_xys</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.rotation_around_bbox_mat3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">rotation_around_bbox_mat3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_around_bbox_mat3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.rotation_around_bbox_mat3x3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.rotation_around_mat3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">rotation_around_mat3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_around_mat3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.rotation_around_mat3x3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.rotation_mat2x2">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">rotation_mat2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_mat2x2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.rotation_mat2x2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.rotation_mat3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">rotation_mat3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radians</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sin=&lt;ufunc</span> <span class="pre">'sin'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cos=&lt;ufunc</span> <span class="pre">'cos'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_mat3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.rotation_mat3x3" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Rotation_matrix">https://en.wikipedia.org/wiki/Rotation_matrix</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.scale_around_mat3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">scale_around_mat3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#scale_around_mat3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.scale_around_mat3x3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.scale_mat3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">scale_mat3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float64'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#scale_mat3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.scale_mat3x3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.shear_mat3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">shear_mat3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shear_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shear_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float64'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#shear_mat3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.shear_mat3x3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.svd">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">svd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#svd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.svd" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>M</strong> (<em>ndarray</em>) – must be either float32 or float64</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(U, s, Vt)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.linalg –test-svd</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">20.5812</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.615</span><span class="p">,</span> <span class="mf">17.1295</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vt</span><span class="p">)</span> <span class="o">=</span> <span class="n">svd</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Ignore:</dt><dd><p>flags = cv2.SVD_FULL_UV
%timeit cv2.SVDecomp(M, flags=flags)
%timeit npl.svd(M)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.transform_around">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">transform_around</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#transform_around"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.transform_around" title="Permalink to this definition"></a></dt>
<dd><p>translates to origin, applies transform and then translates back</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.transform_points_with_homography">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">transform_points_with_homography</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_xys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#transform_points_with_homography"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.transform_points_with_homography" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>H</strong> (<em>ndarray</em><em>[</em><em>float64_t</em><em>, </em><em>ndim=2</em><em>]</em>) – homography/perspective matrix</p></li>
<li><p><strong>_xys</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – (2 x N) array</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.translation_mat3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">translation_mat3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float64'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#translation_mat3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.translation_mat3x3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linalg.whiten_xy_points">
<span class="sig-prename descclassname"><span class="pre">vtool.linalg.</span></span><span class="sig-name descname"><span class="pre">whiten_xy_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy_m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#whiten_xy_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linalg.whiten_xy_points" title="Permalink to this definition"></a></dt>
<dd><p>whitens points to mean=0, stddev=1 and returns transformation</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool</span> <span class="kn">import</span> <span class="n">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_m</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_xy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">whiten_xy_points</span><span class="p">(</span><span class="n">xy_m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_norm</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">tup</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-vtool.matching">
<span id="vtool-matching-module"></span><h2>vtool.matching module<a class="headerlink" href="#module-vtool.matching" title="Permalink to this headline"></a></h2>
<p>vt
python -m utool.util_inspect check_module_usage –pat=”matching.py”</p>
<dl class="py class">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">AnnotPairFeatInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">importances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Information class about feature dimensions of PairwiseMatch.</p>
<p class="rubric">Notes</p>
<p>Can be used to compute marginal importances over groups of features
used in the pairwise one-vs-one scoring algorithm</p>
<p>Can be used to construct an appropriate cfgdict for a new
PairwiseMatch.</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.matching AnnotPairFeatInfo</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">({})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">add_global_measures</span><span class="p">([</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;gps&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;aid1&#39;</span><span class="p">,</span> <span class="s1">&#39;aid2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Feat info without bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">make_feature_vector</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">featinfo</span> <span class="o">=</span> <span class="n">AnnotPairFeatInfo</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pairfeat_cfg</span><span class="p">,</span> <span class="n">global_keys</span> <span class="o">=</span> <span class="n">featinfo</span><span class="o">.</span><span class="n">make_pairfeat_cfg</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pairfeat_cfg = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pairfeat_cfg</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;global_keys = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">global_keys</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;delta&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">global_keys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;max&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">global_keys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">cprint</span><span class="p">(</span><span class="n">featinfo</span><span class="o">.</span><span class="n">get_infostr</span><span class="p">(),</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Feat info with bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">make_feature_vector</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mf">.7</span><span class="p">,</span> <span class="mf">.8</span><span class="p">],</span> <span class="n">bin_key</span><span class="o">=</span><span class="s1">&#39;ratio&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">featinfo</span> <span class="o">=</span> <span class="n">AnnotPairFeatInfo</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pairfeat_cfg</span><span class="p">,</span> <span class="n">global_keys</span> <span class="o">=</span> <span class="n">featinfo</span><span class="o">.</span><span class="n">make_pairfeat_cfg</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pairfeat_cfg = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr4</span><span class="p">(</span><span class="n">pairfeat_cfg</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;global_keys = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">global_keys</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">cprint</span><span class="p">(</span><span class="n">featinfo</span><span class="o">.</span><span class="n">get_infostr</span><span class="p">(),</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.binsum_fmt">
<span class="sig-name descname"><span class="pre">binsum_fmt</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'{op}({measure}[{bin_key}&lt;{binval}])'</span></em><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.binsum_fmt" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.dimkey_grammar">
<span class="sig-name descname"><span class="pre">dimkey_grammar</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.dimkey_grammar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.dimkey_grammar" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.matching AnnotPairFeatInfo.dimkey_grammar</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">({})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">add_global_measures</span><span class="p">([</span><span class="s1">&#39;view&#39;</span><span class="p">,</span> <span class="s1">&#39;qual&#39;</span><span class="p">,</span> <span class="s1">&#39;gps&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;aid1&#39;</span><span class="p">,</span> <span class="s1">&#39;aid2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Feat info without bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">make_feature_vector</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">featinfo</span> <span class="o">=</span> <span class="n">AnnotPairFeatInfo</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat_grammar</span> <span class="o">=</span> <span class="n">featinfo</span><span class="o">.</span><span class="n">dimkey_grammar</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">feat_grammar</span><span class="o">.</span><span class="n">parseString</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.feature">
<span class="sig-name descname"><span class="pre">feature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.feature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.feature" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.find">
<span class="sig-name descname"><span class="pre">find</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.find"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.find" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>groupid options:</dt><dd><p>measure_type global_measure, local_sorter, local_rank,
local_measure, summary_measure, summary_op, summary_bin,
summary_binval, summary_binkey,</p>
</dd>
<dt>Ignore:</dt><dd><p>group_id = ‘summary_op’
op = ‘==’
value = ‘len’</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.get_infostr">
<span class="sig-name descname"><span class="pre">get_infostr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.get_infostr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.get_infostr" title="Permalink to this definition"></a></dt>
<dd><p>Summarizes the types (global, local, summary) of features in X based on
standardized dimension names.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.global_measure">
<span class="sig-name descname"><span class="pre">global_measure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.global_measure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.global_measure" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.group_counts">
<span class="sig-name descname"><span class="pre">group_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.group_counts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.group_counts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.group_importance">
<span class="sig-name descname"><span class="pre">group_importance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.group_importance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.group_importance" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.loc_fmt">
<span class="sig-name descname"><span class="pre">loc_fmt</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'loc[{sorter},{rank}]({measure})'</span></em><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.loc_fmt" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.local_measure">
<span class="sig-name descname"><span class="pre">local_measure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.local_measure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.local_measure" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.local_rank">
<span class="sig-name descname"><span class="pre">local_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.local_rank"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.local_rank" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.local_sorter">
<span class="sig-name descname"><span class="pre">local_sorter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.local_sorter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.local_sorter" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.make_pairfeat_cfg">
<span class="sig-name descname"><span class="pre">make_pairfeat_cfg</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.make_pairfeat_cfg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.make_pairfeat_cfg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.measure">
<span class="sig-name descname"><span class="pre">measure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.measure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.measure" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.measure_type">
<span class="sig-name descname"><span class="pre">measure_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.measure_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.measure_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.print_counts">
<span class="sig-name descname"><span class="pre">print_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.print_counts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.print_counts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.print_margins">
<span class="sig-name descname"><span class="pre">print_margins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_trivial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.print_margins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.print_margins" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.select_columns">
<span class="sig-name descname"><span class="pre">select_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'and'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.select_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.select_columns" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>criteria</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of tokens denoting selection constraints
can be one of:
measure_type global_measure, local_sorter, local_rank,
local_measure, summary_measure, summary_op, summary_bin,
summary_binval, summary_binkey,</p>
</dd>
</dl>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">featinfo</span><span class="o">.</span><span class="n">select_columns</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;measure_type&#39;</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;local&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;local_sorter&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;weighted_ratio_score&#39;</span><span class="p">,</span> <span class="s1">&#39;lnbnn_norm_dist&#39;</span><span class="p">]),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">],</span> <span class="n">op</span><span class="o">=</span><span class="s1">&#39;and&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.sum_fmt">
<span class="sig-name descname"><span class="pre">sum_fmt</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'{op}({measure})'</span></em><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.sum_fmt" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.summary_binkey">
<span class="sig-name descname"><span class="pre">summary_binkey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.summary_binkey"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.summary_binkey" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.summary_binval">
<span class="sig-name descname"><span class="pre">summary_binval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.summary_binval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.summary_binval" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.summary_measure">
<span class="sig-name descname"><span class="pre">summary_measure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.summary_measure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.summary_measure" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.AnnotPairFeatInfo.summary_op">
<span class="sig-name descname"><span class="pre">summary_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.summary_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.AnnotPairFeatInfo.summary_op" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtool.matching.AssignTup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">AssignTup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_fx1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_dist</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vtool.matching.AssignTup" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.matching.AssignTup.fm">
<span class="sig-name descname"><span class="pre">fm</span></span><a class="headerlink" href="#vtool.matching.AssignTup.fm" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.matching.AssignTup.match_dist">
<span class="sig-name descname"><span class="pre">match_dist</span></span><a class="headerlink" href="#vtool.matching.AssignTup.match_dist" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.matching.AssignTup.norm_dist">
<span class="sig-name descname"><span class="pre">norm_dist</span></span><a class="headerlink" href="#vtool.matching.AssignTup.norm_dist" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.matching.AssignTup.norm_fx1">
<span class="sig-name descname"><span class="pre">norm_fx1</span></span><a class="headerlink" href="#vtool.matching.AssignTup.norm_fx1" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="vtool.matching.MatchingError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">MatchingError</span></span><a class="reference internal" href="_modules/vtool/matching.html#MatchingError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.MatchingError" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtool.matching.PairwiseMatch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">PairwiseMatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annot1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annot2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ubelt.util_mixins.NiceRepr</span></code></p>
<p>Newest (Sept-16-2016) object oriented one-vs-one matching interface</p>
<p>Creates an object holding two annotations
Then a pipeline of operations can be applied to
generate score and refine the matches</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The annotation dictionaries are required to have certain attributes.</p>
<dl class="simple">
<dt>Required annotation attributes:</dt><dd><p>(kpts, vecs) OR rchip OR rchip_fpath</p>
</dd>
<dt>Optional annotation attributes:</dt><dd><p>aid, nid, flann, rchip, dlen_sqrd, weight</p>
</dd>
</dl>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgL</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy2.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rchip&#39;</span><span class="p">:</span> <span class="n">imgR</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rchip&#39;</span><span class="p">:</span> <span class="n">imgL</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">PairwiseMatch</span><span class="p">(</span><span class="n">annot1</span><span class="p">,</span> <span class="n">annot2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">apply_all</span><span class="p">({</span><span class="s1">&#39;refine_method&#39;</span><span class="p">:</span> <span class="s1">&#39;affine&#39;</span><span class="p">,</span> <span class="s1">&#39;affine_invariance&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;rotation_invariance&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="n">imgR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR_warp</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">warpHomog</span><span class="p">(</span><span class="n">imgR</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">H_12</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">kwplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">autompl</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR_warp</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR_warp</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--gui)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.guitool</span> <span class="k">as</span> <span class="nn">gt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">ensure_qapp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">ishow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgL</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy2.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rchip&#39;</span><span class="p">:</span> <span class="n">imgR</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rchip&#39;</span><span class="p">:</span> <span class="n">imgL</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">PairwiseMatch</span><span class="p">(</span><span class="n">annot1</span><span class="p">,</span> <span class="n">annot2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">apply_all</span><span class="p">({</span><span class="s1">&#39;refine_method&#39;</span><span class="p">:</span> <span class="s1">&#39;affine&#39;</span><span class="p">,</span> <span class="s1">&#39;affine_invariance&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;rotation_invariance&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="n">imgR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR_warp</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">warpHomog</span><span class="p">(</span><span class="n">imgR</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">H_12</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">kwplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">autompl</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR_warp</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR_warp</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--gui)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.guitool</span> <span class="k">as</span> <span class="nn">gt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">ensure_qapp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">ishow</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.PairwiseMatch.add_global_measures">
<span class="sig-name descname"><span class="pre">add_global_measures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.add_global_measures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.add_global_measures" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.PairwiseMatch.add_local_measures">
<span class="sig-name descname"><span class="pre">add_local_measures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.add_local_measures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.add_local_measures" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.PairwiseMatch.apply_all">
<span class="sig-name descname"><span class="pre">apply_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.apply_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.apply_all" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.PairwiseMatch.apply_ratio_test">
<span class="sig-name descname"><span class="pre">apply_ratio_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.apply_ratio_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.apply_ratio_test" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.PairwiseMatch.apply_sver">
<span class="sig-name descname"><span class="pre">apply_sver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.apply_sver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.apply_sver" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;ratio_thresh&#39;</span><span class="p">:</span> <span class="mf">.8</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>           <span class="s1">&#39;thresh_bins&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.6</span><span class="p">,</span> <span class="mf">.7</span><span class="p">,</span> <span class="mf">.8</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">cfgbase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">apply_ratio_test</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags1</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">apply_sver</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.PairwiseMatch.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.assign" title="Permalink to this definition"></a></dt>
<dd><p>Assign feature correspondences between annots</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">({},</span> <span class="n">apply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m1</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">assign</span><span class="p">({</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m2</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">assign</span><span class="p">({</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">cfgdict</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">all_dict_combinations</span><span class="p">(</span><span class="n">grid</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">match</span><span class="o">.</span><span class="n">assign</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.PairwiseMatch.compress">
<span class="sig-name descname"><span class="pre">compress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.compress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.compress" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.PairwiseMatch.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.copy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.PairwiseMatch.ishow">
<span class="sig-name descname"><span class="pre">ishow</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.ishow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.ishow" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.matching ishow –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.guitool</span> <span class="k">as</span> <span class="nn">gt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">ensure_qapp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">(</span><span class="n">use_cache</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">ishow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">disp_config</span><span class="p">[</span><span class="s1">&#39;show_homog&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">qtapp_loop</span><span class="p">(</span><span class="n">qwin</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.PairwiseMatch.make_feature_vector">
<span class="sig-name descname"><span class="pre">make_feature_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">summary_ops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ratio'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.make_feature_vector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.make_feature_vector" title="Permalink to this definition"></a></dt>
<dd><p>Constructs the pairwise feature vector that represents a match</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>local_keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>global_keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>summary_ops</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>sorters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – (default = ‘ratio’)</p></li>
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – (default = 3)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>feat</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.matching make_feature_vector</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">({})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">make_feature_vector</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;feat = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.PairwiseMatch.matched_vecs2">
<span class="sig-name descname"><span class="pre">matched_vecs2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.matched_vecs2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.matched_vecs2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.PairwiseMatch.ratio_test_flags">
<span class="sig-name descname"><span class="pre">ratio_test_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.ratio_test_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.ratio_test_flags" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.PairwiseMatch.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_homog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_ori</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_ell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_pts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_lines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_rect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_eig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_all_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_blend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ell_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modifysize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heatmask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.show"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.show" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.PairwiseMatch.sver_flags">
<span class="sig-name descname"><span class="pre">sver_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.sver_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.sver_flags" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;newsym&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgbase</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;ratio_thresh&#39;</span><span class="p">:</span> <span class="mf">.8</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_union</span><span class="p">(</span><span class="n">cfgbase</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">thresh_bins</span><span class="o">=</span><span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.6</span><span class="p">,</span> <span class="mf">.7</span><span class="p">,</span> <span class="mf">.8</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">cfgbase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">apply_ratio_test</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags1</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">sver_flags</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags2</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">sver_flags</span><span class="p">(</span><span class="n">cfgbase</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.matching.PairwiseMatch.take">
<span class="sig-name descname"><span class="pre">take</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indicies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.take"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.PairwiseMatch.take" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.matching.assign_symmetric_matches">
<span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">assign_symmetric_matches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fx2_to_fx1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx2_to_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx1_to_fx2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx1_to_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Knorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#assign_symmetric_matches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.assign_symmetric_matches" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Knorm</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assign distances</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">distmat</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">L2</span><span class="p">(</span><span class="n">feat1</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">feat2</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Find nearest K</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx1_to_fx2</span> <span class="o">=</span> <span class="n">distmat</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">K</span> <span class="o">+</span> <span class="n">Knorm</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">distmat</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">K</span> <span class="o">+</span> <span class="n">Knorm</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># and order their distances</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx1_to_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">distmat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fx1_to_fx2</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">distmat</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">)])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># flat_matx1 = fx1_to_fx2 + np.arange(distmat.shape[0])[:, None] * distmat.shape[1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># fx1_to_dist = distmat.take(flat_matx1).reshape(fx1_to_fx2.shape)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx21</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx21</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx21</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;fx1&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fx1_to_fx2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx12</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx12</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;fx2&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx12</span> <span class="o">=</span> <span class="n">fx12</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">K</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx21</span> <span class="o">=</span> <span class="n">fx21</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">K</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx12</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">~</span><span class="n">fx1_to_flags</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx21</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">~</span><span class="n">fx2_to_flags</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fx12.values =</span><span class="se">\n</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fx12</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fm_ =</span><span class="se">\n</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fm_</span><span class="p">,))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fx21.values =</span><span class="se">\n</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fx21</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fm =</span><span class="se">\n</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fm</span><span class="p">,))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unflat_match_idx2</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unflat_match_idx2</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="n">flat_match_idx2</span><span class="p">]</span> <span class="o">=</span> <span class="n">flat_match_idx2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inv_lookup21</span> <span class="o">=</span> <span class="n">unflat_match_idx2</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">K</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">fx2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fx12</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">fx1_to_flags</span><span class="p">]:</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">fx1</span><span class="p">,</span> <span class="n">fx2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">match_fx1_</span><span class="p">,</span> <span class="n">match_fx2_</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">[</span><span class="n">fx2</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="n">K</span><span class="p">]</span> <span class="o">==</span> <span class="n">fx1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">inv_idx</span> <span class="o">=</span> <span class="n">inv_lookup21</span><span class="p">[</span><span class="n">fx2</span><span class="p">][</span><span class="n">cx</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inv_idx = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">inv_idx</span><span class="p">,))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.matching.assign_unconstrained_matches">
<span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">assign_unconstrained_matches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fx2_to_fx1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx2_to_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Knorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx2_to_flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#assign_unconstrained_matches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.assign_unconstrained_matches" title="Permalink to this definition"></a></dt>
<dd><p>assigns vsone matches using results of nearest neighbors.</p>
<dl class="simple">
<dt>Ignore:</dt><dd><p>fx2_to_dist = np.arange(fx2_to_fx1.size).reshape(fx2_to_fx1.shape)</p>
</dd>
<dt>CommandLine:</dt><dd><p>python -m vtool.matching –test-assign_unconstrained_matches –show
python -m vtool.matching assign_unconstrained_matches:0
python -m vtool.matching assign_unconstrained_matches:1</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx2_to_dist</span> <span class="o">=</span> <span class="n">empty_neighbors</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Knorm</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flags</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assigntup</span> <span class="o">=</span> <span class="n">assign_unconstrained_matches</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx2_to_dist</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                         <span class="n">Knorm</span><span class="p">,</span> <span class="n">fx2_to_flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="p">,</span> <span class="n">match_dist</span><span class="p">,</span> <span class="n">norm_fx1</span><span class="p">,</span> <span class="n">norm_dist</span> <span class="o">=</span> <span class="n">assigntup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">assigntup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">77</span><span class="p">,</span>   <span class="mi">971</span><span class="p">,</span> <span class="mi">22</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">116</span><span class="p">,</span>   <span class="mi">120</span><span class="p">,</span> <span class="mi">34</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">122</span><span class="p">,</span>   <span class="mi">128</span><span class="p">,</span> <span class="mi">99</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">1075</span><span class="p">,</span>  <span class="mi">692</span><span class="p">,</span> <span class="mi">102</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">530</span><span class="p">,</span>   <span class="mi">45</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span>  <span class="mi">45</span><span class="p">,</span>  <span class="mi">530</span><span class="p">,</span> <span class="mi">77</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.059</span><span class="p">,</span>  <span class="mf">0.238</span><span class="p">,</span> <span class="mf">.3</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.021</span><span class="p">,</span>  <span class="mf">0.240</span><span class="p">,</span> <span class="mf">.4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.039</span><span class="p">,</span>  <span class="mf">0.247</span><span class="p">,</span> <span class="mf">.5</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.149</span><span class="p">,</span>  <span class="mf">0.151</span><span class="p">,</span> <span class="mf">.6</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.226</span><span class="p">,</span>  <span class="mf">0.244</span><span class="p">,</span> <span class="mf">.7</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.215</span><span class="p">,</span>  <span class="mf">0.236</span><span class="p">,</span> <span class="mf">.8</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Knorm</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flags</span> <span class="o">=</span> <span class="n">fx2_to_flags</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">K</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assigntup</span> <span class="o">=</span> <span class="n">assign_unconstrained_matches</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx2_to_dist</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                         <span class="n">Knorm</span><span class="p">,</span> <span class="n">fx2_to_flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="p">,</span> <span class="n">match_dist</span><span class="p">,</span> <span class="n">norm_fx1</span><span class="p">,</span> <span class="n">norm_dist</span> <span class="o">=</span> <span class="n">assigntup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">assigntup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">fm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">ub</span><span class="o">.</span><span class="n">allsame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">assigntup</span><span class="p">)))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.matching.asymmetric_correspondence">
<span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">asymmetric_correspondence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annot1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annot2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Knorm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_shrink</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#asymmetric_correspondence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.asymmetric_correspondence" title="Permalink to this definition"></a></dt>
<dd><p>Find symmetric feature corresopndences</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.matching.csum">
<span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">csum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#csum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.csum" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.matching.demodata_match">
<span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">demodata_match</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recompute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#demodata_match"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.demodata_match" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.matching.empty_assign">
<span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">empty_assign</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#empty_assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.empty_assign" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.matching.empty_neighbors">
<span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">empty_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_vecs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#empty_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.empty_neighbors" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.matching.ensure_metadata_dlen_sqrd">
<span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">ensure_metadata_dlen_sqrd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_dlen_sqrd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.ensure_metadata_dlen_sqrd" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.matching.ensure_metadata_feats">
<span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">ensure_metadata_feats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_feats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.ensure_metadata_feats" title="Permalink to this definition"></a></dt>
<dd><p>Adds feature evaluation keys to a lazy dictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>annot</strong> (<em>utool.LazyDict</em>) – </p></li>
<li><p><strong>suffix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – (default = ‘’)</p></li>
<li><p><strong>cfgdict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – (default = {})</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.matching –exec-ensure_metadata_feats</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">LazyDict</span><span class="p">({</span><span class="s1">&#39;rchip_fpath&#39;</span><span class="p">:</span> <span class="n">rchip_fpath</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_metadata_feats</span><span class="p">(</span><span class="n">annot</span><span class="p">,</span> <span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">annot</span><span class="o">.</span><span class="n">_stored_results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span><span class="p">[</span><span class="s1">&#39;kpts&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">annot</span><span class="o">.</span><span class="n">_stored_results</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span><span class="p">[</span><span class="s1">&#39;vecs&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">annot</span><span class="o">.</span><span class="n">_stored_results</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.matching.ensure_metadata_flann">
<span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">ensure_metadata_flann</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_flann"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.ensure_metadata_flann" title="Permalink to this definition"></a></dt>
<dd><p>setup lazy flann evaluation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.matching.ensure_metadata_normxy">
<span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">ensure_metadata_normxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_normxy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.ensure_metadata_normxy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.matching.ensure_metadata_vsone">
<span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">ensure_metadata_vsone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annot1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annot2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_vsone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.ensure_metadata_vsone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.matching.flag_sym_slow">
<span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">flag_sym_slow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fx1_to_fx2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx2_to_fx1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#flag_sym_slow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.flag_sym_slow" title="Permalink to this definition"></a></dt>
<dd><p>Returns flags indicating if the matches in fx1_to_fx2 are reciprocal
with the matches in fx2_to_fx1.</p>
<p>Much slower version of flag_symmetric_matches, but more clear</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.matching.flag_symmetric_matches">
<span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">flag_symmetric_matches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fx2_to_fx1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx1_to_fx2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#flag_symmetric_matches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.flag_symmetric_matches" title="Permalink to this definition"></a></dt>
<dd><p>Returns flags indicating if the matches in fx2_to_fx1 are reciprocal
with the matches in fx1_to_fx2.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span> <span class="c1"># 0</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span> <span class="c1"># 1</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span> <span class="c1"># 2</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span> <span class="c1"># 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx1_to_fx2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># 0</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># 1</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># 2</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># 3</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span> <span class="c1"># 4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flagsA</span> <span class="o">=</span> <span class="n">flag_symmetric_matches</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx1_to_fx2</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flagsB</span> <span class="o">=</span> <span class="n">flag_sym_slow</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx1_to_fx2</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">fx2_to_flagsA</span> <span class="o">==</span> <span class="n">fx2_to_flagsB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fx2_to_flagsB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.matching.invsum">
<span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">invsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#invsum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.invsum" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.matching.normalized_nearest_neighbors">
<span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">normalized_nearest_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flann1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vecs2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#normalized_nearest_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.normalized_nearest_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>Computes matches from vecs2 to flann1.</p>
<p>uses flann index to return nearest neighbors with distances normalized
between 0 and 1 using sifts uint8 trick</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.matching.symmetric_correspondence">
<span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">symmetric_correspondence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annot1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annot2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Knorm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_shrink</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#symmetric_correspondence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.symmetric_correspondence" title="Permalink to this definition"></a></dt>
<dd><p>Find symmetric feature corresopndences</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.matching.testdata_annot_metadata">
<span class="sig-prename descclassname"><span class="pre">vtool.matching.</span></span><span class="sig-name descname"><span class="pre">testdata_annot_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rchip_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#testdata_annot_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.matching.testdata_annot_metadata" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool.nearest_neighbors">
<span id="vtool-nearest-neighbors-module"></span><h2>vtool.nearest_neighbors module<a class="headerlink" href="#module-vtool.nearest_neighbors" title="Permalink to this headline"></a></h2>
<p>Wrapper around flann (with caching)</p>
<p>python -c “import vtool, doctest; print(doctest.testmod(vtool.nearest_neighbors))”</p>
<dl class="py class">
<dt class="sig sig-object py" id="vtool.nearest_neighbors.AnnoyWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.nearest_neighbors.</span></span><span class="sig-name descname"><span class="pre">AnnoyWrapper</span></span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#AnnoyWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nearest_neighbors.AnnoyWrapper" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Wrapper for annoy to use the FLANN api</p>
<dl class="py method">
<dt class="sig sig-object py" id="vtool.nearest_neighbors.AnnoyWrapper.build_index">
<span class="sig-name descname"><span class="pre">build_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dvecs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#AnnoyWrapper.build_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nearest_neighbors.AnnoyWrapper.build_index" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.nearest_neighbors.AnnoyWrapper.nn_index">
<span class="sig-name descname"><span class="pre">nn_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qvecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_neighbs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#AnnoyWrapper.nn_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nearest_neighbors.AnnoyWrapper.nn_index" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.nearest_neighbors.ann_flann_once">
<span class="sig-prename descclassname"><span class="pre">vtool.nearest_neighbors.</span></span><span class="sig-name descname"><span class="pre">ann_flann_once</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_neighbors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flann_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#ann_flann_once"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nearest_neighbors.ann_flann_once" title="Permalink to this definition"></a></dt>
<dd><p>Finds the approximate nearest neighbors of qpts in dpts</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/nearest_neighbors.py ann_flann_once:0</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qx2_dx</span><span class="p">,</span> <span class="n">qx2_dist</span> <span class="o">=</span> <span class="n">ann_flann_once</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">qpts</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">qx2_dx</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">qx2_dist</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">    np.array([[3, 3, 3, 3, 0],</span>
<span class="go">              [2, 0, 1, 4, 4]], dtype=np.int32),</span>
<span class="go">    np.array([[1037329., 1235876., 1168550., 1286435., 1075507.],</span>
<span class="go">              [1038324., 1243690., 1304896., 1320598., 1369036.]], dtype=np.float32),</span>
<span class="go">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Test upper bounds on sift descriptors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># SeeAlso distance.understanding_pseudomax_props</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># get points on unit sphere</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nDpts</span> <span class="o">=</span> <span class="mi">5000</span> <span class="c1"># 5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nQpts</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c1"># 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">normalize_rows</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nDpts</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">normalize_rows</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nQpts</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">qpts</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">qmag</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="s1">&#39;not on unit sphere&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dmag</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="s1">&#39;not on unit sphere&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># cast to uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uint8_max</span> <span class="o">=</span> <span class="mi">512</span>  <span class="c1"># hack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uint8_min</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># hack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># 2</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">qpts8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">qpts</span> <span class="o">*</span> <span class="n">uint8_max</span><span class="p">),</span> <span class="n">uint8_min</span><span class="p">,</span> <span class="n">uint8_max</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">dpts</span> <span class="o">*</span> <span class="n">uint8_max</span><span class="p">),</span> <span class="n">uint8_min</span><span class="p">,</span> <span class="n">uint8_max</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmag8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">qpts8</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmag8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">dpts8</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qx2_dx</span><span class="p">,</span> <span class="n">qx2_dist</span> <span class="o">=</span> <span class="n">ann_flann_once</span><span class="p">(</span><span class="n">dpts8</span><span class="p">,</span> <span class="n">qpts8</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">biggest_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">qx2_dist</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;biggest_dist = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">biggest_dist</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get actual distance by hand</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hand_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">qpts8</span> <span class="o">-</span> <span class="n">dpts8</span><span class="p">[</span><span class="n">qx2_dx</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Seems like flann returns squared distance. makes sense</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="nb">repr</span><span class="p">((</span><span class="n">qx2_dx</span><span class="p">,</span> <span class="n">qx2_dist</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Build theoretically maximally distant vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="mi">512</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">D</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span> <span class="o">*</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">512</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">qpts</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">dpts</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># FIX TO ACTUALLY BE AT THE RIGHT NORM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="p">(</span><span class="n">dpts</span> <span class="o">*</span> <span class="p">(</span><span class="mi">512</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[:,</span> <span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="p">(</span><span class="n">qpts</span> <span class="o">*</span> <span class="p">(</span><span class="mi">512</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">qpts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[:,</span> <span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">qpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">qpts</span> <span class="o">-</span> <span class="n">dpts</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Because of norm condition another maximally disant pair of vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># is [1, 0, 0, ... 0] and [0, 1, .. 0, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verifythat this gives you same dist.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">512</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">512</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.nearest_neighbors.assign_to_centroids">
<span class="sig-prename descclassname"><span class="pre">vtool.nearest_neighbors.</span></span><span class="sig-name descname"><span class="pre">assign_to_centroids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flann_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#assign_to_centroids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nearest_neighbors.assign_to_centroids" title="Permalink to this definition"></a></dt>
<dd><p>Helper for akmeans</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.nearest_neighbors.flann_augment">
<span class="sig-prename descclassname"><span class="pre">vtool.nearest_neighbors.</span></span><span class="sig-name descname"><span class="pre">flann_augment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_dpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgstr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_cfgstr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flann_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#flann_augment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nearest_neighbors.flann_augment" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_dpts</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_nth_prime</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_dpts</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_dpts</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_nth_prime</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_app_resource_dir</span><span class="p">(</span><span class="s1">&#39;vtool&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgstr</span> <span class="o">=</span> <span class="s1">&#39;_testcfg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_cfgstr</span> <span class="o">=</span> <span class="s1">&#39;_new_testcfg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="n">get_kdtree_flann_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.nearest_neighbors.flann_cache">
<span class="sig-prename descclassname"><span class="pre">vtool.nearest_neighbors.</span></span><span class="sig-name descname"><span class="pre">flann_cache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flann_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_params_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_data_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">appname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vtool'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#flann_cache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nearest_neighbors.flann_cache" title="Permalink to this definition"></a></dt>
<dd><p>Tries to load a cached flann index before doing anything
from vtool.nn</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.nearest_neighbors.flann_index_time_experiment">
<span class="sig-prename descclassname"><span class="pre">vtool.nearest_neighbors.</span></span><span class="sig-name descname"><span class="pre">flann_index_time_experiment</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#flann_index_time_experiment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nearest_neighbors.flann_index_time_experiment" title="Permalink to this definition"></a></dt>
<dd><p>Shows a plot of how long it takes to build a flann index for a given number of KD-trees</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.nearest_neighbors –test-flann_index_time_experiment</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">flann_index_time_experiment</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.nearest_neighbors.get_flann_cfgstr">
<span class="sig-prename descclassname"><span class="pre">vtool.nearest_neighbors.</span></span><span class="sig-name descname"><span class="pre">get_flann_cfgstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flann_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_params_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_data_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_cfgstr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_flann_cfgstr" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.nearest_neighbors –test-get_flann_cfgstr</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgstr</span> <span class="o">=</span> <span class="s1">&#39;_FEAT(alg=heshes)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="n">get_kdtree_flann_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_flann_cfgstr</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">flann_params</span><span class="p">,</span> <span class="n">cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">_FEAT(alg=heshes)_FLANN(4kdtree)_DPTS((10,128)xxaotseonmfjkzcr)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.nearest_neighbors.get_flann_fpath">
<span class="sig-prename descclassname"><span class="pre">vtool.nearest_neighbors.</span></span><span class="sig-name descname"><span class="pre">get_flann_fpath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flann_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_params_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_data_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">appname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vtool'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_fpath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_flann_fpath" title="Permalink to this definition"></a></dt>
<dd><p>returns filepath for flann index</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.nearest_neighbors.get_flann_params">
<span class="sig-prename descclassname"><span class="pre">vtool.nearest_neighbors.</span></span><span class="sig-name descname"><span class="pre">get_flann_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kdtree'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_flann_params" title="Permalink to this definition"></a></dt>
<dd><p>Returns flann params that are relvant tothe algorithm</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf">http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>algorithm</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – (default = ‘kdtree’)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>flann_params</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.nearest_neighbors –test-get_flann_params –algo=kdtree
python -m vtool.nearest_neighbors –test-get_flann_params –algo=kmeans</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">algorithm</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--algo&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;kdtree&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="n">get_flann_params</span><span class="p">(</span><span class="n">algorithm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;flann_params = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flann_params</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.nearest_neighbors.get_flann_params_cfgstr">
<span class="sig-prename descclassname"><span class="pre">vtool.nearest_neighbors.</span></span><span class="sig-name descname"><span class="pre">get_flann_params_cfgstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flann_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_params_cfgstr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_flann_params_cfgstr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.nearest_neighbors.get_kdtree_flann_params">
<span class="sig-prename descclassname"><span class="pre">vtool.nearest_neighbors.</span></span><span class="sig-name descname"><span class="pre">get_kdtree_flann_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_kdtree_flann_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_kdtree_flann_params" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.nearest_neighbors.invertible_stack">
<span class="sig-prename descclassname"><span class="pre">vtool.nearest_neighbors.</span></span><span class="sig-name descname"><span class="pre">invertible_stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vecs_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#invertible_stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nearest_neighbors.invertible_stack" title="Permalink to this definition"></a></dt>
<dd><p>Stacks descriptors into a flat structure and returns inverse mapping from
flat database descriptor indexes (dx) to annotation ids (label) and feature
indexes (fx). Feature indexes are w.r.t. annotation indexes.</p>
<dl class="simple">
<dt>Output:</dt><dd><p>idx2_desc - flat descriptor stack
idx2_label  - inverted index into annotations
idx2_fx   - inverted index into features</p>
</dd>
</dl>
<p># Example with 2D Descriptors</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DESC_TYPE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label_list</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_vec</span><span class="p">,</span> <span class="n">idx2_label</span><span class="p">,</span> <span class="n">idx2_fx</span> <span class="o">=</span> <span class="n">invertible_stack</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">,</span> <span class="n">label_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">idx2_vec</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
<span class="go">array([[ 0,  0,  5,  2,  1,  5,  2,  1,  3, 42,  2],</span>
<span class="go">       [ 0,  1,  3, 30,  1,  3, 30,  1,  3, 42,  6]], dtype=uint8)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">idx2_label</span><span class="p">))</span>
<span class="go">array([1, 1, 2, 2, 2, 4, 4, 4, 5, 5, 5])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">idx2_fx</span><span class="p">))</span>
<span class="go">array([0, 1, 0, 1, 2, 0, 1, 2, 0, 1, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.nearest_neighbors.test_annoy">
<span class="sig-prename descclassname"><span class="pre">vtool.nearest_neighbors.</span></span><span class="sig-name descname"><span class="pre">test_annoy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#test_annoy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nearest_neighbors.test_annoy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.nearest_neighbors.test_cv2_flann">
<span class="sig-prename descclassname"><span class="pre">vtool.nearest_neighbors.</span></span><span class="sig-name descname"><span class="pre">test_cv2_flann</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#test_cv2_flann"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nearest_neighbors.test_cv2_flann" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>Ignore:</dt><dd><p>[name for name in dir(cv2) if ‘create’ in name.lower()]
[name for name in dir(cv2) if ‘stereo’ in name.lower()]</p>
<p>ut.grab_zipped_url(’<a class="reference external" href="https://priithon.googlecode.com/archive/a6117f5e81ec00abcfb037f0f9da2937bb2ea47f.tar.gz">https://priithon.googlecode.com/archive/a6117f5e81ec00abcfb037f0f9da2937bb2ea47f.tar.gz</a>’, download_dir=’.’)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.nearest_neighbors.tune_flann">
<span class="sig-prename descclassname"><span class="pre">vtool.nearest_neighbors.</span></span><span class="sig-name descname"><span class="pre">tune_flann</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#tune_flann"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nearest_neighbors.tune_flann" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_pami2014.pdf">http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_pami2014.pdf</a>
<a class="reference external" href="http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf">http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf</a>
<a class="reference external" href="http://docs.opencv.org/trunk/modules/flann/doc/flann_fast_approximate_nearest_neighbor_search.html">http://docs.opencv.org/trunk/modules/flann/doc/flann_fast_approximate_nearest_neighbor_search.html</a></p>
<dl>
<dt>Math:</dt><dd><p>cost of an algorithm is:</p>
<dl class="simple">
<dt>LaTeX:</dt><dd><dl class="simple">
<dt>cost = frac</dt><dd><p>{search + build_weight * build }
{ minoverparams( search + build_weight build)} +
memory_weight * memory</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dpts</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>target_precision</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – number between 0 and 1 representing desired
accuracy. Higher values are more accurate.</p></li>
<li><p><strong>build_weight</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – importance weight given to minimizing build time
relative to search time. This number can range from 0 to infinity.
typically because building is a more complex computation you want
to keep the number relatively low, (less than 1) otherwise you’ll
end up getting a linear search (no build time).</p></li>
<li><p><strong>memory_weight</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Importance of memory relative to total speed.
A value less than 1 gives more importance to the time spent and a
value greater than 1 gives more importance to the memory usage.</p></li>
<li><p><strong>sample_fraction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – number between 0 and 1 representing the
fraction of the input data to use in the optimization. A higher
number uses more data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuned_params</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.nearest_neighbors –test-tune_flann</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vtool.numpy_utils">
<span id="vtool-numpy-utils-module"></span><h2>vtool.numpy_utils module<a class="headerlink" href="#module-vtool.numpy_utils" title="Permalink to this headline"></a></h2>
<p>These functions might be PR quality for numpy.</p>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.numpy_utils.atleast_nd">
<span class="sig-prename descclassname"><span class="pre">vtool.numpy_utils.</span></span><span class="sig-name descname"><span class="pre">atleast_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tofront</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#atleast_nd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.numpy_utils.atleast_nd" title="Permalink to this definition"></a></dt>
<dd><p>View inputs as arrays with at least n dimensions.
TODO: Submit as a PR to numpy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>array_like</em>) – One array-like object.  Non-array inputs are
converted to arrays.  Arrays that already have n or more
dimensions are preserved.</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – number of dimensions to ensure</p></li>
<li><p><strong>tofront</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if True new dimensions are added to the front of the
array.  otherwise they are added to the back.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.numpy_utils atleast_nd</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An array with <code class="docutils literal notranslate"><span class="pre">a.ndim</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>.  Copies are avoided where possible,
and views with three or more dimensions are returned.  For example,
a 1-D array of shape <code class="docutils literal notranslate"><span class="pre">(N,)</span></code> becomes a view of shape
<code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">N,</span> <span class="pre">1)</span></code>, and a 2-D array of shape <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">N)</span></code> becomes a view
of shape <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">N,</span> <span class="pre">1)</span></code>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>ensure_shape, np.atleast_1d, np.atleast_2d, np.atleast_3d</p>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[[[</span><span class="mi">1</span><span class="p">]]]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr1_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr2_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result3</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr3_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">,</span> <span class="n">result3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.numpy_utils.ensure_shape">
<span class="sig-prename descclassname"><span class="pre">vtool.numpy_utils.</span></span><span class="sig-name descname"><span class="pre">ensure_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimshape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#ensure_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.numpy_utils.ensure_shape" title="Permalink to this definition"></a></dt>
<dd><p>TODO: Submit as a PR to numpy?</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.numpy_utils.fromiter_nd">
<span class="sig-prename descclassname"><span class="pre">vtool.numpy_utils.</span></span><span class="sig-name descname"><span class="pre">fromiter_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iter_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#fromiter_nd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.numpy_utils.fromiter_nd" title="Permalink to this definition"></a></dt>
<dd><p>Like np.fromiter but handles iterators that generated
n-dimensional arrays. Slightly faster than np.array.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>np.vstack(list_) is still faster than
vt.fromiter_nd(ut.iflatten(list_))</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iter_</strong> (<em>iter</em>) – an iterable that generates homogenous ndarrays</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – the expected output shape</p></li>
<li><p><strong>dtype</strong> (<em>dtype</em>) – the numpy datatype of the generated ndarrays</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The iterable must yeild a numpy array. It cannot yeild a Python list.</p>
</div>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.numpy_utils fromiter_nd</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total</span> <span class="o">=</span> <span class="mi">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">fromiter_nd</span><span class="p">(</span><span class="n">iter_</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">shape</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dfxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">qfxs</span><span class="p">,</span> <span class="n">dfxs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qfxs</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">fromiter_nd</span><span class="p">(</span><span class="n">iter_</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">shape</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat_dim</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mi">500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_data</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_feat_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_data</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">+</span> <span class="n">mu</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Make a large list of vectors of various sizes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Making random vectors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">feat_dim</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">n_feat_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mega_bytes</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">nbytes</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vecs_list</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mega_bytes = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mega_bytes</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">itertools</span> <span class="k">as</span> <span class="nn">it</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_total</span> <span class="o">=</span> <span class="n">n_feat_list</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_total</span><span class="p">,</span> <span class="n">feat_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">fromiter_nd</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">),</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">target1</span> <span class="o">==</span> <span class="n">target2</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">timeit</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mf">20.4</span><span class="n">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">timeit</span> <span class="n">vt</span><span class="o">.</span><span class="n">fromiter_nd</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">),</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">102</span><span class="n">ms</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">time</span> <span class="n">vt</span><span class="o">.</span><span class="n">fromiter_nd</span><span class="p">(</span><span class="n">iter_</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">time</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.numpy_utils.index_to_boolmask">
<span class="sig-prename descclassname"><span class="pre">vtool.numpy_utils.</span></span><span class="sig-name descname"><span class="pre">index_to_boolmask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isflat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#index_to_boolmask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.numpy_utils.index_to_boolmask" title="Permalink to this definition"></a></dt>
<dd><p>transforms a list of indicies into a boolean mask</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index_list</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>maxval</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>maxval</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>mask</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_numpy index_to_boolmask</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_numpy</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxval</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">index_to_boolmask</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="n">maxval</span><span class="p">,</span> <span class="n">isflat</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mask =</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[1 0 0]</span>
<span class="go"> [0 1 0]</span>
<span class="go"> [0 1 0]]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_numpy</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxval</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">index_to_boolmask</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="n">maxval</span><span class="p">,</span> <span class="n">isflat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mask = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">mask = [1 1 0 0 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.numpy_utils.iter_reduce_ufunc">
<span class="sig-prename descclassname"><span class="pre">vtool.numpy_utils.</span></span><span class="sig-name descname"><span class="pre">iter_reduce_ufunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ufunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#iter_reduce_ufunc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.numpy_utils.iter_reduce_ufunc" title="Permalink to this definition"></a></dt>
<dd><p>constant memory iteration and reduction</p>
<p>applys ufunc from left to right over the input arrays</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">memory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen_memory</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">arr_gen</span><span class="p">(</span><span class="n">arr_list</span><span class="p">,</span> <span class="n">gen_memory</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arr_list</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">gen_memory</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">arr</span>
<span class="gp">... </span>        <span class="k">yield</span> <span class="n">gen_memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gen_memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gen_memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ufunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res1</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">arr_list</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res2</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">arr_list</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res3</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">arr_gen</span><span class="p">(</span><span class="n">arr_list</span><span class="p">,</span> <span class="n">gen_memory</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res1       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res1</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res2       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res2</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res3       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;memory     = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gen_memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gen_memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">res1</span> <span class="o">==</span> <span class="n">res2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">res2</span> <span class="o">==</span> <span class="n">res3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.numpy_utils.multiaxis_reduce">
<span class="sig-prename descclassname"><span class="pre">vtool.numpy_utils.</span></span><span class="sig-name descname"><span class="pre">multiaxis_reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ufunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startaxis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#multiaxis_reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.numpy_utils.multiaxis_reduce" title="Permalink to this definition"></a></dt>
<dd><p>used to get max/min over all axes after &lt;startaxis&gt;</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.numpy_utils –test-multiaxis_reduce</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ufunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">startaxis</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_</span> <span class="o">=</span> <span class="n">multiaxis_reduce</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">startaxis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">out_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[182 245 236 249]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.numpy_utils.unique_row_indexes">
<span class="sig-prename descclassname"><span class="pre">vtool.numpy_utils.</span></span><span class="sig-name descname"><span class="pre">unique_row_indexes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#unique_row_indexes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.numpy_utils.unique_row_indexes" title="Permalink to this definition"></a></dt>
<dd><p>np.unique on rows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>ndarray</em>) – 2d array</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>unique_rowx</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array">http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.numpy_utils –test-unique_row_indexes</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">.534</span><span class="p">,</span> <span class="mf">.432</span><span class="p">],</span> <span class="p">[</span><span class="mf">.534</span><span class="p">,</span> <span class="mf">.432</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_rowx</span> <span class="o">=</span> <span class="n">unique_row_indexes</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;unique_rowx = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">unique_rowx</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">unique_rowx = np.array([0, 1, 2, 3, 5], dtype=np.int64)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Ignore:</dt><dd><p>%timeit unique_row_indexes(arr)
%timeit compute_unique_data_ids(arr)
%timeit compute_unique_integer_data_ids(arr)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vtool.other">
<span id="vtool-other-module"></span><h2>vtool.other module<a class="headerlink" href="#module-vtool.other" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.and_lists">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">and_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#and_lists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.and_lists" title="Permalink to this definition"></a></dt>
<dd><p>Like np.logical_and, but can take more than 2 arguments</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-and_lists</p>
</dd>
<dt>SeeAlso:</dt><dd><p>or_lists</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">and_lists</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[False  True False  True]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg3</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">and_lists</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ensure equal division</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">flags</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">endx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">segments</span> <span class="o">*</span> <span class="p">(</span><span class="n">validx</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="p">(</span><span class="n">segments</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">validx</span><span class="p">[:</span><span class="n">endx</span><span class="p">],</span> <span class="n">segments</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">parts</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[243734, 714397, 1204989, 1729375, 2235191]</span>
</pre></div>
</div>
<p>%timeit reduce(np.logical_and, args)
%timeit np.logical_and.reduce(args)  # wins with more data</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.argsort_groups">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">argsort_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng=&lt;module</span> <span class="pre">'numpy.random'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/numpy/random/__init__.py'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomize_levels=True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#argsort_groups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.argsort_groups" title="Permalink to this definition"></a></dt>
<dd><p>Sorts each group normally, but randomizes order of level values.</p>
<p>TODO: move to vtool</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scores_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>reverse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = True)</p></li>
<li><p><strong>rng</strong> (<em>module</em>) – random number generator(default = numpy.random)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia.init.filter_annots –exec-argsort_groups</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idxs_list</span> <span class="o">=</span> <span class="n">argsort_groups</span><span class="p">(</span><span class="n">scores_list</span><span class="p">,</span> <span class="n">reverse</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;idxs_list = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr4</span><span class="p">(</span><span class="n">idxs_list</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.argsort_records">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">argsort_records</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrays</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#argsort_records"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.argsort_records" title="Permalink to this definition"></a></dt>
<dd><p>Sorts arrays that form records.
Same as lexsort(arrays[::-1]) — ie. rows are reversed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arrays</strong> (<em>ndarray</em>) – array of records</p></li>
<li><p><strong>reverse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sortx - sorted indicies</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –exec-argsort_records</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrays</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">],)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sortx</span> <span class="o">=</span> <span class="n">argsort_records</span><span class="p">(</span><span class="n">arrays</span><span class="p">,</span> <span class="n">reverse</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;sortx = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sortx</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lxsrt = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span><span class="n">arrays</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">sortx = [1 2 0 5 4 3 6 7 8]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.assert_zipcompress">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">assert_zipcompress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#assert_zipcompress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.assert_zipcompress" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.asserteq">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">asserteq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nestpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbl1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbl2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_lbl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iswarning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#asserteq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.asserteq" title="Permalink to this definition"></a></dt>
<dd><p>recursive equality checks</p>
<p>asserts that output1 and output2 are close to equal.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.atleast_3channels">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">atleast_3channels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#atleast_3channels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.atleast_3channels" title="Permalink to this definition"></a></dt>
<dd><p>Ensures that there are 3 channels in the image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>ndarray</em><em>[</em><em>N</em><em>, </em><em>M</em><em>, </em><em>...</em><em>]</em>) – the image</p></li>
<li><p><strong>copy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Always copies if True, if False, then copies only when the
size of the array must change.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>with shape (N, M, C), where C in {3, 4}</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.other atleast_3channels</p>
</dd>
<dt>Doctest:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_3channels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_3channels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_3channels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_3channels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.atleast_nd">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">atleast_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tofront</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#atleast_nd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.atleast_nd" title="Permalink to this definition"></a></dt>
<dd><p>View inputs as arrays with at least n dimensions.
TODO: Commit to numpy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>array_like</em>) – One array-like object.  Non-array inputs are
converted to arrays.  Arrays that already have n or more dimensions
are preserved.</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
<li><p><strong>tofront</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if True new dims are added to the front of the array</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –exec-atleast_nd –show</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An array with <code class="docutils literal notranslate"><span class="pre">a.ndim</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>.  Copies are avoided where possible,
and views with three or more dimensions are returned.  For example,
a 1-D array of shape <code class="docutils literal notranslate"><span class="pre">(N,)</span></code> becomes a view of shape
<code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">N,</span> <span class="pre">1)</span></code>, and a 2-D array of shape <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">N)</span></code> becomes a view of shape
<code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">N,</span> <span class="pre">1)</span></code>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>atleast_1d, atleast_2d, atleast_3d</p>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[[[</span><span class="mi">1</span><span class="p">]]]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr1_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr2_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result3</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr3_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">,</span> <span class="n">result3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.atleast_shape">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">atleast_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimshape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#atleast_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.atleast_shape" title="Permalink to this definition"></a></dt>
<dd><p>Ensures that an array takes a certain shape. The total size of the array
must not change.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>ndarray</em>) – array to change the shape of</p></li>
<li><p><strong>dimshape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – desired shape (Nones can be used to broadcast
dimensions)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ndarray - the input array, which has been modified inplace.</p>
</dd>
</dl>
<dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.other ensure_shape</p>
</dd>
<dt>Doctest:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(()),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(()),</span> <span class="nb">tuple</span><span class="p">())</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(()),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">atleast_shape</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">atleast_shape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.calc_error_bars_from_sample">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">calc_error_bars_from_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_positive</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#calc_error_bars_from_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.calc_error_bars_from_sample" title="Permalink to this definition"></a></dt>
<dd><p>Determines a error bars of sample</p>
<p class="rubric">References</p>
<p><a class="reference external" href="https://www.qualtrics.com/blog/determining-sample-size/">https://www.qualtrics.com/blog/determining-sample-size/</a>
<a class="reference external" href="http://www.surveysystem.com/sscalc.htm">http://www.surveysystem.com/sscalc.htm</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Sample_size_determination">https://en.wikipedia.org/wiki/Sample_size_determination</a>
<a class="reference external" href="http://www.surveysystem.com/sample-size-formula.htm">http://www.surveysystem.com/sample-size-formula.htm</a>
<a class="reference external" href="http://courses.wcupa.edu/rbove/Berenson/10th%20ed%20CD-ROM%20topics/section8_7.pdf">http://courses.wcupa.edu/rbove/Berenson/10th%20ed%20CD-ROM%20topics/section8_7.pdf</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Standard_normal_table">https://en.wikipedia.org/wiki/Standard_normal_table</a>
<a class="reference external" href="https://www.unc.edu/~rls/s151-2010/class23.pdf">https://www.unc.edu/~rls/s151-2010/class23.pdf</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.calc_sample_from_error_bars">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">calc_sample_from_error_bars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">err_frac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#calc_sample_from_error_bars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.calc_sample_from_error_bars" title="Permalink to this definition"></a></dt>
<dd><p>Determines a reasonable sample size to achieve desired error bars.</p>
<p>import sympy
p, n, N, z = sympy.symbols(‘prior, ss, pop, zval’)
me = sympy.symbols(‘err_frac’)
expr = (z * sympy.sqrt((p * (1 - p) / n) * ((N - n) / (N - 1))))
equation = sympy.Eq(me, expr)
nexpr = sympy.solve(equation, [n])[0]
nexpr = sympy.simplify(nexpr)</p>
<p>import autopep8
print(autopep8.fix_lines([‘ss = ‘ + str(nexpr)], autopep8._get_options({}, False)))</p>
<p>ss = -pop * prior* (zval**2) <em>(prior - 1) / ((err_frac *</em> 2) * pop - (err_frac**2) - prior * (zval**2) * (prior - 1))
ss = pop * prior * zval ** 2 * (prior - 1) / (-err_frac ** 2 * pop + err_frac ** 2 + prior * zval ** 2 * (prior - 1))</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.check_sift_validity">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">check_sift_validity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sift_uint8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#check_sift_validity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.check_sift_validity" title="Permalink to this definition"></a></dt>
<dd><p>checks if a SIFT descriptor is valid</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.clipnorm">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">clipnorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#clipnorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.clipnorm" title="Permalink to this definition"></a></dt>
<dd><p>normalizes arr to the range 0 to 1 using min_ and max_ as clipping bounds</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.colwise_operation">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">colwise_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#colwise_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.colwise_operation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.compare_implementations">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">compare_implementations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbl1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbl2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_lbl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compare_implementations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.compare_implementations" title="Permalink to this definition"></a></dt>
<dd><p>tests two different implementations of the same function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.compare_matrix_columns">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">compare_matrix_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp_op=&lt;ufunc</span> <span class="pre">'equal'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logic_op=&lt;ufunc</span> <span class="pre">'logical_or'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compare_matrix_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.compare_matrix_columns" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>REPLACE WITH:</dt><dd><p>qfx2_invalid = logic_op.reduce([comp_op([:, None], qfx2_normnid) for col1 in qfx2_topnid.T])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.compare_matrix_to_rows">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">compare_matrix_to_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp_op=&lt;ufunc</span> <span class="pre">'equal'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logic_op=&lt;ufunc</span> <span class="pre">'logical_or'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compare_matrix_to_rows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.compare_matrix_to_rows" title="Permalink to this definition"></a></dt>
<dd><p>Compares each row in row_list to each row in row matrix using comp_op
Both must have the same number of columns.
Performs logic_op on the results of each individual row</p>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>wbia.algo.hots.nn_weights.mark_name_valid_normalizers</p>
</dd>
</dl>
<p>compop   = np.equal
logic_op = np.logical_or</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.componentwise_dot">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">componentwise_dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#componentwise_dot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.componentwise_dot" title="Permalink to this definition"></a></dt>
<dd><p>a dot product is a componentwise multiplication of
two vector and then a sum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr1</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>arr2</strong> (<em>ndarray</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cosangle</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">arr1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">arr1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosangle</span> <span class="o">=</span> <span class="n">componentwise_dot</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cosangle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ 1.  1.  1.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.compress2">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">compress2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compress2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.compress2" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper around numpy compress that makes the signature more similar to take</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.compute_ndarray_unique_rowids_unsafe">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">compute_ndarray_unique_rowids_unsafe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_ndarray_unique_rowids_unsafe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.compute_ndarray_unique_rowids_unsafe" title="Permalink to this definition"></a></dt>
<dd><p>arr = np.random.randint(2, size=(10000, 10))
vt.compute_unique_data_ids_(list(map(tuple, arr)))
len(vt.compute_unique_data_ids_(list(map(tuple, arr))))
len(np.unique(vt.compute_unique_data_ids_(list(map(tuple, arr)))))</p>
<p>%timeit vt.compute_unique_data_ids_(list(map(tuple, arr)))
%timeit compute_ndarray_unique_rowids_unsafe(arr)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.compute_unique_arr_dataids">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">compute_unique_arr_dataids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_arr_dataids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.compute_unique_arr_dataids" title="Permalink to this definition"></a></dt>
<dd><p>specialized version for speed when arr is an ndarray</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.compute_unique_data_ids">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">compute_unique_data_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_data_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.compute_unique_data_ids" title="Permalink to this definition"></a></dt>
<dd><p>This is actually faster than compute_unique_integer_data_ids it seems</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-compute_unique_data_ids</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">.534</span><span class="p">,</span> <span class="mf">.432</span><span class="p">],</span> <span class="p">[</span><span class="mf">.534</span><span class="p">,</span> <span class="mf">.432</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataid_list</span> <span class="o">=</span> <span class="n">compute_unique_data_ids</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;dataid_list = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">dataid_list</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">dataid_list = np.array([0, 1, 2, 3, 0, 4, 4, 2, 1], dtype=np.int32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.compute_unique_data_ids_">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">compute_unique_data_ids_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hashable_rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iddict_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_data_ids_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.compute_unique_data_ids_" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.compute_unique_integer_data_ids">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">compute_unique_integer_data_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_integer_data_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.compute_unique_integer_data_ids" title="Permalink to this definition"></a></dt>
<dd><p>This is actually slower than compute_unique_data_ids it seems</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">compute_unique_data_ids</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">compute_unique_integer_data_ids</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p>%timeit compute_unique_data_ids(data)
%timeit compute_unique_integer_data_ids(data)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.ensure_rng">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">ensure_rng</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#ensure_rng"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.ensure_rng" title="Permalink to this definition"></a></dt>
<dd><p>Returns a numpy random number generator given a seed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.ensure_shape">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">ensure_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimshape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#ensure_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.ensure_shape" title="Permalink to this definition"></a></dt>
<dd><p>Ensures that an array takes a certain shape. The total size of the array
must not change.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>ndarray</em>) – array to change the shape of</p></li>
<li><p><strong>dimshape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – desired shape (Nones can be used to broadcast
dimensions)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ndarray - the input array, which has been modified inplace.</p>
</dd>
</dl>
<dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.other ensure_shape</p>
</dd>
<dt>Doctest:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dimshape</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">ensure_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">arr2</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3</span> <span class="o">=</span> <span class="n">ensure_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">arr3</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.find_best_undirected_edge_indexes">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">find_best_undirected_edge_indexes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directed_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_best_undirected_edge_indexes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.find_best_undirected_edge_indexes" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>directed_edges</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </p></li>
<li><p><strong>score_arr</strong> (<em>ndarray</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>unique_edge_xs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-find_best_undirected_edge_indexes</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">directed_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_edge_xs</span> <span class="o">=</span> <span class="n">find_best_undirected_edge_indexes</span><span class="p">(</span><span class="n">directed_edges</span><span class="p">,</span> <span class="n">score_arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">unique_edge_xs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[0 3 4 6]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">directed_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_arr</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_edge_xs</span> <span class="o">=</span> <span class="n">find_best_undirected_edge_indexes</span><span class="p">(</span><span class="n">directed_edges</span><span class="p">,</span> <span class="n">score_arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">unique_edge_xs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[0 2 3 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.find_elbow_point">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">find_elbow_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curve</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_elbow_point"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.find_elbow_point" title="Permalink to this definition"></a></dt>
<dd><p>Finds the on the curve point furthest from the line defined by the
endpoints of the curve.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>curve</strong> (<em>ndarray</em>) – a monotonic curve</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tradeoff_idx - this is an elbow point in the curve</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/2018178/trade-off-point-on-curve">http://stackoverflow.com/questions/2018178/trade-off-point-on-curve</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other find_elbow_point –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">curve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tradeoff_idx</span> <span class="o">=</span> <span class="n">find_elbow_point</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;tradeoff_idx = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">tradeoff_idx</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">tradeoff_idx</span> <span class="o">==</span> <span class="mi">76</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">tradeoff_idx</span><span class="p">,</span> <span class="n">curve</span><span class="p">[</span><span class="n">tradeoff_idx</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">curve</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">curve</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_point</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">closest_point_on_line_segment</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dist_point</span><span class="p">,</span> <span class="n">point</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">curve</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;curve&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;tradeoff point&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dist_line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;-xb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">segment</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">segment</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;-xb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.find_first_true_indices">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">find_first_true_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_first_true_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.find_first_true_indices" title="Permalink to this definition"></a></dt>
<dd><p>TODO: move to vtool</p>
<p>returns a list of indexes where the index is the first True position
in the corresponding sublist or None if it does not exist</p>
<p>in other words: for each row finds the smallest True column number or None</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>flags_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of lists of booleans</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m utool.util_list –test-find_first_true_indices</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags_list</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">find_first_true_indices</span><span class="p">(</span><span class="n">flags_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">index_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[0, None, 1, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.find_k_true_indicies">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">find_k_true_indicies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_k_true_indicies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.find_k_true_indicies" title="Permalink to this definition"></a></dt>
<dd><p>Uses output of either this function or find_first_true_indices
to find the next index of true flags</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>flags_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of lists of booleans</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m utool.util_list –test-find_next_true_indices</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags_list</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">find_k_true_indicies</span><span class="p">(</span><span class="n">flags_list</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[array([2]), None, array([1, 2]), array([0, 1])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.find_next_true_indices">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">find_next_true_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_next_true_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.find_next_true_indices" title="Permalink to this definition"></a></dt>
<dd><p>Uses output of either this function or find_first_true_indices
to find the next index of true flags</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>flags_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of lists of booleans</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m utool.util_list –test-find_next_true_indices</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags_list</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset_list</span> <span class="o">=</span> <span class="n">find_first_true_indices</span><span class="p">(</span><span class="n">flags_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">find_next_true_indices</span><span class="p">(</span><span class="n">flags_list</span><span class="p">,</span> <span class="n">offset_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">index_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[2, None, 2, None]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.flag_intersection">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">flag_intersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#flag_intersection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.flag_intersection" title="Permalink to this definition"></a></dt>
<dd><p>Flags the rows in <cite>arr1</cite> that contain items in <cite>arr2</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>flags where len(flags) == len(arr1)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">flag_intersection</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;flags = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flags</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">structure_rows</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">flag_intersection</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;flags = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flags</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">flag_intersection</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">flag_intersection</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="sa">r</span><span class="s1">&#39;&#39;&#39;</span>
<span class="go">        import vtool as vt</span>
<span class="go">        import numpy as np</span>
<span class="go">        rng = np.random.RandomState(0)</span>
<span class="go">        arr1 = rng.randint(0, 100, 100000).reshape(-1, 2)</span>
<span class="go">        arr2 = rng.randint(0, 100, 1000).reshape(-1, 2)</span>
<span class="go">        arr1_, arr2_ = vt.structure_rows(arr1, arr2)</span>
<span class="go">        &#39;&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;&#39;&#39;</span>
<span class="go">        np.array([row in arr2_ for row in arr1_])</span>
<span class="go">        np.logical_or.reduce([arr1_ == row_ for row_ in arr2_]).ravel()</span>
<span class="go">        vt.iter_reduce_ufunc(np.logical_or, (arr1_ == row_ for row_ in arr2_)).ravel()</span>
<span class="go">        &#39;&#39;&#39;).split(&#39;\n&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="o">=</span><span class="n">setup</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.fromiter_nd">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">fromiter_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iter_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#fromiter_nd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.fromiter_nd" title="Permalink to this definition"></a></dt>
<dd><p>Like np.fromiter but handles iterators that generated
n-dimensional arrays. Slightly faster than np.array.</p>
<p>maybe commit to numpy?</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iter</strong> (<em>iter</em>) – an iterable that generates homogenous ndarrays</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – the expected output shape</p></li>
<li><p><strong>dtype</strong> (<em>dtype</em>) – the numpy datatype of the generated ndarrays</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The iterable must yeild a numpy array. It cannot yeild a Python list.</p>
</div>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other fromiter_nd –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total</span> <span class="o">=</span> <span class="mi">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">fromiter_nd</span><span class="p">(</span><span class="n">iter_</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">shape</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dfxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">qfxs</span><span class="p">,</span> <span class="n">dfxs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qfxs</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">fromiter_nd</span><span class="p">(</span><span class="n">iter_</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">shape</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.get_covered_mask">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">get_covered_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covered_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covering_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_covered_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.get_covered_mask" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.get_crop_slices">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">get_crop_slices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isfill</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_crop_slices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.get_crop_slices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.get_uncovered_mask">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">get_uncovered_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covered_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covering_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_uncovered_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.get_uncovered_mask" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>covered_array</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>covering_array</strong> (<em>ndarray</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>flags</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-get_uncovered_mask</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covering_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">get_uncovered_mask</span><span class="p">(</span><span class="n">covered_array</span><span class="p">,</span> <span class="n">covering_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ True False  True False False]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covering_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">get_uncovered_mask</span><span class="p">(</span><span class="n">covered_array</span><span class="p">,</span> <span class="n">covering_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ True  True  True  True  True]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
<span class="gp">... </span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covering_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">get_uncovered_mask</span><span class="p">(</span><span class="n">covered_array</span><span class="p">,</span> <span class="n">covering_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flags</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[ True, False,  True],</span>
<span class="go">          [False, False,  True],</span>
<span class="go">          [ True,  True,  True]], dtype=np.bool)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Ignore:</dt><dd><p>covering_array = [1, 2, 3, 4, 5, 6, 7]
%timeit get_uncovered_mask(covered_array, covering_array)
100000 loops, best of 3: 18.6 µs per loop
%timeit get_uncovered_mask2(covered_array, covering_array)
100000 loops, best of 3: 16.9 µs per loop</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.get_undirected_edge_ids">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">get_undirected_edge_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directed_edges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_undirected_edge_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.get_undirected_edge_ids" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>directed_edges</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>edgeid_list</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –exec-get_undirected_edge_ids</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">directed_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edgeid_list</span> <span class="o">=</span> <span class="n">get_undirected_edge_ids</span><span class="p">(</span><span class="n">directed_edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;edgeid_list = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">edgeid_list</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">edgeid_list = [0 0 1 2 3 1 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.grab_webcam_image">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">grab_webcam_image</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#grab_webcam_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.grab_webcam_image" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_gui/py_video_display/py_video_display.html">http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_gui/py_video_display/py_video_display.html</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-grab_webcam_image –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">grab_webcam_image</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s1">&#39;webcap.jpg&#39;</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.greedy_setcover">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">greedy_setcover</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">universe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#greedy_setcover"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.greedy_setcover" title="Permalink to this definition"></a></dt>
<dd><p>Copied implmentation of greedy set cover from stack overflow. Needs work.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/7942312/of-greedy-set-cover-faster">http://stackoverflow.com/questions/7942312/of-greedy-set-cover-faster</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">universe</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subsets</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="nb">set</span><span class="p">([</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chosen</span><span class="p">,</span> <span class="n">costs</span> <span class="o">=</span> <span class="n">greedy_setcover</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">subsets</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cover: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">chosen</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total Cost: </span><span class="si">%r</span><span class="s1">=sum(</span><span class="si">%r</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">costs</span><span class="p">),</span> <span class="n">costs</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.inbounds">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">inbounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#inbounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.inbounds" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num</strong> (<em>scalar</em><em> or </em><em>ndarray</em>) – </p></li>
<li><p><strong>low</strong> (<em>scalar</em><em> or </em><em>ndarray</em>) – </p></li>
<li><p><strong>high</strong> (<em>scalar</em><em> or </em><em>ndarray</em>) – </p></li>
<li><p><strong>eq</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>is_inbounds</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>scalar or ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/other.py inbounds</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>   <span class="p">,</span>  <span class="mf">0.431</span><span class="p">,</span>  <span class="mf">0.279</span><span class="p">],</span>
<span class="gp">... </span>                <span class="p">[</span> <span class="mf">0.204</span><span class="p">,</span>  <span class="mf">0.352</span><span class="p">,</span>  <span class="mf">0.08</span> <span class="p">],</span>
<span class="gp">... </span>                <span class="p">[</span> <span class="mf">0.107</span><span class="p">,</span>  <span class="mf">0.325</span><span class="p">,</span>  <span class="mf">0.179</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">low</span>  <span class="o">=</span> <span class="mf">.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">high</span> <span class="o">=</span> <span class="mf">.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_inbounds</span> <span class="o">=</span> <span class="n">inbounds</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">eq</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">is_inbounds</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.index_partition">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">index_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part1_items</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#index_partition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.index_partition" title="Permalink to this definition"></a></dt>
<dd><p>returns two lists. The first are the indecies of items in item_list that
are in part1_items. the second is the indices in item_list that are not
in part1_items. items in part1_items that are not in item_list are
ignored</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dist&#39;</span><span class="p">,</span> <span class="s1">&#39;fg&#39;</span><span class="p">,</span> <span class="s1">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fg&#39;</span><span class="p">,</span> <span class="s1">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_indexes</span><span class="p">,</span> <span class="n">part2_indexes</span> <span class="o">=</span> <span class="n">index_partition</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part1_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">part1_indexes</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">part2_indexes</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.intersect1d_reduce">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">intersect1d_reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_unique</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect1d_reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.intersect1d_reduce" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.intersect2d_flags">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">intersect2d_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.intersect2d_flags" title="Permalink to this definition"></a></dt>
<dd><p>Checks intersection of rows of A against rows of B</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </p></li>
<li><p><strong>B</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(flag_list1, flag_list2)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-intersect2d_flags</p>
</dd>
<dt>SeeAlso:</dt><dd><p>np.in1d - the one dimensional version</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">609</span><span class="p">,</span> <span class="mi">307</span><span class="p">],</span> <span class="p">[</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">344</span><span class="p">],</span> <span class="p">[</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">690</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">422</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">422</span><span class="p">,</span>  <span class="mi">968</span><span class="p">],</span> <span class="p">[</span> <span class="mi">481</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">1132</span><span class="p">],</span> <span class="p">[</span> <span class="mi">759</span><span class="p">,</span>  <span class="mi">159</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">flag_list1</span><span class="p">,</span> <span class="n">flag_list2</span><span class="p">)</span> <span class="o">=</span> <span class="n">intersect2d_flags</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">flag_list1</span><span class="p">,</span> <span class="n">flag_list2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.intersect2d_indices">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">intersect2d_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.intersect2d_indices" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </p></li>
<li><p><strong>B</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(ax_list, bx_list)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-intersect2d_indices</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">158</span><span class="p">,</span>  <span class="mi">171</span><span class="p">],</span> <span class="p">[</span> <span class="mi">542</span><span class="p">,</span>  <span class="mi">297</span><span class="p">],</span> <span class="p">[</span> <span class="mi">955</span><span class="p">,</span> <span class="mi">1113</span><span class="p">],</span> <span class="p">[</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1254</span><span class="p">],</span> <span class="p">[</span> <span class="mi">976</span><span class="p">,</span> <span class="mi">1255</span><span class="p">],</span> <span class="p">[</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">1265</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">117</span><span class="p">,</span>  <span class="mi">211</span><span class="p">],</span> <span class="p">[</span> <span class="mi">158</span><span class="p">,</span>  <span class="mi">171</span><span class="p">],</span> <span class="p">[</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1254</span><span class="p">],</span> <span class="p">[</span> <span class="mi">309</span><span class="p">,</span>  <span class="mi">328</span><span class="p">],</span> <span class="p">[</span> <span class="mi">447</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">750</span><span class="p">,</span>  <span class="mi">357</span><span class="p">],</span> <span class="p">[</span> <span class="mi">976</span><span class="p">,</span> <span class="mi">1255</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">ax_list</span><span class="p">,</span> <span class="n">bx_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">intersect2d_indices</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">ax_list</span><span class="p">,</span> <span class="n">bx_list</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.intersect2d_numpy">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">intersect2d_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_unique</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.intersect2d_numpy" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays/8317155#8317155">http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays/8317155#8317155</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </p></li>
<li><p><strong>B</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </p></li>
<li><p><strong>assume_unique</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>C</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[ndims=2]</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-intersect2d_numpy</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">78</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span> <span class="mi">283</span><span class="p">,</span> <span class="mi">396</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">403</span><span class="p">,</span> <span class="mi">412</span><span class="p">,</span> <span class="mi">535</span><span class="p">,</span> <span class="mi">552</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">152</span><span class="p">,</span>  <span class="mi">98</span><span class="p">,</span>  <span class="mi">32</span><span class="p">,</span> <span class="mi">260</span><span class="p">,</span> <span class="mi">387</span><span class="p">,</span> <span class="mi">285</span><span class="p">,</span>  <span class="mi">22</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span>  <span class="mi">55</span><span class="p">,</span> <span class="mi">261</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">403</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span> <span class="mi">412</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span> <span class="mi">815</span><span class="p">,</span> <span class="mi">463</span><span class="p">,</span> <span class="mi">613</span><span class="p">,</span> <span class="mi">552</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span> <span class="mi">22</span><span class="p">,</span>  <span class="mi">32</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">199</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">254</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assume_unique</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span> <span class="o">=</span> <span class="n">intersect2d_numpy</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">C</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([[ 85, 403, 412],</span>
<span class="go">       [ 32,  22, 103]]), array([2, 6, 7]), array([0, 1, 2]))</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span> <span class="o">=</span> <span class="n">intersect2d_numpy</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">C</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([[1, 2, 3]]), array([0]), array([0]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.intersect2d_structured_numpy">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">intersect2d_structured_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_unique</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_structured_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.intersect2d_structured_numpy" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr1</strong> – unstructured 2d array</p></li>
<li><p><strong>arr2</strong> – unstructured 2d array</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A_, B_, C_ - structured versions of arr1, and arr2, and their structured intersection</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array">http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array</a>
<a class="reference external" href="http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays">http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.iter_reduce_ufunc">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">iter_reduce_ufunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ufunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#iter_reduce_ufunc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.iter_reduce_ufunc" title="Permalink to this definition"></a></dt>
<dd><p>constant memory iteration and reduction</p>
<p>applys ufunc from left to right over the input arrays</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">memory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen_memory</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">arr_gen</span><span class="p">(</span><span class="n">arr_list</span><span class="p">,</span> <span class="n">gen_memory</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arr_list</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">gen_memory</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">arr</span>
<span class="gp">... </span>        <span class="k">yield</span> <span class="n">gen_memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gen_memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gen_memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ufunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res1</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">arr_list</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res2</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">arr_list</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res3</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">arr_gen</span><span class="p">(</span><span class="n">arr_list</span><span class="p">,</span> <span class="n">gen_memory</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res1       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res1</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res2       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res2</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res3       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;memory     = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gen_memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gen_memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">res1</span> <span class="o">==</span> <span class="n">res2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">res2</span> <span class="o">==</span> <span class="n">res3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.list_compress_">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">list_compress_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#list_compress_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.list_compress_" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.list_take_">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">list_take_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#list_take_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.list_take_" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.make_video">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">make_video</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outvid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'XVID'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#make_video"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.make_video" title="Permalink to this definition"></a></dt>
<dd><p>Create a video from a list of images.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://www.xavierdupre.fr/blog/2016-03-30_nojs.html">http://www.xavierdupre.fr/blog/2016-03-30_nojs.html</a>
<a class="reference external" href="http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_gui/py_video_display/py_video_display.html">http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_gui/py_video_display/py_video_display.html</a></p>
<p>&#64;param      outvid      output video
&#64;param      images      list of images to use in the video
&#64;param      fps         frame per second
&#64;param      size        size of each frame
&#64;param      is_color    color
&#64;param      format      see <a class="reference external" href="http://www.fourcc.org/codecs.php">http://www.fourcc.org/codecs.php</a></p>
<p>The function relies on <a class="reference external" href="http://opencv-python-tutroals.readthedocs.org/en/latest/">http://opencv-python-tutroals.readthedocs.org/en/latest/</a>.
By default, the video will have the size of the first image.
It will resize every image to this size before adding them to the video.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.make_video2">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">make_video2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#make_video2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.make_video2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.median_abs_dev">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">median_abs_dev</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_list</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#median_abs_dev"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.median_abs_dev" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Median_absolute_deviation">https://en.wikipedia.org/wiki/Median_absolute_deviation</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.mult_lists">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">mult_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#mult_lists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.mult_lists" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.multigroup_lookup">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">multigroup_lookup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lazydict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subkeys_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#multigroup_lookup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.multigroup_lookup" title="Permalink to this definition"></a></dt>
<dd><p>Efficiently calls custom_func for each item in zip(keys_list, subkeys_list)
by grouping subkeys to minimize the number of calls to custom_func.</p>
<p>We are given multiple lists of keys, and subvals.
The goal is to group the subvals by keys and apply the subval lookups
(a call to a function) to the key only once and at the same time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lazydict</strong> (<em>dict of utool.LazyDict</em>) – </p></li>
<li><p><strong>keys_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>subkeys_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>custom_func</strong> (<em>func</em>) – must have signature custom_func(lazydict, key, subkeys)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>vt.multigroup_lookup_naive - unoptomized version, but simple to read</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpath_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">util_grabdata</span><span class="o">.</span><span class="n">get_valid_test_imgkeys</span><span class="p">()]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lazydict</span> <span class="o">=</span> <span class="p">{</span><span class="n">count</span><span class="p">:</span> <span class="n">vt</span><span class="o">.</span><span class="n">testdata_annot_metadata</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span> <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">fpath</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fpath_list</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aids_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fms</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">keys_list</span> <span class="o">=</span> <span class="n">aids_list</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subkeys_list</span> <span class="o">=</span> <span class="n">fms</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">custom_func</span><span class="p">(</span><span class="n">lazydict</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">subkeys</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">annot</span> <span class="o">=</span> <span class="n">lazydict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">kpts</span> <span class="o">=</span> <span class="n">annot</span><span class="p">[</span><span class="s1">&#39;kpts&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">rchip</span> <span class="o">=</span> <span class="n">annot</span><span class="p">[</span><span class="s1">&#39;rchip&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">kpts_m</span> <span class="o">=</span> <span class="n">kpts</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">subkeys</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">warped_patches</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_warped_patches</span><span class="p">(</span><span class="n">rchip</span><span class="p">,</span> <span class="n">kpts_m</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">warped_patches</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_lists1</span> <span class="o">=</span> <span class="n">multigroup_lookup</span><span class="p">(</span><span class="n">lazydict</span><span class="p">,</span> <span class="n">keys_list</span><span class="p">,</span> <span class="n">subkeys_list</span><span class="p">,</span> <span class="n">custom_func</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_lists2</span> <span class="o">=</span> <span class="n">multigroup_lookup_naive</span><span class="p">(</span><span class="n">lazydict</span><span class="p">,</span> <span class="n">keys_list</span><span class="p">,</span> <span class="n">subkeys_list</span><span class="p">,</span> <span class="n">custom_func</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">sver_c_wrapper</span><span class="o">.</span><span class="n">asserteq</span><span class="p">(</span><span class="n">data_lists1</span><span class="p">,</span> <span class="n">data_lists2</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">keys_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subkeys_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.multigroup_lookup_naive">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">multigroup_lookup_naive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lazydict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subkeys_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#multigroup_lookup_naive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.multigroup_lookup_naive" title="Permalink to this definition"></a></dt>
<dd><p>Slow version of multigroup_lookup. Makes a call to custom_func for each
item in zip(keys_list, subkeys_list).</p>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>vt.multigroup_lookup</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.nearest_point">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">nearest_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#nearest_point"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.nearest_point" title="Permalink to this definition"></a></dt>
<dd><p>finds the nearest point(s) in pts to (x, y)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.nonunique_row_flags">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">nonunique_row_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#nonunique_row_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.nonunique_row_flags" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.nonunique_row_indexes">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">nonunique_row_indexes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#nonunique_row_indexes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.nonunique_row_indexes" title="Permalink to this definition"></a></dt>
<dd><p>rows that are not unique (does not include the first instance of each pattern)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>ndarray</em>) – 2d array</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>nonunique_rowx</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>unique_row_indexes
nonunique_row_flags</p>
</dd>
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-unique_row_indexes</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">.534</span><span class="p">,</span> <span class="mf">.432</span><span class="p">],</span> <span class="p">[</span><span class="mf">.534</span><span class="p">,</span> <span class="mf">.432</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nonunique_rowx</span> <span class="o">=</span> <span class="n">unique_row_indexes</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;nonunique_rowx = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">nonunique_rowx</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">nonunique_rowx = np.array([4, 6, 7, 8], dtype=np.int64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.norm01">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">norm01</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#norm01"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.norm01" title="Permalink to this definition"></a></dt>
<dd><p>normalizes a numpy array from 0 to 1 based in its extent</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dim</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_norm</span> <span class="o">=</span> <span class="n">norm01</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">array_norm</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.or_lists">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">or_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#or_lists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.or_lists" title="Permalink to this definition"></a></dt>
<dd><p>Like np.logical_and, but can take more than 2 arguments</p>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>and_lists</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.pad_vstack">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">pad_vstack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#pad_vstack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.pad_vstack" title="Permalink to this definition"></a></dt>
<dd><p>Stacks values and pads arrays with different lengths with zeros</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.rebuild_partition">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">rebuild_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">part1_vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part2_vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part1_indexes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part2_indexes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#rebuild_partition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.rebuild_partition" title="Permalink to this definition"></a></dt>
<dd><p>Inverts work done by index_partition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>part1_vals</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>part2_vals</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>part1_indexes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – </p></li>
<li><p><strong>part2_indexes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-rebuild_partition</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dist&#39;</span><span class="p">,</span> <span class="s1">&#39;fg&#39;</span><span class="p">,</span> <span class="s1">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fg&#39;</span><span class="p">,</span> <span class="s1">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_indexes</span><span class="p">,</span> <span class="n">part2_indexes</span> <span class="o">=</span> <span class="n">index_partition</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part1_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_vals</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part1_indexes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part2_vals</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part2_indexes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val_list</span> <span class="o">=</span> <span class="n">rebuild_partition</span><span class="p">(</span><span class="n">part1_vals</span><span class="p">,</span> <span class="n">part2_vals</span><span class="p">,</span> <span class="n">part1_indexes</span><span class="p">,</span> <span class="n">part2_indexes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">val_list</span> <span class="o">==</span> <span class="n">item_list</span><span class="p">,</span> <span class="s1">&#39;incorrect inversin&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">val_list</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.rowwise_operation">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">rowwise_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#rowwise_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.rowwise_operation" title="Permalink to this definition"></a></dt>
<dd><p>DEPRICATE THIS IS POSSIBLE WITH STRICTLY BROADCASTING AND
USING np.newaxis</p>
<p>DEPRICATE, numpy has better ways of doing this.
Is the rowwise name correct? Should it be colwise?</p>
<p>performs an operation between an
(N x A x B … x Z) array with an
(N x 1) array</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.safe_argmax">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">safe_argmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_argmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.safe_argmax" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>Doctest:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">safe_argmax</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">safe_argmax</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">safe_argmax</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">safe_argmax</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">safe_argmax</span><span class="p">([]))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.safe_cat">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">safe_cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_shape=(0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_cat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.safe_cat" title="Permalink to this definition"></a></dt>
<dd><p>stacks a tuple even if it is empty
Also deals with numpy bug where cat fails if an element in sequence is empty</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">safe_cat</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">safe_cat</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;s = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="p">)]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">safe_cat</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;s = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="p">)]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">safe_cat</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;s = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="p">)]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.safe_div">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">safe_div</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_div"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.safe_div" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.safe_extreme">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">safe_extreme</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_extreme"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.safe_extreme" title="Permalink to this definition"></a></dt>
<dd><p>Applies an exterme operation to an 1d array (typically max/min) but ensures
a value is always returned even in operations without identities. The
default identity must be specified using the <cite>fill</cite> argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>ndarray</em>) – 1d array to take extreme of</p></li>
<li><p><strong>op</strong> (<em>func</em>) – vectorized operation like np.max to apply to array</p></li>
<li><p><strong>fill</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – return type if arr has no elements (default = nan)</p></li>
<li><p><strong>finite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if True ignores non-finite values (default = False)</p></li>
<li><p><strong>nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if False ignores nans (default = True)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.safe_max">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">safe_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.safe_max" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>ndarray</em>) – 1d array to take max of</p></li>
<li><p><strong>fill</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – return type if arr has no elements (default = nan)</p></li>
<li><p><strong>finite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if True ignores non-finite values (default = False)</p></li>
<li><p><strong>nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if False ignores nans (default = True)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other safe_max –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results1</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_max</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results2</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_max</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results3</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_max</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results4</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_max</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">results1</span><span class="p">,</span> <span class="n">results2</span><span class="p">,</span> <span class="n">results3</span><span class="p">,</span> <span class="n">results4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;results = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">results = [</span>
<span class="go">    [float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;inf&#39;), float(&#39;inf&#39;), 1],</span>
<span class="go">    [float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), 1.0, 1],</span>
<span class="go">    [float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), 1.0, 1],</span>
<span class="go">    [float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;inf&#39;), float(&#39;inf&#39;), float(&#39;inf&#39;), 1],</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.safe_min">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">safe_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.safe_min" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results1</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_min</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results2</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_min</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results3</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_min</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results4</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_min</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">results1</span><span class="p">,</span> <span class="n">results2</span><span class="p">,</span> <span class="n">results3</span><span class="p">,</span> <span class="n">results4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;results = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">results = [</span>
<span class="go">    [float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;inf&#39;), 1.0, 0],</span>
<span class="go">    [float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), 1.0, 0],</span>
<span class="go">    [float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), 1.0, 0],</span>
<span class="go">    [float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;-inf&#39;), float(&#39;inf&#39;), 1.0, 0],</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.safe_vstack">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">safe_vstack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_shape=(0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_vstack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.safe_vstack" title="Permalink to this definition"></a></dt>
<dd><p>stacks a tuple even if it is empty</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.significant_shape">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">significant_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#significant_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.significant_shape" title="Permalink to this definition"></a></dt>
<dd><p>find the shape without trailing 1’s</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.structure_rows">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">structure_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arrs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#structure_rows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.structure_rows" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other structure_rows</p>
</dd>
<dt>SeeAlso:</dt><dd><p>unstructure_rows</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">609</span><span class="p">,</span> <span class="mi">307</span><span class="p">],</span> <span class="p">[</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">344</span><span class="p">],</span> <span class="p">[</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">690</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">422</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">422</span><span class="p">,</span>  <span class="mi">968</span><span class="p">],</span> <span class="p">[</span> <span class="mi">481</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">1132</span><span class="p">],</span> <span class="p">[</span> <span class="mi">759</span><span class="p">,</span>  <span class="mi">159</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structured_arrs</span> <span class="o">=</span> <span class="n">structure_rows</span><span class="p">(</span><span class="o">*</span><span class="n">arrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unstructured_arrs</span> <span class="o">=</span> <span class="n">unstructure_rows</span><span class="p">(</span><span class="o">*</span><span class="n">structured_arrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">unstructured_arrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">arrs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">unstructured_arrs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">arrs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">union_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">union1d</span><span class="p">(</span><span class="o">*</span><span class="n">structured_arrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">union</span><span class="p">,</span> <span class="o">=</span> <span class="n">unstructure_rows</span><span class="p">(</span><span class="n">union_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">union</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.take2">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">take2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#take2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.take2" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper around numpy compress that makes the signature more similar to take</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.take_col_per_row">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">take_col_per_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colx_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#take_col_per_row"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.take_col_per_row" title="Permalink to this definition"></a></dt>
<dd><p>takes a column from each row</p>
<dl>
<dt>Ignore:</dt><dd><p>num_rows = 1000
num_cols = 4</p>
<p>arr = np.arange(10 * 4).reshape(10, 4)
colx_list = (np.random.rand(10) * 4).astype(np.int)</p>
<p>%timeit np.array([row[cx] for (row, cx) in zip(arr, colx_list)])
%timeit arr.ravel().take(np.ravel_multi_index((np.arange(len(colx_list)), colx_list), arr.shape))
%timeit arr.ravel().take(colx_list + np.arange(arr.shape[0]) * arr.shape[1])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.to_undirected_edges">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">to_undirected_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directed_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#to_undirected_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.to_undirected_edges" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.trytake">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">trytake</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#trytake"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.trytake" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.unique_rows">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">unique_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#unique_rows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.unique_rows" title="Permalink to this definition"></a></dt>
<dd><p>Order or columns does not matter if directed = False</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.unstructure_rows">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">unstructure_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">structured_arrs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#unstructure_rows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.unstructure_rows" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>SeeAlso:</dt><dd><p>structure_rows</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.weighted_average_scoring">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">weighted_average_scoring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fsv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_filtxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonweight_filtxs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#weighted_average_scoring"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.weighted_average_scoring" title="Permalink to this definition"></a></dt>
<dd><p>does frac{sum_i w^f_i * w^d_i * r_i}{sum_i w^f_i, w^d_i}
to get a weighed average of ratio scores</p>
<p>If we normalize the weight part to add to 1 then we can get per-feature
scores.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Weighted_arithmetic_mean">http://en.wikipedia.org/wiki/Weighted_arithmetic_mean</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.82992172</span><span class="p">,</span>  <span class="mf">1.56136119</span><span class="p">,</span>  <span class="mf">0.66465378</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.8000412</span> <span class="p">,</span>  <span class="mf">2.14719748</span><span class="p">,</span>  <span class="mf">1.</span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.80848503</span><span class="p">,</span>  <span class="mf">2.6816361</span> <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.86761665</span><span class="p">,</span>  <span class="mf">2.70189977</span><span class="p">,</span>  <span class="mf">1.</span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.8004055</span> <span class="p">,</span>  <span class="mf">1.58753884</span><span class="p">,</span>  <span class="mf">0.92178345</span><span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weight_filtxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nonweight_filtxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_fs</span> <span class="o">=</span> <span class="n">weighted_average_scoring</span><span class="p">(</span><span class="n">fsv</span><span class="p">,</span> <span class="n">weight_filtxs</span><span class="p">,</span> <span class="n">nonweight_filtxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">new_fs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.weighted_geometic_mean">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">weighted_geometic_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#weighted_geometic_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.weighted_geometic_mean" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>list of ndarrays</em>) – </p></li>
<li><p><strong>weights</strong> (<em>ndarray</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-weighted_geometic_mean</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Weighted_geometric_mean">https://en.wikipedia.org/wiki/Weighted_geometric_mean</a></p>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>scipy.stats.mstats.gmean</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mf">.9</span><span class="p">,</span> <span class="mf">.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gmean_</span> <span class="o">=</span> <span class="n">weighted_geometic_mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;gmean_ = </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gmean_</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">gmean_ = 0.740</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gmean_</span> <span class="o">=</span> <span class="n">weighted_geometic_mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;gmean_ = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">gmean_</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Ignore:</dt><dd><p>res1 = ((img1 ** .5 * img2 ** .5)) ** 1
res2 = np.sqrt(img1 * img2)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.weighted_geometic_mean_unnormalized">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">weighted_geometic_mean_unnormalized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#weighted_geometic_mean_unnormalized"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.weighted_geometic_mean_unnormalized" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.zipcat">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">zipcat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#zipcat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.zipcat" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr1_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>arr2_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –exec-zipcat –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_list</span> <span class="o">=</span> <span class="n">zipcat</span><span class="p">(</span><span class="n">arr1_list</span><span class="p">,</span> <span class="n">arr2_list</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_list0</span> <span class="o">=</span> <span class="n">zipcat</span><span class="p">(</span><span class="n">arr1_list</span><span class="p">,</span> <span class="n">arr2_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_list1</span> <span class="o">=</span> <span class="n">zipcat</span><span class="p">(</span><span class="n">arr1_list</span><span class="p">,</span> <span class="n">arr2_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_list2</span> <span class="o">=</span> <span class="n">zipcat</span><span class="p">(</span><span class="n">arr1_list</span><span class="p">,</span> <span class="n">arr2_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr3_list = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">(</span><span class="n">arr3_list</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr3_list0 = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">(</span><span class="n">arr3_list0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr3_list2 = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">(</span><span class="n">arr3_list2</span><span class="p">),))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.zipcompress">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">zipcompress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#zipcompress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.zipcompress" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.zipcompress_safe">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">zipcompress_safe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#zipcompress_safe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.zipcompress_safe" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.ziptake">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">ziptake</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#ziptake"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.ziptake" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.other.zstar_value">
<span class="sig-prename descclassname"><span class="pre">vtool.other.</span></span><span class="sig-name descname"><span class="pre">zstar_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#zstar_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.other.zstar_value" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/28242593/correct-way-to-obtain-confidence-interval-with-scipy">http://stackoverflow.com/questions/28242593/correct-way-to-obtain-confidence-interval-with-scipy</a></p>
</dd></dl>

</section>
<section id="module-vtool.patch">
<span id="vtool-patch-module"></span><h2>vtool.patch module<a class="headerlink" href="#module-vtool.patch" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.GaussianBlurInplace">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">GaussianBlurInplace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#GaussianBlurInplace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.GaussianBlurInplace" title="Permalink to this definition"></a></dt>
<dd><p>simulates code from helpers.cpp in hesaff</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>sigma</strong> (<em>flaot</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-GaussianBlurInplace:0 –show
python -m vtool.patch –test-GaussianBlurInplace:1 –show</p>
</dd>
<dt>References;</dt><dd><p><a class="reference external" href="http://www.cse.usf.edu/~r1k/MachineVisionBook/MachineVision.files/MachineVision_Chapter4.pdf">http://www.cse.usf.edu/~r1k/MachineVisionBook/MachineVision.files/MachineVision_Chapter4.pdf</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Scale_space_implementation">http://en.wikipedia.org/wiki/Scale_space_implementation</a>
<a class="reference external" href="http://www.cse.psu.edu/~rtc12/CSE486/lecture10_6pp.pdf">http://www.cse.psu.edu/~rtc12/CSE486/lecture10_6pp.pdf</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The product of the convolution of two Gaussian functions with spread
sigma is a Gaussian function with spread sqrt(2)*sigma scaled by the
area of the Gaussian filter</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">get_test_patch</span><span class="p">(</span><span class="s1">&#39;star2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_orig</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="mf">2.0</span> <span class="o">*</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="ow">not</span> <span class="n">size</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># check if even</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">size</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ksize</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_orig</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># demonstrate cascading smoothing property</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># THIS ISNT WORKING WHY???</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">get_test_patch</span><span class="p">(</span><span class="s1">&#39;star2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img3</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img4</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_orig</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma1</span> <span class="o">=</span> <span class="mf">.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma2</span> <span class="o">=</span> <span class="mf">.9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma3</span> <span class="o">=</span> <span class="n">sigma1</span> <span class="o">+</span> <span class="n">sigma2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># components</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img2</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># all in one shot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img3</span><span class="p">,</span> <span class="n">sigma3</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># addative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img4</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img4</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">img4</span> <span class="o">-</span> <span class="n">img3</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ksize</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#fig.add_subplot(1, 3, 1, projection=&#39;3d&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma3</span><span class="p">,</span> <span class="n">sigma3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_orig</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img1</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img2</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img4</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1"> + </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma1</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.draw_kp_ori_steps">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">draw_kp_ori_steps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#draw_kp_ori_steps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.draw_kp_ori_steps" title="Permalink to this definition"></a></dt>
<dd><p>Shows steps in orientation estimation</p>
<dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-draw_kp_ori_steps –show –fname=zebra.png –fx=121
python -m vtool.patch –test-draw_kp_ori_steps –show –interact
python -m vtool.patch –test-draw_kp_ori_steps –save ~/latex/crall-candidacy-2015/figures/test_fint_kp_direction.jpg –dpath figures ‘–caption=visualization of the steps in the computation of the dominant gradient orientations.’ –figsize=14,9 –dpi=160 –height=2.65  –left=.04 –right=.96 –top=.95 –bottom=.05 –wspace=.1 –hspace=.1</p>
<p>python -m vtool.patch –test-draw_kp_ori_steps –dpath ~/latex/crall-candidacy-2015/ –save figures/draw_kp_ori_steps.jpg  –figsize=14,9 –dpi=180 –height=2.65 –left=.04 –right=.96 –top=.95 –bottom=.05 –wspace=.1 –hspace=.1 –diskshow</p>
<p>python -m vtool.patch –test-draw_kp_ori_steps –dpath ~/latex/crall-candidacy-2015/ –save figures/draw_kp_ori_steps.jpg  –figsize=14,9 –dpi=180  –djust=.04,.05,.1 –diskshow –fname=zebra.png –fx=121</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_kp_ori_steps</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.find_dominant_kp_orientations">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">find_dominant_kp_orientations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">36</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxima_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DEBUG_ROTINVAR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#find_dominant_kp_orientations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.find_dominant_kp_orientations" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf">http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf</a>
page 219</p>
<p><a class="reference external" href="http://www.cs.berkeley.edu/~malik/cs294/lowe-ijcv04.pdf">http://www.cs.berkeley.edu/~malik/cs294/lowe-ijcv04.pdf</a>
page 13.</p>
<p>Lowe uses a 36-bin histogram of edge orientations weigted by a gaussian
distance to the center and gradient magintude. He finds all peaks within
80% of the global maximum. Then he fine tunes the orientation using a
3-binned parabolic fit. Multiple orientations (and hence multiple
keypoints) can be returned, but empirically only about 15% will have
these and they do tend to be important.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>ori_offset - offset of current orientation to dominant orientation</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-find_dominant_kp_orientations</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#imgBGR = get_test_patch(&#39;cross&#39;, jitter=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;star.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kp</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;kp = </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">kp_cpp_infostr</span><span class="p">(</span><span class="n">kp</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_oris</span> <span class="o">=</span> <span class="n">find_dominant_kp_orientations</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">kp</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                         <span class="n">maxima_thresh</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                         <span class="n">DEBUG_ROTINVAR</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;new_oris = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">new_oris</span><span class="p">,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.find_kpts_direction">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">find_kpts_direction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DEBUG_ROTINVAR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#find_kpts_direction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.find_kpts_direction" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imgBGR</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data in opencv format (blue, green, red)</p></li>
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>kpts -  keypoints</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float32_t, ndim=2]</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-find_kpts_direction</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.find_patch_dominant_orientations">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">find_patch_dominant_orientations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">36</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxima_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DEBUG_ROTINVAR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#find_patch_dominant_orientations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.find_patch_dominant_orientations" title="Permalink to this definition"></a></dt>
<dd><p>helper</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.gaussian_average_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">gaussian_average_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gaussian_average_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.gaussian_average_patch" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patch</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-gaussian_average_patch</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel">http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">get_star_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#sigma = 1.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">gaussian_average_patch</span><span class="p">(</span><span class="n">patch</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">0.414210641527</span>
</pre></div>
</div>
<dl class="simple">
<dt>Ignore:</dt><dd><p>import utool as ut
import wbia.plottool as pt
import vtool as vt
import cv2
gauss_kernel_d0 = (cv2.getGaussianKernel(patch.shape[0], sigma))
gauss_kernel_d1 = (cv2.getGaussianKernel(patch.shape[1], sigma))
weighted_patch = patch.copy()
weighted_patch = np.multiply(weighted_patch,   gauss_kernel_d0)
weighted_patch = np.multiply(weighted_patch.T, gauss_kernel_d1).T
gaussian_kern2 = gauss_kernel_d0.dot(gauss_kernel_d1.T)
fig = pt.figure(fnum=1, pnum=(1, 3, 1), doclf=True, docla=True)
pt.imshow(patch * 255)
fig = pt.figure(fnum=1, pnum=(1, 3, 2))
pt.imshow(ut.norm_zero_one(gaussian_kern2) * 255.0)
fig = pt.figure(fnum=1, pnum=(1, 3, 3))
pt.imshow(ut.norm_zero_one(weighted_patch) * 255.0)
pt.update()</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.gaussian_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">gaussian_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">7)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gaussian_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.gaussian_patch" title="Permalink to this definition"></a></dt>
<dd><p>another version of the guassian_patch function. hopefully better</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel">http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – array dimensions</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-gaussian_patch –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#shape = (7, 7)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># 1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gausspatch</span> <span class="o">=</span> <span class="n">gaussian_patch</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sum_</span> <span class="o">=</span> <span class="n">gausspatch</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_almost_eq</span><span class="p">(</span><span class="n">sum_</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">norm01</span><span class="p">(</span><span class="n">gausspatch</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.gaussian_weight_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">gaussian_weight_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gaussian_weight_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.gaussian_weight_patch" title="Permalink to this definition"></a></dt>
<dd><p>Applies two one dimensional gaussian operations to a patch which
effectively weights it by a 2-dimensional gaussian. This is efficient
because the actually 2-d gaussian never needs to be allocated.</p>
<p>test_show_gaussian_patches</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.generate_to_patch_transforms">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">generate_to_patch_transforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">41</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#generate_to_patch_transforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.generate_to_patch_transforms" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.get_cross_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">get_cross_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_cross_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.get_cross_patch" title="Permalink to this definition"></a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.get_no_symbol">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">get_no_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'symbol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(100,</span> <span class="pre">100)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_no_symbol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.get_no_symbol" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>errorimg</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-get_no_symbol –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">errorimg</span> <span class="o">=</span> <span class="n">get_no_symbol</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">errorimg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.get_orientation_histogram">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">get_orientation_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gori_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">36</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DEBUG_ROTINVAR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_orientation_histogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.get_orientation_histogram" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gori</strong> – </p></li>
<li><p><strong>gori_weights</strong> – </p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(hist, centers)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-get_orientation_histogram</p>
</dd>
<dt>Ignore:</dt><dd><p>print(vt.kpts_docrepr(gori, ‘gori = ‘))
print(vt.kpts_docrepr(gori_weights, ‘gori_weights = ‘))</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gori</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">4.71</span><span class="p">,</span>  <span class="mf">6.15</span><span class="p">,</span>  <span class="mf">3.13</span><span class="p">,</span>  <span class="mf">3.24</span><span class="p">,</span>  <span class="mf">4.71</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">4.71</span><span class="p">,</span>  <span class="mf">4.61</span><span class="p">,</span>  <span class="mf">0.5</span> <span class="p">,</span>  <span class="mf">4.85</span><span class="p">,</span>  <span class="mf">4.71</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">1.57</span><span class="p">,</span>  <span class="mf">6.28</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">1.57</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gori_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.19</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.21</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.16</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.11</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.17</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.19</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_orientation_histogram</span><span class="p">(</span><span class="n">gori</span><span class="p">,</span> <span class="n">gori_weights</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.get_star2_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">get_star2_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_star2_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.get_star2_patch" title="Permalink to this definition"></a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.get_star_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">get_star_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_star_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.get_star_patch" title="Permalink to this definition"></a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.get_stripe_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">get_stripe_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_stripe_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.get_stripe_patch" title="Permalink to this definition"></a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.get_test_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">get_test_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'star'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_test_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.get_test_patch" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – </p></li>
<li><p><strong>jitter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>patch</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-get_test_patch –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;star2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jitter</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">get_test_patch</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">jitter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">patch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.get_unwarped_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">get_unwarped_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gray</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_unwarped_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.get_unwarped_patch" title="Permalink to this definition"></a></dt>
<dd><p>Returns unwarped warped patch around a keypoint</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em>) – array representing an image</p></li>
<li><p><strong>kpt</strong> (<em>ndarray</em>) – keypoint ndarray in [x, y, a, c, d, theta] format</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(wpatch, wkp) the normalized 41x41 patches from the img corresonding to the keypoint</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.get_unwarped_patches">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">get_unwarped_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_unwarped_patches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.get_unwarped_patches" title="Permalink to this definition"></a></dt>
<dd><p>Returns cropped unwarped (keypoint is still elliptical) patch around a
keypoint</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em>) – array representing an image</p></li>
<li><p><strong>kpts</strong> (<em>ndarrays</em>) – keypoint ndarrays in [x, y, a, c, d, theta] format</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(patches, subkpts) - the unnormalized patches from the img</dt><dd><p>corresonding to the keypoint</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.get_warped_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">get_warped_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gray</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borderMode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">41</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_warped_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.get_warped_patch" title="Permalink to this definition"></a></dt>
<dd><p>Returns warped (into a unit circle) patch around a keypoint</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em>) – array representing an image</p></li>
<li><p><strong>kpt</strong> (<em>ndarray</em>) – keypoint ndarray in [x, y, a, c, d, theta] format</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(wpatch, wkp) the normalized 41x41 patches from</dt><dd><p>the img corresonding to the keypoint</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(ndarray, ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.get_warped_patches">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">get_warped_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borderMode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">41</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cpp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_warped_patches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.get_warped_patches" title="Permalink to this definition"></a></dt>
<dd><p>Returns warped (into a unit circle) patch around a keypoint</p>
<dl class="simple">
<dt>FIXME:</dt><dd><p>there is a slight translation difference in the way Python extracts
patches and the way C++ extracts patches. C++ should be correct.
TODO: have C++ able to extract color.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – array representing an image</p></li>
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – list of keypoint ndarrays in
[[x, y, a, c, d, theta]] format</p></li>
<li><p><strong>flags</strong> (<em>long</em>) – cv2 interpolation flags</p></li>
<li><p><strong>borderMode</strong> (<em>long</em>) – cv2 border flags</p></li>
<li><p><strong>patch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – resolution of resulting image patch</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(warped_patches, warped_subkpts) the normalized 41x41</dt><dd><p>patches from the img corresonding to the keypoint</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a>)</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-get_warped_patches –show –use_cpp
python -m vtool.patch –test-get_warped_patches –show –use_python</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cpp</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--use_cpp&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">desc</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">INTER_LANCZOS4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">borderMode</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_REPLICATE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">warped_patches</span><span class="p">,</span> <span class="n">warped_subkpts</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_warped_patches</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">kpts</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">borderMode</span><span class="p">,</span> <span class="n">use_cpp</span><span class="o">=</span><span class="n">use_cpp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">warped_patches</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">warped_subkpts</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">warped_patches</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_kpts2(warped_subkpts, pts=True, rect=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;use_cpp = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">use_cpp</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.gradient_fill">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">gradient_fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gradient_fill"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.gradient_fill" title="Permalink to this definition"></a></dt>
<dd><p>FIXME: angle does not work properly</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch gradient_fill –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#style = &#39;linear&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;step&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">gradient_fill</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_uint8</span><span class="p">(</span><span class="n">patch</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.intern_warp_single_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">intern_warp_single_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borderMode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#intern_warp_single_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.intern_warp_single_patch" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori</span> <span class="o">=</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">patch_size</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y a c d S&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">half_patch_size</span> <span class="o">=</span> <span class="n">patch_size</span> <span class="o">/</span> <span class="mi">2</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">sympy_rotation_mat3x3</span><span class="p">(</span><span class="n">radians</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># TODO: handle array impouts</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">sin_</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cos_</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(((</span><span class="n">cos_</span><span class="p">,</span> <span class="o">-</span><span class="n">sin_</span><span class="p">,</span>  <span class="mi">0</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">(</span><span class="n">sin_</span><span class="p">,</span>  <span class="n">cos_</span><span class="p">,</span>  <span class="mi">0</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">(</span>   <span class="mi">0</span><span class="p">,</span>     <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">ori</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kp</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_invV_mats</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">with_trans</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">kp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ss</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">patch_size</span><span class="p">)</span> <span class="o">*</span> <span class="mf">3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ltool</span><span class="o">.</span><span class="n">translation_mat3x3</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>  <span class="c1"># Center the patch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">sympy_rotation_mat3x3</span><span class="p">(</span><span class="o">-</span><span class="n">ori</span><span class="p">)</span>  <span class="c1"># Rotate the centered unit circle patch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ltool</span><span class="o">.</span><span class="n">scale_mat3x3</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>  <span class="c1"># scale from unit circle to the patch size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ltool</span><span class="o">.</span><span class="n">translation_mat3x3</span><span class="p">(</span><span class="n">half_patch_size</span><span class="p">,</span> <span class="n">half_patch_size</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>  <span class="c1"># Translate back to patch-image coordinates</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy</span><span class="o">.</span><span class="n">MatMul</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">add_matmul_hold_prop</span><span class="p">(</span><span class="n">mat</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1">#import functools</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">matmul_hold</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">new</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">MatMul</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="n">hold</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">return</span> <span class="n">new</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1">#matmul_hold = functools.partial(sympy.MatMul, mat, hold=True)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">setattr</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="s1">&#39;matmul_hold&#39;</span><span class="p">,</span> <span class="n">matmul_hold</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">matmul_hold</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">.</span><span class="n">matmul_hold</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">.</span><span class="n">matmul_hold</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">.</span><span class="n">matmul_hold</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#M = X.multiply(S).multiply(R).multiply(V).multiply(T)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V_full</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">V_full</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">T</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">R</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">invV</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;^{-1}&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.inverted_sift_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">inverted_sift_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#inverted_sift_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.inverted_sift_patch" title="Permalink to this definition"></a></dt>
<dd><p>Idea for inverted sift visualization</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch test_sift_viz –show –name=star
python -m vtool.patch test_sift_viz –show –name=star2
python -m vtool.patch test_sift_viz –show –name=cross
python -m vtool.patch test_sift_viz –show –name=stripe</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_test_patch</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--name&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;star&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sift</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">extract_feature_from_patch</span><span class="p">(</span><span class="n">patch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">siftimg</span> <span class="o">=</span> <span class="n">test_sift_viz</span><span class="p">(</span><span class="n">sift</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Need to do some image blending</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">mpl_sift</span><span class="o">.</span><span class="n">draw_sift_on_patch</span><span class="p">(</span><span class="n">siftimg</span><span class="p">,</span> <span class="n">sift</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch2</span> <span class="o">=</span> <span class="n">patch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_uint8</span><span class="p">(</span><span class="n">patch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_square</span><span class="p">(</span><span class="n">patch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">mpl_sift</span><span class="o">.</span><span class="n">draw_sift_on_patch</span><span class="p">(</span><span class="n">patch2</span><span class="p">,</span> <span class="n">sift</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.make_test_image_keypoints">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">make_test_image_keypoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skew</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#make_test_image_keypoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.make_test_image_keypoints" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.patch_gaussian_weighted_average_intensities">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">patch_gaussian_weighted_average_intensities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">probchip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_gaussian_weighted_average_intensities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.patch_gaussian_weighted_average_intensities" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.patch_gradient">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">patch_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.patch_gradient" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.patch_mag">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">patch_mag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gradx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grady</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_mag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.patch_mag" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.patch_ori">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">patch_ori</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gradx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grady</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_ori"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.patch_ori" title="Permalink to this definition"></a></dt>
<dd><p>returns patch orientation relative to the x-axis</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.show_gaussian_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">show_gaussian_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#show_gaussian_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.show_gaussian_patch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.show_patch_orientation_estimation">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">show_patch_orientation_estimation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grady</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gori_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#show_patch_orientation_estimation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.show_patch_orientation_estimation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.test_ondisk_find_patch_fpath_dominant_orientations">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">test_ondisk_find_patch_fpath_dominant_orientations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">36</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxima_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DEBUG_ROTINVAR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#test_ondisk_find_patch_fpath_dominant_orientations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.test_ondisk_find_patch_fpath_dominant_orientations" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patch_fpath</strong> – </p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
<li><p><strong>maxima_thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-test_ondisk_find_patch_fpath_dominant_orientations</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--patch-fpath&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;star.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_ondisk_find_patch_fpath_dominant_orientations</span><span class="p">(</span><span class="n">patch_fpath</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.test_show_gaussian_patches">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">test_show_gaussian_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(19,</span> <span class="pre">19)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#test_show_gaussian_patches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.test_show_gaussian_patches" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-test_show_gaussian_patches –show
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=7,7
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=17,17
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=41,41
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=29,29
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=41,7</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://matplotlib.org/examples/mplot3d/surface3d_demo.html">http://matplotlib.org/examples/mplot3d/surface3d_demo.html</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">((</span><span class="s1">&#39;--shape&#39;</span><span class="p">,),</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_show_gaussian_patches</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.test_show_gaussian_patches2">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">test_show_gaussian_patches2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(19,</span> <span class="pre">19)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#test_show_gaussian_patches2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.test_show_gaussian_patches2" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-test_show_gaussian_patches2 –show
python -m vtool.patch –test-test_show_gaussian_patches2 –show –shape=7,7
python -m vtool.patch –test-test_show_gaussian_patches2 –show –shape=19,19
python -m vtool.patch –test-test_show_gaussian_patches2 –show –shape=41,41
python -m vtool.patch –test-test_show_gaussian_patches2 –show –shape=41,7</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://matplotlib.org/examples/mplot3d/surface3d_demo.html">http://matplotlib.org/examples/mplot3d/surface3d_demo.html</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">((</span><span class="s1">&#39;--shape&#39;</span><span class="p">,),</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_show_gaussian_patches2</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch.testdata_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.patch.</span></span><span class="sig-name descname"><span class="pre">testdata_patch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#testdata_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch.testdata_patch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool.quality_classifier">
<span id="vtool-quality-classifier-module"></span><h2>vtool.quality_classifier module<a class="headerlink" href="#module-vtool.quality_classifier" title="Permalink to this headline"></a></h2>
<p class="rubric">References</p>
<p>% Single-image noise level estimation for blind denoising.
% <a class="reference external" href="http://www.ok.ctrl.titech.ac.jp/res/NLE/TIP2013-noise-level-estimation06607209.pdfhttp://www.ok.ctrl.titech.ac.jp/res/NLE/TIP2013-noise-level-estimation06607209.pdf">http://www.ok.ctrl.titech.ac.jp/res/NLE/TIP2013-noise-level-estimation06607209.pdfhttp://www.ok.ctrl.titech.ac.jp/res/NLE/TIP2013-noise-level-estimation06607209.pdf</a></p>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.quality_classifier.compute_average_contrast">
<span class="sig-prename descclassname"><span class="pre">vtool.quality_classifier.</span></span><span class="sig-name descname"><span class="pre">compute_average_contrast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/quality_classifier.html#compute_average_contrast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.quality_classifier.compute_average_contrast" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.quality_classifier –exec-compute_average_contrast –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.quality_classifier</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">average_contrast</span><span class="p">,</span> <span class="n">gradmag_sqrd</span> <span class="o">=</span> <span class="n">compute_average_contrast</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:plottool)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gradmag_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.quality_classifier.contrast_measures">
<span class="sig-prename descclassname"><span class="pre">vtool.quality_classifier.</span></span><span class="sig-name descname"><span class="pre">contrast_measures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/quality_classifier.html#contrast_measures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.quality_classifier.contrast_measures" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.quality_classifier.fourier_devtest">
<span class="sig-prename descclassname"><span class="pre">vtool.quality_classifier.</span></span><span class="sig-name descname"><span class="pre">fourier_devtest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/quality_classifier.html#fourier_devtest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.quality_classifier.fourier_devtest" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.quality_classifier –test-fourier_devtest –show</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_imgproc/py_transforms/py_fourier_transform/py_fourier_transform.html">http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_imgproc/py_transforms/py_fourier_transform/py_fourier_transform.html</a>
<a class="reference external" href="http://cns-alumni.bu.edu/~slehar/fourier/fourier.html">http://cns-alumni.bu.edu/~slehar/fourier/fourier.html</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.quality_classifier</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">magnitude_spectrum</span> <span class="o">=</span> <span class="n">fourier_devtest</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.quality_classifier.test_average_contrast">
<span class="sig-prename descclassname"><span class="pre">vtool.quality_classifier.</span></span><span class="sig-name descname"><span class="pre">test_average_contrast</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/quality_classifier.html#test_average_contrast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.quality_classifier.test_average_contrast" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool.score_normalization">
<span id="vtool-score-normalization-module"></span><h2>vtool.score_normalization module<a class="headerlink" href="#module-vtool.score_normalization" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vtool.score_normalization.ScoreNormVisualizeClass">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.score_normalization.</span></span><span class="sig-name descname"><span class="pre">ScoreNormVisualizeClass</span></span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormVisualizeClass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormVisualizeClass" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p># HACK; eventually move all individual plots into a class structure</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtool.score_normalization.ScoreNormalizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.score_normalization.</span></span><span class="sig-name descname"><span class="pre">ScoreNormalizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">utool.util_cache.Cachable</span></code>, <a class="reference internal" href="#vtool.score_normalization.ScoreNormVisualizeClass" title="vtool.score_normalization.ScoreNormVisualizeClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">vtool.score_normalization.ScoreNormVisualizeClass</span></code></a></p>
<p>Conforms to scikit-learn Estimator interface</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –test-ScoreNormalizer –show –cmd</p>
</dd>
<dt>Kwargs:</dt><dd><p>tpr (float): target true positive rate (default .90)
fpr (float): target false positive rate (default None)
reverse (bool): True if lower scores are better, False if higher scores
are better (default=None)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ScoreNormalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">testdata_binary_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="vtool.score_normalization.ScoreNormalizer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finite_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits estimator to data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em>) – one dimensional scores</p></li>
<li><p><strong>y</strong> (<em>ndarray</em>) – binary labels</p></li>
<li><p><strong>attrs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – dictionary of data attributes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.score_normalization.ScoreNormalizer.fit_partitioned">
<span class="sig-name descname"><span class="pre">fit_partitioned</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tp_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part_attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.fit_partitioned"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.fit_partitioned" title="Permalink to this definition"></a></dt>
<dd><p>convinience func to fit only scores that have been separated
instead of labeled</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.score_normalization.ScoreNormalizer.get_accuracy">
<span class="sig-name descname"><span class="pre">get_accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_accuracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_accuracy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.score_normalization.ScoreNormalizer.get_confusion_indicies">
<span class="sig-name descname"><span class="pre">get_confusion_indicies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_confusion_indicies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_confusion_indicies" title="Permalink to this definition"></a></dt>
<dd><p>combination of get_correct_indices and get_error_indicies</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.score_normalization.ScoreNormalizer.get_correct_indices">
<span class="sig-name descname"><span class="pre">get_correct_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_correct_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_correct_indices" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em>) – data</p></li>
<li><p><strong>y</strong> (<em>ndarray</em>) – labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(fp_indicies, fn_indicies)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –test-get_correct_indices</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">testdata_score_normalier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">tp_indicies</span><span class="p">,</span> <span class="n">tn_indicies</span><span class="p">)</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">get_correct_indices</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">tp_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">tn_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span>    <span class="s1">&#39;tp_X = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">tp_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">tn_X = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">tn_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">tp_X = np.array([ 8.883,  8.77 ,  8.759])</span>
<span class="go">tn_X = np.array([ 0.727,  0.76 ,  0.841])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.score_normalization.ScoreNormalizer.get_error_indicies">
<span class="sig-name descname"><span class="pre">get_error_indicies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_error_indicies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_error_indicies" title="Permalink to this definition"></a></dt>
<dd><p>Returns the indicies of the most difficult type I and type II errors.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">testdata_score_normalier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">fp_indicies</span><span class="p">,</span> <span class="n">fn_indicies</span><span class="p">)</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">get_error_indicies</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fp_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">fp_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">fn_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span>    <span class="s1">&#39;fp_X = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fp_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">fn_X = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fn_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">fp_X = np.array([ 6.196,  5.912,  5.804])</span>
<span class="go">fn_X = np.array([ 3.947,  4.277,  4.43 ])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.score_normalization.ScoreNormalizer.get_partitioned_support">
<span class="sig-name descname"><span class="pre">get_partitioned_support</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_partitioned_support"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_partitioned_support" title="Permalink to this definition"></a></dt>
<dd><p>convinience get prepartitioned data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.score_normalization.ScoreNormalizer.get_prefix">
<span class="sig-name descname"><span class="pre">get_prefix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_prefix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_prefix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.score_normalization.ScoreNormalizer.get_support">
<span class="sig-name descname"><span class="pre">get_support</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">finite_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_support"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_support" title="Permalink to this definition"></a></dt>
<dd><p>return X, y, and attrs</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.score_normalization.ScoreNormalizer.inverse_normalize">
<span class="sig-name descname"><span class="pre">inverse_normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">probs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.inverse_normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.inverse_normalize" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.score_normalization.ScoreNormalizer.learn_probabilities">
<span class="sig-name descname"><span class="pre">learn_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.learn_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.learn_probabilities" title="Permalink to this definition"></a></dt>
<dd><p>Kernel density estimation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.score_normalization.ScoreNormalizer.learn_threshold">
<span class="sig-name descname"><span class="pre">learn_threshold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">thresh_kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.learn_threshold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.learn_threshold" title="Permalink to this definition"></a></dt>
<dd><p>Learns cutoff threshold that achieves the target confusion metric
Typically a desired false positive rate (recall) is specified</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.score_normalization.ScoreNormalizer.learn_threshold2">
<span class="sig-name descname"><span class="pre">learn_threshold2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.learn_threshold2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.learn_threshold2" title="Permalink to this definition"></a></dt>
<dd><p>Finds a cutoff where the probability of a truepos stats becoming
greater than probability of trueneg</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –exec-learn_threshold2 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder, X, y = testdata_score_normalier([(3.5, 256), (9.5, 1024), (15.5, 2048)], [(6.5, 256), (12.5, 5064), (18.5, 128)], adjust=1, p_tp_method=&#39;ratio&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">testdata_score_normalier</span><span class="p">([(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="p">(</span><span class="mf">9.5</span><span class="p">,</span> <span class="mi">1024</span><span class="p">),</span> <span class="p">(</span><span class="mf">15.5</span><span class="p">,</span> <span class="mi">5064</span><span class="p">)],</span> <span class="p">[(</span><span class="mf">6.5</span><span class="p">,</span> <span class="mi">256</span><span class="p">),</span> <span class="p">(</span><span class="mf">12.5</span><span class="p">,</span> <span class="mi">2048</span><span class="p">),</span> <span class="p">(</span><span class="mf">18.5</span><span class="p">,</span> <span class="mi">128</span><span class="p">)],</span> <span class="n">adjust</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">p_tp_method</span><span class="o">=</span><span class="s1">&#39;ratio&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder, X, y = testdata_score_normalier(adjust=1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder, X, y = testdata_score_normalier([(3.5, 2048)], [(30.5, 128)], tn_scale=.1, adjust=1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder, X, y = testdata_score_normalier([(0, 64)], [(-.1, 12)], adjust=8, min_clip=0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">encoder</span><span class="o">.</span><span class="n">learn_threshold2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exec</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">execstr_dict</span><span class="p">(</span><span class="n">locals_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.plot(xdata[0:-2], np.diff(np.diff(closeness)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#maxima_x, maxima_y, argmaxima = vt.hist_argmaxima(closeness)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fnum</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">multi_plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="p">[</span><span class="n">tp_curve</span><span class="p">,</span> <span class="n">tn_curve</span><span class="p">,</span> <span class="n">closeness</span><span class="p">,</span> <span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">label_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p(tp | s)&#39;</span><span class="p">,</span> <span class="s1">&#39;p(tn | s)&#39;</span><span class="p">,</span> <span class="s1">&#39;closeness&#39;</span><span class="p">,</span> <span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">linewidth_list</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;intersection points&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">xdata</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">closeness</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;closeness maxima&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_submax</span><span class="p">,</span> <span class="n">y_submax</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;chosen&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.plot(xdata[argmaxima], curveness[argmaxima], &#39;rx&#39;, label=&#39;curveness maxima&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.plot(x_submax, y_submax, &#39;o&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">tp_curve</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">tn_curve</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">tp_curve</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">tn_curve</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.plot(xdata[argmaxima], encoder.interp_fn(x_submax), &#39;rx&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_mkinterp</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">assume_sorted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_interp_sgtn</span> <span class="o">=</span> <span class="n">_mkinterp</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">tn_curve</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_interp_sgtp</span> <span class="o">=</span> <span class="n">_mkinterp</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">tp_curve</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_submax</span><span class="p">,</span> <span class="n">_interp_sgtn</span><span class="p">(</span><span class="n">x_submax</span><span class="p">),</span> <span class="s1">&#39;go&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_submax</span><span class="p">,</span> <span class="n">_interp_sgtp</span><span class="p">(</span><span class="n">x_submax</span><span class="p">),</span> <span class="s1">&#39;bx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">multi_plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="p">[</span><span class="n">tp_area</span><span class="p">,</span> <span class="n">fp_area</span><span class="p">,</span> <span class="n">tn_area</span><span class="p">,</span> <span class="n">fn_area</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;intersection areas&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">label_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tp_area&#39;</span><span class="p">,</span> <span class="s1">&#39;fp_area&#39;</span><span class="p">,</span> <span class="s1">&#39;tn_area&#39;</span><span class="p">,</span> <span class="s1">&#39;fn_area&#39;</span><span class="p">],</span> <span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">xdata</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">multi_plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="p">[</span><span class="n">lr_pos</span><span class="p">,</span> <span class="n">lr_neg</span><span class="p">,</span> <span class="n">acc</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;intersection quality (liklihood ratios)&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">label_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lr_pos=tp/fp&#39;</span><span class="p">,</span> <span class="s1">&#39;lr_neg=fn/tn&#39;</span><span class="p">,</span> <span class="s1">&#39;acc&#39;</span><span class="p">],</span> <span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">xdata</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pnum_</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">make_pnum_nextgen</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">_plot_score_support_hist</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder._plot_prebayes(fnum=fnum, pnum=pnum_())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">_plot_postbayes</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">_plot_roc</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">adjust_subplots</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">.95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">.08</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.score_normalization.ScoreNormalizer.normalize_scores">
<span class="sig-name descname"><span class="pre">normalize_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.normalize_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.normalize_scores" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.score_normalization.ScoreNormalizer.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.predict" title="Permalink to this definition"></a></dt>
<dd><p>Predict true or false of <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.score_normalization.ScoreNormalizer.visualize">
<span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.visualize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.visualize" title="Permalink to this definition"></a></dt>
<dd><p>shows details about the score normalizer</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>fnum
figtitle
with_hist
interactive
with_scores
with_roc
with_precision_recall</p>
</dd>
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –exec-ScoreNormalizer.visualize:0 –show
python -m vtool.score_normalization –exec-ScoreNormalizer.visualize:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># UNSTABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ScoreNormalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">testdata_binary_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_pr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_roc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_hist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># UNSTABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ScoreNormalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">testdata_binary_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_pr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_roc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_hist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_scores</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_prebayes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_postbayes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">target_tpr</span><span class="o">=</span><span class="mf">.95</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.score_normalization.check_unused_kwargs">
<span class="sig-prename descclassname"><span class="pre">vtool.score_normalization.</span></span><span class="sig-name descname"><span class="pre">check_unused_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#check_unused_kwargs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.check_unused_kwargs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.score_normalization.estimate_pdf">
<span class="sig-prename descclassname"><span class="pre">vtool.score_normalization.</span></span><span class="sig-name descname"><span class="pre">estimate_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#estimate_pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.estimate_pdf" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>References;</dt><dd><p><a class="reference external" href="http://statsmodels.sourceforge.net/devel/generated/statsmodels.nonparametric.kde.KDEUnivariate.html">http://statsmodels.sourceforge.net/devel/generated/statsmodels.nonparametric.kde.KDEUnivariate.html</a>
<a class="reference external" href="https://jakevdp.github.io/blog/2013/12/01/kernel-density-estimation/">https://jakevdp.github.io/blog/2013/12/01/kernel-density-estimation/</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em>) – 1 dimensional data of float64</p></li>
<li><p><strong>gridsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – domain size</p></li>
<li><p><strong>adjust</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – smoothing factor</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>data_pdf</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_pdf</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">estimate_pdf</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_pdf</span><span class="o">.</span><span class="n">support</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">data_pdf</span><span class="o">.</span><span class="n">cdf</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.score_normalization.find_clip_range">
<span class="sig-prename descclassname"><span class="pre">vtool.score_normalization.</span></span><span class="sig-name descname"><span class="pre">find_clip_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tp_support</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_support</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.6180339887499997</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#find_clip_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.find_clip_range" title="Permalink to this definition"></a></dt>
<dd><p>TODO: generalize to arbitrary domains (not just 0-&gt;inf)</p>
<p>Finds score to clip true positives past. This is useful when the highest
true positive scores can be much larger than the highest true negative
score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tp_support</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>tn_support</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>clip_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – factor of the true negative domain to search for true positives</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>min_score, max_score</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –test-find_clip_range</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">50000</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">110</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clip_factor</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">PHI</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_score</span><span class="p">,</span> <span class="n">max_score</span> <span class="o">=</span> <span class="n">find_clip_range</span><span class="p">(</span><span class="n">tp_support</span><span class="p">,</span> <span class="n">tn_support</span><span class="p">,</span>  <span class="n">clip_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.4f</span><span class="s1">, </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">((</span><span class="n">min_score</span><span class="p">,</span> <span class="n">max_score</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">10.0000, 287.9837</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.score_normalization.flatten_scores">
<span class="sig-prename descclassname"><span class="pre">vtool.score_normalization.</span></span><span class="sig-name descname"><span class="pre">flatten_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tp_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part_attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#flatten_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.flatten_scores" title="Permalink to this definition"></a></dt>
<dd><p>convinience helper to translate partitioned to unpartitioned data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tp_scores</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>tn_scores</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>part_attrs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – (default = None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(scores, labels, attrs)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –test-flatten_scores</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part_attrs</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;qaid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">]},</span>
<span class="gp">... </span>    <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;qaid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]},</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">flatten_scores</span><span class="p">(</span>
<span class="gp">... </span><span class="n">tp_scores</span><span class="p">,</span> <span class="n">tn_scores</span><span class="p">,</span> <span class="n">part_attrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resdict</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">odict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;attrs&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">resdict</span><span class="p">,</span> <span class="n">nobraces</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="n">explicit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">X=np.array([5, 6, 6, 7, 1, 2, 2]),</span>
<span class="go">y=np.array([1, 1, 1, 1, 0, 0, 0]),</span>
<span class="go">attrs=&#39;qaid&#39;: np.array([21, 24, 25, 26, 11, 14, 15]),</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.score_normalization.get_left_area">
<span class="sig-prename descclassname"><span class="pre">vtool.score_normalization.</span></span><span class="sig-name descname"><span class="pre">get_left_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#get_left_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.get_left_area" title="Permalink to this definition"></a></dt>
<dd><p>area to the left of each index point</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.score_normalization.get_right_area">
<span class="sig-prename descclassname"><span class="pre">vtool.score_normalization.</span></span><span class="sig-name descname"><span class="pre">get_right_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#get_right_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.get_right_area" title="Permalink to this definition"></a></dt>
<dd><p>area to the right of each index point</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.score_normalization.inspect_pdfs">
<span class="sig-prename descclassname"><span class="pre">vtool.score_normalization.</span></span><span class="sig-name descname"><span class="pre">inspect_pdfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tn_support</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp_support</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_tp_given_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_tn_given_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_score_given_tp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_score_given_tn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_roc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_precision_recall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_hist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_stems</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part_attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr_callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_prebayes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_postbayes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#inspect_pdfs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.inspect_pdfs" title="Permalink to this definition"></a></dt>
<dd><p>Shows plots of learned thresholds</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –test-ScoreNormalizer –show
python -m vtool.score_normalization –exec-ScoreNormalizer.visualize –show</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.score_normalization.learn_score_normalization">
<span class="sig-prename descclassname"><span class="pre">vtool.score_normalization.</span></span><span class="sig-name descname"><span class="pre">learn_score_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tp_support</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_support</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monotonize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.6180339887499997</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_tp_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eq'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#learn_score_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.learn_score_normalization" title="Permalink to this definition"></a></dt>
<dd><p>Takes collected data and applys parzen window density estimation and bayes rule.</p>
<p>#True positive scores must be larger than true negative scores.
FIXME: might be an issue with pdfs summing to 1 here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tp_support</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>tn_support</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>gridsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – default 512</p></li>
<li><p><strong>adjust</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – default 8</p></li>
<li><p><strong>return_all</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – default False</p></li>
<li><p><strong>monotonize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – default True</p></li>
<li><p><strong>clip_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – default phi ** 2</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(score_domain, p_tp_given_score, p_tn_given_score, p_score_given_tp, p_score_given_tn, p_score)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –test-learn_score_normalization</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsize</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adjust</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_all</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">monotonize</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clip_factor</span> <span class="o">=</span> <span class="mf">2.6180339887499997</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">score_domain</span><span class="p">,</span> <span class="n">p_tp_given_score</span><span class="p">)</span> <span class="o">=</span> <span class="n">learn_score_normalization</span><span class="p">(</span><span class="n">tp_support</span><span class="p">,</span> <span class="n">tn_support</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">p_tp_given_score</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">0.99</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.score_normalization.normalize_scores">
<span class="sig-prename descclassname"><span class="pre">vtool.score_normalization.</span></span><span class="sig-name descname"><span class="pre">normalize_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">score_domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_tp_given_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#normalize_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.normalize_scores" title="Permalink to this definition"></a></dt>
<dd><p>Adjusts a raw scores to a probabilities based on a learned normalizer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>score_domain</strong> (<em>ndarray</em>) – input score domain</p></li>
<li><p><strong>p_tp_given_score</strong> (<em>ndarray</em>) – learned probability mapping</p></li>
<li><p><strong>scores</strong> (<em>ndarray</em>) – raw scores</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>probabilities</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –test-normalize_scores</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_tp_given_score</span> <span class="o">=</span> <span class="p">(</span><span class="n">score_domain</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">score_domain</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">9.99</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">11.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prob</span> <span class="o">=</span> <span class="n">normalize_scores</span><span class="p">(</span><span class="n">score_domain</span><span class="p">,</span> <span class="n">p_tp_given_score</span><span class="p">,</span> <span class="n">scores</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#np.set_printoptions(suppress=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress_small</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">score_domain</span><span class="p">,</span> <span class="n">p_tp_given_score</span><span class="p">,</span> <span class="s1">&#39;r-x&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;learned probability&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="s1">&#39;yo&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Normalized scores&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;query points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([ 0.  ,  0.  ,  0.  ,  0.05,  0.64,  1.  ,  1.  ,  1.  ,  1.  ], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.score_normalization.partition_scores">
<span class="sig-prename descclassname"><span class="pre">vtool.score_normalization.</span></span><span class="sig-name descname"><span class="pre">partition_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#partition_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.partition_scores" title="Permalink to this definition"></a></dt>
<dd><p>convinience helper to translate partitioned to unpartitioned data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tp_scores</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>tn_scores</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>attrs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – (default = None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(scores, labels, attrs)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –test-partition_scores</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;qaid&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">21</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">])}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">partition_scores</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resdict</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">odict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="s1">&#39;tp_scores&#39;</span><span class="p">,</span> <span class="s1">&#39;tn_scores&#39;</span><span class="p">,</span> <span class="s1">&#39;part_attrs&#39;</span><span class="p">],</span> <span class="n">tup</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">resdict</span><span class="p">,</span> <span class="n">nobraces</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="n">explicit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">tp_scores=np.array([5, 6, 6, 7]),</span>
<span class="go">tn_scores=np.array([1, 2, 2]),</span>
<span class="go">part_attrs=False: &#39;qaid&#39;: np.array([11, 14, 15]),</span>
<span class="go">           True: &#39;qaid&#39;: np.array([21, 24, 25, 26]),,</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.score_normalization.plot_postbayes_pdf">
<span class="sig-prename descclassname"><span class="pre">vtool.score_normalization.</span></span><span class="sig-name descname"><span class="pre">plot_postbayes_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">score_domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_tn_given_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_tp_given_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#plot_postbayes_pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.plot_postbayes_pdf" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.score_normalization.plot_prebayes_pdf">
<span class="sig-prename descclassname"><span class="pre">vtool.score_normalization.</span></span><span class="sig-name descname"><span class="pre">plot_prebayes_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">score_domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_score_given_tn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_score_given_tp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#plot_prebayes_pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.plot_prebayes_pdf" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.score_normalization.test_score_normalization">
<span class="sig-prename descclassname"><span class="pre">vtool.score_normalization.</span></span><span class="sig-name descname"><span class="pre">test_score_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tp_support</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_support</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_roc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_precision_recall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normkw_varydict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#test_score_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.test_score_normalization" title="Permalink to this definition"></a></dt>
<dd><p>Gives an overview of how well threshold can be learned from raw scores.</p>
<p>DEPRICATE</p>
<dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –test-test_score_normalization –show</p>
</dd>
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/score_normalization.py test_score_normalization</p>
</dd>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># GUI_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Shows how score normalization works with gaussian noise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">randstate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get a training sample</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_support</span> <span class="o">=</span> <span class="n">randstate</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">6.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">256</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_support</span> <span class="o">=</span> <span class="n">randstate</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">256</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:plottool)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_score_normalization</span><span class="p">(</span><span class="n">tp_support</span><span class="p">,</span> <span class="n">tn_support</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.score_normalization.testdata_score_normalier">
<span class="sig-prename descclassname"><span class="pre">vtool.score_normalization.</span></span><span class="sig-name descname"><span class="pre">testdata_score_normalier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tp_bumps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[(6.5,</span> <span class="pre">256)]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_bumps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[(3.5,</span> <span class="pre">256)]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#testdata_score_normalier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.score_normalization.testdata_score_normalier" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool.segmentation">
<span id="vtool-segmentation-module"></span><h2>vtool.segmentation module<a class="headerlink" href="#module-vtool.segmentation" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.segmentation.clean_mask">
<span class="sig-prename descclassname"><span class="pre">vtool.segmentation.</span></span><span class="sig-name descname"><span class="pre">clean_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_dilate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_erode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.025</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#clean_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.segmentation.clean_mask" title="Permalink to this definition"></a></dt>
<dd><p>Clean the mask
(num_erode, num_dilate) = (1, 1)
(w, h) = (10, 10)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.segmentation.demo_grabcut">
<span class="sig-prename descclassname"><span class="pre">vtool.segmentation.</span></span><span class="sig-name descname"><span class="pre">demo_grabcut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bgr_img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#demo_grabcut"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.segmentation.demo_grabcut" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.segmentation –test-demo_grabcut –show</p>
</dd>
<dt>SeeAlso:</dt><dd><p>python -m wbia.algo.preproc.preproc_probchip –test-postprocess_dev</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.segmentation</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bgr_img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bgr_img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">demo_grabcut</span><span class="p">(</span><span class="n">bgr_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">## xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.segmentation.fill_holes">
<span class="sig-prename descclassname"><span class="pre">vtool.segmentation.</span></span><span class="sig-name descname"><span class="pre">fill_holes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#fill_holes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.segmentation.fill_holes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.segmentation.grabcut">
<span class="sig-prename descclassname"><span class="pre">vtool.segmentation.</span></span><span class="sig-name descname"><span class="pre">grabcut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bgr_img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#grabcut"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.segmentation.grabcut" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Referencs:</dt><dd><p><a class="reference external" href="http://docs.opencv.org/trunk/doc/py_tutorials/py_imgproc/py_grabcut/py_grabcut.html">http://docs.opencv.org/trunk/doc/py_tutorials/py_imgproc/py_grabcut/py_grabcut.html</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.segmentation.grabcut2">
<span class="sig-prename descclassname"><span class="pre">vtool.segmentation.</span></span><span class="sig-name descname"><span class="pre">grabcut2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rgb_chip</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#grabcut2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.segmentation.grabcut2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.segmentation.mask_colored_img">
<span class="sig-prename descclassname"><span class="pre">vtool.segmentation.</span></span><span class="sig-name descname"><span class="pre">mask_colored_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_rgb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bgr'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#mask_colored_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.segmentation.mask_colored_img" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.segmentation.printDBG">
<span class="sig-prename descclassname"><span class="pre">vtool.segmentation.</span></span><span class="sig-name descname"><span class="pre">printDBG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#printDBG"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.segmentation.printDBG" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.segmentation.resize_img_and_bbox">
<span class="sig-prename descclassname"><span class="pre">vtool.segmentation.</span></span><span class="sig-name descname"><span class="pre">resize_img_and_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sqrt_area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#resize_img_and_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.segmentation.resize_img_and_bbox" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.segmentation.segment">
<span class="sig-prename descclassname"><span class="pre">vtool.segmentation.</span></span><span class="sig-name descname"><span class="pre">segment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#segment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.segmentation.segment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool.spatial_verification">
<span id="vtool-spatial-verification-module"></span><h2>vtool.spatial_verification module<a class="headerlink" href="#module-vtool.spatial_verification" title="Permalink to this headline"></a></h2>
<p>Spatial verification of keypoint matches</p>
<dl class="simple">
<dt>Notation:</dt><dd><p>1_m = img1_matches; 2_m = img2_matches
x and y are locations, invV is the elliptical shapes.
fx are the original feature indexes (used for making sure 1 keypoint isn’t assigned to 2)</p>
</dd>
<dt>Look Into:</dt><dd><p>Standard
skimage.transform
<a class="reference external" href="http://stackoverflow.com/questions/11462781/fast-2d-rigid-body-transformations-in-numpy-scipy">http://stackoverflow.com/questions/11462781/fast-2d-rigid-body-transformations-in-numpy-scipy</a>
skimage.transform.fast_homography(im, H)</p>
</dd>
<dt>FIXME:</dt><dd><p>is it scaled_thresh or scaled_thresh_sqrd</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://ags.cs.uni-kl.de/fileadmin/inf_ags/3dcv-ws11-12/3DCV_WS11-12_lec04.pdf">http://ags.cs.uni-kl.de/fileadmin/inf_ags/3dcv-ws11-12/3DCV_WS11-12_lec04.pdf</a>
<a class="reference external" href="http://www.imgfsr.com/CVPR2011/Tutorial6/RANSAC_CVPR2011.pdf">http://www.imgfsr.com/CVPR2011/Tutorial6/RANSAC_CVPR2011.pdf</a>
<a class="reference external" href="http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf">http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf</a> Page 317</p>
<p class="rubric">Notes</p>
<p>Invariants of affine transforms - parallel lines, ratios of parallel lengths, ratios of areas
Invariants of homographies - cross‐ratio of four points on a line (ratio of ratio)</p>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.spatial_verification.build_affine_lstsqrs_Mx6">
<span class="sig-prename descclassname"><span class="pre">vtool.spatial_verification.</span></span><span class="sig-name descname"><span class="pre">build_affine_lstsqrs_Mx6</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy1_man</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy2_man</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#build_affine_lstsqrs_Mx6"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.spatial_verification.build_affine_lstsqrs_Mx6" title="Permalink to this definition"></a></dt>
<dd><p>CURRENTLY NOT WORKING</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.spatial_verification –test-build_affine_lstsqrs_Mx6</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_man</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_man</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Mx6</span> <span class="o">=</span> <span class="n">build_affine_lstsqrs_Mx6</span><span class="p">(</span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">Mx6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">Mx6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x1, y1, x2, y2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">A</span><span class="p">))</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">A</span><span class="p">))</span><span class="o">.</span><span class="n">pinv</span><span class="p">()</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf">https://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf</a> page 22</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.spatial_verification.build_lstsqrs_Mx9">
<span class="sig-prename descclassname"><span class="pre">vtool.spatial_verification.</span></span><span class="sig-name descname"><span class="pre">build_lstsqrs_Mx9</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy1_mn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy2_mn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#build_lstsqrs_Mx9"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.spatial_verification.build_lstsqrs_Mx9" title="Permalink to this definition"></a></dt>
<dd><p>Builds the M x 9 least squares matrix</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.spatial_verification –test-build_lstsqrs_Mx9</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Mx9</span> <span class="o">=</span> <span class="n">build_lstsqrs_Mx9</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">Mx9</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">suppress_small</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[  0.00e+00,   0.00e+00,   0.00e+00,  -3.20e+01,  -2.72e+01,</span>
<span class="go">            -1.00e+00,   8.82e+02,   7.49e+02,   2.76e+01],</span>
<span class="go">          [  3.20e+01,   2.72e+01,   1.00e+00,   0.00e+00,   0.00e+00,</span>
<span class="go">             0.00e+00,  -1.09e+03,  -9.28e+02,  -3.42e+01]], dtype=np.float64)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://dip.sun.ac.za/~stefan/TW793/attach/notes/homography_estimation.pdf">http://dip.sun.ac.za/~stefan/TW793/attach/notes/homography_estimation.pdf</a>
<a class="reference external" href="http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf">http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf</a> Page 317
<a class="reference external" href="http://vision.ece.ucsb.edu/~zuliani/Research/RANSAC/docs/RANSAC4Dummies.pdf">http://vision.ece.ucsb.edu/~zuliani/Research/RANSAC/docs/RANSAC4Dummies.pdf</a> page 53</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.spatial_verification.compute_affine">
<span class="sig-prename descclassname"><span class="pre">vtool.spatial_verification.</span></span><span class="sig-name descname"><span class="pre">compute_affine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy1_man</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy2_man</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#compute_affine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.spatial_verification.compute_affine" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xy1_mn</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – xy points in image1</p></li>
<li><p><strong>xy2_mn</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – corresponding xy points in image 2</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A - affine matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[shape=(3,3)]</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.spatial_verification –test-compute_affine:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">compute_affine</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy1_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers_normalized</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A_prime</span> <span class="o">=</span> <span class="n">compute_affine</span><span class="p">(</span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span> <span class="n">A_prime</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">T1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">/=</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip2_blendA</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">get_blended_chip</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rchip2_blendA</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">[[  1.19e+00  -1.06e-02  -4.49e+01]</span>
<span class="go"> [ -2.22e-01   1.12e+00  -2.78e+01]</span>
<span class="go"> [  0.00e+00   0.00e+00   1.00e+00]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.spatial_verification.compute_homog">
<span class="sig-prename descclassname"><span class="pre">vtool.spatial_verification.</span></span><span class="sig-name descname"><span class="pre">compute_homog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy1_mn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy2_mn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#compute_homog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.spatial_verification.compute_homog" title="Permalink to this definition"></a></dt>
<dd><p>Generate 6 degrees of freedom homography transformation
Computes homography from normalized (0 to 1) point correspondences
from 2 –&gt; 1
(database-&gt;query)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xy1_mn</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – xy points in image1</p></li>
<li><p><strong>xy2_mn</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – corresponding xy points in image 2</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>H - homography matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[shape=(3,3)]</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.spatial_verification –test-compute_homog:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">compute_homog</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#result = ut.hashstr(H)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[  1.83e-03   2.85e-03  -7.11e-01]</span>
<span class="go"> [  2.82e-03   1.80e-03  -7.03e-01]</span>
<span class="go"> [  1.67e-05   1.68e-05  -5.53e-03]]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers_normalized</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H_prime</span> <span class="o">=</span> <span class="n">compute_homog</span><span class="p">(</span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span> <span class="n">H_prime</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">T1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">/=</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip2_blendH</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">get_blended_chip</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rchip2_blendH</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">[[  9.22e-01  -2.50e-01   2.75e+01]</span>
<span class="go"> [ -2.04e-01   8.79e-01  -7.94e+00]</span>
<span class="go"> [ -1.82e-04  -5.99e-04   1.00e+00]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.spatial_verification.estimate_refined_transform">
<span class="sig-prename descclassname"><span class="pre">vtool.spatial_verification.</span></span><span class="sig-name descname"><span class="pre">estimate_refined_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aff_inliers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'homog'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#estimate_refined_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.spatial_verification.estimate_refined_transform" title="Permalink to this definition"></a></dt>
<dd><p>estimates final transformation using normalized affine inliers</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/2.4/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html">http://docs.opencv.org/2.4/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.spatial_verification.get_affine_inliers">
<span class="sig-prename descclassname"><span class="pre">vtool.spatial_verification.</span></span><span class="sig-name descname"><span class="pre">get_affine_inliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_thresh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_affine_inliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.spatial_verification.get_affine_inliers" title="Permalink to this definition"></a></dt>
<dd><p>Estimates inliers deterministically using elliptical shapes</p>
<p>Compute all transforms from kpts1 to kpts2 (enumerate all hypothesis)
We transform from chip1 -&gt; chip2
The determinants are squared keypoint scales</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>aff_inliers_list, aff_errors_list, Aff_mats</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>FROM PERDOCH 2009:</dt><dd><p>H = inv(Aj).dot(Rj.T).dot(Ri).dot(Ai)
H = inv(Aj).dot(Ai)
The input invVs = perdoch.invA’s</p>
</dd>
<dt>CommandLine:</dt><dd><p>python2 -m vtool.spatial_verification –test-get_affine_inliers
python3 -m vtool.spatial_verification –test-get_affine_inliers</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">make_dummy_fm</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span><span class="p">(</span><span class="mf">.009</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh_sqrd</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_thresh</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span><span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">get_affine_inliers</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">scale_thresh_sqrd</span><span class="p">,</span> <span class="n">ori_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_str</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress_small</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;output_str = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">output_str</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_inliers_list</span><span class="p">,</span> <span class="n">aff_errors_list</span><span class="p">,</span> <span class="n">Aff_mats</span> <span class="o">=</span> <span class="n">output</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;nInliers=</span><span class="si">%r</span><span class="s1"> hash=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">aff_inliers_list</span><span class="p">),</span> <span class="n">ut</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">output_str</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.spatial_verification.get_best_affine_inliers">
<span class="sig-prename descclassname"><span class="pre">vtool.spatial_verification.</span></span><span class="sig-name descname"><span class="pre">get_best_affine_inliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forcepy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_best_affine_inliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.spatial_verification.get_best_affine_inliers" title="Permalink to this definition"></a></dt>
<dd><p>Tests each hypothesis and returns only the best transformation and inliers</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.spatial_verification.get_best_affine_inliers_">
<span class="sig-prename descclassname"><span class="pre">vtool.spatial_verification.</span></span><span class="sig-name descname"><span class="pre">get_best_affine_inliers_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_thresh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_best_affine_inliers_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.spatial_verification.get_best_affine_inliers_" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.spatial_verification.get_normalized_affine_inliers">
<span class="sig-prename descclassname"><span class="pre">vtool.spatial_verification.</span></span><span class="sig-name descname"><span class="pre">get_normalized_affine_inliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aff_inliers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_normalized_affine_inliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.spatial_verification.get_normalized_affine_inliers" title="Permalink to this definition"></a></dt>
<dd><p>returns xy-inliers that are normalized to have a mean of 0 and std of 1 as
well as the transformations so the inverse can be taken</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.spatial_verification.refine_inliers">
<span class="sig-prename descclassname"><span class="pre">vtool.spatial_verification.</span></span><span class="sig-name descname"><span class="pre">refine_inliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aff_inliers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.57</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_homog_checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'homog'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#refine_inliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.spatial_verification.refine_inliers" title="Permalink to this definition"></a></dt>
<dd><p>Given a set of hypothesis inliers, computes a homography and refines inliers
returned homography maps image1 space into image2 space</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.spatial_verification –test-refine_inliers
python -m vtool.spatial_verification –test-refine_inliers:0
python -m vtool.spatial_verification –test-refine_inliers:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">make_dummy_fm</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_inliers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="mf">.01</span> <span class="o">*</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_kpts_dlen_sqrd</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homogtup</span> <span class="o">=</span> <span class="n">refine_inliers</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refined_inliers</span><span class="p">,</span> <span class="n">refined_errors</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">homogtup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">homogtup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_small</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup1</span> <span class="o">=</span> <span class="n">refine_inliers</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">homog_tup1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">homog_tup1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">show_sv</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">homog_tup</span><span class="o">=</span><span class="n">homog_tup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.spatial_verification.spatially_verify_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.spatial_verification.</span></span><span class="sig-name descname"><span class="pre">spatially_verify_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5707963267948966</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dlen_sqrd2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_nInliers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnAff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_homog_checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'homog'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_nInliers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#spatially_verify_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.spatial_verification.spatially_verify_kpts" title="Permalink to this definition"></a></dt>
<dd><p>Driver function
Spatially validates feature matches</p>
<p>FIXME: there is a non-determenism here</p>
<p>Returned homography maps image1 space into image2 space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts1</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – all keypoints in image 1</p></li>
<li><p><strong>kpts2</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – all keypoints in image 2</p></li>
<li><p><strong>fm</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – matching keypoint indexes […, (kp1x, kp2x), …]</p></li>
<li><p><strong>xy_thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – spatial distance threshold under affine transform to
be considered a match</p></li>
<li><p><strong>scale_thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
<li><p><strong>ori_thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
<li><p><strong>dlen_sqrd2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – diagonal length squared of image/chip 2</p></li>
<li><p><strong>min_nInliers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – default=4</p></li>
<li><p><strong>returnAff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – returns best affine hypothesis as well</p></li>
<li><p><strong>max_nInliers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – homog is not considered after this threshold</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(refined_inliers, refined_errors, H, aff_inliers, aff_errors, Aff) if success else None</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m xdoctest vtool.spatial_verification spatially_verify_kpts:0 –show
python -m xdoctest vtool.spatial_verification spatially_verify_kpts:0 –show –refine-method=’affine’
python -m xdoctest vtool.spatial_verification spatially_verify_kpts:0 –dpath figures –show –save ~/latex/crall-candidacy-2015/figures/sver_kpts.jpg  # NOQA
python -m xdoctest vtool.spatial_verification spatially_verify_kpts:0</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname1&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname2&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;easy2.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_extract_features_default_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span><span class="p">[</span><span class="s1">&#39;ratio_thresh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">.625</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">argparse_dict</span><span class="p">(</span><span class="n">default_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">)</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">testdata_ratio_matches</span><span class="p">(</span><span class="n">fname1</span><span class="p">,</span> <span class="n">fname2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_thresh</span> <span class="o">=</span> <span class="mf">.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dlen_sqrd2</span> <span class="o">=</span> <span class="mf">447271.015</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_thresh</span> <span class="o">=</span> <span class="mf">1.57</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_nInliers</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">returnAff</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refine_method</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--refine-method&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;homog&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svtup</span> <span class="o">=</span> <span class="n">spatially_verify_kpts</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">xy_thresh</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span><span class="p">,</span> <span class="n">dlen_sqrd2</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">min_nInliers</span><span class="p">,</span> <span class="n">match_weights</span><span class="p">,</span> <span class="n">returnAff</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">refine_method</span><span class="o">=</span><span class="n">refine_method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">svtup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">svtup</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;sver failed&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refined_inliers</span><span class="p">,</span> <span class="n">refined_errors</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">svtup</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_inliers</span><span class="p">,</span> <span class="n">aff_errors</span><span class="p">,</span> <span class="n">Aff</span> <span class="o">=</span> <span class="n">svtup</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print(&#39;aff_errors = %r&#39; % (aff_errors,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;aff_inliers = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">aff_inliers</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;refined_inliers = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">refined_inliers</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print(&#39;refined_errors = %r&#39; % (refined_errors,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_type_profile</span><span class="p">(</span><span class="n">svtup</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#result = ub.repr2(svtup, precision=3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">refined_inliers</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">aff_inliers</span><span class="p">,</span> <span class="n">Aff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">show_sv</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_tup</span><span class="o">=</span><span class="n">aff_tup</span><span class="p">,</span> <span class="n">homog_tup</span><span class="o">=</span><span class="n">homog_tup</span><span class="p">,</span> <span class="n">refine_method</span><span class="o">=</span><span class="n">refine_method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">tuple(numpy.ndarray, tuple(numpy.ndarray*3), numpy.ndarray, numpy.ndarray, tuple(numpy.ndarray*3), numpy.ndarray)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.spatial_verification.test_affine_errors">
<span class="sig-prename descclassname"><span class="pre">vtool.spatial_verification.</span></span><span class="sig-name descname"><span class="pre">test_affine_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_thresh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#test_affine_errors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.spatial_verification.test_affine_errors" title="Permalink to this definition"></a></dt>
<dd><p>used for refinement as opposed to initial estimation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.spatial_verification.test_homog_errors">
<span class="sig-prename descclassname"><span class="pre">vtool.spatial_verification.</span></span><span class="sig-name descname"><span class="pre">test_homog_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_homog_checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#test_homog_errors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.spatial_verification.test_homog_errors" title="Permalink to this definition"></a></dt>
<dd><p>Test to see which keypoints the homography correctly maps</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>H</strong> (<em>ndarray</em><em>[</em><em>float64_t</em><em>, </em><em>ndim=2</em><em>]</em>) – homography/perspective matrix</p></li>
<li><p><strong>kpts1</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>kpts2</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>fm</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of feature matches as tuples (qfx, dfx)</p></li>
<li><p><strong>xy_thresh_sqrd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
<li><p><strong>scale_thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
<li><p><strong>ori_thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – angle in radians</p></li>
<li><p><strong>full_homog_checks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>homog_tup1</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.spatial_verification –test-test_homog_errors:0 –show
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –rotation_invariance
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –rotation_invariance –no-affine-invariance –xy-thresh=.001
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –rotation_invariance –no-affine-invariance –xy-thresh=.001 –no-full-homog-checks
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –no-full-homog-checks
# ————–
# Shows (sorta) how inliers are computed
python -m vtool.spatial_verification –test-test_homog_errors:1 –show
python -m vtool.spatial_verification –test-test_homog_errors:1 –show –rotation_invariance
python -m vtool.spatial_verification –test-test_homog_errors:1 –show –rotation_invariance –no-affine-invariance –xy-thresh=.001
python -m vtool.spatial_verification –test-test_homog_errors:1 –show –rotation_invariance –xy-thresh=.001
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –rotation_invariance –xy-thresh=.001</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">estimate_refined_transform</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.57</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">full_homog_checks</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--no-full-homog-checks&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup1</span> <span class="o">=</span> <span class="n">test_homog_errors</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">,</span> <span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span><span class="p">,</span> <span class="n">full_homog_checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">homog_tup1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">homog_tup1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">show_sv</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">homog_tup</span><span class="o">=</span><span class="n">homog_tup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm_</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">estimate_refined_transform</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm_</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.57</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">full_homog_checks</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--no-full-homog-checks&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ----------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Take subset of feature matches</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">fm_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_err</span><span class="p">,</span> <span class="n">xy_err</span><span class="p">,</span> <span class="n">ori_err</span> <span class="o">=</span> \
<span class="gp">... </span>    <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">test_homog_errors</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="s1">&#39;scale_err, xy_err, ori_err&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># we only care about checking out scale and orientation here. ignore bad xy points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_inliers_flag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">less</span><span class="p">(</span><span class="n">xy_err</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_err</span><span class="p">[</span><span class="o">~</span><span class="n">xy_inliers_flag</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">fm_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scale_err</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="mi">10</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">fm_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scale_err</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="mi">10</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Exec sourcecode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1_m</span><span class="p">,</span> <span class="n">kpts2_m</span><span class="p">,</span> <span class="n">off_xy1_m</span><span class="p">,</span> <span class="n">off_xy1_mt</span><span class="p">,</span> <span class="n">dxy1_m</span><span class="p">,</span> <span class="n">dxy1_mt</span><span class="p">,</span> <span class="n">xy2_m</span><span class="p">,</span> <span class="n">xy1_m</span><span class="p">,</span> <span class="n">xy1_mt</span><span class="p">,</span> <span class="n">scale_err</span><span class="p">,</span> <span class="n">xy_err</span><span class="p">,</span> <span class="n">ori_err</span> <span class="o">=</span> \
<span class="gp">... </span>    <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">test_homog_errors</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="s1">&#39;kpts1_m, kpts2_m, off_xy1_m, off_xy1_mt, dxy1_m, dxy1_mt, xy2_m, xy1_m, xy1_mt, scale_err, xy_err, ori_err&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;orig points and offset point&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy1_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">off_xy1_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">LIGHT_BLUE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;transformed points and matching points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># first have to make corresponding offset points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use reference point for scale and orientation tests</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oris2_m</span>   <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_oris</span><span class="p">(</span><span class="n">kpts2_m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scales2_m</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_scales</span><span class="p">(</span><span class="n">kpts2_m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dxy2_m</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">oris2_m</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">oris2_m</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaled_dxy2_m</span> <span class="o">=</span> <span class="n">dxy2_m</span> <span class="o">*</span> <span class="n">scales2_m</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">off_xy2_m</span> <span class="o">=</span> <span class="n">xy2_m</span> <span class="o">+</span> <span class="n">scaled_dxy2_m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw transformed semgents</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy2_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">off_xy2_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">GREEN</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw corresponding matches semgents</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy1_mt</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">off_xy1_mt</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw matches between correspondences</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy1_mt</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">xy2_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ORANGE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#vt.get _xy_axis_extents(kpts1_m)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_sv.show_sv(rchip1, rchip2, kpts1, kpts2, fm, homog_tup=homog_tup)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.spatial_verification.testdata_matching_affine_inliers">
<span class="sig-prename descclassname"><span class="pre">vtool.spatial_verification.</span></span><span class="sig-name descname"><span class="pre">testdata_matching_affine_inliers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#testdata_matching_affine_inliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.spatial_verification.testdata_matching_affine_inliers" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.spatial_verification.testdata_matching_affine_inliers_normalized">
<span class="sig-prename descclassname"><span class="pre">vtool.spatial_verification.</span></span><span class="sig-name descname"><span class="pre">testdata_matching_affine_inliers_normalized</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#testdata_matching_affine_inliers_normalized"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.spatial_verification.testdata_matching_affine_inliers_normalized" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.spatial_verification.try_svd">
<span class="sig-prename descclassname"><span class="pre">vtool.spatial_verification.</span></span><span class="sig-name descname"><span class="pre">try_svd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#try_svd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.spatial_verification.try_svd" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.spatial_verification try_svd</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">build_lstsqrs_Mx9</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">USV</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">compute_uv</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">USV</span> <span class="o">=</span> <span class="n">try_svd</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">(</span><span class="n">wh_num</span><span class="o">=</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">build_lstsqrs_Mx9</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">USV</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">compute_uv</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">USV</span> <span class="o">=</span> <span class="n">try_svd</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.spatial_verification.unnormalize_transform">
<span class="sig-prename descclassname"><span class="pre">vtool.spatial_verification.</span></span><span class="sig-name descname"><span class="pre">unnormalize_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M_prime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#unnormalize_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.spatial_verification.unnormalize_transform" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool.sver_c_wrapper">
<span id="vtool-sver-c-wrapper-module"></span><h2>vtool.sver_c_wrapper module<a class="headerlink" href="#module-vtool.sver_c_wrapper" title="Permalink to this headline"></a></h2>
<p>wraps c implementations slower parts of spatial verification</p>
<dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.sver_c_wrapper –rebuild-sver
python -m vtool.sver_c_wrapper –rebuild-sver –allexamples
python -m vtool.sver_c_wrapper –allexamples</p>
<p>python -m vtool.sver_c_wrapper –test-test_sver_wrapper –rebuild-sver</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.sver_c_wrapper.c_double_p">
<span class="sig-prename descclassname"><span class="pre">vtool.sver_c_wrapper.</span></span><span class="sig-name descname"><span class="pre">c_double_p</span></span><a class="headerlink" href="#vtool.sver_c_wrapper.c_double_p" title="Permalink to this definition"></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">vtool.sver_c_wrapper.LP_c_double</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.sver_c_wrapper.call_hello">
<span class="sig-prename descclassname"><span class="pre">vtool.sver_c_wrapper.</span></span><span class="sig-name descname"><span class="pre">call_hello</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#call_hello"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.sver_c_wrapper.call_hello" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.sver_c_wrapper.errs_t">
<span class="sig-prename descclassname"><span class="pre">vtool.sver_c_wrapper.</span></span><span class="sig-name descname"><span class="pre">errs_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#errs_t"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.sver_c_wrapper.errs_t" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.sver_c_wrapper.get_affine_inliers_cpp">
<span class="sig-prename descclassname"><span class="pre">vtool.sver_c_wrapper.</span></span><span class="sig-name descname"><span class="pre">get_affine_inliers_cpp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_thresh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#get_affine_inliers_cpp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.sver_c_wrapper.get_affine_inliers_cpp" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.sver_c_wrapper.get_best_affine_inliers_cpp">
<span class="sig-prename descclassname"><span class="pre">vtool.sver_c_wrapper.</span></span><span class="sig-name descname"><span class="pre">get_best_affine_inliers_cpp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_thresh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#get_best_affine_inliers_cpp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.sver_c_wrapper.get_best_affine_inliers_cpp" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.sver_c_wrapper.inliers_t">
<span class="sig-prename descclassname"><span class="pre">vtool.sver_c_wrapper.</span></span><span class="sig-name descname"><span class="pre">inliers_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#inliers_t"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.sver_c_wrapper.inliers_t" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.sver_c_wrapper.mats_t">
<span class="sig-prename descclassname"><span class="pre">vtool.sver_c_wrapper.</span></span><span class="sig-name descname"><span class="pre">mats_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#mats_t"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.sver_c_wrapper.mats_t" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool.symbolic">
<span id="vtool-symbolic-module"></span><h2>vtool.symbolic module<a class="headerlink" href="#module-vtool.symbolic" title="Permalink to this headline"></a></h2>
<p>Sympy helpers</p>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.symbolic.check_expr_eq">
<span class="sig-prename descclassname"><span class="pre">vtool.symbolic.</span></span><span class="sig-name descname"><span class="pre">check_expr_eq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#check_expr_eq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.symbolic.check_expr_eq" title="Permalink to this definition"></a></dt>
<dd><p>Does not work in general. Problem is not decidable.
Thanks Richard.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expr1</strong> – </p></li>
<li><p><strong>expr2</strong> – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.symbolic –test-check_expr_eq</p>
</dd>
<dt>SeeALso:</dt><dd><p>vt.symbolic_randcheck</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.symbolic</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span> <span class="p">[</span><span class="n">sx</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">tx</span> <span class="o">+</span> <span class="n">w1</span><span class="o">*</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">sy</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">ty</span> <span class="o">+</span> <span class="n">w2</span><span class="o">*</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span> <span class="p">[</span><span class="n">sx</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">tx</span> <span class="o">+</span> <span class="n">w1</span><span class="o">*</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">sy</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">ty</span> <span class="o">+</span> <span class="n">w2</span><span class="o">*</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">check_expr_eq</span><span class="p">(</span><span class="n">expr1</span><span class="p">,</span> <span class="n">expr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.symbolic.custom_sympy_attrs">
<span class="sig-prename descclassname"><span class="pre">vtool.symbolic.</span></span><span class="sig-name descname"><span class="pre">custom_sympy_attrs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#custom_sympy_attrs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.symbolic.custom_sympy_attrs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.symbolic.evalprint">
<span class="sig-prename descclassname"><span class="pre">vtool.symbolic.</span></span><span class="sig-name descname"><span class="pre">evalprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">str_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">globals_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locals_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#evalprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.symbolic.evalprint" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.symbolic.symbolic_randcheck">
<span class="sig-prename descclassname"><span class="pre">vtool.symbolic.</span></span><span class="sig-name descname"><span class="pre">symbolic_randcheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#symbolic_randcheck"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.symbolic.symbolic_randcheck" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.symbolic.sympy_latex_repr">
<span class="sig-prename descclassname"><span class="pre">vtool.symbolic.</span></span><span class="sig-name descname"><span class="pre">sympy_latex_repr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#sympy_latex_repr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.symbolic.sympy_latex_repr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.symbolic.sympy_mat">
<span class="sig-prename descclassname"><span class="pre">vtool.symbolic.</span></span><span class="sig-name descname"><span class="pre">sympy_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#sympy_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.symbolic.sympy_mat" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.symbolic.sympy_numpy_repr">
<span class="sig-prename descclassname"><span class="pre">vtool.symbolic.</span></span><span class="sig-name descname"><span class="pre">sympy_numpy_repr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#sympy_numpy_repr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.symbolic.sympy_numpy_repr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-vtool.trig">
<span id="vtool-trig-module"></span><h2>vtool.trig module<a class="headerlink" href="#module-vtool.trig" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.trig.atan2">
<span class="sig-prename descclassname"><span class="pre">vtool.trig.</span></span><span class="sig-name descname"><span class="pre">atan2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/trig.html#atan2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.trig.atan2" title="Permalink to this definition"></a></dt>
<dd><p>does atan2 but returns from 0 to TAU</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.trig</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">theta</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">theta</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">ub</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;6bfc86a2e94dd2dafbf501035719a7873d57f5f8e9cde88c4ccc35e98bb9e7b82abf6230803a923be7060866d66b8ac567388803593f9b7c763163a24282442a&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;90fe55311562f1c3ae451d5c4f27573259fed96752a5bd03f0f1216b46cf5b4b48024dcc744bfc6df7e6f8d6eb2a2a4b31b9f5ca75c0064b37acd09303811d76&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-vtool.util_math">
<span id="vtool-util-math-module"></span><h2>vtool.util_math module<a class="headerlink" href="#module-vtool.util_math" title="Permalink to this headline"></a></h2>
<p># LICENCE Apache 2 or whatever</p>
<p>FIXME: monotization functions need more hueristics</p>
<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.beaton_tukey_loss">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">beaton_tukey_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#beaton_tukey_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.beaton_tukey_loss" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia.plottool.draw_func2 –exec-plot_func –show –range=-8,8 –func=vt.beaton_tukey_weight,vt.beaton_tukey_loss</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Steward_Robust%20parameter%20estimation%20in%20computer%20vision.pdf</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.beaton_tukey_weight">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">beaton_tukey_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#beaton_tukey_weight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.beaton_tukey_weight" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia.plottool.draw_func2 –exec-plot_func –show –range=-8,8 –func=vt.beaton_tukey_weight</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Steward_Robust%20parameter%20estimation%20in%20computer%20vision.pdf</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.breakup_equal_streak">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">breakup_equal_streak</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#breakup_equal_streak"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.breakup_equal_streak" title="Permalink to this definition"></a></dt>
<dd><p>Breaks up streaks of equal values by interpolating between the next lowest and next highest value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr_in</strong> – </p></li>
<li><p><strong>left_endpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>right_endpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>arr -</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –exec-breakup_equal_streak
python -m vtool.util_math –test-ensure_monotone_strictly_increasing –show –offset=0</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">1.20488135</span><span class="p">,</span>  <span class="mf">1.2529297</span> <span class="p">,</span>  <span class="mf">1.27306686</span><span class="p">,</span>  <span class="mf">1.29859663</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="mf">1.31769871</span><span class="p">,</span> <span class="mf">1.37102388</span><span class="p">,</span>  <span class="mf">1.38114004</span><span class="p">,</span>  <span class="mf">1.45732054</span><span class="p">,</span>  <span class="mf">1.48119571</span><span class="p">,</span>  <span class="mf">1.48119571</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.5381895</span> <span class="p">,</span>  <span class="mf">1.54162741</span><span class="p">,</span>  <span class="mf">1.57492901</span><span class="p">,</span>  <span class="mf">1.61129523</span><span class="p">,</span>  <span class="mf">1.61129523</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.61270343</span><span class="p">,</span>  <span class="mf">1.63377551</span><span class="p">,</span>  <span class="mf">1.7423034</span> <span class="p">,</span>  <span class="mf">1.76364247</span><span class="p">,</span>  <span class="mf">1.79908459</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.83564709</span><span class="p">,</span>  <span class="mf">1.83819742</span><span class="p">,</span>  <span class="mf">1.83819742</span><span class="p">,</span>  <span class="mf">1.86786967</span><span class="p">,</span>  <span class="mf">1.86786967</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.90720142</span><span class="p">,</span>  <span class="mf">1.90720142</span><span class="p">,</span>  <span class="mf">1.92293973</span><span class="p">,</span>  <span class="mf">1.92293973</span><span class="p">,</span> <span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left_endpoint</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right_endpoint</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">breakup_equal_streak</span><span class="p">(</span><span class="n">arr_in</span><span class="p">,</span> <span class="n">left_endpoint</span><span class="p">,</span> <span class="n">right_endpoint</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_increasing</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;arr = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.ensure_monotone_decreasing">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">ensure_monotone_decreasing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fromleft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fromright</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#ensure_monotone_decreasing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.ensure_monotone_decreasing" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>ndarray</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>arr</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –test-ensure_monotone_decreasing –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_decreasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">fromright</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fromleft</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.ensure_monotone_increasing">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">ensure_monotone_increasing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fromright</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fromleft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#ensure_monotone_increasing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.ensure_monotone_increasing" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>ndarray</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>arr</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –test-ensure_monotone_increasing –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">argval</span><span class="p">(</span><span class="s1">&#39;--offset&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">2.3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">fromleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fromright</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (increasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.ensure_monotone_strictly_decreasing">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">ensure_monotone_strictly_decreasing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#ensure_monotone_strictly_decreasing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.ensure_monotone_strictly_decreasing" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>left_endpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – </p></li>
<li><p><strong>right_endpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>arr</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –test-ensure_monotone_strictly_decreasing –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">75</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.05</span> <span class="o">+</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#arr_ = vt.demodata.testdata_nonmonotonic()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#domain = np.arange(len(arr_))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left_endpoint</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right_endpoint</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_strictly_decreasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">left_endpoint</span><span class="p">,</span> <span class="n">right_endpoint</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_decreasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s1">&#39;ensure strict monotonic failed&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">ensure_monotone_decreasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (strictly decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.ensure_monotone_strictly_increasing">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">ensure_monotone_strictly_increasing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zerohack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onehack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#ensure_monotone_strictly_increasing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.ensure_monotone_strictly_increasing" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>ndarray</em>) – sequence to monotonize</p></li>
<li><p><strong>zerohack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – default False, if True sets the first element to be zero and linearlly interpolates to the first nonzero item</p></li>
<li><p><strong>onehack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – default False, if True one will not be in the resulting array (replaced with number very close to one)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://mathoverflow.net/questions/17464/making-a-non-monotone-function-monotone">http://mathoverflow.net/questions/17464/making-a-non-monotone-function-monotone</a>
<a class="reference external" href="http://stackoverflow.com/questions/28563711/make-a-numpy-array-monotonic-without-a-python-loop">http://stackoverflow.com/questions/28563711/make-a-numpy-array-monotonic-without-a-python-loop</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Isotonic_regression">https://en.wikipedia.org/wiki/Isotonic_regression</a>
<a class="reference external" href="http://scikit-learn.org/stable/auto_examples/plot_isotonic_regression.html">http://scikit-learn.org/stable/auto_examples/plot_isotonic_regression.html</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –test-ensure_monotone_strictly_increasing –show
python -m vtool.util_math –test-ensure_monotone_strictly_increasing –show –offset=0</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>   <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.91</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_strictly_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_increasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s1">&#39;ensure strict monotonic failed1&#39;</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left_endpoint</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right_endpoint</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--offset&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">2.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.1</span> <span class="o">+</span> <span class="mf">1.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#arr_ = vt.demodata.testdata_nonmonotonic()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#domain = np.arange(len(arr_))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_strictly_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">left_endpoint</span><span class="p">,</span> <span class="n">right_endpoint</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">arr</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">non_decreasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s1">&#39;ensure nondecreasing failed2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_increasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s1">&#39;ensure strict monotonic failed2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">ensure_monotone_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (strictly decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.gauss_func1d">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">gauss_func1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#gauss_func1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.gauss_func1d" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – </p></li>
<li><p><strong>mu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –test-gauss_func1d</p>
</dd>
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –test-gauss_func1d –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussval</span> <span class="o">=</span> <span class="n">gauss_func1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_repr</span><span class="p">(</span><span class="n">gaussval</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gaussval</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">array([ 0.05,  0.24,  0.35,  0.4 ,  0.35,  0.24,  0.05])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.gauss_func1d_unnormalized">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">gauss_func1d_unnormalized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#gauss_func1d_unnormalized"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.gauss_func1d_unnormalized" title="Permalink to this definition"></a></dt>
<dd><p>faster version of gauss_func1d with no normalization. So the maximum point
will have a value of 1.0</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –test-gauss_func1d_unnormalized –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussval</span> <span class="o">=</span> <span class="n">gauss_func1d_unnormalized</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_repr</span><span class="p">(</span><span class="n">gaussval</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gaussval</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">array([ 0.05,  0.24,  0.35,  0.4 ,  0.35,  0.24,  0.05])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.gauss_parzen_est">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">gauss_parzen_est</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.38</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#gauss_parzen_est"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.gauss_parzen_est" title="Permalink to this definition"></a></dt>
<dd><p>python -m wbia.plottool.draw_func2 –exec-plot_func –show –range=-.2,.2 –func=vt.gauss_parzen_est
python -m wbia.plottool.draw_func2 –exec-plot_func –show –range=0,1 –func=vt.gauss_parzen_est</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.group_consecutive">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">group_consecutive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#group_consecutive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.group_consecutive" title="Permalink to this definition"></a></dt>
<dd><p>Returns lists of consecutive values</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/7352684/how-to-find-the-groups-of-consecutive-elements-from-an-array-in-numpy">http://stackoverflow.com/questions/7352684/how-to-find-the-groups-of-consecutive-elements-from-an-array-in-numpy</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>ndarray</em>) – must be integral and unique</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>arr -</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –exec-group_consecutive</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groups</span> <span class="o">=</span> <span class="n">group_consecutive</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;groups = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">groups</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">groups = [array([1, 2, 3]), array([ 5,  6,  7,  8,  9, 10]), array([15]), array([ 99, 100, 101])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.iceil">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">iceil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.int32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#iceil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.iceil" title="Permalink to this definition"></a></dt>
<dd><p>Integer ceiling. (because numpy doesn’t seem to have it!)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>num</strong> (<em>ndarray</em><em> or </em><em>scalar</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray or scalar</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –test-iceil</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">iceil</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">iceil</span><span class="p">(</span><span class="n">num</span><span class="p">),</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([2, 3], dtype=np.int32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.interpolate_nans">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">interpolate_nans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#interpolate_nans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.interpolate_nans" title="Permalink to this definition"></a></dt>
<dd><p>replaces nans with interpolated values or 0</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>ndarray</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new_arr</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –exec-interpolate_nans</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_arr</span> <span class="o">=</span> <span class="n">interpolate_nans</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;new_arr = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">new_arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">new_arr = [ 0.  0.  0.  0.]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_arr</span> <span class="o">=</span> <span class="n">interpolate_nans</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;new_arr = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">new_arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">new_arr = [  1.    1.    2.8   4.6   6.4   8.2  10.    7.5   5. ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.iround">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">iround</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.int32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#iround"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.iround" title="Permalink to this definition"></a></dt>
<dd><p>Integer round. (because numpy doesn’t seem to have it!)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.logistic_01">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">logistic_01</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#logistic_01"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.logistic_01" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – </p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –exec-logistic_01 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">logistic_01</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.logit">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">logit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#logit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.logit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.non_decreasing">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">non_decreasing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#non_decreasing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.non_decreasing" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.non_increasing">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">non_increasing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#non_increasing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.non_increasing" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.strictly_decreasing">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">strictly_decreasing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#strictly_decreasing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.strictly_decreasing" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.strictly_increasing">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">strictly_increasing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#strictly_increasing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.strictly_increasing" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.util_math.test_language_modulus">
<span class="sig-prename descclassname"><span class="pre">vtool.util_math.</span></span><span class="sig-name descname"><span class="pre">test_language_modulus</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#test_language_modulus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.util_math.test_language_modulus" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Modulo_operation">http://en.wikipedia.org/wiki/Modulo_operation</a></p>
</dd></dl>

</section>
<section id="module-vtool">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-vtool" title="Permalink to this headline"></a></h2>
<p>VTool - Computer vision tools</p>
<dl class="simple">
<dt>Autogenerate Command:</dt><dd><p>mkinit vtool -i</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">AnnotPairFeatInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">importances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Information class about feature dimensions of PairwiseMatch.</p>
<p class="rubric">Notes</p>
<p>Can be used to compute marginal importances over groups of features
used in the pairwise one-vs-one scoring algorithm</p>
<p>Can be used to construct an appropriate cfgdict for a new
PairwiseMatch.</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.matching AnnotPairFeatInfo</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">({})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">add_global_measures</span><span class="p">([</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;gps&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;aid1&#39;</span><span class="p">,</span> <span class="s1">&#39;aid2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Feat info without bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">make_feature_vector</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">featinfo</span> <span class="o">=</span> <span class="n">AnnotPairFeatInfo</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pairfeat_cfg</span><span class="p">,</span> <span class="n">global_keys</span> <span class="o">=</span> <span class="n">featinfo</span><span class="o">.</span><span class="n">make_pairfeat_cfg</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pairfeat_cfg = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pairfeat_cfg</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;global_keys = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">global_keys</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;delta&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">global_keys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;max&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">global_keys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">cprint</span><span class="p">(</span><span class="n">featinfo</span><span class="o">.</span><span class="n">get_infostr</span><span class="p">(),</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Feat info with bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">make_feature_vector</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mf">.7</span><span class="p">,</span> <span class="mf">.8</span><span class="p">],</span> <span class="n">bin_key</span><span class="o">=</span><span class="s1">&#39;ratio&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">featinfo</span> <span class="o">=</span> <span class="n">AnnotPairFeatInfo</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pairfeat_cfg</span><span class="p">,</span> <span class="n">global_keys</span> <span class="o">=</span> <span class="n">featinfo</span><span class="o">.</span><span class="n">make_pairfeat_cfg</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pairfeat_cfg = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr4</span><span class="p">(</span><span class="n">pairfeat_cfg</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;global_keys = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">global_keys</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">cprint</span><span class="p">(</span><span class="n">featinfo</span><span class="o">.</span><span class="n">get_infostr</span><span class="p">(),</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.binsum_fmt">
<span class="sig-name descname"><span class="pre">binsum_fmt</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'{op}({measure}[{bin_key}&lt;{binval}])'</span></em><a class="headerlink" href="#vtool.AnnotPairFeatInfo.binsum_fmt" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.dimkey_grammar">
<span class="sig-name descname"><span class="pre">dimkey_grammar</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.dimkey_grammar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.dimkey_grammar" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.matching AnnotPairFeatInfo.dimkey_grammar</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">({})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">add_global_measures</span><span class="p">([</span><span class="s1">&#39;view&#39;</span><span class="p">,</span> <span class="s1">&#39;qual&#39;</span><span class="p">,</span> <span class="s1">&#39;gps&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;aid1&#39;</span><span class="p">,</span> <span class="s1">&#39;aid2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Feat info without bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">make_feature_vector</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">featinfo</span> <span class="o">=</span> <span class="n">AnnotPairFeatInfo</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat_grammar</span> <span class="o">=</span> <span class="n">featinfo</span><span class="o">.</span><span class="n">dimkey_grammar</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">feat_grammar</span><span class="o">.</span><span class="n">parseString</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.feature">
<span class="sig-name descname"><span class="pre">feature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.feature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.feature" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.find">
<span class="sig-name descname"><span class="pre">find</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.find"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.find" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>groupid options:</dt><dd><p>measure_type global_measure, local_sorter, local_rank,
local_measure, summary_measure, summary_op, summary_bin,
summary_binval, summary_binkey,</p>
</dd>
<dt>Ignore:</dt><dd><p>group_id = ‘summary_op’
op = ‘==’
value = ‘len’</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.get_infostr">
<span class="sig-name descname"><span class="pre">get_infostr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.get_infostr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.get_infostr" title="Permalink to this definition"></a></dt>
<dd><p>Summarizes the types (global, local, summary) of features in X based on
standardized dimension names.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.global_measure">
<span class="sig-name descname"><span class="pre">global_measure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.global_measure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.global_measure" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.group_counts">
<span class="sig-name descname"><span class="pre">group_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.group_counts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.group_counts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.group_importance">
<span class="sig-name descname"><span class="pre">group_importance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.group_importance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.group_importance" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.loc_fmt">
<span class="sig-name descname"><span class="pre">loc_fmt</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'loc[{sorter},{rank}]({measure})'</span></em><a class="headerlink" href="#vtool.AnnotPairFeatInfo.loc_fmt" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.local_measure">
<span class="sig-name descname"><span class="pre">local_measure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.local_measure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.local_measure" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.local_rank">
<span class="sig-name descname"><span class="pre">local_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.local_rank"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.local_rank" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.local_sorter">
<span class="sig-name descname"><span class="pre">local_sorter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.local_sorter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.local_sorter" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.make_pairfeat_cfg">
<span class="sig-name descname"><span class="pre">make_pairfeat_cfg</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.make_pairfeat_cfg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.make_pairfeat_cfg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.measure">
<span class="sig-name descname"><span class="pre">measure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.measure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.measure" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.measure_type">
<span class="sig-name descname"><span class="pre">measure_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.measure_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.measure_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.print_counts">
<span class="sig-name descname"><span class="pre">print_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.print_counts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.print_counts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.print_margins">
<span class="sig-name descname"><span class="pre">print_margins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_trivial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.print_margins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.print_margins" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vtool.AnnotPairFeatInfo.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.select_columns">
<span class="sig-name descname"><span class="pre">select_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'and'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.select_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.select_columns" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>criteria</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of tokens denoting selection constraints
can be one of:
measure_type global_measure, local_sorter, local_rank,
local_measure, summary_measure, summary_op, summary_bin,
summary_binval, summary_binkey,</p>
</dd>
</dl>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">featinfo</span><span class="o">.</span><span class="n">select_columns</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;measure_type&#39;</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;local&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s1">&#39;local_sorter&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;weighted_ratio_score&#39;</span><span class="p">,</span> <span class="s1">&#39;lnbnn_norm_dist&#39;</span><span class="p">]),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">],</span> <span class="n">op</span><span class="o">=</span><span class="s1">&#39;and&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.sum_fmt">
<span class="sig-name descname"><span class="pre">sum_fmt</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'{op}({measure})'</span></em><a class="headerlink" href="#vtool.AnnotPairFeatInfo.sum_fmt" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.summary_binkey">
<span class="sig-name descname"><span class="pre">summary_binkey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.summary_binkey"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.summary_binkey" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.summary_binval">
<span class="sig-name descname"><span class="pre">summary_binval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.summary_binval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.summary_binval" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.summary_measure">
<span class="sig-name descname"><span class="pre">summary_measure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.summary_measure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.summary_measure" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnotPairFeatInfo.summary_op">
<span class="sig-name descname"><span class="pre">summary_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#AnnotPairFeatInfo.summary_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnotPairFeatInfo.summary_op" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtool.AnnoyWraper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">AnnoyWraper</span></span><a class="reference internal" href="_modules/vtool/clustering2.html#AnnoyWraper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnoyWraper" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>flann-like interface to annnoy</p>
<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnoyWraper.build_annoy">
<span class="sig-name descname"><span class="pre">build_annoy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centroids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#AnnoyWraper.build_annoy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnoyWraper.build_annoy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnoyWraper.nn">
<span class="sig-name descname"><span class="pre">nn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_vecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_vecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#AnnoyWraper.nn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnoyWraper.nn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnoyWraper.query_annoy">
<span class="sig-name descname"><span class="pre">query_annoy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_vecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#AnnoyWraper.query_annoy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnoyWraper.query_annoy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtool.AnnoyWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">AnnoyWrapper</span></span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#AnnoyWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnoyWrapper" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Wrapper for annoy to use the FLANN api</p>
<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnoyWrapper.build_index">
<span class="sig-name descname"><span class="pre">build_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dvecs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#AnnoyWrapper.build_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnoyWrapper.build_index" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.AnnoyWrapper.nn_index">
<span class="sig-name descname"><span class="pre">nn_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qvecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_neighbs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#AnnoyWrapper.nn_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.AnnoyWrapper.nn_index" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtool.AssignTup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">AssignTup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_fx1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_dist</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vtool.AssignTup" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.AssignTup.fm">
<span class="sig-name descname"><span class="pre">fm</span></span><a class="headerlink" href="#vtool.AssignTup.fm" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.AssignTup.match_dist">
<span class="sig-name descname"><span class="pre">match_dist</span></span><a class="headerlink" href="#vtool.AssignTup.match_dist" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.AssignTup.norm_dist">
<span class="sig-name descname"><span class="pre">norm_dist</span></span><a class="headerlink" href="#vtool.AssignTup.norm_dist" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.AssignTup.norm_fx1">
<span class="sig-name descname"><span class="pre">norm_fx1</span></span><a class="headerlink" href="#vtool.AssignTup.norm_fx1" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ConfusionMetrics</span></span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ConfusionMetrics" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ubelt.util_mixins.NiceRepr</span></code></p>
<p>Can compute average percision using the PASCAL definition</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://www.flinders.edu.au/science_engineering/fms/School-CSEM/publications/tech_reps-research_artfcts/TRRA_2007.pdf">http://www.flinders.edu.au/science_engineering/fms/School-CSEM/publications/tech_reps-research_artfcts/TRRA_2007.pdf</a>
<a class="reference external" href="http://www.alta.asn.au/events/altss_w2003_proc/altss/courses/powers/Bookmaker-all/200302-ICCS-Bookmaker.pdfcs">http://www.alta.asn.au/events/altss_w2003_proc/altss/courses/powers/Bookmaker-all/200302-ICCS-Bookmaker.pdfcs</a>
<a class="reference external" href="http://www.cs.bris.ac.uk/Publications/Papers/1000704.pdf">http://www.cs.bris.ac.uk/Publications/Papers/1000704.pdf</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Information_retrieval">http://en.wikipedia.org/wiki/Information_retrieval</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Precision_and_recall">http://en.wikipedia.org/wiki/Precision_and_recall</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Confusion_matrix">https://en.wikipedia.org/wiki/Confusion_matrix</a>
<a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_curve.html#sklearn.metrics.roc_curve">http://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_curve.html#sklearn.metrics.roc_curve</a></p>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>sklearn.metrics.ranking._binary_clf_curve</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>From oxford:
Precision is defined as the ratio of retrieved positive images to the
total number retrieved.
Recall is defined as the ratio of the number of retrieved positive
images to the total number of positive images in the corpus.</p>
<dl class="simple">
<dt>Ignore:</dt><dd><p>varname_list = ‘tp, fp, fn, tn, fpr, tpr, tpa’.split(’, ‘)
lines = [‘self.{varname} = {varname}’.format(varname=varname) for varname in varname_list]
print(ut.indent(’n’.join(lines)))</p>
</dd>
<dt>CommandLine:</dt><dd><p>python -m vtool.confusion ConfusionMetrics –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">=</span> <span class="n">confusions</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">n_pos</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">n_tp</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">n_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">n_neg</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">n_tn</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">n_fp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">rp</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">rn</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">pp</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">pn</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">fpr</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">tnr</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">fnr</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">tpr</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tpr</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">tp</span> <span class="o">/</span> <span class="n">c</span><span class="o">.</span><span class="n">rp</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tpa</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">tp</span> <span class="o">/</span> <span class="n">c</span><span class="o">.</span><span class="n">pp</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">jacc</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">tp</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tp</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">fn</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">fp</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">mcc</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">mk</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="n">bm</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">c</span><span class="o">.</span><span class="n">acc</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tpr</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">fpr</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">c</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ppv</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">recall</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="n">prev</span> <span class="o">/</span> <span class="n">c</span><span class="o">.</span><span class="n">bias</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">c</span><span class="o">.</span><span class="n">wracc</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">tpr</span> <span class="o">-</span> <span class="n">c</span><span class="o">.</span><span class="n">fpr</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span><span class="o">.</span><span class="n">draw_roc_curve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.acc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">acc</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.acc" title="Permalink to this definition"></a></dt>
<dd><p>accuracy</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.aliases">
<span class="sig-name descname"><span class="pre">aliases</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'acc':</span> <span class="pre">{'accuracy',</span> <span class="pre">'rand_accuracy',</span> <span class="pre">'tea',</span> <span class="pre">'ter'},</span> <span class="pre">'bm':</span> <span class="pre">{'bookmaker_informedness',</span> <span class="pre">&quot;deltaP'&quot;,</span> <span class="pre">'informedness',</span> <span class="pre">'r_R'},</span> <span class="pre">'cn':</span> <span class="pre">{'cost_neg'},</span> <span class="pre">'cp':</span> <span class="pre">{'cost_pos'},</span> <span class="pre">'cs':</span> <span class="pre">{'class_odds',</span> <span class="pre">'skew'},</span> <span class="pre">'cv':</span> <span class="pre">{'cost_ratio'},</span> <span class="pre">'fn':</span> <span class="pre">{'false_neg',</span> <span class="pre">'miss',</span> <span class="pre">'type2_error'},</span> <span class="pre">'fnr':</span> <span class="pre">{'false_neg_rate',</span> <span class="pre">'miss_rate'},</span> <span class="pre">'fp':</span> <span class="pre">{'false_alarm',</span> <span class="pre">'false_pos',</span> <span class="pre">'type1_error'},</span> <span class="pre">'fpr':</span> <span class="pre">{'fallout',</span> <span class="pre">'false_pos_rate'},</span> <span class="pre">'jacc':</span> <span class="pre">{'jaccard_coefficient'},</span> <span class="pre">'mcc':</span> <span class="pre">{'matthews_correlation_coefficient'},</span> <span class="pre">'mk':</span> <span class="pre">{'deltaP',</span> <span class="pre">'markedness',</span> <span class="pre">'r_P'},</span> <span class="pre">'n_fn':</span> <span class="pre">{'n_false_neg',</span> <span class="pre">'n_miss'},</span> <span class="pre">'n_fp':</span> <span class="pre">{'n_false_alarm',</span> <span class="pre">'n_false_pos'},</span> <span class="pre">'n_tn':</span> <span class="pre">{'n_reject',</span> <span class="pre">'n_true_neg'},</span> <span class="pre">'n_tp':</span> <span class="pre">{'n_hit',</span> <span class="pre">'n_true_pos'},</span> <span class="pre">'pn':</span> <span class="pre">{'pred_neg'},</span> <span class="pre">'pp':</span> <span class="pre">{'bias',</span> <span class="pre">'pred_pos'},</span> <span class="pre">'rn':</span> <span class="pre">{'real_neg'},</span> <span class="pre">'rp':</span> <span class="pre">{'prev',</span> <span class="pre">'prevalence',</span> <span class="pre">'real_pos'},</span> <span class="pre">'tn':</span> <span class="pre">{'reject',</span> <span class="pre">'true_neg'},</span> <span class="pre">'tna':</span> <span class="pre">{'inv_precision',</span> <span class="pre">'neg_predict_value',</span> <span class="pre">'npv',</span> <span class="pre">'true_neg_acc'},</span> <span class="pre">'tnr':</span> <span class="pre">{'inv_recall,</span> <span class="pre">specificity',</span> <span class="pre">'true_neg_rate'},</span> <span class="pre">'tp':</span> <span class="pre">{'hit',</span> <span class="pre">'true_pos'},</span> <span class="pre">'tpa':</span> <span class="pre">{'pos_predict_value',</span> <span class="pre">'ppv',</span> <span class="pre">'precision',</span> <span class="pre">'true_pos_acc'},</span> <span class="pre">'tpr':</span> <span class="pre">{'hit_rate',</span> <span class="pre">'recall',</span> <span class="pre">'sensitivity',</span> <span class="pre">'true_pos_rate'},</span> <span class="pre">'wracc':</span> <span class="pre">{'weighted_relative_accuracy'}}</span></em><a class="headerlink" href="#vtool.ConfusionMetrics.aliases" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.auc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">auc</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.auc" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>The AUC is a standard measure used to evaluate a binary classifier and</dt><dd><p>represents the probability that a random correct case will
receive a higher score than a random incorrect case.</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic#Area_under_the_curve">https://en.wikipedia.org/wiki/Receiver_operating_characteristic#Area_under_the_curve</a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.auc_trap">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">auc_trap</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.auc_trap" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.bm">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bm</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.bm" title="Permalink to this definition"></a></dt>
<dd><p>bookmaker informedness</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.c">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">c</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.c" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.cs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cs</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.cs" title="Permalink to this definition"></a></dt>
<dd><p>class ratio</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.cv">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cv</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.cv" title="Permalink to this definition"></a></dt>
<dd><p>ratio of cost of making a mistake</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.draw_precision_recall_curve">
<span class="sig-name descname"><span class="pre">draw_precision_recall_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nSamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.draw_precision_recall_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ConfusionMetrics.draw_precision_recall_curve" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.draw_roc_curve">
<span class="sig-name descname"><span class="pre">draw_roc_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.draw_roc_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ConfusionMetrics.draw_roc_curve" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ConfusionMetrics.fit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.fn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fn</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.fn" title="Permalink to this definition"></a></dt>
<dd><p>false negative probability</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.fnr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fnr</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.fnr" title="Permalink to this definition"></a></dt>
<dd><p>miss rate, false negative rate</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.fp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fp</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.fp" title="Permalink to this definition"></a></dt>
<dd><p>false positive probability</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.fpr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fpr</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.fpr" title="Permalink to this definition"></a></dt>
<dd><p>fallout, false positive rate</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.from_tp_and_tn_scores">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_tp_and_tn_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tp_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.from_tp_and_tn_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ConfusionMetrics.from_tp_and_tn_scores" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.get_ave_precision">
<span class="sig-name descname"><span class="pre">get_ave_precision</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_ave_precision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ConfusionMetrics.get_ave_precision" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.get_fpr_at_recall">
<span class="sig-name descname"><span class="pre">get_fpr_at_recall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_recall</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_fpr_at_recall"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ConfusionMetrics.get_fpr_at_recall" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.get_index_at_metric">
<span class="sig-name descname"><span class="pre">get_index_at_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">at_metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">at_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subindex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tiebreaker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'maxthresh'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_index_at_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ConfusionMetrics.get_index_at_metric" title="Permalink to this definition"></a></dt>
<dd><p>Finds the index that is closet to the metric at a given value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tiebreaker</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – either ‘minimize’ or ‘maximize’
if ‘maximize’, then a larger threshold is considered better
when resolving ambiguities. Otherwise a smaller thresh is
better.</p>
</dd>
</dl>
<dl>
<dt>Doctest:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pat1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pat2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pat3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pat4</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pats</span> <span class="o">=</span> <span class="p">[</span><span class="n">pat1</span><span class="p">,</span> <span class="n">pat2</span><span class="p">,</span> <span class="n">pat3</span><span class="p">,</span> <span class="n">pat4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">itertools</span> <span class="k">as</span> <span class="nn">it</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create places of ambiguitiy and unambiguity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">flatten</span><span class="p">([[</span><span class="nb">next</span><span class="p">(</span><span class="n">s</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">pat</span><span class="p">)</span> <span class="k">for</span> <span class="n">pat</span> <span class="ow">in</span> <span class="n">pats</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">flatten</span><span class="p">([</span><span class="n">pat</span> <span class="k">for</span> <span class="n">pat</span> <span class="ow">in</span> <span class="n">pats</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">at_metric</span> <span class="o">=</span> <span class="s1">&#39;n_false_pos&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">at_value</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subindex</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index_at_metric</span><span class="p">(</span><span class="n">at_metric</span><span class="p">,</span> <span class="n">at_value</span><span class="p">,</span> <span class="n">subindex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tiebreaker</span><span class="o">=</span><span class="s1">&#39;minthresh&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index_at_metric</span><span class="p">(</span><span class="n">at_metric</span><span class="p">,</span> <span class="n">at_value</span><span class="p">,</span> <span class="n">subindex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tiebreaker</span><span class="o">=</span> <span class="s1">&#39;maxthresh&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">idx1</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">idx2</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.get_metric_at_index">
<span class="sig-name descname"><span class="pre">get_metric_at_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subindex</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_metric_at_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ConfusionMetrics.get_metric_at_index" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.get_metric_at_metric">
<span class="sig-name descname"><span class="pre">get_metric_at_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">get_metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">at_metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">at_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subindex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tiebreaker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'maxthresh'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_metric_at_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ConfusionMetrics.get_metric_at_metric" title="Permalink to this definition"></a></dt>
<dd><p>Finds the corresponding value of <cite>get_metric</cite> at a specific value of
<cite>at_metric</cite>.</p>
<p>get_metric = ‘fpr’
at_metric = ‘tpr’
at_value = .25
self.rrr()</p>
<p>self.get_metric_at_metric(‘fpr’, ‘tpr’, .25)
self.get_metric_at_metric(‘n_false_pos’, ‘tpr’, .25)
self.get_metric_at_metric(‘n_true_pos’, ‘tpr’, .25)</p>
<p>get_metric = ‘n_true_pos’
at_metric = ‘n_false_pos’
at_value = 0
subindex = False</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.get_metric_at_thresh">
<span class="sig-name descname"><span class="pre">get_metric_at_thresh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_metric_at_thresh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ConfusionMetrics.get_metric_at_thresh" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – name of a metric</p></li>
<li><p><strong>thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – desired threshold</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>value - metric value</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
<dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.confusion –exec-get_metric_at_threshold</p>
</dd>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">cfms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;fpr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;tpr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metric_at_thresh</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(None, None) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">((</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.get_recall_at_fpr">
<span class="sig-name descname"><span class="pre">get_recall_at_fpr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_fpr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_recall_at_fpr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ConfusionMetrics.get_recall_at_fpr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.get_thresh_at_metric">
<span class="sig-name descname"><span class="pre">get_thresh_at_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_thresh_at_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ConfusionMetrics.get_thresh_at_metric" title="Permalink to this definition"></a></dt>
<dd><p>Gets a threshold for a binary classifier using a target metric and value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – name of metric like tpr or fpr</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – corresponding numeric value</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>thresh</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.confusion get_thresh_at_metric
python -m vtool.confusion –exec-interact_roc_factory –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;tpr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="mf">.85</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_thresh_at_metric</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">value</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;thresh = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">thresh</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">thresh = 22.5</span>
</pre></div>
</div>
<dl class="simple">
<dt>Ignore:</dt><dd><p>metric = ‘fpr’
value = 1e-4
self = cfms
maximize = False</p>
</dd>
</dl>
<p>interpolate_replbounds(metric_values, self.thresholds, 0, maximize=maximize)
interpolate_replbounds(metric_values, self.thresholds, 1e-4, maximize=maximize)
interpolate_replbounds(metric_values, self.thresholds, 1e-3, maximize=maximize)
interpolate_replbounds(metric_values, self.thresholds, 1e-2, maximize=maximize)
interpolate_replbounds(metric_values, self.thresholds, 1e-2, maximize=maximize)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.get_thresh_at_metric_max">
<span class="sig-name descname"><span class="pre">get_thresh_at_metric_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_thresh_at_metric_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ConfusionMetrics.get_thresh_at_metric_max" title="Permalink to this definition"></a></dt>
<dd><p>metric = ‘mcc’
metric = ‘fnr’</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.inv_aliases">
<span class="sig-name descname"><span class="pre">inv_aliases</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'acc':</span> <span class="pre">'acc',</span> <span class="pre">'accuracy':</span> <span class="pre">'acc',</span> <span class="pre">'bias':</span> <span class="pre">'pp',</span> <span class="pre">'bm':</span> <span class="pre">'bm',</span> <span class="pre">'bookmaker_informedness':</span> <span class="pre">'bm',</span> <span class="pre">'class_odds':</span> <span class="pre">'cs',</span> <span class="pre">'cn':</span> <span class="pre">'cn',</span> <span class="pre">'cost_neg':</span> <span class="pre">'cn',</span> <span class="pre">'cost_pos':</span> <span class="pre">'cp',</span> <span class="pre">'cost_ratio':</span> <span class="pre">'cv',</span> <span class="pre">'cp':</span> <span class="pre">'cp',</span> <span class="pre">'cs':</span> <span class="pre">'cs',</span> <span class="pre">'cv':</span> <span class="pre">'cv',</span> <span class="pre">'deltaP':</span> <span class="pre">'mk',</span> <span class="pre">&quot;deltaP'&quot;:</span> <span class="pre">'bm',</span> <span class="pre">'fallout':</span> <span class="pre">'fpr',</span> <span class="pre">'false_alarm':</span> <span class="pre">'fp',</span> <span class="pre">'false_neg':</span> <span class="pre">'fn',</span> <span class="pre">'false_neg_rate':</span> <span class="pre">'fnr',</span> <span class="pre">'false_pos':</span> <span class="pre">'fp',</span> <span class="pre">'false_pos_rate':</span> <span class="pre">'fpr',</span> <span class="pre">'fn':</span> <span class="pre">'fn',</span> <span class="pre">'fnr':</span> <span class="pre">'fnr',</span> <span class="pre">'fp':</span> <span class="pre">'fp',</span> <span class="pre">'fpr':</span> <span class="pre">'fpr',</span> <span class="pre">'hit':</span> <span class="pre">'tp',</span> <span class="pre">'hit_rate':</span> <span class="pre">'tpr',</span> <span class="pre">'informedness':</span> <span class="pre">'bm',</span> <span class="pre">'inv_precision':</span> <span class="pre">'tna',</span> <span class="pre">'inv_recall,</span> <span class="pre">specificity':</span> <span class="pre">'tnr',</span> <span class="pre">'jacc':</span> <span class="pre">'jacc',</span> <span class="pre">'jaccard_coefficient':</span> <span class="pre">'jacc',</span> <span class="pre">'markedness':</span> <span class="pre">'mk',</span> <span class="pre">'matthews_correlation_coefficient':</span> <span class="pre">'mcc',</span> <span class="pre">'mcc':</span> <span class="pre">'mcc',</span> <span class="pre">'miss':</span> <span class="pre">'fn',</span> <span class="pre">'miss_rate':</span> <span class="pre">'fnr',</span> <span class="pre">'mk':</span> <span class="pre">'mk',</span> <span class="pre">'n_false_alarm':</span> <span class="pre">'n_fp',</span> <span class="pre">'n_false_neg':</span> <span class="pre">'n_fn',</span> <span class="pre">'n_false_pos':</span> <span class="pre">'n_fp',</span> <span class="pre">'n_fn':</span> <span class="pre">'n_fn',</span> <span class="pre">'n_fp':</span> <span class="pre">'n_fp',</span> <span class="pre">'n_hit':</span> <span class="pre">'n_tp',</span> <span class="pre">'n_miss':</span> <span class="pre">'n_fn',</span> <span class="pre">'n_reject':</span> <span class="pre">'n_tn',</span> <span class="pre">'n_tn':</span> <span class="pre">'n_tn',</span> <span class="pre">'n_tp':</span> <span class="pre">'n_tp',</span> <span class="pre">'n_true_neg':</span> <span class="pre">'n_tn',</span> <span class="pre">'n_true_pos':</span> <span class="pre">'n_tp',</span> <span class="pre">'neg_predict_value':</span> <span class="pre">'tna',</span> <span class="pre">'npv':</span> <span class="pre">'tna',</span> <span class="pre">'pn':</span> <span class="pre">'pn',</span> <span class="pre">'pos_predict_value':</span> <span class="pre">'tpa',</span> <span class="pre">'pp':</span> <span class="pre">'pp',</span> <span class="pre">'ppv':</span> <span class="pre">'tpa',</span> <span class="pre">'precision':</span> <span class="pre">'tpa',</span> <span class="pre">'pred_neg':</span> <span class="pre">'pn',</span> <span class="pre">'pred_pos':</span> <span class="pre">'pp',</span> <span class="pre">'prev':</span> <span class="pre">'rp',</span> <span class="pre">'prevalence':</span> <span class="pre">'rp',</span> <span class="pre">'r_P':</span> <span class="pre">'mk',</span> <span class="pre">'r_R':</span> <span class="pre">'bm',</span> <span class="pre">'rand_accuracy':</span> <span class="pre">'acc',</span> <span class="pre">'real_neg':</span> <span class="pre">'rn',</span> <span class="pre">'real_pos':</span> <span class="pre">'rp',</span> <span class="pre">'recall':</span> <span class="pre">'tpr',</span> <span class="pre">'reject':</span> <span class="pre">'tn',</span> <span class="pre">'rn':</span> <span class="pre">'rn',</span> <span class="pre">'rp':</span> <span class="pre">'rp',</span> <span class="pre">'sensitivity':</span> <span class="pre">'tpr',</span> <span class="pre">'skew':</span> <span class="pre">'cs',</span> <span class="pre">'tea':</span> <span class="pre">'acc',</span> <span class="pre">'ter':</span> <span class="pre">'acc',</span> <span class="pre">'tn':</span> <span class="pre">'tn',</span> <span class="pre">'tna':</span> <span class="pre">'tna',</span> <span class="pre">'tnr':</span> <span class="pre">'tnr',</span> <span class="pre">'tp':</span> <span class="pre">'tp',</span> <span class="pre">'tpa':</span> <span class="pre">'tpa',</span> <span class="pre">'tpr':</span> <span class="pre">'tpr',</span> <span class="pre">'true_neg':</span> <span class="pre">'tn',</span> <span class="pre">'true_neg_acc':</span> <span class="pre">'tna',</span> <span class="pre">'true_neg_rate':</span> <span class="pre">'tnr',</span> <span class="pre">'true_pos':</span> <span class="pre">'tp',</span> <span class="pre">'true_pos_acc':</span> <span class="pre">'tpa',</span> <span class="pre">'true_pos_rate':</span> <span class="pre">'tpr',</span> <span class="pre">'type1_error':</span> <span class="pre">'fp',</span> <span class="pre">'type2_error':</span> <span class="pre">'fn',</span> <span class="pre">'weighted_relative_accuracy':</span> <span class="pre">'wracc',</span> <span class="pre">'wracc':</span> <span class="pre">'wracc'}</span></em><a class="headerlink" href="#vtool.ConfusionMetrics.inv_aliases" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.jacc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">jacc</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.jacc" title="Permalink to this definition"></a></dt>
<dd><p>jaccard coefficient</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.mcc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mcc</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.mcc" title="Permalink to this definition"></a></dt>
<dd><p>matthews correlation coefficient</p>
<dl class="simple">
<dt>Also true that:</dt><dd><p>mcc == np.sqrt(self.bm * self.mk)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.minimizing_metrics">
<span class="sig-name descname"><span class="pre">minimizing_metrics</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'fn',</span> <span class="pre">'fnr',</span> <span class="pre">'fp',</span> <span class="pre">'fpr'}</span></em><a class="headerlink" href="#vtool.ConfusionMetrics.minimizing_metrics" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.mk">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mk</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.mk" title="Permalink to this definition"></a></dt>
<dd><p>markedness</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.paper_alias">
<span class="sig-name descname"><span class="pre">paper_alias</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[['dtp',</span> <span class="pre">'determinant'],</span> <span class="pre">['lr',</span> <span class="pre">'liklihood-ratio'],</span> <span class="pre">['nlr',</span> <span class="pre">'negative-liklihood-ratio'],</span> <span class="pre">['bmg',</span> <span class="pre">'bookmarkG',</span> <span class="pre">'bookmark_geometric_mean',</span> <span class="pre">'mcc?'],</span> <span class="pre">['evenness_R',</span> <span class="pre">'PrevG2'],</span> <span class="pre">['evenness_P',</span> <span class="pre">'BiasG2'],</span> <span class="pre">['rh',</span> <span class="pre">'real_harmonic_mean'],</span> <span class="pre">['ph',</span> <span class="pre">'pred_harminic_mean']]</span></em><a class="headerlink" href="#vtool.ConfusionMetrics.paper_alias" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.paper_relations">
<span class="sig-name descname"><span class="pre">paper_relations</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'BMG':</span> <span class="pre">['dtp</span> <span class="pre">/</span> <span class="pre">evenness_G'],</span> <span class="pre">'BiasG2':</span> <span class="pre">['bias</span> <span class="pre">*</span> <span class="pre">1</span> <span class="pre">-</span> <span class="pre">bias'],</span> <span class="pre">'IBias':</span> <span class="pre">['1</span> <span class="pre">-</span> <span class="pre">Bias'],</span> <span class="pre">'N':</span> <span class="pre">['A</span> <span class="pre">+</span> <span class="pre">B</span> <span class="pre">+</span> <span class="pre">C</span> <span class="pre">+</span> <span class="pre">D'],</span> <span class="pre">'bm':</span> <span class="pre">['dtp</span> <span class="pre">/</span> <span class="pre">(prev</span> <span class="pre">*</span> <span class="pre">(1</span> <span class="pre">-</span> <span class="pre">prev))'],</span> <span class="pre">'deltap':</span> <span class="pre">['dtp</span> <span class="pre">-</span> <span class="pre">dtn',</span> <span class="pre">'2</span> <span class="pre">*</span> <span class="pre">dp'],</span> <span class="pre">'dp':</span> <span class="pre">['tp</span> <span class="pre">-</span> <span class="pre">etp',</span> <span class="pre">'dtp',</span> <span class="pre">'-dtn',</span> <span class="pre">'-(tn</span> <span class="pre">-</span> <span class="pre">etn)'],</span> <span class="pre">'dtp':</span> <span class="pre">['A</span> <span class="pre">*</span> <span class="pre">D</span> <span class="pre">-</span> <span class="pre">B</span> <span class="pre">*</span> <span class="pre">C'],</span> <span class="pre">'etn':</span> <span class="pre">['rn</span> <span class="pre">*</span> <span class="pre">pn',</span> <span class="pre">'expected_true_negatives'],</span> <span class="pre">'etp':</span> <span class="pre">['rp</span> <span class="pre">*</span> <span class="pre">pp',</span> <span class="pre">'expected_true_positives'],</span> <span class="pre">'kappa':</span> <span class="pre">['deltap</span> <span class="pre">/</span> <span class="pre">(deltap</span> <span class="pre">+</span> <span class="pre">(fp</span> <span class="pre">+</span> <span class="pre">fn)</span> <span class="pre">/</span> <span class="pre">2)'],</span> <span class="pre">'lr':</span> <span class="pre">['tpr</span> <span class="pre">/</span> <span class="pre">(1</span> <span class="pre">-</span> <span class="pre">tnr)'],</span> <span class="pre">'mk':</span> <span class="pre">['dtp</span> <span class="pre">/</span> <span class="pre">(bias</span> <span class="pre">*</span> <span class="pre">(1</span> <span class="pre">-</span> <span class="pre">bias))',</span> <span class="pre">'dtp</span> <span class="pre">/</span> <span class="pre">biasG</span> <span class="pre">**</span> <span class="pre">2'],</span> <span class="pre">'nlr':</span> <span class="pre">['tnr</span> <span class="pre">/</span> <span class="pre">(1</span> <span class="pre">-</span> <span class="pre">tpr)'],</span> <span class="pre">'ph':</span> <span class="pre">['2</span> <span class="pre">*</span> <span class="pre">pp</span> <span class="pre">*</span> <span class="pre">pn</span> <span class="pre">/</span> <span class="pre">(pp</span> <span class="pre">+</span> <span class="pre">pn)',</span> <span class="pre">'pred_harminic_mean'],</span> <span class="pre">'rh':</span> <span class="pre">['2</span> <span class="pre">*</span> <span class="pre">rp</span> <span class="pre">*</span> <span class="pre">rn</span> <span class="pre">/</span> <span class="pre">(rp</span> <span class="pre">+</span> <span class="pre">rn)',</span> <span class="pre">'real_harmonic_mean']}</span></em><a class="headerlink" href="#vtool.ConfusionMetrics.paper_relations" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.plot_metrics">
<span class="sig-name descname"><span class="pre">plot_metrics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.plot_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ConfusionMetrics.plot_metrics" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.plot_vs">
<span class="sig-name descname"><span class="pre">plot_vs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_metric</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.plot_vs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ConfusionMetrics.plot_vs" title="Permalink to this definition"></a></dt>
<dd><p>x_metric = ‘thresholds’
y_metric = ‘fpr’</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.pn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pn</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.pn" title="Permalink to this definition"></a></dt>
<dd><p>predicted negative probability</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.pp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pp</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.pp" title="Permalink to this definition"></a></dt>
<dd><p>predicted positive probability</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.rn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rn</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.rn" title="Permalink to this definition"></a></dt>
<dd><p>real negative probability</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.rp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rp</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.rp" title="Permalink to this definition"></a></dt>
<dd><p>real positive probability</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.show_mcc">
<span class="sig-name descname"><span class="pre">show_mcc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.show_mcc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ConfusionMetrics.show_mcc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.sqrd_error">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sqrd_error</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.sqrd_error" title="Permalink to this definition"></a></dt>
<dd><p>squared error</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.thresh">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">thresh</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.thresh" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.tn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tn</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.tn" title="Permalink to this definition"></a></dt>
<dd><p>true negative probability</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.tna">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tna</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.tna" title="Permalink to this definition"></a></dt>
<dd><p>negative predictive value, inverse precision</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.tnr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tnr</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.tnr" title="Permalink to this definition"></a></dt>
<dd><p>true negative rate, inverse recall</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.tp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tp</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.tp" title="Permalink to this definition"></a></dt>
<dd><p>true positive probability</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.tpa">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tpa</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.tpa" title="Permalink to this definition"></a></dt>
<dd><p>miss rate, false negative rate</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.tpr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tpr</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.tpr" title="Permalink to this definition"></a></dt>
<dd><p>sensitivity, recall, hit rate, tpr</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtool.ConfusionMetrics.wracc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wracc</span></span><a class="headerlink" href="#vtool.ConfusionMetrics.wracc" title="Permalink to this definition"></a></dt>
<dd><p>weighted relative accuracy</p>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.DEFAULT_DTYPE">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">DEFAULT_DTYPE</span></span><a class="headerlink" href="#vtool.DEFAULT_DTYPE" title="Permalink to this definition"></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.float32</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.GaussianBlurInplace">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">GaussianBlurInplace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#GaussianBlurInplace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.GaussianBlurInplace" title="Permalink to this definition"></a></dt>
<dd><p>simulates code from helpers.cpp in hesaff</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>sigma</strong> (<em>flaot</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-GaussianBlurInplace:0 –show
python -m vtool.patch –test-GaussianBlurInplace:1 –show</p>
</dd>
<dt>References;</dt><dd><p><a class="reference external" href="http://www.cse.usf.edu/~r1k/MachineVisionBook/MachineVision.files/MachineVision_Chapter4.pdf">http://www.cse.usf.edu/~r1k/MachineVisionBook/MachineVision.files/MachineVision_Chapter4.pdf</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Scale_space_implementation">http://en.wikipedia.org/wiki/Scale_space_implementation</a>
<a class="reference external" href="http://www.cse.psu.edu/~rtc12/CSE486/lecture10_6pp.pdf">http://www.cse.psu.edu/~rtc12/CSE486/lecture10_6pp.pdf</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The product of the convolution of two Gaussian functions with spread
sigma is a Gaussian function with spread sqrt(2)*sigma scaled by the
area of the Gaussian filter</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">get_test_patch</span><span class="p">(</span><span class="s1">&#39;star2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_orig</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="mf">2.0</span> <span class="o">*</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="ow">not</span> <span class="n">size</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># check if even</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">size</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ksize</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_orig</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># demonstrate cascading smoothing property</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># THIS ISNT WORKING WHY???</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">get_test_patch</span><span class="p">(</span><span class="s1">&#39;star2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img3</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img4</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_orig</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma1</span> <span class="o">=</span> <span class="mf">.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma2</span> <span class="o">=</span> <span class="mf">.9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma3</span> <span class="o">=</span> <span class="n">sigma1</span> <span class="o">+</span> <span class="n">sigma2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># components</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img2</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># all in one shot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img3</span><span class="p">,</span> <span class="n">sigma3</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># addative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img4</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img4</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">img4</span> <span class="o">-</span> <span class="n">img3</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ksize</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#fig.add_subplot(1, 3, 1, projection=&#39;3d&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma3</span><span class="p">,</span> <span class="n">sigma3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_orig</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img1</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img2</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img4</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1"> + </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma1</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.INDEX_DTYPE">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">INDEX_DTYPE</span></span><a class="headerlink" href="#vtool.INDEX_DTYPE" title="Permalink to this definition"></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.int32</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.KPTS_DTYPE">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">KPTS_DTYPE</span></span><a class="headerlink" href="#vtool.KPTS_DTYPE" title="Permalink to this definition"></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.float32</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.L1">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">L1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float64'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.L1" title="Permalink to this definition"></a></dt>
<dd><p>returns L1 (aka manhatten or grid) distance between two histograms</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.L2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">L2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.L2" title="Permalink to this definition"></a></dt>
<dd><p>returns L2 (aka euclidean or standard) distance between two histograms</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.L2_root_sift">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">L2_root_sift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2_root_sift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.L2_root_sift" title="Permalink to this definition"></a></dt>
<dd><p>Normalized Root-SIFT L2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist1</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</p></li>
<li><p><strong>hist2</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>euclidean distance between 0-1 normalized sift descriptors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.L2_sift">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">L2_sift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2_sift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.L2_sift" title="Permalink to this definition"></a></dt>
<dd><p>Normalized SIFT L2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist1</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</p></li>
<li><p><strong>hist2</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>euclidean distance between 0-1 normalized sift descriptors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –test-L2_sift</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sift1</span><span class="p">,</span> <span class="n">sift2</span><span class="p">,</span> <span class="n">sift3</span><span class="p">,</span> <span class="n">sift4</span><span class="p">,</span> <span class="n">sift5</span> <span class="o">=</span> <span class="n">testdata_sift2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2_dist</span> <span class="o">=</span> <span class="n">L2_sift</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dist</span> <span class="o">=</span> <span class="n">L2_sift</span><span class="p">(</span><span class="n">sift4</span><span class="p">,</span> <span class="n">sift5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">max_dist</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">l2_dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.L2_sift_sqrd">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">L2_sift_sqrd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2_sift_sqrd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.L2_sift_sqrd" title="Permalink to this definition"></a></dt>
<dd><p>Normalized SIFT L2**2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist1</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</p></li>
<li><p><strong>hist2</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>squared euclidean distance between 0-1 normalized sift descriptors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.L2_sqrd">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">L2_sqrd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float64'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2_sqrd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.L2_sqrd" title="Permalink to this definition"></a></dt>
<dd><p>returns the squared L2 distance</p>
<dl class="simple">
<dt># FIXME:</dt><dd><p>if hist1.shape = (0,) and hist.shape = (0,) then result=0.0</p>
</dd>
<dt>SeeAlso:</dt><dd><p>L2</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">exec_funckw</span><span class="p">(</span><span class="n">L2_sqrd</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2dist</span> <span class="o">=</span> <span class="n">L2_sqrd</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">l2dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="vtool.MatchingError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">MatchingError</span></span><a class="reference internal" href="_modules/vtool/matching.html#MatchingError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.MatchingError" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtool.PairwiseMatch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">PairwiseMatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annot1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annot2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.PairwiseMatch" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ubelt.util_mixins.NiceRepr</span></code></p>
<p>Newest (Sept-16-2016) object oriented one-vs-one matching interface</p>
<p>Creates an object holding two annotations
Then a pipeline of operations can be applied to
generate score and refine the matches</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The annotation dictionaries are required to have certain attributes.</p>
<dl class="simple">
<dt>Required annotation attributes:</dt><dd><p>(kpts, vecs) OR rchip OR rchip_fpath</p>
</dd>
<dt>Optional annotation attributes:</dt><dd><p>aid, nid, flann, rchip, dlen_sqrd, weight</p>
</dd>
</dl>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgL</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy2.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rchip&#39;</span><span class="p">:</span> <span class="n">imgR</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rchip&#39;</span><span class="p">:</span> <span class="n">imgL</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">PairwiseMatch</span><span class="p">(</span><span class="n">annot1</span><span class="p">,</span> <span class="n">annot2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">apply_all</span><span class="p">({</span><span class="s1">&#39;refine_method&#39;</span><span class="p">:</span> <span class="s1">&#39;affine&#39;</span><span class="p">,</span> <span class="s1">&#39;affine_invariance&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;rotation_invariance&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="n">imgR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR_warp</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">warpHomog</span><span class="p">(</span><span class="n">imgR</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">H_12</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">kwplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">autompl</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR_warp</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR_warp</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--gui)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.guitool</span> <span class="k">as</span> <span class="nn">gt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">ensure_qapp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">ishow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgL</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy2.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rchip&#39;</span><span class="p">:</span> <span class="n">imgR</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rchip&#39;</span><span class="p">:</span> <span class="n">imgL</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">PairwiseMatch</span><span class="p">(</span><span class="n">annot1</span><span class="p">,</span> <span class="n">annot2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">apply_all</span><span class="p">({</span><span class="s1">&#39;refine_method&#39;</span><span class="p">:</span> <span class="s1">&#39;affine&#39;</span><span class="p">,</span> <span class="s1">&#39;affine_invariance&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;rotation_invariance&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="n">imgR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR_warp</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">warpHomog</span><span class="p">(</span><span class="n">imgR</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">H_12</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">kwplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">autompl</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR_warp</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR_warp</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--gui)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.guitool</span> <span class="k">as</span> <span class="nn">gt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">ensure_qapp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">ishow</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="vtool.PairwiseMatch.add_global_measures">
<span class="sig-name descname"><span class="pre">add_global_measures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.add_global_measures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.PairwiseMatch.add_global_measures" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.PairwiseMatch.add_local_measures">
<span class="sig-name descname"><span class="pre">add_local_measures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.add_local_measures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.PairwiseMatch.add_local_measures" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.PairwiseMatch.apply_all">
<span class="sig-name descname"><span class="pre">apply_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.apply_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.PairwiseMatch.apply_all" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.PairwiseMatch.apply_ratio_test">
<span class="sig-name descname"><span class="pre">apply_ratio_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.apply_ratio_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.PairwiseMatch.apply_ratio_test" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.PairwiseMatch.apply_sver">
<span class="sig-name descname"><span class="pre">apply_sver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.apply_sver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.PairwiseMatch.apply_sver" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;ratio_thresh&#39;</span><span class="p">:</span> <span class="mf">.8</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>           <span class="s1">&#39;thresh_bins&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.6</span><span class="p">,</span> <span class="mf">.7</span><span class="p">,</span> <span class="mf">.8</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">cfgbase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">apply_ratio_test</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags1</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">apply_sver</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.PairwiseMatch.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.PairwiseMatch.assign" title="Permalink to this definition"></a></dt>
<dd><p>Assign feature correspondences between annots</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">({},</span> <span class="n">apply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m1</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">assign</span><span class="p">({</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m2</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">assign</span><span class="p">({</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">cfgdict</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">all_dict_combinations</span><span class="p">(</span><span class="n">grid</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">match</span><span class="o">.</span><span class="n">assign</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.PairwiseMatch.compress">
<span class="sig-name descname"><span class="pre">compress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.compress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.PairwiseMatch.compress" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.PairwiseMatch.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.PairwiseMatch.copy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.PairwiseMatch.ishow">
<span class="sig-name descname"><span class="pre">ishow</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.ishow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.PairwiseMatch.ishow" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.matching ishow –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.guitool</span> <span class="k">as</span> <span class="nn">gt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">ensure_qapp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">(</span><span class="n">use_cache</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">ishow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">disp_config</span><span class="p">[</span><span class="s1">&#39;show_homog&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">qtapp_loop</span><span class="p">(</span><span class="n">qwin</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.PairwiseMatch.make_feature_vector">
<span class="sig-name descname"><span class="pre">make_feature_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">summary_ops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ratio'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.make_feature_vector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.PairwiseMatch.make_feature_vector" title="Permalink to this definition"></a></dt>
<dd><p>Constructs the pairwise feature vector that represents a match</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>local_keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>global_keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>summary_ops</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>sorters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – (default = ‘ratio’)</p></li>
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – (default = 3)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>feat</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.matching make_feature_vector</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">({})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">make_feature_vector</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;feat = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.PairwiseMatch.matched_vecs2">
<span class="sig-name descname"><span class="pre">matched_vecs2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.matched_vecs2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.PairwiseMatch.matched_vecs2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.PairwiseMatch.ratio_test_flags">
<span class="sig-name descname"><span class="pre">ratio_test_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.ratio_test_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.PairwiseMatch.ratio_test_flags" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.PairwiseMatch.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_homog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_ori</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_ell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_pts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_lines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_rect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_eig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_all_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_blend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ell_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modifysize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heatmask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.show"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.PairwiseMatch.show" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.PairwiseMatch.sver_flags">
<span class="sig-name descname"><span class="pre">sver_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.sver_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.PairwiseMatch.sver_flags" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;newsym&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">demodata_match</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgbase</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;symmetric&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;ratio_thresh&#39;</span><span class="p">:</span> <span class="mf">.8</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_union</span><span class="p">(</span><span class="n">cfgbase</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">thresh_bins</span><span class="o">=</span><span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.6</span><span class="p">,</span> <span class="mf">.7</span><span class="p">,</span> <span class="mf">.8</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">cfgbase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span><span class="o">.</span><span class="n">apply_ratio_test</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags1</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">sver_flags</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags2</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">sver_flags</span><span class="p">(</span><span class="n">cfgbase</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.PairwiseMatch.take">
<span class="sig-name descname"><span class="pre">take</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indicies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#PairwiseMatch.take"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.PairwiseMatch.take" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.SV_DTYPE">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">SV_DTYPE</span></span><a class="headerlink" href="#vtool.SV_DTYPE" title="Permalink to this definition"></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.float64</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtool.ScaleStrat">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ScaleStrat</span></span><a class="reference internal" href="_modules/vtool/chip.html#ScaleStrat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScaleStrat" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Scaling strategies</p>
<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScaleStrat.area">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig_wh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#ScaleStrat.area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScaleStrat.area" title="Permalink to this definition"></a></dt>
<dd><p>The area becomes target</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – target size</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="mi">800</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">)),</span> <span class="p">(</span><span class="mi">743</span><span class="p">,</span> <span class="mi">861</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="mi">800</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">190</span><span class="p">)),</span> <span class="p">(</span><span class="mi">861</span><span class="p">,</span> <span class="mi">743</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScaleStrat.maxwh">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">maxwh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig_wh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#ScaleStrat.maxwh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScaleStrat.maxwh" title="Permalink to this definition"></a></dt>
<dd><p>The maximum dimension becomes target</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – target size</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">maxwh</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="p">(</span><span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">)),</span> <span class="p">(</span><span class="mi">691</span><span class="p">,</span> <span class="mi">800</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">maxwh</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">190</span><span class="p">)),</span> <span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">691</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScaleStrat.width">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">width</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig_wh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#ScaleStrat.width"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScaleStrat.width" title="Permalink to this definition"></a></dt>
<dd><p>The width becomes target</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – target size</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="p">(</span><span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">)),</span> <span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">926</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ScaleStrat</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">190</span><span class="p">)),</span> <span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">691</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtool.ScoreNormVisualizeClass">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ScoreNormVisualizeClass</span></span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormVisualizeClass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScoreNormVisualizeClass" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p># HACK; eventually move all individual plots into a class structure</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtool.ScoreNormalizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ScoreNormalizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScoreNormalizer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">utool.util_cache.Cachable</span></code>, <a class="reference internal" href="#vtool.score_normalization.ScoreNormVisualizeClass" title="vtool.score_normalization.ScoreNormVisualizeClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">vtool.score_normalization.ScoreNormVisualizeClass</span></code></a></p>
<p>Conforms to scikit-learn Estimator interface</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –test-ScoreNormalizer –show –cmd</p>
</dd>
<dt>Kwargs:</dt><dd><p>tpr (float): target true positive rate (default .90)
fpr (float): target false positive rate (default None)
reverse (bool): True if lower scores are better, False if higher scores
are better (default=None)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ScoreNormalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">testdata_binary_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScoreNormalizer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finite_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScoreNormalizer.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits estimator to data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em>) – one dimensional scores</p></li>
<li><p><strong>y</strong> (<em>ndarray</em>) – binary labels</p></li>
<li><p><strong>attrs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – dictionary of data attributes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScoreNormalizer.fit_partitioned">
<span class="sig-name descname"><span class="pre">fit_partitioned</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tp_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part_attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.fit_partitioned"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScoreNormalizer.fit_partitioned" title="Permalink to this definition"></a></dt>
<dd><p>convinience func to fit only scores that have been separated
instead of labeled</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScoreNormalizer.get_accuracy">
<span class="sig-name descname"><span class="pre">get_accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_accuracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScoreNormalizer.get_accuracy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScoreNormalizer.get_confusion_indicies">
<span class="sig-name descname"><span class="pre">get_confusion_indicies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_confusion_indicies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScoreNormalizer.get_confusion_indicies" title="Permalink to this definition"></a></dt>
<dd><p>combination of get_correct_indices and get_error_indicies</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScoreNormalizer.get_correct_indices">
<span class="sig-name descname"><span class="pre">get_correct_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_correct_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScoreNormalizer.get_correct_indices" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em>) – data</p></li>
<li><p><strong>y</strong> (<em>ndarray</em>) – labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(fp_indicies, fn_indicies)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –test-get_correct_indices</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">testdata_score_normalier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">tp_indicies</span><span class="p">,</span> <span class="n">tn_indicies</span><span class="p">)</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">get_correct_indices</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">tp_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">tn_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span>    <span class="s1">&#39;tp_X = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">tp_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">tn_X = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">tn_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">tp_X = np.array([ 8.883,  8.77 ,  8.759])</span>
<span class="go">tn_X = np.array([ 0.727,  0.76 ,  0.841])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScoreNormalizer.get_error_indicies">
<span class="sig-name descname"><span class="pre">get_error_indicies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_error_indicies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScoreNormalizer.get_error_indicies" title="Permalink to this definition"></a></dt>
<dd><p>Returns the indicies of the most difficult type I and type II errors.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">testdata_score_normalier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">fp_indicies</span><span class="p">,</span> <span class="n">fn_indicies</span><span class="p">)</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">get_error_indicies</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fp_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">fp_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">fn_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span>    <span class="s1">&#39;fp_X = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fp_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">fn_X = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fn_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">fp_X = np.array([ 6.196,  5.912,  5.804])</span>
<span class="go">fn_X = np.array([ 3.947,  4.277,  4.43 ])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScoreNormalizer.get_partitioned_support">
<span class="sig-name descname"><span class="pre">get_partitioned_support</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_partitioned_support"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScoreNormalizer.get_partitioned_support" title="Permalink to this definition"></a></dt>
<dd><p>convinience get prepartitioned data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScoreNormalizer.get_prefix">
<span class="sig-name descname"><span class="pre">get_prefix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_prefix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScoreNormalizer.get_prefix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScoreNormalizer.get_support">
<span class="sig-name descname"><span class="pre">get_support</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">finite_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_support"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScoreNormalizer.get_support" title="Permalink to this definition"></a></dt>
<dd><p>return X, y, and attrs</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScoreNormalizer.inverse_normalize">
<span class="sig-name descname"><span class="pre">inverse_normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">probs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.inverse_normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScoreNormalizer.inverse_normalize" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScoreNormalizer.learn_probabilities">
<span class="sig-name descname"><span class="pre">learn_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.learn_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScoreNormalizer.learn_probabilities" title="Permalink to this definition"></a></dt>
<dd><p>Kernel density estimation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScoreNormalizer.learn_threshold">
<span class="sig-name descname"><span class="pre">learn_threshold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">thresh_kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.learn_threshold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScoreNormalizer.learn_threshold" title="Permalink to this definition"></a></dt>
<dd><p>Learns cutoff threshold that achieves the target confusion metric
Typically a desired false positive rate (recall) is specified</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScoreNormalizer.learn_threshold2">
<span class="sig-name descname"><span class="pre">learn_threshold2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.learn_threshold2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScoreNormalizer.learn_threshold2" title="Permalink to this definition"></a></dt>
<dd><p>Finds a cutoff where the probability of a truepos stats becoming
greater than probability of trueneg</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –exec-learn_threshold2 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder, X, y = testdata_score_normalier([(3.5, 256), (9.5, 1024), (15.5, 2048)], [(6.5, 256), (12.5, 5064), (18.5, 128)], adjust=1, p_tp_method=&#39;ratio&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">testdata_score_normalier</span><span class="p">([(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="p">(</span><span class="mf">9.5</span><span class="p">,</span> <span class="mi">1024</span><span class="p">),</span> <span class="p">(</span><span class="mf">15.5</span><span class="p">,</span> <span class="mi">5064</span><span class="p">)],</span> <span class="p">[(</span><span class="mf">6.5</span><span class="p">,</span> <span class="mi">256</span><span class="p">),</span> <span class="p">(</span><span class="mf">12.5</span><span class="p">,</span> <span class="mi">2048</span><span class="p">),</span> <span class="p">(</span><span class="mf">18.5</span><span class="p">,</span> <span class="mi">128</span><span class="p">)],</span> <span class="n">adjust</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">p_tp_method</span><span class="o">=</span><span class="s1">&#39;ratio&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder, X, y = testdata_score_normalier(adjust=1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder, X, y = testdata_score_normalier([(3.5, 2048)], [(30.5, 128)], tn_scale=.1, adjust=1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder, X, y = testdata_score_normalier([(0, 64)], [(-.1, 12)], adjust=8, min_clip=0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">encoder</span><span class="o">.</span><span class="n">learn_threshold2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exec</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">execstr_dict</span><span class="p">(</span><span class="n">locals_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.plot(xdata[0:-2], np.diff(np.diff(closeness)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#maxima_x, maxima_y, argmaxima = vt.hist_argmaxima(closeness)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fnum</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">multi_plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="p">[</span><span class="n">tp_curve</span><span class="p">,</span> <span class="n">tn_curve</span><span class="p">,</span> <span class="n">closeness</span><span class="p">,</span> <span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">label_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p(tp | s)&#39;</span><span class="p">,</span> <span class="s1">&#39;p(tn | s)&#39;</span><span class="p">,</span> <span class="s1">&#39;closeness&#39;</span><span class="p">,</span> <span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">linewidth_list</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;intersection points&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">xdata</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">closeness</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;closeness maxima&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_submax</span><span class="p">,</span> <span class="n">y_submax</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;chosen&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.plot(xdata[argmaxima], curveness[argmaxima], &#39;rx&#39;, label=&#39;curveness maxima&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.plot(x_submax, y_submax, &#39;o&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">tp_curve</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">tn_curve</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">tp_curve</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">tn_curve</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.plot(xdata[argmaxima], encoder.interp_fn(x_submax), &#39;rx&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_mkinterp</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">assume_sorted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_interp_sgtn</span> <span class="o">=</span> <span class="n">_mkinterp</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">tn_curve</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_interp_sgtp</span> <span class="o">=</span> <span class="n">_mkinterp</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">tp_curve</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_submax</span><span class="p">,</span> <span class="n">_interp_sgtn</span><span class="p">(</span><span class="n">x_submax</span><span class="p">),</span> <span class="s1">&#39;go&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_submax</span><span class="p">,</span> <span class="n">_interp_sgtp</span><span class="p">(</span><span class="n">x_submax</span><span class="p">),</span> <span class="s1">&#39;bx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">multi_plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="p">[</span><span class="n">tp_area</span><span class="p">,</span> <span class="n">fp_area</span><span class="p">,</span> <span class="n">tn_area</span><span class="p">,</span> <span class="n">fn_area</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;intersection areas&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">label_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tp_area&#39;</span><span class="p">,</span> <span class="s1">&#39;fp_area&#39;</span><span class="p">,</span> <span class="s1">&#39;tn_area&#39;</span><span class="p">,</span> <span class="s1">&#39;fn_area&#39;</span><span class="p">],</span> <span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">xdata</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">multi_plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="p">[</span><span class="n">lr_pos</span><span class="p">,</span> <span class="n">lr_neg</span><span class="p">,</span> <span class="n">acc</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;intersection quality (liklihood ratios)&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">label_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lr_pos=tp/fp&#39;</span><span class="p">,</span> <span class="s1">&#39;lr_neg=fn/tn&#39;</span><span class="p">,</span> <span class="s1">&#39;acc&#39;</span><span class="p">],</span> <span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">xdata</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pnum_</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">make_pnum_nextgen</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">_plot_score_support_hist</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#encoder._plot_prebayes(fnum=fnum, pnum=pnum_())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">_plot_postbayes</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">_plot_roc</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">adjust_subplots</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">.95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">.08</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScoreNormalizer.normalize_scores">
<span class="sig-name descname"><span class="pre">normalize_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.normalize_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScoreNormalizer.normalize_scores" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScoreNormalizer.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScoreNormalizer.predict" title="Permalink to this definition"></a></dt>
<dd><p>Predict true or false of <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtool.ScoreNormalizer.visualize">
<span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.visualize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ScoreNormalizer.visualize" title="Permalink to this definition"></a></dt>
<dd><p>shows details about the score normalizer</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>fnum
figtitle
with_hist
interactive
with_scores
with_roc
with_precision_recall</p>
</dd>
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –exec-ScoreNormalizer.visualize:0 –show
python -m vtool.score_normalization –exec-ScoreNormalizer.visualize:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># UNSTABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ScoreNormalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">testdata_binary_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_pr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_roc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_hist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># UNSTABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ScoreNormalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">testdata_binary_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_pr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_roc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_hist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_scores</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_prebayes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_postbayes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">target_tpr</span><span class="o">=</span><span class="mf">.95</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.TEMP_VEC_DTYPE">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">TEMP_VEC_DTYPE</span></span><a class="headerlink" href="#vtool.TEMP_VEC_DTYPE" title="Permalink to this definition"></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.float64</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtool.TRANSFORM_DTYPE">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">TRANSFORM_DTYPE</span></span><a class="headerlink" href="#vtool.TRANSFORM_DTYPE" title="Permalink to this definition"></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.float64</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.adaptive_scale">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">adaptive_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nScales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#adaptive_scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.adaptive_scale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.add_homogenous_coordinate">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">add_homogenous_coordinate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">_xys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#add_homogenous_coordinate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.add_homogenous_coordinate" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.linalg –test-add_homogenous_coordinate</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xyzs</span> <span class="o">=</span> <span class="n">add_homogenous_coordinate</span><span class="p">(</span><span class="n">_xys</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">_xys</span> <span class="o">==</span> <span class="n">remove_homogenous_coordinate</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.affine_around_mat3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">affine_around_mat3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#affine_around_mat3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.affine_around_mat3x3" title="Permalink to this definition"></a></dt>
<dd><p>Executes an affine transform around center point (x, y).
Equivalent to translation.dot(affine).dot(inv(translation))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – center x location in input space</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – center y location in input space</p></li>
<li><p><strong>sx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – x scale factor (default = 1)</p></li>
<li><p><strong>sy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – y scale factor (default = 1)</p></li>
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – counter-clockwise rotation angle in radians(default = 0)</p></li>
<li><p><strong>shear</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – counter-clockwise shear angle in radians(default = 0)</p></li>
<li><p><strong>tx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – x-translation (default = 0)</p></li>
<li><p><strong>ty</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – y-translation (default = 0)</p></li>
<li><p><strong>x2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – center y location in output space (default = x)</p></li>
<li><p><strong>y2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – center y location in output space (default = y)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.linalg affine_around_mat3x3 –show</p>
</dd>
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/linalg.py affine_around_mat3x3</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orig_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">verts_from_bbox</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">bbox_center</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">bbox_from_verts</span><span class="p">(</span><span class="n">orig_pts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shear</span> <span class="o">=</span> <span class="mf">.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff</span> <span class="o">=</span> <span class="n">affine_around_mat3x3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                           <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trans_pts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">transform_points_with_homography</span><span class="p">(</span><span class="n">Aff</span><span class="p">,</span> <span class="n">orig_pts</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoc: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;bx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">orig_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">orig_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trans_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trans_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;transformed&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Demo of affine_around_mat3x3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">256.0</span><span class="p">,</span> <span class="mf">256.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">timer</span> <span class="ow">in</span> <span class="n">ub</span><span class="o">.</span><span class="n">Timerit</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;old&#39;</span><span class="p">):</span>  <span class="c1"># 19.0697 µs</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">with</span> <span class="n">timer</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">tr1_</span> <span class="o">=</span> <span class="n">translation_mat3x3</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">Aff_</span> <span class="o">=</span> <span class="n">affine_mat3x3</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">tr2_</span> <span class="o">=</span> <span class="n">translation_mat3x3</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">Aff1</span> <span class="o">=</span> <span class="n">tr2_</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Aff_</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">tr1_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">timer</span> <span class="ow">in</span> <span class="n">ub</span><span class="o">.</span><span class="n">Timerit</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">):</span>  <span class="c1"># 11.0242 µs</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">with</span> <span class="n">timer</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">Aff2</span> <span class="o">=</span> <span class="n">affine_around_mat3x3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                    <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">Aff2</span><span class="p">,</span> <span class="n">Aff1</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Shows the symbolic construction of the code</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;x, y, sx, sy, theta, shear, tx, ty, x2, y2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">sx</span> <span class="o">=</span> <span class="n">sy</span> <span class="o">=</span> <span class="n">tx</span> <span class="o">=</span> <span class="n">ty</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># move to center xy, apply affine transform, move center xy2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr1_</span> <span class="o">=</span> <span class="n">translation_mat3x3</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff_</span> <span class="o">=</span> <span class="n">affine_mat3x3</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">trig</span><span class="o">=</span><span class="n">sympy</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr2_</span> <span class="o">=</span> <span class="n">translation_mat3x3</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># combine transformations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">(</span><span class="n">tr2_</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Aff_</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">tr1_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s1">&#39;Aff&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Numpy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">sympy_numpy_repr</span><span class="p">(</span><span class="n">Aff</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.affine_mat3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">affine_mat3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sx=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shear=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tx=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ty=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trig=&lt;module</span> <span class="pre">'numpy'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/numpy/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#affine_mat3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.affine_mat3x3" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – x scale factor (default = 1)</p></li>
<li><p><strong>sy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – y scale factor (default = 1)</p></li>
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – rotation angle (radians) in counterclockwise direction</p></li>
<li><p><strong>shear</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – shear angle (radians) in counterclockwise directions</p></li>
<li><p><strong>tx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – x-translation (default = 0)</p></li>
<li><p><strong>ty</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – y-translation (default = 0)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://github.com/scikit-image/scikit-image/blob/master/skimage/transform/_geometric.py">https://github.com/scikit-image/scikit-image/blob/master/skimage/transform/_geometric.py</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.affine_warp_around_center">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">affine_warp_around_center</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borderMode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#affine_warp_around_center"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.affine_warp_around_center" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-affine_warp_around_center –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shear</span> <span class="o">=</span> <span class="mf">.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ty</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sy</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">borderMode</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_CONSTANT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">INTER_LANCZOS4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_warped</span> <span class="o">=</span> <span class="n">affine_warp_around_center</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">sx</span><span class="o">=</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="o">=</span><span class="n">sy</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">theta</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="o">=</span><span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="o">=</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="o">=</span><span class="n">ty</span><span class="p">,</span> <span class="n">dsize</span><span class="o">=</span><span class="n">dsize</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">borderMode</span><span class="o">=</span><span class="n">borderMode</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span> <span class="n">borderValue</span><span class="o">=</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">img_warped</span> <span class="o">*</span> <span class="mf">255.0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.and_lists">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">and_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#and_lists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.and_lists" title="Permalink to this definition"></a></dt>
<dd><p>Like np.logical_and, but can take more than 2 arguments</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-and_lists</p>
</dd>
<dt>SeeAlso:</dt><dd><p>or_lists</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">and_lists</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[False  True False  True]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg3</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">and_lists</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ensure equal division</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">flags</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">endx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">segments</span> <span class="o">*</span> <span class="p">(</span><span class="n">validx</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="p">(</span><span class="n">segments</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">validx</span><span class="p">[:</span><span class="n">endx</span><span class="p">],</span> <span class="n">segments</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">parts</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[243734, 714397, 1204989, 1729375, 2235191]</span>
</pre></div>
</div>
<p>%timeit reduce(np.logical_and, args)
%timeit np.logical_and.reduce(args)  # wins with more data</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ann_flann_once">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ann_flann_once</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_neighbors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flann_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#ann_flann_once"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ann_flann_once" title="Permalink to this definition"></a></dt>
<dd><p>Finds the approximate nearest neighbors of qpts in dpts</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/nearest_neighbors.py ann_flann_once:0</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qx2_dx</span><span class="p">,</span> <span class="n">qx2_dist</span> <span class="o">=</span> <span class="n">ann_flann_once</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">qpts</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">qx2_dx</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">qx2_dist</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">    np.array([[3, 3, 3, 3, 0],</span>
<span class="go">              [2, 0, 1, 4, 4]], dtype=np.int32),</span>
<span class="go">    np.array([[1037329., 1235876., 1168550., 1286435., 1075507.],</span>
<span class="go">              [1038324., 1243690., 1304896., 1320598., 1369036.]], dtype=np.float32),</span>
<span class="go">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Test upper bounds on sift descriptors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># SeeAlso distance.understanding_pseudomax_props</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># get points on unit sphere</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nDpts</span> <span class="o">=</span> <span class="mi">5000</span> <span class="c1"># 5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nQpts</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c1"># 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">normalize_rows</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nDpts</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">normalize_rows</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nQpts</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">qpts</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">qmag</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="s1">&#39;not on unit sphere&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dmag</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="s1">&#39;not on unit sphere&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># cast to uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uint8_max</span> <span class="o">=</span> <span class="mi">512</span>  <span class="c1"># hack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uint8_min</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># hack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># 2</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">qpts8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">qpts</span> <span class="o">*</span> <span class="n">uint8_max</span><span class="p">),</span> <span class="n">uint8_min</span><span class="p">,</span> <span class="n">uint8_max</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">dpts</span> <span class="o">*</span> <span class="n">uint8_max</span><span class="p">),</span> <span class="n">uint8_min</span><span class="p">,</span> <span class="n">uint8_max</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmag8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">qpts8</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmag8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">dpts8</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qx2_dx</span><span class="p">,</span> <span class="n">qx2_dist</span> <span class="o">=</span> <span class="n">ann_flann_once</span><span class="p">(</span><span class="n">dpts8</span><span class="p">,</span> <span class="n">qpts8</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">biggest_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">qx2_dist</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;biggest_dist = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">biggest_dist</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get actual distance by hand</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hand_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">qpts8</span> <span class="o">-</span> <span class="n">dpts8</span><span class="p">[</span><span class="n">qx2_dx</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Seems like flann returns squared distance. makes sense</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="nb">repr</span><span class="p">((</span><span class="n">qx2_dx</span><span class="p">,</span> <span class="n">qx2_dist</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Build theoretically maximally distant vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="mi">512</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">D</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span> <span class="o">*</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">512</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">qpts</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">dpts</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># FIX TO ACTUALLY BE AT THE RIGHT NORM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="p">(</span><span class="n">dpts</span> <span class="o">*</span> <span class="p">(</span><span class="mi">512</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[:,</span> <span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="p">(</span><span class="n">qpts</span> <span class="o">*</span> <span class="p">(</span><span class="mi">512</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">qpts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[:,</span> <span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">qpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">qpts</span> <span class="o">-</span> <span class="n">dpts</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Because of norm condition another maximally disant pair of vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># is [1, 0, 0, ... 0] and [0, 1, .. 0, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verifythat this gives you same dist.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">512</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">512</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.apply_filter_funcs">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">apply_filter_funcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chipBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_funcs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#apply_filter_funcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.apply_filter_funcs" title="Permalink to this definition"></a></dt>
<dd><p>applies a list of preprocessing filters to a chip</p>
<p>DEPRICATE</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.apply_grouping">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">apply_grouping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.apply_grouping" title="Permalink to this definition"></a></dt>
<dd><p>applies grouping from group_indicies
apply_grouping</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>items</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>groupxs</strong> (<em>list of ndarrays</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>grouped items</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of ndarrays</p>
</dd>
</dl>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>group_indices
invert_apply_grouping</p>
</dd>
<dt>CommandLine:</dt><dd><p>python -m vtool.clustering2 –test-apply_grouping</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_items</span> <span class="o">=</span> <span class="n">apply_grouping</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">grouped_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[array([8, 5, 6]), array([1, 5, 8, 7]), array([5, 3, 0, 9])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.apply_grouping_">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">apply_grouping_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupxs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.apply_grouping_" title="Permalink to this definition"></a></dt>
<dd><p>non-optimized version</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.apply_grouping_iter">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">apply_grouping_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupxs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping_iter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.apply_grouping_iter" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.apply_grouping_iter2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">apply_grouping_iter2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupxs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping_iter2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.apply_grouping_iter2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.apply_jagged_grouping">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">apply_jagged_grouping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unflat_items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupxs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_jagged_grouping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.apply_jagged_grouping" title="Permalink to this definition"></a></dt>
<dd><p>takes unflat_list and flat group indices. Returns the unflat grouping</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.argsort_groups">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">argsort_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng=&lt;module</span> <span class="pre">'numpy.random'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/numpy/random/__init__.py'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomize_levels=True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#argsort_groups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.argsort_groups" title="Permalink to this definition"></a></dt>
<dd><p>Sorts each group normally, but randomizes order of level values.</p>
<p>TODO: move to vtool</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scores_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>reverse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = True)</p></li>
<li><p><strong>rng</strong> (<em>module</em>) – random number generator(default = numpy.random)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia.init.filter_annots –exec-argsort_groups</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idxs_list</span> <span class="o">=</span> <span class="n">argsort_groups</span><span class="p">(</span><span class="n">scores_list</span><span class="p">,</span> <span class="n">reverse</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;idxs_list = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr4</span><span class="p">(</span><span class="n">idxs_list</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.argsort_records">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">argsort_records</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrays</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#argsort_records"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.argsort_records" title="Permalink to this definition"></a></dt>
<dd><p>Sorts arrays that form records.
Same as lexsort(arrays[::-1]) — ie. rows are reversed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arrays</strong> (<em>ndarray</em>) – array of records</p></li>
<li><p><strong>reverse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sortx - sorted indicies</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –exec-argsort_records</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrays</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">],)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sortx</span> <span class="o">=</span> <span class="n">argsort_records</span><span class="p">(</span><span class="n">arrays</span><span class="p">,</span> <span class="n">reverse</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;sortx = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sortx</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lxsrt = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span><span class="n">arrays</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">sortx = [1 2 0 5 4 3 6 7 8]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.argsubextrema2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">argsubextrema2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xdata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubextrema2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.argsubextrema2" title="Permalink to this definition"></a></dt>
<dd><p>Determines approximate maxima values to subindex accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ydata</strong> (<em>ndarray</em>) – ydata, histogram frequencies</p></li>
<li><p><strong>xdata</strong> (<em>ndarray</em>) – xdata, histogram labels</p></li>
<li><p><strong>thresh_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – cutoff point for labeing a value as a maxima</p></li>
<li><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if True allows for flat extrema to be found.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(submaxima_x, submaxima_y)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.histogram argsubmaxima
python -m vtool.histogram argsubmaxima –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh_factor</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">op</span> <span class="o">=</span> <span class="s1">&#39;min&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">argsubextrema2</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="p">,</span> <span class="n">thresh_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_hist_subbin_maxima</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl>
<dt>Doctest:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh_factor</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">op</span> <span class="o">=</span> <span class="s1">&#39;max&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh_factor</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">argsubextrema2</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">thresh_factor</span><span class="o">=</span><span class="n">thresh_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">qtensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">doclf</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subextrema_x</span><span class="p">,</span> <span class="n">subextrema_y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.argsubmax">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">argsubmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xdata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.argsubmax" title="Permalink to this definition"></a></dt>
<dd><p>Finds a single submaximum value to subindex accuracy.
If xdata is not specified, submax_x is a fractional index.
Otherwise, submax_x is sub-xdata (essentially doing the index interpolation
for you)</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span>  <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="p">[</span><span class="mi">00</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span>  <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">argsubmax</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">argsubmax</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="n">xdata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">([</span><span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">],</span> <span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">2.1667, 2.0208,</span>
<span class="go">21.6667, 2.0208,</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span><span class="o">=</span><span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argsubmax</span><span class="p">(</span><span class="n">hist_</span><span class="p">)</span>
<span class="go">(4.0, 4.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.argsubmax2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">argsubmax2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xdata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmax2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.argsubmax2" title="Permalink to this definition"></a></dt>
<dd><p>Finds a single submaximum value to subindex accuracy.
If xdata is not specified, submax_x is a fractional index.
This version always normalizes x-coordinates.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span>  <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="p">[</span><span class="mi">00</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span>  <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">argsubmax</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">argsubmax</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xdata</span><span class="o">=</span><span class="n">xdata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">([</span><span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">],</span> <span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">2.1667, 2.0208,</span>
<span class="go">21.6667, 2.0208,</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh_factor</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argsubmax</span><span class="p">(</span><span class="n">hist_</span><span class="p">)</span>
<span class="go">(4.0, 4.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.argsubmaxima">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">argsubmaxima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxima_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmaxima"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.argsubmaxima" title="Permalink to this definition"></a></dt>
<dd><p>Determines approximate maxima values to subindex accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist_</strong> (<em>ndarray</em>) – ydata, histogram frequencies</p></li>
<li><p><strong>centers</strong> (<em>ndarray</em>) – xdata, histogram labels</p></li>
<li><p><strong>maxima_thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – cutoff point for labeing a value as a maxima</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(submaxima_x, submaxima_y)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.histogram argsubmaxima
python -m vtool.histogram argsubmaxima –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">argsubmaxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_hist_subbin_maxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">(array([ 3.0318792]), array([ 37.19208239]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.argsubmaxima2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">argsubmaxima2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xdata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmaxima2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.argsubmaxima2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.argsubmin2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">argsubmin2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xdata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubmin2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.argsubmin2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.argsubminima2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">argsubminima2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xdata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#argsubminima2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.argsubminima2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.assert_zipcompress">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">assert_zipcompress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#assert_zipcompress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.assert_zipcompress" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.asserteq">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">asserteq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nestpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbl1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbl2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_lbl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iswarning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#asserteq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.asserteq" title="Permalink to this definition"></a></dt>
<dd><p>recursive equality checks</p>
<p>asserts that output1 and output2 are close to equal.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.assign_symmetric_matches">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">assign_symmetric_matches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fx2_to_fx1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx2_to_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx1_to_fx2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx1_to_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Knorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#assign_symmetric_matches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.assign_symmetric_matches" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Knorm</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assign distances</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">distmat</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">L2</span><span class="p">(</span><span class="n">feat1</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">feat2</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Find nearest K</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx1_to_fx2</span> <span class="o">=</span> <span class="n">distmat</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">K</span> <span class="o">+</span> <span class="n">Knorm</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">distmat</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">K</span> <span class="o">+</span> <span class="n">Knorm</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># and order their distances</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx1_to_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">distmat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fx1_to_fx2</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">distmat</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">)])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># flat_matx1 = fx1_to_fx2 + np.arange(distmat.shape[0])[:, None] * distmat.shape[1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># fx1_to_dist = distmat.take(flat_matx1).reshape(fx1_to_fx2.shape)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx21</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx21</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx21</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;fx1&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fx1_to_fx2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx12</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx12</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;fx2&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx12</span> <span class="o">=</span> <span class="n">fx12</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">K</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx21</span> <span class="o">=</span> <span class="n">fx21</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">K</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx12</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">~</span><span class="n">fx1_to_flags</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx21</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">~</span><span class="n">fx2_to_flags</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fx12.values =</span><span class="se">\n</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fx12</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fm_ =</span><span class="se">\n</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fm_</span><span class="p">,))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fx21.values =</span><span class="se">\n</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fx21</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fm =</span><span class="se">\n</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fm</span><span class="p">,))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unflat_match_idx2</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unflat_match_idx2</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="n">flat_match_idx2</span><span class="p">]</span> <span class="o">=</span> <span class="n">flat_match_idx2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inv_lookup21</span> <span class="o">=</span> <span class="n">unflat_match_idx2</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">K</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">fx2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fx12</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">fx1_to_flags</span><span class="p">]:</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">fx1</span><span class="p">,</span> <span class="n">fx2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">match_fx1_</span><span class="p">,</span> <span class="n">match_fx2_</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">[</span><span class="n">fx2</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="n">K</span><span class="p">]</span> <span class="o">==</span> <span class="n">fx1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">inv_idx</span> <span class="o">=</span> <span class="n">inv_lookup21</span><span class="p">[</span><span class="n">fx2</span><span class="p">][</span><span class="n">cx</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inv_idx = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">inv_idx</span><span class="p">,))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.assign_to_centroids">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">assign_to_centroids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flann_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#assign_to_centroids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.assign_to_centroids" title="Permalink to this definition"></a></dt>
<dd><p>Helper for akmeans</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.assign_unconstrained_matches">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">assign_unconstrained_matches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fx2_to_fx1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx2_to_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Knorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx2_to_flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#assign_unconstrained_matches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.assign_unconstrained_matches" title="Permalink to this definition"></a></dt>
<dd><p>assigns vsone matches using results of nearest neighbors.</p>
<dl class="simple">
<dt>Ignore:</dt><dd><p>fx2_to_dist = np.arange(fx2_to_fx1.size).reshape(fx2_to_fx1.shape)</p>
</dd>
<dt>CommandLine:</dt><dd><p>python -m vtool.matching –test-assign_unconstrained_matches –show
python -m vtool.matching assign_unconstrained_matches:0
python -m vtool.matching assign_unconstrained_matches:1</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx2_to_dist</span> <span class="o">=</span> <span class="n">empty_neighbors</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Knorm</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flags</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assigntup</span> <span class="o">=</span> <span class="n">assign_unconstrained_matches</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx2_to_dist</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                         <span class="n">Knorm</span><span class="p">,</span> <span class="n">fx2_to_flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="p">,</span> <span class="n">match_dist</span><span class="p">,</span> <span class="n">norm_fx1</span><span class="p">,</span> <span class="n">norm_dist</span> <span class="o">=</span> <span class="n">assigntup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">assigntup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">77</span><span class="p">,</span>   <span class="mi">971</span><span class="p">,</span> <span class="mi">22</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">116</span><span class="p">,</span>   <span class="mi">120</span><span class="p">,</span> <span class="mi">34</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">122</span><span class="p">,</span>   <span class="mi">128</span><span class="p">,</span> <span class="mi">99</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">1075</span><span class="p">,</span>  <span class="mi">692</span><span class="p">,</span> <span class="mi">102</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">530</span><span class="p">,</span>   <span class="mi">45</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span>  <span class="mi">45</span><span class="p">,</span>  <span class="mi">530</span><span class="p">,</span> <span class="mi">77</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.059</span><span class="p">,</span>  <span class="mf">0.238</span><span class="p">,</span> <span class="mf">.3</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.021</span><span class="p">,</span>  <span class="mf">0.240</span><span class="p">,</span> <span class="mf">.4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.039</span><span class="p">,</span>  <span class="mf">0.247</span><span class="p">,</span> <span class="mf">.5</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.149</span><span class="p">,</span>  <span class="mf">0.151</span><span class="p">,</span> <span class="mf">.6</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.226</span><span class="p">,</span>  <span class="mf">0.244</span><span class="p">,</span> <span class="mf">.7</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.215</span><span class="p">,</span>  <span class="mf">0.236</span><span class="p">,</span> <span class="mf">.8</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Knorm</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flags</span> <span class="o">=</span> <span class="n">fx2_to_flags</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">K</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assigntup</span> <span class="o">=</span> <span class="n">assign_unconstrained_matches</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx2_to_dist</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                         <span class="n">Knorm</span><span class="p">,</span> <span class="n">fx2_to_flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="p">,</span> <span class="n">match_dist</span><span class="p">,</span> <span class="n">norm_fx1</span><span class="p">,</span> <span class="n">norm_dist</span> <span class="o">=</span> <span class="n">assigntup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">assigntup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">fm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">ub</span><span class="o">.</span><span class="n">allsame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">assigntup</span><span class="p">)))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.asymmetric_correspondence">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">asymmetric_correspondence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annot1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annot2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Knorm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_shrink</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#asymmetric_correspondence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.asymmetric_correspondence" title="Permalink to this definition"></a></dt>
<dd><p>Find symmetric feature corresopndences</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.atan2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">atan2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/trig.html#atan2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.atan2" title="Permalink to this definition"></a></dt>
<dd><p>does atan2 but returns from 0 to TAU</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.trig</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">theta</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">theta</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">ub</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;6bfc86a2e94dd2dafbf501035719a7873d57f5f8e9cde88c4ccc35e98bb9e7b82abf6230803a923be7060866d66b8ac567388803593f9b7c763163a24282442a&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;90fe55311562f1c3ae451d5c4f27573259fed96752a5bd03f0f1216b46cf5b4b48024dcc744bfc6df7e6f8d6eb2a2a4b31b9f5ca75c0064b37acd09303811d76&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.atleast_3channels">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">atleast_3channels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#atleast_3channels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.atleast_3channels" title="Permalink to this definition"></a></dt>
<dd><p>Ensures that there are 3 channels in the image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>ndarray</em><em>[</em><em>N</em><em>, </em><em>M</em><em>, </em><em>...</em><em>]</em>) – the image</p></li>
<li><p><strong>copy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Always copies if True, if False, then copies only when the
size of the array must change.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>with shape (N, M, C), where C in {3, 4}</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.other atleast_3channels</p>
</dd>
<dt>Doctest:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_3channels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_3channels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_3channels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_3channels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.atleast_nd">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">atleast_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tofront</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#atleast_nd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.atleast_nd" title="Permalink to this definition"></a></dt>
<dd><p>View inputs as arrays with at least n dimensions.
TODO: Submit as a PR to numpy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>array_like</em>) – One array-like object.  Non-array inputs are
converted to arrays.  Arrays that already have n or more
dimensions are preserved.</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – number of dimensions to ensure</p></li>
<li><p><strong>tofront</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if True new dimensions are added to the front of the
array.  otherwise they are added to the back.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.numpy_utils atleast_nd</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An array with <code class="docutils literal notranslate"><span class="pre">a.ndim</span> <span class="pre">&gt;=</span> <span class="pre">n</span></code>.  Copies are avoided where possible,
and views with three or more dimensions are returned.  For example,
a 1-D array of shape <code class="docutils literal notranslate"><span class="pre">(N,)</span></code> becomes a view of shape
<code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">N,</span> <span class="pre">1)</span></code>, and a 2-D array of shape <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">N)</span></code> becomes a view
of shape <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">N,</span> <span class="pre">1)</span></code>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>ensure_shape, np.atleast_1d, np.atleast_2d, np.atleast_3d</p>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[[[</span><span class="mi">1</span><span class="p">]]]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_</span> <span class="o">=</span> <span class="n">atleast_nd</span><span class="p">(</span><span class="n">arr3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr1_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr2_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result3</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr3_</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">,</span> <span class="n">result3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.atleast_shape">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">atleast_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimshape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#atleast_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.atleast_shape" title="Permalink to this definition"></a></dt>
<dd><p>Ensures that an array takes a certain shape. The total size of the array
must not change.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>ndarray</em>) – array to change the shape of</p></li>
<li><p><strong>dimshape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – desired shape (Nones can be used to broadcast
dimensions)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ndarray - the input array, which has been modified inplace.</p>
</dd>
</dl>
<dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.other ensure_shape</p>
</dd>
<dt>Doctest:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(()),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(()),</span> <span class="nb">tuple</span><span class="p">())</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(()),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">atleast_shape</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">atleast_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">atleast_shape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.augment_2x2_with_translation">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">augment_2x2_with_translation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_mat2x2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#augment_2x2_with_translation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.augment_2x2_with_translation" title="Permalink to this definition"></a></dt>
<dd><p>helper function to augment shape matrix with a translation component.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.bar_L2_sift">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">bar_L2_sift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#bar_L2_sift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.bar_L2_sift" title="Permalink to this definition"></a></dt>
<dd><p>Normalized SIFT L2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist1</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</p></li>
<li><p><strong>hist2</strong> (<em>ndarray</em>) – Nx128 array of uint8 with pseudomax trick</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –test-bar_L2_sift</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">barl2_dist</span> <span class="o">=</span> <span class="n">bar_L2_sift</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">barl2_dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.bar_cos_sift">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">bar_cos_sift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#bar_cos_sift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.bar_cos_sift" title="Permalink to this definition"></a></dt>
<dd><p>1 - cos dist</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.bbox_center">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">bbox_center</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_center"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.bbox_center" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.bbox_from_center_wh">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">bbox_from_center_wh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center_xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_from_center_wh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.bbox_from_center_wh" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.bbox_from_extent">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">bbox_from_extent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extent</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_from_extent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.bbox_from_extent" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>extent</strong> (<em>ndarray</em>) – tl_x, br_x, tl_y, br_y</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tl_x, tl_y, w, h</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bbox (ndarray)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="n">bbox_from_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;bbox = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">bbox = [0, 0, 10, 10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.bbox_from_verts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">bbox_from_verts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">castint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_from_verts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.bbox_from_verts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.bbox_from_xywh">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">bbox_from_xywh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_rel_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">0]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_from_xywh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.bbox_from_xywh" title="Permalink to this definition"></a></dt>
<dd><p>need to specify xy_rel_pos if xy is not in tl already</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.bboxes_from_vert_list">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">bboxes_from_vert_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verts_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">castint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bboxes_from_vert_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.bboxes_from_vert_list" title="Permalink to this definition"></a></dt>
<dd><p>Fit the bounding polygon inside a rectangle</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.beaton_tukey_loss">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">beaton_tukey_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#beaton_tukey_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.beaton_tukey_loss" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia.plottool.draw_func2 –exec-plot_func –show –range=-8,8 –func=vt.beaton_tukey_weight,vt.beaton_tukey_loss</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Steward_Robust%20parameter%20estimation%20in%20computer%20vision.pdf</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.beaton_tukey_weight">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">beaton_tukey_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#beaton_tukey_weight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.beaton_tukey_weight" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia.plottool.draw_func2 –exec-plot_func –show –range=-8,8 –func=vt.beaton_tukey_weight</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Steward_Robust%20parameter%20estimation%20in%20computer%20vision.pdf</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.blend_images">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">blend_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'average'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.blend_images" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img1</strong> (<em>np.ndarray</em>) – first image</p></li>
<li><p><strong>img2</strong> (<em>np.ndarray</em>) – second image</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – can be average, multiply, or overlay</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.blend_images_average">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">blend_images_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.blend_images_average" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – (default = 0.5)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>imgB</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.blend blend_images_average:0 –show
python -m vtool.blend blend_images_average:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_average</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">blend_images_average</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s1">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="s1">&#39;alpha=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.blend_images_average_stack">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">blend_images_average_stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_average_stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.blend_images_average_stack" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – (default = 0.5)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>imgB</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.blend –test-blend_images_average:0 –show
python -m vtool.blend –test-blend_images_average:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_average</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.blend_images_mult_average">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">blend_images_mult_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_mult_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.blend_images_mult_average" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – (default = 0.5)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>imgB</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.blend –test-blend_images_mult_average:0 –show
python -m vtool.blend –test-blend_images_mult_average:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_mult_average</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">blend_images_mult_average</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s1">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="s1">&#39;alpha=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.blend_images_multiply">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">blend_images_multiply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_multiply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.blend_images_multiply" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – (default = 0.5)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>imgB</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.blend –test-blend_images_multiply:0 –show
python -m vtool.blend –test-blend_images_multiply:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_multiply</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">blend_images_multiply</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s1">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="s1">&#39;alpha=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.breakup_equal_streak">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">breakup_equal_streak</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#breakup_equal_streak"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.breakup_equal_streak" title="Permalink to this definition"></a></dt>
<dd><p>Breaks up streaks of equal values by interpolating between the next lowest and next highest value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr_in</strong> – </p></li>
<li><p><strong>left_endpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>right_endpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>arr -</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –exec-breakup_equal_streak
python -m vtool.util_math –test-ensure_monotone_strictly_increasing –show –offset=0</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">1.20488135</span><span class="p">,</span>  <span class="mf">1.2529297</span> <span class="p">,</span>  <span class="mf">1.27306686</span><span class="p">,</span>  <span class="mf">1.29859663</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="mf">1.31769871</span><span class="p">,</span> <span class="mf">1.37102388</span><span class="p">,</span>  <span class="mf">1.38114004</span><span class="p">,</span>  <span class="mf">1.45732054</span><span class="p">,</span>  <span class="mf">1.48119571</span><span class="p">,</span>  <span class="mf">1.48119571</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.5381895</span> <span class="p">,</span>  <span class="mf">1.54162741</span><span class="p">,</span>  <span class="mf">1.57492901</span><span class="p">,</span>  <span class="mf">1.61129523</span><span class="p">,</span>  <span class="mf">1.61129523</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.61270343</span><span class="p">,</span>  <span class="mf">1.63377551</span><span class="p">,</span>  <span class="mf">1.7423034</span> <span class="p">,</span>  <span class="mf">1.76364247</span><span class="p">,</span>  <span class="mf">1.79908459</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.83564709</span><span class="p">,</span>  <span class="mf">1.83819742</span><span class="p">,</span>  <span class="mf">1.83819742</span><span class="p">,</span>  <span class="mf">1.86786967</span><span class="p">,</span>  <span class="mf">1.86786967</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.90720142</span><span class="p">,</span>  <span class="mf">1.90720142</span><span class="p">,</span>  <span class="mf">1.92293973</span><span class="p">,</span>  <span class="mf">1.92293973</span><span class="p">,</span> <span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left_endpoint</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right_endpoint</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">breakup_equal_streak</span><span class="p">(</span><span class="n">arr_in</span><span class="p">,</span> <span class="n">left_endpoint</span><span class="p">,</span> <span class="n">right_endpoint</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_increasing</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;arr = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.build_affine_lstsqrs_Mx6">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">build_affine_lstsqrs_Mx6</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy1_man</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy2_man</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#build_affine_lstsqrs_Mx6"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.build_affine_lstsqrs_Mx6" title="Permalink to this definition"></a></dt>
<dd><p>CURRENTLY NOT WORKING</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.spatial_verification –test-build_affine_lstsqrs_Mx6</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_man</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_man</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Mx6</span> <span class="o">=</span> <span class="n">build_affine_lstsqrs_Mx6</span><span class="p">(</span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">Mx6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">Mx6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x1, y1, x2, y2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">A</span><span class="p">))</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">A</span><span class="p">))</span><span class="o">.</span><span class="n">pinv</span><span class="p">()</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf">https://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf</a> page 22</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.build_lstsqrs_Mx9">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">build_lstsqrs_Mx9</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy1_mn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy2_mn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#build_lstsqrs_Mx9"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.build_lstsqrs_Mx9" title="Permalink to this definition"></a></dt>
<dd><p>Builds the M x 9 least squares matrix</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.spatial_verification –test-build_lstsqrs_Mx9</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Mx9</span> <span class="o">=</span> <span class="n">build_lstsqrs_Mx9</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">Mx9</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">suppress_small</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[  0.00e+00,   0.00e+00,   0.00e+00,  -3.20e+01,  -2.72e+01,</span>
<span class="go">            -1.00e+00,   8.82e+02,   7.49e+02,   2.76e+01],</span>
<span class="go">          [  3.20e+01,   2.72e+01,   1.00e+00,   0.00e+00,   0.00e+00,</span>
<span class="go">             0.00e+00,  -1.09e+03,  -9.28e+02,  -3.42e+01]], dtype=np.float64)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://dip.sun.ac.za/~stefan/TW793/attach/notes/homography_estimation.pdf">http://dip.sun.ac.za/~stefan/TW793/attach/notes/homography_estimation.pdf</a>
<a class="reference external" href="http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf">http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf</a> Page 317
<a class="reference external" href="http://vision.ece.ucsb.edu/~zuliani/Research/RANSAC/docs/RANSAC4Dummies.pdf">http://vision.ece.ucsb.edu/~zuliani/Research/RANSAC/docs/RANSAC4Dummies.pdf</a> page 53</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.calc_error_bars_from_sample">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">calc_error_bars_from_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_positive</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#calc_error_bars_from_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.calc_error_bars_from_sample" title="Permalink to this definition"></a></dt>
<dd><p>Determines a error bars of sample</p>
<p class="rubric">References</p>
<p><a class="reference external" href="https://www.qualtrics.com/blog/determining-sample-size/">https://www.qualtrics.com/blog/determining-sample-size/</a>
<a class="reference external" href="http://www.surveysystem.com/sscalc.htm">http://www.surveysystem.com/sscalc.htm</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Sample_size_determination">https://en.wikipedia.org/wiki/Sample_size_determination</a>
<a class="reference external" href="http://www.surveysystem.com/sample-size-formula.htm">http://www.surveysystem.com/sample-size-formula.htm</a>
<a class="reference external" href="http://courses.wcupa.edu/rbove/Berenson/10th%20ed%20CD-ROM%20topics/section8_7.pdf">http://courses.wcupa.edu/rbove/Berenson/10th%20ed%20CD-ROM%20topics/section8_7.pdf</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Standard_normal_table">https://en.wikipedia.org/wiki/Standard_normal_table</a>
<a class="reference external" href="https://www.unc.edu/~rls/s151-2010/class23.pdf">https://www.unc.edu/~rls/s151-2010/class23.pdf</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.calc_sample_from_error_bars">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">calc_sample_from_error_bars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">err_frac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#calc_sample_from_error_bars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.calc_sample_from_error_bars" title="Permalink to this definition"></a></dt>
<dd><p>Determines a reasonable sample size to achieve desired error bars.</p>
<p>import sympy
p, n, N, z = sympy.symbols(‘prior, ss, pop, zval’)
me = sympy.symbols(‘err_frac’)
expr = (z * sympy.sqrt((p * (1 - p) / n) * ((N - n) / (N - 1))))
equation = sympy.Eq(me, expr)
nexpr = sympy.solve(equation, [n])[0]
nexpr = sympy.simplify(nexpr)</p>
<p>import autopep8
print(autopep8.fix_lines([‘ss = ‘ + str(nexpr)], autopep8._get_options({}, False)))</p>
<p>ss = -pop * prior* (zval**2) <em>(prior - 1) / ((err_frac *</em> 2) * pop - (err_frac**2) - prior * (zval**2) * (prior - 1))
ss = pop * prior * zval ** 2 * (prior - 1) / (-err_frac ** 2 * pop + err_frac ** 2 + prior * zval ** 2 * (prior - 1))</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.cast_split">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">cast_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#cast_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.cast_split" title="Permalink to this definition"></a></dt>
<dd><p>breakup keypoints into location, shape, and orientation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.check_exif_keys">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">check_exif_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pil_img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#check_exif_keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.check_exif_keys" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.check_expr_eq">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">check_expr_eq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#check_expr_eq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.check_expr_eq" title="Permalink to this definition"></a></dt>
<dd><p>Does not work in general. Problem is not decidable.
Thanks Richard.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expr1</strong> – </p></li>
<li><p><strong>expr2</strong> – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.symbolic –test-check_expr_eq</p>
</dd>
<dt>SeeALso:</dt><dd><p>vt.symbolic_randcheck</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.symbolic</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span> <span class="p">[</span><span class="n">sx</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">tx</span> <span class="o">+</span> <span class="n">w1</span><span class="o">*</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">sy</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">ty</span> <span class="o">+</span> <span class="n">w2</span><span class="o">*</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span> <span class="p">[</span><span class="n">sx</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">tx</span> <span class="o">+</span> <span class="n">w1</span><span class="o">*</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">sy</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">ty</span> <span class="o">+</span> <span class="n">w2</span><span class="o">*</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">check_expr_eq</span><span class="p">(</span><span class="n">expr1</span><span class="p">,</span> <span class="n">expr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.check_kpts_in_bounds">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">check_kpts_in_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#check_kpts_in_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.check_kpts_in_bounds" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.check_sift_validity">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">check_sift_validity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sift_uint8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#check_sift_validity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.check_sift_validity" title="Permalink to this definition"></a></dt>
<dd><p>checks if a SIFT descriptor is valid</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.check_unused_kwargs">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">check_unused_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#check_unused_kwargs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.check_unused_kwargs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.circular_distance">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">circular_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#circular_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.circular_distance" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clipnorm">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">clipnorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#clipnorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clipnorm" title="Permalink to this definition"></a></dt>
<dd><p>normalizes arr to the range 0 to 1 using min_ and max_ as clipping bounds</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clipwhite">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">clipwhite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#clipwhite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clipwhite" title="Permalink to this definition"></a></dt>
<dd><p>Strips white borders off an image</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.clipwhite_ondisk">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">clipwhite_ondisk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpath_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#clipwhite_ondisk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.clipwhite_ondisk" title="Permalink to this definition"></a></dt>
<dd><p>Strips white borders off an image on disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fpath_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – </p></li>
<li><p><strong>fpath_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – verbosity flag(default = True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>fpath_out</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image clipwhite_ondisk</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.closest_point">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">closest_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distfunc=&lt;function</span> <span class="pre">L2_sqrd&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#closest_point"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.closest_point" title="Permalink to this definition"></a></dt>
<dd><p>finds the nearest point(s) in pts to (x, y)
pt = np.array([1])
pt_arr = np.array([1.1, 2, .95, 20])[:, None]
distfunc = vt.L2_sqrd</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.closest_point_on_bbox">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">closest_point_on_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#closest_point_on_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.closest_point_on_bbox" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">21</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">closest_point_on_bbox</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_list</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.closest_point_on_line">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">closest_point_on_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#closest_point_on_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.closest_point_on_line" title="Permalink to this definition"></a></dt>
<dd><p>e1 and e2 define two points on the line.
Does not clip to the segment.</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.geometry closest_point_on_line –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">21.83012702</span><span class="p">,</span>  <span class="mf">13.16987298</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">16.83012702</span><span class="p">,</span>  <span class="mf">21.83012702</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span>  <span class="mf">8.16987298</span><span class="p">,</span>  <span class="mf">16.83012702</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">13.16987298</span><span class="p">,</span>   <span class="mf">8.16987298</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">21.83012702</span><span class="p">,</span>  <span class="mf">13.16987298</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_list</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">close_pts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_list</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">closest_point_on_line</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span> <span class="k">for</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">itertwo</span><span class="p">(</span><span class="n">verts</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">L2_sqrd</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">new_pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">new_pt</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">close_pts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidates</span><span class="p">[</span><span class="n">dists</span><span class="o">.</span><span class="n">argmin</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">close_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">close_pts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original point&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">close_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">close_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;closest point on shape&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">p_list</span><span class="p">,</span> <span class="n">close_pts</span><span class="p">)):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.closest_point_on_line_segment">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">closest_point_on_line_segment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#closest_point_on_line_segment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.closest_point_on_line_segment" title="Permalink to this definition"></a></dt>
<dd><p>Finds the closet point from p on line segment (e1, e2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>ndarray</em>) – and xy point</p></li>
<li><p><strong>e1</strong> (<em>ndarray</em>) – the first xy endpoint of the segment</p></li>
<li><p><strong>e2</strong> (<em>ndarray</em>) – the second xy endpoint of the segment</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pt_on_seg - the closest xy point on (e1, e2) from p</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line">http://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line</a>
<a class="reference external" href="http://stackoverflow.com/questions/849211/shortest-distance-between-a-point-and-a-line-segment">http://stackoverflow.com/questions/849211/shortest-distance-between-a-point-and-a-line-segment</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.geometry –exec-closest_point_on_line_segment –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#bbox = np.array([10, 10, 10, 10], dtype=np.float)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#verts_ = np.array(vt.verts_from_bbox(bbox, close=True))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#R = vt.rotation_around_bbox_mat3x3(vt.TAU / 3, bbox)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#verts = vt.transform_points_with_homography(R, verts_.T).T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">21.83012702</span><span class="p">,</span>  <span class="mf">13.16987298</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">16.83012702</span><span class="p">,</span>  <span class="mf">21.83012702</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span>  <span class="mf">8.16987298</span><span class="p">,</span>  <span class="mf">16.83012702</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">13.16987298</span><span class="p">,</span>   <span class="mf">8.16987298</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">[</span> <span class="mf">21.83012702</span><span class="p">,</span>  <span class="mf">13.16987298</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_list</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">close_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">closest_point_on_vert_segments</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">verts</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original point&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">close_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">close_pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;closest point on shape&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">p_list</span><span class="p">,</span> <span class="n">close_pts</span><span class="p">)):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.closest_point_on_vert_segments">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">closest_point_on_vert_segments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#closest_point_on_vert_segments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.closest_point_on_vert_segments" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.colwise_operation">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">colwise_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#colwise_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.colwise_operation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.combine_offset_lists">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">combine_offset_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offsets_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfs_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_tups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sf_tups</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#combine_offset_lists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.combine_offset_lists" title="Permalink to this definition"></a></dt>
<dd><p>Helper for stacking</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.compare_implementations">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">compare_implementations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbl1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbl2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_lbl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compare_implementations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.compare_implementations" title="Permalink to this definition"></a></dt>
<dd><p>tests two different implementations of the same function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.compare_matrix_columns">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">compare_matrix_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp_op=&lt;ufunc</span> <span class="pre">'equal'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logic_op=&lt;ufunc</span> <span class="pre">'logical_or'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compare_matrix_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.compare_matrix_columns" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>REPLACE WITH:</dt><dd><p>qfx2_invalid = logic_op.reduce([comp_op([:, None], qfx2_normnid) for col1 in qfx2_topnid.T])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.compare_matrix_to_rows">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">compare_matrix_to_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp_op=&lt;ufunc</span> <span class="pre">'equal'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logic_op=&lt;ufunc</span> <span class="pre">'logical_or'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compare_matrix_to_rows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.compare_matrix_to_rows" title="Permalink to this definition"></a></dt>
<dd><p>Compares each row in row_list to each row in row matrix using comp_op
Both must have the same number of columns.
Performs logic_op on the results of each individual row</p>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>wbia.algo.hots.nn_weights.mark_name_valid_normalizers</p>
</dd>
</dl>
<p>compop   = np.equal
logic_op = np.logical_or</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.componentwise_dot">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">componentwise_dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#componentwise_dot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.componentwise_dot" title="Permalink to this definition"></a></dt>
<dd><p>a dot product is a componentwise multiplication of
two vector and then a sum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr1</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>arr2</strong> (<em>ndarray</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cosangle</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">arr1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">arr1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosangle</span> <span class="o">=</span> <span class="n">componentwise_dot</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cosangle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ 1.  1.  1.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.compress2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">compress2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compress2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.compress2" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper around numpy compress that makes the signature more similar to take</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.compute_affine">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">compute_affine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy1_man</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy2_man</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#compute_affine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.compute_affine" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xy1_mn</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – xy points in image1</p></li>
<li><p><strong>xy2_mn</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – corresponding xy points in image 2</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A - affine matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[shape=(3,3)]</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.spatial_verification –test-compute_affine:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">compute_affine</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy1_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers_normalized</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A_prime</span> <span class="o">=</span> <span class="n">compute_affine</span><span class="p">(</span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span> <span class="n">A_prime</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">T1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">/=</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip2_blendA</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">get_blended_chip</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rchip2_blendA</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">[[  1.19e+00  -1.06e-02  -4.49e+01]</span>
<span class="go"> [ -2.22e-01   1.12e+00  -2.78e+01]</span>
<span class="go"> [  0.00e+00   0.00e+00   1.00e+00]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.compute_chip">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">compute_chip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gfpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#compute_chip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.compute_chip" title="Permalink to this definition"></a></dt>
<dd><p>Extracts a chip and applies filters</p>
<p>DEPRICATE</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gfpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – image file path string</p></li>
<li><p><strong>bbox</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – bounding box in the format (x, y, w, h)</p></li>
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – angle in radians</p></li>
<li><p><strong>new_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – must maintain the same aspect ratio or else you will get weirdness</p></li>
<li><p><strong>filter_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>chipBGR -  cropped image</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.chip –test-compute_chip –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="n">TAU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gfpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filter_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR</span> <span class="o">=</span> <span class="n">compute_chip</span><span class="p">(</span><span class="n">gfpath</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">new_size</span><span class="p">,</span> <span class="n">filter_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">chipBGR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_size</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;did not resize correctly&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">draw_verts</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">gfpath</span><span class="p">),</span> <span class="n">vt</span><span class="o">.</span><span class="n">scaled_verts_from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.compute_distances">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">compute_distances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['L1',</span> <span class="pre">'L2']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#compute_distances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.compute_distances" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist1</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>hist2</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>dist_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – (default = [‘L1’, ‘L2’])</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dist_dict</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –test-compute_distances</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">,</span> <span class="s1">&#39;L2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_dict</span> <span class="o">=</span> <span class="n">compute_distances</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">,</span> <span class="n">dist_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">dist_dict</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.compute_homog">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">compute_homog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy1_mn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy2_mn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#compute_homog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.compute_homog" title="Permalink to this definition"></a></dt>
<dd><p>Generate 6 degrees of freedom homography transformation
Computes homography from normalized (0 to 1) point correspondences
from 2 –&gt; 1
(database-&gt;query)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xy1_mn</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – xy points in image1</p></li>
<li><p><strong>xy2_mn</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – corresponding xy points in image 2</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>H - homography matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[shape=(3,3)]</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.spatial_verification –test-compute_homog:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">compute_homog</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#result = ut.hashstr(H)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[  1.83e-03   2.85e-03  -7.11e-01]</span>
<span class="go"> [  2.82e-03   1.80e-03  -7.03e-01]</span>
<span class="go"> [  1.67e-05   1.68e-05  -5.53e-03]]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers_normalized</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H_prime</span> <span class="o">=</span> <span class="n">compute_homog</span><span class="p">(</span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span> <span class="n">H_prime</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">T1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">/=</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip2_blendH</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">get_blended_chip</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rchip2_blendH</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">[[  9.22e-01  -2.50e-01   2.75e+01]</span>
<span class="go"> [ -2.04e-01   8.79e-01  -7.94e+00]</span>
<span class="go"> [ -1.82e-04  -5.99e-04   1.00e+00]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.compute_ndarray_unique_rowids_unsafe">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">compute_ndarray_unique_rowids_unsafe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_ndarray_unique_rowids_unsafe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.compute_ndarray_unique_rowids_unsafe" title="Permalink to this definition"></a></dt>
<dd><p>arr = np.random.randint(2, size=(10000, 10))
vt.compute_unique_data_ids_(list(map(tuple, arr)))
len(vt.compute_unique_data_ids_(list(map(tuple, arr))))
len(np.unique(vt.compute_unique_data_ids_(list(map(tuple, arr)))))</p>
<p>%timeit vt.compute_unique_data_ids_(list(map(tuple, arr)))
%timeit compute_ndarray_unique_rowids_unsafe(arr)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.compute_unique_arr_dataids">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">compute_unique_arr_dataids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_arr_dataids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.compute_unique_arr_dataids" title="Permalink to this definition"></a></dt>
<dd><p>specialized version for speed when arr is an ndarray</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.compute_unique_data_ids">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">compute_unique_data_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_data_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.compute_unique_data_ids" title="Permalink to this definition"></a></dt>
<dd><p>This is actually faster than compute_unique_integer_data_ids it seems</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-compute_unique_data_ids</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">.534</span><span class="p">,</span> <span class="mf">.432</span><span class="p">],</span> <span class="p">[</span><span class="mf">.534</span><span class="p">,</span> <span class="mf">.432</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataid_list</span> <span class="o">=</span> <span class="n">compute_unique_data_ids</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;dataid_list = &#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">dataid_list</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">dataid_list = np.array([0, 1, 2, 3, 0, 4, 4, 2, 1], dtype=np.int32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.compute_unique_data_ids_">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">compute_unique_data_ids_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hashable_rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iddict_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_data_ids_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.compute_unique_data_ids_" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.compute_unique_integer_data_ids">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">compute_unique_integer_data_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_integer_data_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.compute_unique_integer_data_ids" title="Permalink to this definition"></a></dt>
<dd><p>This is actually slower than compute_unique_data_ids it seems</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">compute_unique_data_ids</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">compute_unique_integer_data_ids</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p>%timeit compute_unique_data_ids(data)
%timeit compute_unique_integer_data_ids(data)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.convert_colorspace">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">convert_colorspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_colorspace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BGR'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#convert_colorspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.convert_colorspace" title="Permalink to this definition"></a></dt>
<dd><p>Converts colorspace of img.
Convinience function around cv2.cvtColor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>colorspace</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – RGB, LAB, etc</p></li>
<li><p><strong>src_colorspace</strong> (<em>unicode</em>) – (default = u’BGR’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>img -  image data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[uint8_t, ndim=2]</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image convert_colorspace –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;zebra.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://itsnasb.com/wp-content/uploads/2013/03/lisa-frank-logo1.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_float</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_float01</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">colorspace</span> <span class="o">=</span> <span class="s1">&#39;LAB&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">src_colorspace</span> <span class="o">=</span> <span class="s1">&#39;BGR&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgLAB</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgL</span> <span class="o">=</span> <span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillL</span> <span class="o">=</span> <span class="n">imgL</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillAB</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">is_float</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">else</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgAB_LAB</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">fillL</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgA_LAB</span>  <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="n">fillL</span><span class="p">,</span> <span class="n">fillAB</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB_LAB</span>  <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="n">fillL</span><span class="p">,</span> <span class="n">fillAB</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgAB_BGR</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">imgAB_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgA_BGR</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">imgA_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB_BGR</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">imgB_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#imgAB_HSV = convert_colorspace(convert_colorspace(imgAB_LAB, &#39;LAB&#39;, &#39;BGR&#39;), &#39;BGR&#39;, &#39;HSV&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgAB_HSV</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="s1">&#39;HSV&#39;</span><span class="p">,</span> <span class="s1">&#39;BGR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgAB_HSV</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mf">.6</span> <span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">is_float</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">else</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgCOLOR_BRG</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">imgAB_HSV</span><span class="p">,</span> <span class="s1">&#39;BGR&#39;</span><span class="p">,</span> <span class="s1">&#39;HSV&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgL</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;L (lightness)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A (grayscale)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B (grayscale)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgCOLOR_BRG</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Hue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgAB_BGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A+B (color overlay)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgA_BGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A (Red-Green)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB_BGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;B (Blue-Yellow)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgblind_LAB</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">fillAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgblind_BRG</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">rgblind_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">byblind_LAB</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">embed_channels</span><span class="p">(</span><span class="n">imgLAB</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">fillAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">byblind_BGR</span> <span class="o">=</span> <span class="n">convert_colorspace</span><span class="p">(</span><span class="n">byblind_LAB</span><span class="p">,</span> <span class="n">src_colorspace</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">byblind_BGR</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;colorblind B-Y&#39;</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rgblind_BRG</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;colorblind R-G&#39;</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.convert_degrees">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">convert_degrees</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#convert_degrees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.convert_degrees" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to convert the GPS coordinates stored in the EXIF to degress in float format</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Geographic_coordinate_conversion">http://en.wikipedia.org/wiki/Geographic_coordinate_conversion</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.convert_image_list_colorspace">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">convert_image_list_colorspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_colorspace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BGR'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#convert_image_list_colorspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.convert_image_list_colorspace" title="Permalink to this definition"></a></dt>
<dd><p>converts a list of images from &lt;src_colorspace&gt; to &lt;colorspace&gt;</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.convert_kptsZ_to_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">convert_kptsZ_to_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts_Z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#convert_kptsZ_to_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.convert_kptsZ_to_kpts" title="Permalink to this definition"></a></dt>
<dd><p>Convert keypoints in Z format to invV format</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.cos_sift">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">cos_sift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#cos_sift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.cos_sift" title="Permalink to this definition"></a></dt>
<dd><p>cos dist</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –test-cos_sift</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2_dist</span> <span class="o">=</span> <span class="n">cos_sift</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.cosine_dist">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">cosine_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#cosine_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.cosine_dist" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.crop_out_imgfill">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">crop_out_imgfill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#crop_out_imgfill"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.crop_out_imgfill" title="Permalink to this definition"></a></dt>
<dd><p>Crops image to remove fillval</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>fillval</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – (default = 0)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cropped_img</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –exec-crop_out_imgfill</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_stripe_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="n">img</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_GRAY2RGB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_img</span> <span class="o">=</span> <span class="n">crop_out_imgfill</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">fillval</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_img2</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">cropped_img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_RGB2GRAY</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;cropped_img2 = </span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cropped_img2</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_stripe_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="n">img</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillval</span> <span class="o">=</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_img</span> <span class="o">=</span> <span class="n">crop_out_imgfill</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">fillval</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;cropped_img = </span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cropped_img</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.csum">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">csum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#csum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.csum" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.custom_sympy_attrs">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">custom_sympy_attrs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#custom_sympy_attrs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.custom_sympy_attrs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.cvt_BGR2L">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">cvt_BGR2L</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#cvt_BGR2L"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.cvt_BGR2L" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.cvt_BGR2RGB">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">cvt_BGR2RGB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#cvt_BGR2RGB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.cvt_BGR2RGB" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.cvt_bbox_xywh_to_pt1pt2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">cvt_bbox_xywh_to_pt1pt2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xywh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">round_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#cvt_bbox_xywh_to_pt1pt2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.cvt_bbox_xywh_to_pt1pt2" title="Permalink to this definition"></a></dt>
<dd><p>Converts bbox to thumb format with a scale factor</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.cyclic_distance">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">cyclic_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modulo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#cyclic_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.cyclic_distance" title="Permalink to this definition"></a></dt>
<dd><p>returns an unsigned distance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr1</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>arr2</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>modulo</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
<li><p><strong>out</strong> (<em>ndarray</em>) – (default = None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>arr_dist</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance cyclic_distance</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modulo</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># doesnt matter what offset is</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">modulo</span> <span class="o">+</span> <span class="n">offset</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">arr1</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_dist</span> <span class="o">=</span> <span class="n">cyclic_distance</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="n">modulo</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;arr_dist =</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_dist</span><span class="p">),))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.decompose_Z_to_RV_mats2x2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">decompose_Z_to_RV_mats2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z_mats2x2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#decompose_Z_to_RV_mats2x2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.decompose_Z_to_RV_mats2x2" title="Permalink to this definition"></a></dt>
<dd><p>A, B, C = [0.016682, 0.001693, 0.014927]
# A, B, C = [0.010141, -1.1e-05, 0.02863]
Z = np.array([[A, B], [B, C]])</p>
<p>A, B, C = 0.010141, -1.1e-05, 0.02863</p>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Working on figuring relationship between us and VGG</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">Z_mats2x2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">circle_xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">invV_mats</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">circle_xy</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">invV</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">],</span> <span class="p">[</span><span class="n">_</span><span class="p">,</span> <span class="n">C</span><span class="p">]]</span> <span class="o">=</span> <span class="n">E</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[[</span><span class="n">A_</span><span class="p">,</span> <span class="n">B_</span><span class="p">],</span> <span class="p">[</span><span class="n">_</span><span class="p">,</span> <span class="n">C_</span><span class="p">]]</span> <span class="o">=</span> <span class="n">E</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">X</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">X</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">Y</span><span class="p">)</span> <span class="o">+</span> <span class="n">C</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">Y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z_mats2x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[[</span> <span class="mf">.016682</span><span class="p">,</span> <span class="mf">.001693</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span> <span class="mf">.001693</span><span class="p">,</span> <span class="mf">.014927</span><span class="p">]],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[[</span> <span class="mf">.01662</span><span class="p">,</span> <span class="mf">.001693</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span> <span class="mf">.001693</span><span class="p">,</span> <span class="mf">.014927</span><span class="p">]],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[[</span> <span class="mf">.016682</span><span class="p">,</span> <span class="mf">.00193</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span> <span class="mf">.00193</span><span class="p">,</span> <span class="mf">.01492</span><span class="p">]],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.linalg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">timeit</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">sqrtm</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="k">for</span> <span class="n">Z</span> <span class="ow">in</span> <span class="n">Z_mats2x2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">timeit</span> <span class="n">decompose_Z_to_VR_mats2x2</span><span class="p">(</span><span class="n">Z_mats2x2</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.decompose_Z_to_V_2x2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">decompose_Z_to_V_2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z_2x2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#decompose_Z_to_V_2x2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.decompose_Z_to_V_2x2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.decompose_Z_to_invV_2x2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">decompose_Z_to_invV_2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z_2x2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#decompose_Z_to_invV_2x2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.decompose_Z_to_invV_2x2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.decompose_Z_to_invV_mats2x2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">decompose_Z_to_invV_mats2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z_mats2x2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#decompose_Z_to_invV_mats2x2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.decompose_Z_to_invV_mats2x2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.demodata_match">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">demodata_match</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recompute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#demodata_match"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.demodata_match" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.det_distance">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">det_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">det1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">det2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#det_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.det_distance" title="Permalink to this definition"></a></dt>
<dd><p>Returns how far off determinants are from one another</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaledist</span> <span class="o">=</span> <span class="n">det_distance</span><span class="p">(</span><span class="n">det1</span><span class="p">,</span> <span class="n">det2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">scaledist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.det_ltri">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">det_ltri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ltri</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#det_ltri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.det_ltri" title="Permalink to this definition"></a></dt>
<dd><p>Lower triangular determinant</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.detect_opencv_keypoints">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">detect_opencv_keypoints</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#detect_opencv_keypoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.detect_opencv_keypoints" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.distance_to_lineseg">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">distance_to_lineseg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#distance_to_lineseg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.distance_to_lineseg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.dot_ltri">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">dot_ltri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ltri1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ltri2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#dot_ltri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.dot_ltri" title="Permalink to this definition"></a></dt>
<dd><p>Lower triangular dot product</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.draw_border">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">draw_border</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">128,</span> <span class="pre">255)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thickness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#draw_border"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.draw_border" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_in</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>color</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – in bgr</p></li>
<li><p><strong>thickness</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
<li><p><strong>out</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.geometry –test-draw_border –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_in</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:plottool)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">draw_border</span><span class="p">(</span><span class="n">img_in</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.draw_kp_ori_steps">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">draw_kp_ori_steps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#draw_kp_ori_steps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.draw_kp_ori_steps" title="Permalink to this definition"></a></dt>
<dd><p>Shows steps in orientation estimation</p>
<dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-draw_kp_ori_steps –show –fname=zebra.png –fx=121
python -m vtool.patch –test-draw_kp_ori_steps –show –interact
python -m vtool.patch –test-draw_kp_ori_steps –save ~/latex/crall-candidacy-2015/figures/test_fint_kp_direction.jpg –dpath figures ‘–caption=visualization of the steps in the computation of the dominant gradient orientations.’ –figsize=14,9 –dpi=160 –height=2.65  –left=.04 –right=.96 –top=.95 –bottom=.05 –wspace=.1 –hspace=.1</p>
<p>python -m vtool.patch –test-draw_kp_ori_steps –dpath ~/latex/crall-candidacy-2015/ –save figures/draw_kp_ori_steps.jpg  –figsize=14,9 –dpi=180 –height=2.65 –left=.04 –right=.96 –top=.95 –bottom=.05 –wspace=.1 –hspace=.1 –diskshow</p>
<p>python -m vtool.patch –test-draw_kp_ori_steps –dpath ~/latex/crall-candidacy-2015/ –save figures/draw_kp_ori_steps.jpg  –figsize=14,9 –dpi=180  –djust=.04,.05,.1 –diskshow –fname=zebra.png –fx=121</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_kp_ori_steps</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.draw_precision_recall_curve">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">draw_precision_recall_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recall_domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_interp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_pref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#draw_precision_recall_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.draw_precision_recall_curve" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.draw_roc_curve">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">draw_roc_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tpr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_tpr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_fpr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_operating_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#draw_roc_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.draw_roc_curve" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fpr</strong> – </p></li>
<li><p><strong>tpr</strong> – </p></li>
<li><p><strong>fnum</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – figure number(default = None)</p></li>
<li><p><strong>pnum</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – plot number(default = None)</p></li>
<li><p><strong>marker</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – (default = ‘-x’)</p></li>
<li><p><strong>target_tpr</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>target_fpr</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>thresholds</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>color</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>show_operating_point</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.confusion –exec-draw_roc_curve –show –lightbg</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpr</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">fpr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tpr</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">tpr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresholds</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">thresholds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fnum</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pnum</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_tpr</span> <span class="o">=</span> <span class="mf">.85</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_fpr</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_operating_point</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_roc_curve</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">target_tpr</span><span class="p">,</span> <span class="n">target_fpr</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">thresholds</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">show_operating_point</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.draw_text">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">draw_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">textcolor_rgb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontScale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thickness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontFace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineType</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottomLeftOrigin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#draw_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.draw_text" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-draw_text:0 –show
python -m vtool.image –test-draw_text:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">font_names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cv2</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;FONT_H&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;opencv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">400</span><span class="p">,</span> <span class="mi">1024</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fontScale</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CV_AA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">font_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">font_names</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">font_name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fontFace</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">font_name</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">count</span> <span class="o">*</span> <span class="mi">45</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;opencv - &#39;</span> <span class="o">+</span> <span class="n">font_name</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">draw_text</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">org</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">fontFace</span><span class="o">=</span><span class="n">fontFace</span><span class="p">,</span> <span class="n">textcolor_rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="n">fontScale</span><span class="o">=</span><span class="n">fontScale</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">font_names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cv2</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;FONT_H&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;opencv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">400</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span> <span class="p">:</span><span class="mi">512</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">200</span><span class="p">:,</span> <span class="mi">512</span><span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fontScale</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CV_AA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">font_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">font_names</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">font_name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fontFace</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">font_name</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">count</span> <span class="o">*</span> <span class="mi">45</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;opencv - &#39;</span> <span class="o">+</span> <span class="n">font_name</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">draw_text</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">org</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">fontFace</span><span class="o">=</span><span class="n">fontFace</span><span class="p">,</span> <span class="n">textcolor_rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="n">fontScale</span><span class="o">=</span><span class="n">fontScale</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p>where each of the font IDs can be combined with FONT_ITALIC to get the slanted letters.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.draw_verts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">draw_verts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">128,</span> <span class="pre">255)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thickness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#draw_verts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.draw_verts" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_in</strong> – </p></li>
<li><p><strong>verts</strong> – </p></li>
<li><p><strong>color</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – </p></li>
<li><p><strong>thickness</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>img -  image data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[uint8_t, ndim=2]</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.geometry –test-draw_verts –show
python -m vtool.geometry –test-draw_verts:0 –show
python -m vtool.geometry –test-draw_verts:1 –show</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/core/doc/drawing_functions.html#line">http://docs.opencv.org/modules/core/doc/drawing_functions.html#line</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_in</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">draw_verts</span><span class="p">(</span><span class="n">img_in</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_in</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">img</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">img</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">img_in</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_in</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">img_in</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">draw_verts</span><span class="p">(</span><span class="n">img_in</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_in</span> <span class="ow">is</span> <span class="n">img</span><span class="p">,</span> <span class="s1">&#39;should be in place&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">out</span> <span class="ow">is</span> <span class="n">img</span><span class="p">,</span> <span class="s1">&#39;should be in place&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p>out = img_in = np.zeros((500, 500, 3), dtype=np.uint8)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.dummy_img">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">dummy_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#dummy_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.dummy_img" title="Permalink to this definition"></a></dt>
<dd><p>Creates a demodata test image</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.dummy_seed">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">dummy_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#dummy_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.dummy_seed" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.embed_channels">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">embed_channels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nchannels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#embed_channels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.embed_channels" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>input_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – (default = (0,))</p></li>
<li><p><strong>nchannels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – (default = 3)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image embed_channels –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Embed a (N,M,2) image into an (N,M,3) image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_channels</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nchannels</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newimg</span> <span class="o">=</span> <span class="n">embed_channels</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">input_channels</span><span class="p">,</span> <span class="n">nchannels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">newimg</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">newimg</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">input_channels</span><span class="p">]</span> <span class="o">==</span> <span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.embed_in_square_image">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">embed_in_square_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_origin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_origin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#embed_in_square_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.embed_in_square_image" title="Permalink to this definition"></a></dt>
<dd><p>Embeds an image in the center of an empty image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>target_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – </p></li>
<li><p><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – position of</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>img_sqare</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image embed_in_square_image –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_size</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">))</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_origin</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_origin</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_square</span> <span class="o">=</span> <span class="n">embed_in_square_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">target_size</span><span class="p">,</span> <span class="n">img_origin</span><span class="p">,</span> <span class="n">target_origin</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_square</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="n">img</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img_square</span><span class="p">)</span> <span class="o">==</span> <span class="n">target_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_origin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_origin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_square2</span> <span class="o">=</span> <span class="n">embed_in_square_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">target_size</span><span class="p">,</span> <span class="n">img_origin</span><span class="p">,</span> <span class="n">target_origin</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_square</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="n">img</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img_square</span><span class="p">)</span> <span class="o">==</span> <span class="n">target_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_square</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_square2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.emd">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">emd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cost_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sift'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#emd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.emd" title="Permalink to this definition"></a></dt>
<dd><p>earth mover’s distance by robjects(lpSovle::lp.transport)
require: lpsolve55-5.5.0.9.win32-py2.7.exe</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –test-emd</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emd_dists</span> <span class="o">=</span> <span class="n">emd</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">emd_dists</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.empty_assign">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">empty_assign</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#empty_assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.empty_assign" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.empty_neighbors">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">empty_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_vecs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#empty_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.empty_neighbors" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ensure_3channel">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ensure_3channel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#ensure_3channel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ensure_3channel" title="Permalink to this definition"></a></dt>
<dd><p>DEPRICATE IN FAVOR OF atleast_3channels?</p>
<p>Ensures that there are 3 channels in the image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>patch</strong> (<em>ndarray</em><em>[</em><em>N</em><em>, </em><em>M</em><em>, </em><em>...</em><em>]</em>) – the image</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[N, M, 3]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –exec-ensure_3channel –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch1</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;astro.png&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">:</span><span class="mi">512</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span> <span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;ada.jpg&#39;</span><span class="p">))[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch3</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;jeff.png&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">:</span><span class="mi">390</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">400</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res1</span> <span class="o">=</span> <span class="n">ensure_3channel</span><span class="p">(</span><span class="n">patch1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res2</span> <span class="o">=</span> <span class="n">ensure_3channel</span><span class="p">(</span><span class="n">patch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res3</span> <span class="o">=</span> <span class="n">ensure_3channel</span><span class="p">(</span><span class="n">patch3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">patch1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;failed test1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">patch2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;failed test2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">patch3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;failed test3&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ensure_4channel">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ensure_4channel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#ensure_4channel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ensure_4channel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ensure_alpha_channel">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ensure_alpha_channel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#ensure_alpha_channel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ensure_alpha_channel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ensure_grayscale">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ensure_grayscale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorspace_hint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BGR'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#ensure_grayscale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ensure_grayscale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ensure_metadata_dlen_sqrd">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ensure_metadata_dlen_sqrd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_dlen_sqrd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ensure_metadata_dlen_sqrd" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ensure_metadata_feats">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ensure_metadata_feats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_feats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ensure_metadata_feats" title="Permalink to this definition"></a></dt>
<dd><p>Adds feature evaluation keys to a lazy dictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>annot</strong> (<em>utool.LazyDict</em>) – </p></li>
<li><p><strong>suffix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – (default = ‘’)</p></li>
<li><p><strong>cfgdict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – (default = {})</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.matching –exec-ensure_metadata_feats</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">LazyDict</span><span class="p">({</span><span class="s1">&#39;rchip_fpath&#39;</span><span class="p">:</span> <span class="n">rchip_fpath</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_metadata_feats</span><span class="p">(</span><span class="n">annot</span><span class="p">,</span> <span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">annot</span><span class="o">.</span><span class="n">_stored_results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span><span class="p">[</span><span class="s1">&#39;kpts&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">annot</span><span class="o">.</span><span class="n">_stored_results</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span><span class="p">[</span><span class="s1">&#39;vecs&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">annot</span><span class="o">.</span><span class="n">_stored_results</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ensure_metadata_flann">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ensure_metadata_flann</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_flann"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ensure_metadata_flann" title="Permalink to this definition"></a></dt>
<dd><p>setup lazy flann evaluation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ensure_metadata_normxy">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ensure_metadata_normxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_normxy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ensure_metadata_normxy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ensure_metadata_vsone">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ensure_metadata_vsone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annot1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annot2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_metadata_vsone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ensure_metadata_vsone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ensure_monotone_decreasing">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ensure_monotone_decreasing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fromleft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fromright</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#ensure_monotone_decreasing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ensure_monotone_decreasing" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>ndarray</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>arr</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –test-ensure_monotone_decreasing –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_decreasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">fromright</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fromleft</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ensure_monotone_increasing">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ensure_monotone_increasing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fromright</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fromleft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#ensure_monotone_increasing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ensure_monotone_increasing" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>ndarray</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>arr</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –test-ensure_monotone_increasing –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">argval</span><span class="p">(</span><span class="s1">&#39;--offset&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">2.3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">fromleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fromright</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (increasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ensure_monotone_strictly_decreasing">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ensure_monotone_strictly_decreasing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#ensure_monotone_strictly_decreasing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ensure_monotone_strictly_decreasing" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>left_endpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – </p></li>
<li><p><strong>right_endpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>arr</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –test-ensure_monotone_strictly_decreasing –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">75</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.05</span> <span class="o">+</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#arr_ = vt.demodata.testdata_nonmonotonic()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#domain = np.arange(len(arr_))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left_endpoint</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right_endpoint</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_strictly_decreasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">left_endpoint</span><span class="p">,</span> <span class="n">right_endpoint</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_decreasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s1">&#39;ensure strict monotonic failed&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">ensure_monotone_decreasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (strictly decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ensure_monotone_strictly_increasing">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ensure_monotone_strictly_increasing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zerohack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onehack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#ensure_monotone_strictly_increasing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ensure_monotone_strictly_increasing" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>ndarray</em>) – sequence to monotonize</p></li>
<li><p><strong>zerohack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – default False, if True sets the first element to be zero and linearlly interpolates to the first nonzero item</p></li>
<li><p><strong>onehack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – default False, if True one will not be in the resulting array (replaced with number very close to one)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://mathoverflow.net/questions/17464/making-a-non-monotone-function-monotone">http://mathoverflow.net/questions/17464/making-a-non-monotone-function-monotone</a>
<a class="reference external" href="http://stackoverflow.com/questions/28563711/make-a-numpy-array-monotonic-without-a-python-loop">http://stackoverflow.com/questions/28563711/make-a-numpy-array-monotonic-without-a-python-loop</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Isotonic_regression">https://en.wikipedia.org/wiki/Isotonic_regression</a>
<a class="reference external" href="http://scikit-learn.org/stable/auto_examples/plot_isotonic_regression.html">http://scikit-learn.org/stable/auto_examples/plot_isotonic_regression.html</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –test-ensure_monotone_strictly_increasing –show
python -m vtool.util_math –test-ensure_monotone_strictly_increasing –show –offset=0</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>   <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.91</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_strictly_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_increasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s1">&#39;ensure strict monotonic failed1&#39;</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left_endpoint</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right_endpoint</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--offset&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">2.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.1</span> <span class="o">+</span> <span class="mf">1.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#arr_ = vt.demodata.testdata_nonmonotonic()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#domain = np.arange(len(arr_))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_strictly_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">left_endpoint</span><span class="p">,</span> <span class="n">right_endpoint</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">arr</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">non_decreasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s1">&#39;ensure nondecreasing failed2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_increasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s1">&#39;ensure strict monotonic failed2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">ensure_monotone_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after monotonization (strictly decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ensure_rng">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ensure_rng</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#ensure_rng"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ensure_rng" title="Permalink to this definition"></a></dt>
<dd><p>Returns a numpy random number generator given a seed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ensure_shape">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ensure_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimshape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#ensure_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ensure_shape" title="Permalink to this definition"></a></dt>
<dd><p>TODO: Submit as a PR to numpy?</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.estimate_pdf">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">estimate_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#estimate_pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.estimate_pdf" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>References;</dt><dd><p><a class="reference external" href="http://statsmodels.sourceforge.net/devel/generated/statsmodels.nonparametric.kde.KDEUnivariate.html">http://statsmodels.sourceforge.net/devel/generated/statsmodels.nonparametric.kde.KDEUnivariate.html</a>
<a class="reference external" href="https://jakevdp.github.io/blog/2013/12/01/kernel-density-estimation/">https://jakevdp.github.io/blog/2013/12/01/kernel-density-estimation/</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em>) – 1 dimensional data of float64</p></li>
<li><p><strong>gridsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – domain size</p></li>
<li><p><strong>adjust</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – smoothing factor</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>data_pdf</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_pdf</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">estimate_pdf</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_pdf</span><span class="o">.</span><span class="n">support</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">data_pdf</span><span class="o">.</span><span class="n">cdf</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.estimate_refined_transform">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">estimate_refined_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aff_inliers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'homog'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#estimate_refined_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.estimate_refined_transform" title="Permalink to this definition"></a></dt>
<dd><p>estimates final transformation using normalized affine inliers</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/2.4/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html">http://docs.opencv.org/2.4/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.evalprint">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">evalprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">str_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">globals_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locals_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#evalprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.evalprint" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.example_binary">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">example_binary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#example_binary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.example_binary" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.expand_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">expand_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#expand_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.expand_kpts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.expand_scales">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">expand_scales</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nScales</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#expand_scales"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.expand_scales" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.expand_subscales">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">expand_subscales</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subscale_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#expand_subscales"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.expand_subscales" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.extent_from_bbox">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">extent_from_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#extent_from_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.extent_from_bbox" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bbox</strong> (<em>ndarray</em>) – tl_x, tl_y, w, h</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tl_x, br_x, tl_y, br_y</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>extent (ndarray)</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/geometry.py extent_from_bbox</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">extent_from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;extent = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">extent = [0, 10, 0, 10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.extent_from_verts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">extent_from_verts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#extent_from_verts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.extent_from_verts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.extract_chip_from_gpath">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">extract_chip_from_gpath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gfpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_from_gpath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.extract_chip_from_gpath" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.extract_chip_from_gpath_into_square">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">extract_chip_from_gpath_into_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_from_gpath_into_square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.extract_chip_from_gpath_into_square" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.extract_chip_from_img">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">extract_chip_from_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_from_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.extract_chip_from_img" title="Permalink to this definition"></a></dt>
<dd><p>Crops chip from image ; Rotates and scales;</p>
<p>ibs.show_annot_image(aid)[0].pt_save_and_view()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gfpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – </p></li>
<li><p><strong>bbox</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – xywh</p></li>
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
<li><p><strong>new_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – wy</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>chipBGR</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.chip –test-extract_chip_from_img
python -m vtool.chip –test-extract_chip_from_img –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">gtool</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">58</span><span class="p">,</span> <span class="mi">34</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR</span> <span class="o">=</span> <span class="n">extract_chip_from_img</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">new_size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">chipBGR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_size</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;did not resize correctly&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.extract_chip_into_square">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">extract_chip_into_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_into_square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.extract_chip_into_square" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.extract_feature_from_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">extract_feature_from_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#extract_feature_from_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.extract_feature_from_patch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.extract_features">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">extract_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_or_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hesaff+sift'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#extract_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.extract_features" title="Permalink to this definition"></a></dt>
<dd><p>calls pyhesaff’s main driver function for detecting hessian affine keypoints.
extra parameters can be passed to the hessian affine detector by using
kwargs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_or_fpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – image file path on disk</p></li>
<li><p><strong>use_adaptive_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
<li><p><strong>nogravity_hack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(kpts, vecs)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.features –test-extract_features
python -m vtool.features –test-extract_features –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.features</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;lena.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat_type</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">argval</span><span class="p">(</span><span class="s1">&#39;--feat_type&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;hesaff+sift&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyhesaff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">parse_dict_from_argv</span><span class="p">(</span><span class="n">pyhesaff</span><span class="o">.</span><span class="n">get_hesaff_default_params</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#(kpts, vecs) = extract_features(img_fpath)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">extract_features</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">feat_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Show keypoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.figure(fnum=1, doclf=True, docla=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.imshow(imgBGR)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_kpts2(kpts, ori=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">interact_keypoints</span><span class="o">.</span><span class="n">ishow_keypoints</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ell_alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;distinct&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.extrema_neighbors">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">extrema_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extrema_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nBins</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#extrema_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.extrema_neighbors" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.filterflags_valid_images">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">filterflags_valid_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gpaths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_formats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invalid_formats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#filterflags_valid_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.filterflags_valid_images" title="Permalink to this definition"></a></dt>
<dd><p>Flags images with a format that disagrees with its extension</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gpaths</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of image paths</p></li>
<li><p><strong>valid_formats</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>invalid_formats</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – verbosity flag(default = True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>isvalid_flags</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image filterflags_valid_images –show</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>An MPO (Multi Picture Object) file is a stereoscopic image and contains
two JPG images side-by-side, and allows them to be viewed as a single
3D image.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gpaths</span> <span class="o">=</span> <span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;astro.png&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">filterflags_valid_images</span><span class="p">(</span><span class="n">gpaths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.find_best_undirected_edge_indexes">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">find_best_undirected_edge_indexes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directed_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_best_undirected_edge_indexes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.find_best_undirected_edge_indexes" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>directed_edges</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </p></li>
<li><p><strong>score_arr</strong> (<em>ndarray</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>unique_edge_xs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-find_best_undirected_edge_indexes</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">directed_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_edge_xs</span> <span class="o">=</span> <span class="n">find_best_undirected_edge_indexes</span><span class="p">(</span><span class="n">directed_edges</span><span class="p">,</span> <span class="n">score_arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">unique_edge_xs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[0 3 4 6]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">directed_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_arr</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_edge_xs</span> <span class="o">=</span> <span class="n">find_best_undirected_edge_indexes</span><span class="p">(</span><span class="n">directed_edges</span><span class="p">,</span> <span class="n">score_arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">unique_edge_xs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[0 2 3 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.find_clip_range">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">find_clip_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tp_support</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_support</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.6180339887499997</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#find_clip_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.find_clip_range" title="Permalink to this definition"></a></dt>
<dd><p>TODO: generalize to arbitrary domains (not just 0-&gt;inf)</p>
<p>Finds score to clip true positives past. This is useful when the highest
true positive scores can be much larger than the highest true negative
score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tp_support</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>tn_support</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>clip_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – factor of the true negative domain to search for true positives</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>min_score, max_score</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –test-find_clip_range</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">50000</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">110</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clip_factor</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">PHI</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_score</span><span class="p">,</span> <span class="n">max_score</span> <span class="o">=</span> <span class="n">find_clip_range</span><span class="p">(</span><span class="n">tp_support</span><span class="p">,</span> <span class="n">tn_support</span><span class="p">,</span>  <span class="n">clip_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.4f</span><span class="s1">, </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">((</span><span class="n">min_score</span><span class="p">,</span> <span class="n">max_score</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">10.0000, 287.9837</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.find_dominant_kp_orientations">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">find_dominant_kp_orientations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">36</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxima_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DEBUG_ROTINVAR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#find_dominant_kp_orientations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.find_dominant_kp_orientations" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf">http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf</a>
page 219</p>
<p><a class="reference external" href="http://www.cs.berkeley.edu/~malik/cs294/lowe-ijcv04.pdf">http://www.cs.berkeley.edu/~malik/cs294/lowe-ijcv04.pdf</a>
page 13.</p>
<p>Lowe uses a 36-bin histogram of edge orientations weigted by a gaussian
distance to the center and gradient magintude. He finds all peaks within
80% of the global maximum. Then he fine tunes the orientation using a
3-binned parabolic fit. Multiple orientations (and hence multiple
keypoints) can be returned, but empirically only about 15% will have
these and they do tend to be important.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>ori_offset - offset of current orientation to dominant orientation</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-find_dominant_kp_orientations</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#imgBGR = get_test_patch(&#39;cross&#39;, jitter=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;star.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kp</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;kp = </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">kp_cpp_infostr</span><span class="p">(</span><span class="n">kp</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_oris</span> <span class="o">=</span> <span class="n">find_dominant_kp_orientations</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">kp</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                         <span class="n">maxima_thresh</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                         <span class="n">DEBUG_ROTINVAR</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;new_oris = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">new_oris</span><span class="p">,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.find_duplicate_items">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">find_duplicate_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item_arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#find_duplicate_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.find_duplicate_items" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>item_arr</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>duplicate_items</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><p>?</p>
</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.clustering2 –test-find_duplicate_items</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/21888406/getting-the-indexes-to-the-duplicate-columns-of-a-numpy-array">http://stackoverflow.com/questions/21888406/getting-the-indexes-to-the-duplicate-columns-of-a-numpy-array</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">duplicate_items</span> <span class="o">=</span> <span class="n">find_duplicate_items</span><span class="p">(</span><span class="n">item_arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">duplicate_items</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="n">six</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">find_duplicate_items</span><span class="p">(</span><span class="n">item_arr</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">duplicate_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[9, 67, 87, 88]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.find_elbow_point">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">find_elbow_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curve</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_elbow_point"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.find_elbow_point" title="Permalink to this definition"></a></dt>
<dd><p>Finds the on the curve point furthest from the line defined by the
endpoints of the curve.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>curve</strong> (<em>ndarray</em>) – a monotonic curve</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tradeoff_idx - this is an elbow point in the curve</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/2018178/trade-off-point-on-curve">http://stackoverflow.com/questions/2018178/trade-off-point-on-curve</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other find_elbow_point –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">curve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tradeoff_idx</span> <span class="o">=</span> <span class="n">find_elbow_point</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;tradeoff_idx = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">tradeoff_idx</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">tradeoff_idx</span> <span class="o">==</span> <span class="mi">76</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">tradeoff_idx</span><span class="p">,</span> <span class="n">curve</span><span class="p">[</span><span class="n">tradeoff_idx</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">curve</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">curve</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_point</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">closest_point_on_line_segment</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dist_point</span><span class="p">,</span> <span class="n">point</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">curve</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;curve&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;tradeoff point&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dist_line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;-xb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">segment</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">segment</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;-xb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.find_first_true_indices">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">find_first_true_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_first_true_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.find_first_true_indices" title="Permalink to this definition"></a></dt>
<dd><p>TODO: move to vtool</p>
<p>returns a list of indexes where the index is the first True position
in the corresponding sublist or None if it does not exist</p>
<p>in other words: for each row finds the smallest True column number or None</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>flags_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of lists of booleans</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m utool.util_list –test-find_first_true_indices</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags_list</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">find_first_true_indices</span><span class="p">(</span><span class="n">flags_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">index_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[0, None, 1, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.find_k_true_indicies">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">find_k_true_indicies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_k_true_indicies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.find_k_true_indicies" title="Permalink to this definition"></a></dt>
<dd><p>Uses output of either this function or find_first_true_indices
to find the next index of true flags</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>flags_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of lists of booleans</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m utool.util_list –test-find_next_true_indices</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags_list</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">find_k_true_indicies</span><span class="p">(</span><span class="n">flags_list</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[array([2]), None, array([1, 2]), array([0, 1])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.find_kpts_direction">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">find_kpts_direction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DEBUG_ROTINVAR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#find_kpts_direction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.find_kpts_direction" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imgBGR</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data in opencv format (blue, green, red)</p></li>
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>kpts -  keypoints</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float32_t, ndim=2]</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-find_kpts_direction</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.find_maxima">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">find_maxima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#find_maxima"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.find_maxima" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.find_maxima_with_neighbors">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">find_maxima_with_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scalar_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#find_maxima_with_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.find_maxima_with_neighbors" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.find_next_true_indices">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">find_next_true_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_next_true_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.find_next_true_indices" title="Permalink to this definition"></a></dt>
<dd><p>Uses output of either this function or find_first_true_indices
to find the next index of true flags</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>flags_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of lists of booleans</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m utool.util_list –test-find_next_true_indices</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags_list</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset_list</span> <span class="o">=</span> <span class="n">find_first_true_indices</span><span class="p">(</span><span class="n">flags_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">find_next_true_indices</span><span class="p">(</span><span class="n">flags_list</span><span class="p">,</span> <span class="n">offset_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">index_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[2, None, 2, None]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.find_patch_dominant_orientations">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">find_patch_dominant_orientations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">36</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxima_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DEBUG_ROTINVAR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#find_patch_dominant_orientations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.find_patch_dominant_orientations" title="Permalink to this definition"></a></dt>
<dd><p>helper</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.find_pixel_value_index">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">find_pixel_value_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#find_pixel_value_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.find_pixel_value_index" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>pixel</strong> (<em>ndarray</em><em> or </em><em>scalar</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –test-find_pixel_value_index</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/21407815/get-column-row-index-from-numpy-array-that-meets-a-boolean-condition">http://stackoverflow.com/questions/21407815/get-column-row-index-from-numpy-array-that-meets-a-boolean-condition</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pixel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">find_pixel_value_index</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pixel</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[0 0]</span>
<span class="go"> [1 1]</span>
<span class="go"> [2 0]</span>
<span class="go"> [2 3]</span>
<span class="go"> [5 5]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.flag_intersection">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">flag_intersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#flag_intersection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.flag_intersection" title="Permalink to this definition"></a></dt>
<dd><p>Flags the rows in <cite>arr1</cite> that contain items in <cite>arr2</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>flags where len(flags) == len(arr1)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">flag_intersection</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;flags = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flags</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">structure_rows</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">flag_intersection</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;flags = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flags</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">flag_intersection</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">flag_intersection</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="sa">r</span><span class="s1">&#39;&#39;&#39;</span>
<span class="go">        import vtool as vt</span>
<span class="go">        import numpy as np</span>
<span class="go">        rng = np.random.RandomState(0)</span>
<span class="go">        arr1 = rng.randint(0, 100, 100000).reshape(-1, 2)</span>
<span class="go">        arr2 = rng.randint(0, 100, 1000).reshape(-1, 2)</span>
<span class="go">        arr1_, arr2_ = vt.structure_rows(arr1, arr2)</span>
<span class="go">        &#39;&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;&#39;&#39;</span>
<span class="go">        np.array([row in arr2_ for row in arr1_])</span>
<span class="go">        np.logical_or.reduce([arr1_ == row_ for row_ in arr2_]).ravel()</span>
<span class="go">        vt.iter_reduce_ufunc(np.logical_or, (arr1_ == row_ for row_ in arr2_)).ravel()</span>
<span class="go">        &#39;&#39;&#39;).split(&#39;\n&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="o">=</span><span class="n">setup</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.flag_sym_slow">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">flag_sym_slow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fx1_to_fx2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx2_to_fx1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#flag_sym_slow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.flag_sym_slow" title="Permalink to this definition"></a></dt>
<dd><p>Returns flags indicating if the matches in fx1_to_fx2 are reciprocal
with the matches in fx2_to_fx1.</p>
<p>Much slower version of flag_symmetric_matches, but more clear</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.flag_symmetric_matches">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">flag_symmetric_matches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fx2_to_fx1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx1_to_fx2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#flag_symmetric_matches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.flag_symmetric_matches" title="Permalink to this definition"></a></dt>
<dd><p>Returns flags indicating if the matches in fx2_to_fx1 are reciprocal
with the matches in fx1_to_fx2.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span> <span class="c1"># 0</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span> <span class="c1"># 1</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span> <span class="c1"># 2</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span> <span class="c1"># 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx1_to_fx2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># 0</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># 1</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># 2</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># 3</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span> <span class="c1"># 4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flagsA</span> <span class="o">=</span> <span class="n">flag_symmetric_matches</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx1_to_fx2</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_flagsB</span> <span class="o">=</span> <span class="n">flag_sym_slow</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx1_to_fx2</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">fx2_to_flagsA</span> <span class="o">==</span> <span class="n">fx2_to_flagsB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fx2_to_flagsB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.flann_augment">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">flann_augment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_dpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgstr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_cfgstr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flann_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#flann_augment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.flann_augment" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_dpts</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_nth_prime</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_dpts</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_dpts</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_nth_prime</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_app_resource_dir</span><span class="p">(</span><span class="s1">&#39;vtool&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgstr</span> <span class="o">=</span> <span class="s1">&#39;_testcfg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_cfgstr</span> <span class="o">=</span> <span class="s1">&#39;_new_testcfg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="n">get_kdtree_flann_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.flann_cache">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">flann_cache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flann_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_params_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_data_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">appname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vtool'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#flann_cache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.flann_cache" title="Permalink to this definition"></a></dt>
<dd><p>Tries to load a cached flann index before doing anything
from vtool.nn</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.flann_index_time_experiment">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">flann_index_time_experiment</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#flann_index_time_experiment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.flann_index_time_experiment" title="Permalink to this definition"></a></dt>
<dd><p>Shows a plot of how long it takes to build a flann index for a given number of KD-trees</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.nearest_neighbors –test-flann_index_time_experiment</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">flann_index_time_experiment</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.flatten_invV_mats_to_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">flatten_invV_mats_to_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">invV_mats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#flatten_invV_mats_to_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.flatten_invV_mats_to_kpts" title="Permalink to this definition"></a></dt>
<dd><p>flattens invV matrices into kpts format</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.flatten_scores">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">flatten_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tp_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part_attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#flatten_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.flatten_scores" title="Permalink to this definition"></a></dt>
<dd><p>convinience helper to translate partitioned to unpartitioned data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tp_scores</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>tn_scores</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>part_attrs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – (default = None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(scores, labels, attrs)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –test-flatten_scores</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part_attrs</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;qaid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">]},</span>
<span class="gp">... </span>    <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;qaid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]},</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">flatten_scores</span><span class="p">(</span>
<span class="gp">... </span><span class="n">tp_scores</span><span class="p">,</span> <span class="n">tn_scores</span><span class="p">,</span> <span class="n">part_attrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resdict</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">odict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;attrs&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">resdict</span><span class="p">,</span> <span class="n">nobraces</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="n">explicit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">X=np.array([5, 6, 6, 7, 1, 2, 2]),</span>
<span class="go">y=np.array([1, 1, 1, 1, 0, 0, 0]),</span>
<span class="go">attrs=&#39;qaid&#39;: np.array([21, 24, 25, 26, 11, 14, 15]),</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.force_kpts_feasibility">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">force_kpts_feasibility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xys_nonneg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#force_kpts_feasibility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.force_kpts_feasibility" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.fromiter_nd">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">fromiter_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iter_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#fromiter_nd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.fromiter_nd" title="Permalink to this definition"></a></dt>
<dd><p>Like np.fromiter but handles iterators that generated
n-dimensional arrays. Slightly faster than np.array.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>np.vstack(list_) is still faster than
vt.fromiter_nd(ut.iflatten(list_))</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iter_</strong> (<em>iter</em>) – an iterable that generates homogenous ndarrays</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – the expected output shape</p></li>
<li><p><strong>dtype</strong> (<em>dtype</em>) – the numpy datatype of the generated ndarrays</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The iterable must yeild a numpy array. It cannot yeild a Python list.</p>
</div>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.numpy_utils fromiter_nd</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total</span> <span class="o">=</span> <span class="mi">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">fromiter_nd</span><span class="p">(</span><span class="n">iter_</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">shape</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dfxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">qfxs</span><span class="p">,</span> <span class="n">dfxs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qfxs</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">fromiter_nd</span><span class="p">(</span><span class="n">iter_</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">shape</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat_dim</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mi">500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_data</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_feat_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_data</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">+</span> <span class="n">mu</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Make a large list of vectors of various sizes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Making random vectors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">feat_dim</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">n_feat_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mega_bytes</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">nbytes</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vecs_list</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mega_bytes = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mega_bytes</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">itertools</span> <span class="k">as</span> <span class="nn">it</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_total</span> <span class="o">=</span> <span class="n">n_feat_list</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_total</span><span class="p">,</span> <span class="n">feat_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">fromiter_nd</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">),</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">target1</span> <span class="o">==</span> <span class="n">target2</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">timeit</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mf">20.4</span><span class="n">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">timeit</span> <span class="n">vt</span><span class="o">.</span><span class="n">fromiter_nd</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">),</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">102</span><span class="n">ms</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iter_</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">time</span> <span class="n">vt</span><span class="o">.</span><span class="n">fromiter_nd</span><span class="p">(</span><span class="n">iter_</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">time</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.gamma_adjust">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">gamma_adjust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#gamma_adjust"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.gamma_adjust" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.blend –test-gamma_adjust:0 –show</p>
</dd>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">gamma_adjust</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_float01</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">img</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s1">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="s1">&#39;gamma=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.gauss2d_pdf">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">gauss2d_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#gauss2d_pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.gauss2d_pdf" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – x cooordinate of a 2D Gaussian</p></li>
<li><p><strong>y</strong> – y cooordinate of a 2D Gaussian</p></li>
<li><p><strong>sigma</strong> – covariance of vector</p></li>
<li><p><strong>mu</strong> – mean of vector</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>float - The probability density at that point</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.gauss_func1d">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">gauss_func1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#gauss_func1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.gauss_func1d" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – </p></li>
<li><p><strong>mu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –test-gauss_func1d</p>
</dd>
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –test-gauss_func1d –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussval</span> <span class="o">=</span> <span class="n">gauss_func1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_repr</span><span class="p">(</span><span class="n">gaussval</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gaussval</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">array([ 0.05,  0.24,  0.35,  0.4 ,  0.35,  0.24,  0.05])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.gauss_func1d_unnormalized">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">gauss_func1d_unnormalized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#gauss_func1d_unnormalized"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.gauss_func1d_unnormalized" title="Permalink to this definition"></a></dt>
<dd><p>faster version of gauss_func1d with no normalization. So the maximum point
will have a value of 1.0</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –test-gauss_func1d_unnormalized –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussval</span> <span class="o">=</span> <span class="n">gauss_func1d_unnormalized</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_repr</span><span class="p">(</span><span class="n">gaussval</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gaussval</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">array([ 0.05,  0.24,  0.35,  0.4 ,  0.35,  0.24,  0.05])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.gauss_parzen_est">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">gauss_parzen_est</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.38</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#gauss_parzen_est"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.gauss_parzen_est" title="Permalink to this definition"></a></dt>
<dd><p>python -m wbia.plottool.draw_func2 –exec-plot_func –show –range=-.2,.2 –func=vt.gauss_parzen_est
python -m wbia.plottool.draw_func2 –exec-plot_func –show –range=0,1 –func=vt.gauss_parzen_est</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.gaussian_average_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">gaussian_average_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gaussian_average_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.gaussian_average_patch" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patch</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-gaussian_average_patch</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel">http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">get_star_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#sigma = 1.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">gaussian_average_patch</span><span class="p">(</span><span class="n">patch</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">0.414210641527</span>
</pre></div>
</div>
<dl class="simple">
<dt>Ignore:</dt><dd><p>import utool as ut
import wbia.plottool as pt
import vtool as vt
import cv2
gauss_kernel_d0 = (cv2.getGaussianKernel(patch.shape[0], sigma))
gauss_kernel_d1 = (cv2.getGaussianKernel(patch.shape[1], sigma))
weighted_patch = patch.copy()
weighted_patch = np.multiply(weighted_patch,   gauss_kernel_d0)
weighted_patch = np.multiply(weighted_patch.T, gauss_kernel_d1).T
gaussian_kern2 = gauss_kernel_d0.dot(gauss_kernel_d1.T)
fig = pt.figure(fnum=1, pnum=(1, 3, 1), doclf=True, docla=True)
pt.imshow(patch * 255)
fig = pt.figure(fnum=1, pnum=(1, 3, 2))
pt.imshow(ut.norm_zero_one(gaussian_kern2) * 255.0)
fig = pt.figure(fnum=1, pnum=(1, 3, 3))
pt.imshow(ut.norm_zero_one(weighted_patch) * 255.0)
pt.update()</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.gaussian_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">gaussian_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">7)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gaussian_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.gaussian_patch" title="Permalink to this definition"></a></dt>
<dd><p>another version of the guassian_patch function. hopefully better</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel">http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – array dimensions</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-gaussian_patch –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#shape = (7, 7)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># 1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gausspatch</span> <span class="o">=</span> <span class="n">gaussian_patch</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sum_</span> <span class="o">=</span> <span class="n">gausspatch</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_almost_eq</span><span class="p">(</span><span class="n">sum_</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">norm01</span><span class="p">(</span><span class="n">gausspatch</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.gaussian_weight_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">gaussian_weight_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gaussian_weight_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.gaussian_weight_patch" title="Permalink to this definition"></a></dt>
<dd><p>Applies two one dimensional gaussian operations to a patch which
effectively weights it by a 2-dimensional gaussian. This is efficient
because the actually 2-d gaussian never needs to be allocated.</p>
<p>test_show_gaussian_patches</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.generate_to_patch_transforms">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">generate_to_patch_transforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">41</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#generate_to_patch_transforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.generate_to_patch_transforms" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_RV_mats2x2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_RV_mats2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_RV_mats2x2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_RV_mats2x2" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>sequence of matrices that transform an ellipse to unit circle</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>V_mats (ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_RV_mats_3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_RV_mats_3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_RV_mats_3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_RV_mats_3x3" title="Permalink to this definition"></a></dt>
<dd><p>prefered over get_invV_mats</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>sequence of matrices that transform an ellipse to unit circle</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>V_mats (ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_V_mats">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_V_mats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_V_mats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_V_mats" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>sequence of matrices that transform an ellipse to unit circle</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>V_mats (ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_Z_mats">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_Z_mats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V_mats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_Z_mats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_Z_mats" title="Permalink to this definition"></a></dt>
<dd><p>transform into conic matrix Z
Z = (V.T).dot(V)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Z is a conic representation of an ellipse</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Z_mats (ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_affine_inliers">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_affine_inliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_thresh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_affine_inliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_affine_inliers" title="Permalink to this definition"></a></dt>
<dd><p>Estimates inliers deterministically using elliptical shapes</p>
<p>Compute all transforms from kpts1 to kpts2 (enumerate all hypothesis)
We transform from chip1 -&gt; chip2
The determinants are squared keypoint scales</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>aff_inliers_list, aff_errors_list, Aff_mats</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>FROM PERDOCH 2009:</dt><dd><p>H = inv(Aj).dot(Rj.T).dot(Ri).dot(Ai)
H = inv(Aj).dot(Ai)
The input invVs = perdoch.invA’s</p>
</dd>
<dt>CommandLine:</dt><dd><p>python2 -m vtool.spatial_verification –test-get_affine_inliers
python3 -m vtool.spatial_verification –test-get_affine_inliers</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">make_dummy_fm</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span><span class="p">(</span><span class="mf">.009</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh_sqrd</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_thresh</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span><span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">get_affine_inliers</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">scale_thresh_sqrd</span><span class="p">,</span> <span class="n">ori_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_str</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress_small</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;output_str = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">output_str</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_inliers_list</span><span class="p">,</span> <span class="n">aff_errors_list</span><span class="p">,</span> <span class="n">Aff_mats</span> <span class="o">=</span> <span class="n">output</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;nInliers=</span><span class="si">%r</span><span class="s1"> hash=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">aff_inliers_list</span><span class="p">),</span> <span class="n">ut</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">output_str</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_best_affine_inliers">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_best_affine_inliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forcepy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_best_affine_inliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_best_affine_inliers" title="Permalink to this definition"></a></dt>
<dd><p>Tests each hypothesis and returns only the best transformation and inliers</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_best_affine_inliers_">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_best_affine_inliers_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_thresh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_best_affine_inliers_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_best_affine_inliers_" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_covered_mask">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_covered_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covered_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covering_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_covered_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_covered_mask" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_crop_slices">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_crop_slices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isfill</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_crop_slices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_crop_slices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_cross_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_cross_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_cross_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_cross_patch" title="Permalink to this definition"></a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_dummy_dpts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_dummy_dpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.uint8'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_dpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_dummy_dpts" title="Permalink to this definition"></a></dt>
<dd><p>Random SIFTish keypoints</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_dummy_invV_mats">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_dummy_invV_mats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_invV_mats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_dummy_invV_mats" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_dummy_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_dummy_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_dummy_kpts" title="Permalink to this definition"></a></dt>
<dd><p>Some testing data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – number of times to duplicate</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.10)"><em>type</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>kpts -  keypoints</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float32_t, ndim=2][ndims=2]</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/demodata.py get_dummy_kpts</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">get_dummy_kpts</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_dummy_kpts_pair">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_dummy_kpts_pair</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wh_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(30,</span> <span class="pre">30)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wh_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_kpts_pair"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_dummy_kpts_pair" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_dummy_matching_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_dummy_matching_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_matching_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_dummy_matching_kpts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_dummy_xy">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_dummy_xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_dummy_xy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_dummy_xy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_even_point_sample">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_even_point_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_even_point_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_even_point_sample" title="Permalink to this definition"></a></dt>
<dd><p>gets even points sample along the boundary of the ellipse</p>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>pyhesaff.tests.test_ellipse</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ell_border_pts_list</span> <span class="o">=</span> <span class="n">get_even_point_sample</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">ell_border_pts_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;even sample points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_exif_dict">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_exif_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pil_img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exif_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_exif_dict" title="Permalink to this definition"></a></dt>
<dd><p>Returns exif dictionary by TAGID</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_exif_dict2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_exif_dict2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pil_img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exif_dict2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_exif_dict2" title="Permalink to this definition"></a></dt>
<dd><p>Returns exif dictionary by TAG (less efficient)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_exif_tagids">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_exif_tagids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tag_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exif_tagids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_exif_tagids" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_exist">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_exist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_exist" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_extract_features_default_params">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_extract_features_default_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#get_extract_features_default_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_extract_features_default_params" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.features –test-get_extract_features_default_params</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.features</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_dict</span> <span class="o">=</span> <span class="n">get_extract_features_default_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">param_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_extramargin_measures">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_extramargin_measures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox_gs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halfoffset_ms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(64,</span> <span class="pre">64)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#get_extramargin_measures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_extramargin_measures" title="Permalink to this definition"></a></dt>
<dd><p>Computes a detection chip with a bit of spatial context so the detection
algorithm doesn’t clip boundaries</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>mbbox_gs, margin_size -</dt><dd><p>margin bounding box in image size,
size of entire margined chip,</p>
</dd>
</dl>
</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.chip –test-get_extramargin_measures –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gfpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox_gs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="mf">.15</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">halfoffset_ms</span> <span class="o">=</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mbbox_gs</span><span class="p">,</span> <span class="n">margin_size</span> <span class="o">=</span> <span class="n">get_extramargin_measures</span><span class="p">(</span><span class="n">bbox_gs</span><span class="p">,</span> <span class="n">new_size</span><span class="p">,</span> <span class="n">halfoffset_ms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">testshow_extramargin_info</span><span class="p">(</span><span class="n">gfpath</span><span class="p">,</span> <span class="n">bbox_gs</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">new_size</span><span class="p">,</span> <span class="n">halfoffset_ms</span><span class="p">,</span> <span class="n">mbbox_gs</span><span class="p">,</span> <span class="n">margin_size</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_flann_cfgstr">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_flann_cfgstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flann_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_params_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_data_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_cfgstr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_flann_cfgstr" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.nearest_neighbors –test-get_flann_cfgstr</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgstr</span> <span class="o">=</span> <span class="s1">&#39;_FEAT(alg=heshes)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="n">get_kdtree_flann_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_flann_cfgstr</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">flann_params</span><span class="p">,</span> <span class="n">cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">_FEAT(alg=heshes)_FLANN(4kdtree)_DPTS((10,128)xxaotseonmfjkzcr)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_flann_fpath">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_flann_fpath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flann_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_params_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_data_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">appname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vtool'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_fpath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_flann_fpath" title="Permalink to this definition"></a></dt>
<dd><p>returns filepath for flann index</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_flann_params">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_flann_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kdtree'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_flann_params" title="Permalink to this definition"></a></dt>
<dd><p>Returns flann params that are relvant tothe algorithm</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf">http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>algorithm</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – (default = ‘kdtree’)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>flann_params</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.nearest_neighbors –test-get_flann_params –algo=kdtree
python -m vtool.nearest_neighbors –test-get_flann_params –algo=kmeans</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">algorithm</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--algo&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;kdtree&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="n">get_flann_params</span><span class="p">(</span><span class="n">algorithm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;flann_params = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flann_params</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_flann_params_cfgstr">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_flann_params_cfgstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flann_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_params_cfgstr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_flann_params_cfgstr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_grid_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_grid_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wh=(300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">300)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wh_stride=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale=20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wh_num=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_grid_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_grid_kpts" title="Permalink to this definition"></a></dt>
<dd><p>Returns a regular grid of keypoints</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wh</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – (default = (300, 300))</p></li>
<li><p><strong>wh_stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – stride of keypoints (defaults to (50, 50))</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – (default = 20)</p></li>
<li><p><strong>wh_num</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – desired number of keypoints in x and y direction.
(incompatible with stride).</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.10)"><em>type</em></a>) – (default = &lt;type ‘numpy.float32’&gt;)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>kpts -  keypoints</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float32_t, ndim=2]</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.keypoint get_grid_kpts –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh</span> <span class="o">=</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_stride</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_num</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">get_grid_kpts</span><span class="p">(</span><span class="n">wh</span><span class="p">,</span> <span class="n">wh_num</span><span class="o">=</span><span class="n">wh_num</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">wh_num</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;kpts = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">kpts</span><span class="o">.</span><span class="n">shape</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_histinfo_str">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_histinfo_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#get_histinfo_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_histinfo_str" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_image_to_chip_transform">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_image_to_chip_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chipsz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#get_image_to_chip_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_image_to_chip_transform" title="Permalink to this definition"></a></dt>
<dd><p>transforms image space into chipspace</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<em>bbox   - bounding box of chip in image</em>) – </p></li>
<li><p><strong>chip</strong> (<em>chipsz - size of the</em>) – </p></li>
<li><p><strong>box</strong> (<em>theta  - rotation of the bounding</em>) – </p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy.abc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">theta</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">target_area</span>  <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y w h, a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gx</span><span class="p">,</span> <span class="n">gy</span>  <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;gx, gy&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">floor</span>  <span class="c1"># hack</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ht</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">target_area</span> <span class="o">*</span> <span class="n">h</span> <span class="o">/</span> <span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wt</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">ht</span> <span class="o">/</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cw_</span><span class="p">,</span> <span class="n">ch_</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">wt</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">ht</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool</span> <span class="kn">import</span> <span class="n">ltool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T1</span> <span class="o">=</span> <span class="n">ltool</span><span class="o">.</span><span class="n">translation_mat3x3</span><span class="p">(</span><span class="n">tx1</span><span class="p">,</span> <span class="n">ty1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span>  <span class="o">=</span> <span class="n">ltool</span><span class="o">.</span><span class="n">scale_mat3x3</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span>  <span class="o">=</span> <span class="n">ltool</span><span class="o">.</span><span class="n">rotation_mat3x3</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">,</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T2</span> <span class="o">=</span> <span class="n">ltool</span><span class="o">.</span><span class="n">translation_mat3x3</span><span class="p">(</span><span class="n">tx2</span><span class="p">,</span> <span class="n">ty2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">add_matmul_hold_prop</span><span class="p">(</span><span class="n">mat</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1">#import functools</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">mat</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">matmul_hold</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">new</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">MatMul</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="n">hold</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">return</span> <span class="n">new</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">setattr</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="s1">&#39;matmul_hold&#39;</span><span class="p">,</span> <span class="n">matmul_hold</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">mat</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T1</span> <span class="o">=</span> <span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">T1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T2</span> <span class="o">=</span> <span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">T2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">T2</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">T1</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_invVR_mats2x2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_invVR_mats2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats2x2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_invVR_mats2x2" title="Permalink to this definition"></a></dt>
<dd><p>Returns the keypoint shape+rotation matrix (from unit circle to ellipse)
Ignores translation component</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em><em>[</em><em>ndims=2</em><em>]</em>) – keypoints</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>invVR_mats</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.keypoint –test-get_invVR_mats2x2</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats2x2</span> <span class="o">=</span> <span class="n">get_invVR_mats2x2</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invVR_mats2x2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats2x2</span> <span class="o">=</span> <span class="n">get_invVR_mats2x2</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">invVR_mats2x2</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_invVR_mats3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_invVR_mats3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_invVR_mats3x3" title="Permalink to this definition"></a></dt>
<dd><p>NEWER FUNCTION</p>
<p>Returns full keypoint transform matricies from a unit circle to an
ellipse that has been rotated, scaled, skewed, and translated. Into
the image keypoint position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>invVR_mats</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float32_t, ndim=3]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats3x3</span> <span class="o">=</span> <span class="n">get_invVR_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invVR_mats3x3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[ 1.,  0., 10.],</span>
<span class="go">        [ 2.,  3., 20.],</span>
<span class="go">        [ 0.,  0.,  1.]],</span>
<span class="go">       [[ 0., -1., 30.],</span>
<span class="go">        [ 3., -2., 40.],</span>
<span class="go">        [ 0.,  0.,  1.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_invVR_mats_oris">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_invVR_mats_oris</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">invVR_mats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_oris"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_invVR_mats_oris" title="Permalink to this definition"></a></dt>
<dd><p>extracts orientation from matrix encoding, this is a bit tricker
can use -arctan2 or (0, 0) and (0, 1), but then have to normalize</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">get_invVR_mats_oris</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_invVR_mats_shape">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_invVR_mats_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">invVR_mats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_invVR_mats_shape" title="Permalink to this definition"></a></dt>
<dd><p>Extracts keypoint shape components</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">get_invVR_mats_shape</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">pibujdiaimwcnmomserkcytyyikahjmp</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p>TODO
(a.ravel()[(cols + (rows * a.shape[1]).reshape((-1,1))).ravel()]).reshape(rows.size, cols.size)
<a class="reference external" href="http://stackoverflow.com/questions/14386822/fast-numpy-fancy-indexing">http://stackoverflow.com/questions/14386822/fast-numpy-fancy-indexing</a>
# So, this doesn’t work
# Try this instead
<a class="reference external" href="http://docs.cython.org/src/userguide/memoryviews.html#memoryviews">http://docs.cython.org/src/userguide/memoryviews.html#memoryviews</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_invVR_mats_sqrd_scale">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_invVR_mats_sqrd_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">invVR_mats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_sqrd_scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_invVR_mats_sqrd_scale" title="Permalink to this definition"></a></dt>
<dd><p>Returns the squared scale of the invVR keyponts</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det_arr</span> <span class="o">=</span> <span class="n">get_invVR_mats_sqrd_scale</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">det_arr</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([-0.16, -0.09, -0.34, 0.59, -0.2 , 0.18, 0.06], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_invVR_mats_xys">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_invVR_mats_xys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">invVR_mats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_xys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_invVR_mats_xys" title="Permalink to this definition"></a></dt>
<dd><p>extracts locations
extracts xys from matrix encoding, Its just the (0, 2), and (1, 2) components</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>invVR_mats</strong> (<em>ndarray</em>) – list of matrices mapping ucircles to ellipses</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the xy location</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;&#39;&#39;</span>
<span class="go">        import numpy as np</span>
<span class="go">        np.random.seed(0)</span>
<span class="go">        invVR_mats = np.random.rand(1000, 3, 3).astype(np.float64)</span>
<span class="go">        &#39;&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;&#39;&#39;</span>
<span class="go">        invVR_mats[:, 0:2, 2].T</span>
<span class="go">        invVR_mats.T[2, 0:2]</span>
<span class="go">        invVR_mats.T.take(2, axis=0).take([0, 1], axis=0)</span>
<span class="go">        invVR_mats.T.take(2, axis=0)[0:2]</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">util_dev</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1E5</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_invV_mats">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_invV_mats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_trans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_ori</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ashomog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascontiguous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_mats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_invV_mats" title="Permalink to this definition"></a></dt>
<dd><p>TODO: DEPRICATE. too many conditionals</p>
<p>packs keypoint shapes into affine invV matrixes
(default is just the 2x2 shape. But translation, orientation,
homogonous, and contiguous flags can be set.)</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">with_trans</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">with_ori</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ashomog</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascontiguous</span><span class="o">=</span><span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">innVR_mats</span> <span class="o">=</span> <span class="n">get_invV_mats</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">with_trans</span><span class="p">,</span> <span class="n">with_ori</span><span class="p">,</span> <span class="n">ashomog</span><span class="p">,</span> <span class="n">ascontiguous</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">innVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[ 1.,  0., 10.],</span>
<span class="go">        [ 2.,  3., 20.],</span>
<span class="go">        [ 0.,  0.,  1.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_invV_mats2x2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_invV_mats2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_mats2x2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_invV_mats2x2" title="Permalink to this definition"></a></dt>
<dd><p>Returns the keypoint shape (from unit circle to ellipse)
Ignores translation and rotation component</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>invV_mats</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float32_t, ndim=3]</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.keypoint –test-get_invV_mats2x2</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_mats2x2</span> <span class="o">=</span> <span class="n">get_invV_mats2x2</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invV_mats2x2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_invV_mats3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_invV_mats3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_mats3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_invV_mats3x3" title="Permalink to this definition"></a></dt>
<dd><p>NEWER FUNCTION</p>
<p>Returns full keypoint transform matricies from a unit circle to an
ellipse that has been scaled, skewed, and translated. Into
the image keypoint position.</p>
<p>DOES NOT INCLUDE ROTATION</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>invVR_mats -  keypoint shape and rotations (possibly translation)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float32_t, ndim=3]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_arrs3x3</span> <span class="o">=</span> <span class="n">get_invV_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invV_arrs3x3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_invVs">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_invVs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_invVs" title="Permalink to this definition"></a></dt>
<dd><p>Keypoint shapes (oriented with the gravity vector)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_kdtree_flann_params">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_kdtree_flann_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_kdtree_flann_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_kdtree_flann_params" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_kpts_dlen_sqrd">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_kpts_dlen_sqrd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_dlen_sqrd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_kpts_dlen_sqrd" title="Permalink to this definition"></a></dt>
<dd><p>returns diagonal length squared of keypoint extent</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>outer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – loose if False tight if True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dlen_sqrd</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dlen_sqrd</span> <span class="o">=</span> <span class="n">get_kpts_dlen_sqrd</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">dlen_sqrd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">3735.01</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_kpts_dummy_img">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_kpts_dummy_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_kpts_dummy_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_kpts_dummy_img" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>sf</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>img</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sf</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span>  <span class="n">get_kpts_dummy_img</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">sf</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_kpts_eccentricity">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_kpts_eccentricity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_eccentricity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_kpts_eccentricity" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>SeeAlso:</dt><dd><p>pyhesaff.tests.test_ellipse</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Eccentricity_(mathematics">https://en.wikipedia.org/wiki/Eccentricity_(mathematics</a>)</p>
<p class="rubric">Notes</p>
<p>For an ellipse/hyperbola the eccentricity is
sqrt(1 - (b ** 2 / a ** 2))</p>
<p>Eccentricity is undefined for parabolas</p>
<p>where a is the lenth of the semi-major axis and b is the length of the
semi minor axis. The length of the semi-major axis is 2 time the
largest eigenvalue.  And the length of the semi-minor axis is 2 times
the smallest eigenvalue.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – (default = (0.0, 0.0))</p></li>
<li><p><strong>scale_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – (default = 1.0)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.keypoint –exec-get_kpts_eccentricity –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts_</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kpts_</span><span class="p">,</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ecc</span> <span class="o">=</span> <span class="n">get_kpts_eccentricity</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;ecc = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">ecc</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">colors</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">scores_to_color</span><span class="p">(</span><span class="n">ecc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_axis_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ecc</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">ecc = np.array([ 0.96, 0.99, 0.87, 0.91, 0.55, 0.  ])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_kpts_image_extent">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_kpts_image_extent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_image_extent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_kpts_image_extent" title="Permalink to this definition"></a></dt>
<dd><p>returns the width and height of keypoint bounding box
This combines xy and shape information
Does not take into account if keypoint extent goes under (0, 0)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em><em>[</em><em>ndims=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>outer</strong> – uses outer rectangle if True. Set to false for a
tighter extent.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(minx, maxx, miny, maxy)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">outer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">extent</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_axis_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([ 14.78, 48.05,  0.32, 51.58])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_kpts_strs">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_kpts_strs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_strs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_kpts_strs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_kpts_wh">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_kpts_wh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_wh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_kpts_wh" title="Permalink to this definition"></a></dt>
<dd><p>Gets the width / height diameter of a keypoint
ie the diameter of the xaxis and yaxis of the keypoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em><em>[</em><em>ndims=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>outer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if True returns wh of bounding box.
This is useful because extracting a patch needs a rectangle.
If false it returns the otherwise gets the extent of the ellipse.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(2xN) column1 is X extent and column2 is Y extent</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Determine formula for min/maxing x and y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, y&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a, d&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nonnegative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xeqn</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yeqn</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">c</span> <span class="o">*</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="n">v</span> <span class="o">*</span> <span class="n">d</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dxdt</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">xeqn</span><span class="p">,</span> <span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dydt</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">yeqn</span><span class="p">,</span> <span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Ugg, cant get sympy to do trig derivative, do it manually</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dxdt</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dydt</span> <span class="o">=</span> <span class="n">d</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">-</span> <span class="n">c</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">critical_thetas</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">dxdt</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">critical_thetas</span> <span class="o">+=</span> <span class="n">solve</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">dydt</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">critical_thetas</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">((</span><span class="n">c</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">d</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="n">d</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">((</span><span class="n">c</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">d</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="n">d</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">critical_uvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">critical_thetas</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">critical_thetas</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">critical_xys</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">critical_uvs</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>SeeAlso:</dt><dd><p>get_kpts_major_minor</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span> <span class="o">*</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span> <span class="o">*</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyexnts</span> <span class="o">=</span> <span class="n">get_kpts_wh</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">xyexnts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">scale_extents</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_axis_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radii</span> <span class="o">=</span> <span class="n">xyexnts</span> <span class="o">/</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">horiz_pts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">xs</span> <span class="o">-</span> <span class="n">radii</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ys</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">horiz_pts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">xs</span> <span class="o">+</span> <span class="n">radii</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ys</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert_pts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xs</span><span class="p">,</span> <span class="p">(</span><span class="n">ys</span> <span class="o">-</span> <span class="n">radii</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert_pts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xs</span><span class="p">,</span> <span class="p">(</span><span class="n">ys</span> <span class="o">+</span> <span class="n">radii</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments2</span><span class="p">(</span><span class="n">horiz_pts1</span><span class="p">,</span> <span class="n">horiz_pts2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments2</span><span class="p">(</span><span class="n">vert_pts1</span><span class="p">,</span> <span class="n">vert_pts2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([[10.43315411, 58.5216589 ],</span>
<span class="go">          [ 4.71017647, 58.5216589 ],</span>
<span class="go">          [24.43314171, 45.09558868],</span>
<span class="go">          [26.71114159, 63.47679138],</span>
<span class="go">          [32.10540009, 30.28536987]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_lat_lon">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_lat_lon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exif_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">1,</span> <span class="pre">-</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_lat_lon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_lat_lon" title="Permalink to this definition"></a></dt>
<dd><p>Returns the latitude and longitude, if available, from the provided
exif_data2 (obtained through exif_data2 above)</p>
<p class="rubric">Notes</p>
<p>Might need to downgrade to Pillow 2.9.0 to solve a bug with getting GPS
<a class="reference external" href="https://github.com/python-pillow/Pillow/issues/1477">https://github.com/python-pillow/Pillow/issues/1477</a></p>
<p>python -c “from PIL import Image; print(Image.PILLOW_VERSION)”</p>
<p>pip uninstall Pillow
pip install Pillow==2.9</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.exif –test-get_lat_lon</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exif_dict</span> <span class="o">=</span> <span class="n">get_exif_dict</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latlon</span> <span class="o">=</span> <span class="n">get_lat_lon</span><span class="p">(</span><span class="n">exif_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">latlon</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_left_area">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_left_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#get_left_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_left_area" title="Permalink to this definition"></a></dt>
<dd><p>area to the left of each index point</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_match_spatial_squared_error">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_match_spatial_squared_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx2_to_fx1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_match_spatial_squared_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_match_spatial_squared_error" title="Permalink to this definition"></a></dt>
<dd><p>transforms img2 to img2 and finds squared spatial error</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts1</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>kpts2</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>H</strong> (<em>ndarray</em><em>[</em><em>float64_t</em><em>, </em><em>ndim=2</em><em>]</em>) – homography/perspective matrix mapping image 1 to image 2 space</p></li>
<li><p><strong>fx2_to_fx1</strong> (<em>ndarray</em>) – has shape (nMatch, K)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>fx2_to_xyerr_sqrd has shape (nMatch, K)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">129.83</span><span class="p">,</span>  <span class="mf">46.97</span><span class="p">,</span>  <span class="mf">15.84</span><span class="p">,</span>   <span class="mf">4.66</span><span class="p">,</span>   <span class="mf">7.24</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">137.88</span><span class="p">,</span>  <span class="mf">49.87</span><span class="p">,</span>  <span class="mf">20.09</span><span class="p">,</span>   <span class="mf">5.76</span><span class="p">,</span>   <span class="mf">6.2</span> <span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">115.95</span><span class="p">,</span>  <span class="mf">53.13</span><span class="p">,</span>  <span class="mf">12.96</span><span class="p">,</span>   <span class="mf">1.73</span><span class="p">,</span>   <span class="mf">8.77</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">324.88</span><span class="p">,</span> <span class="mf">172.58</span><span class="p">,</span> <span class="mf">127.69</span><span class="p">,</span>  <span class="mf">41.29</span><span class="p">,</span>  <span class="mf">50.5</span> <span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">285.44</span><span class="p">,</span> <span class="mf">254.61</span><span class="p">,</span> <span class="mf">136.06</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.77</span><span class="p">,</span>  <span class="mf">76.69</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">367.72</span><span class="p">,</span> <span class="mf">140.81</span><span class="p">,</span> <span class="mf">172.13</span><span class="p">,</span>  <span class="mf">12.99</span><span class="p">,</span>  <span class="mf">96.15</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">318.93</span><span class="p">,</span>  <span class="mf">11.98</span><span class="p">,</span>  <span class="mf">12.11</span><span class="p">,</span>   <span class="mf">0.38</span><span class="p">,</span>   <span class="mf">8.04</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">509.47</span><span class="p">,</span>  <span class="mf">12.53</span><span class="p">,</span>  <span class="mf">22.4</span> <span class="p">,</span>   <span class="mf">1.31</span><span class="p">,</span>   <span class="mf">5.04</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">514.03</span><span class="p">,</span>  <span class="mf">13.04</span><span class="p">,</span>  <span class="mf">19.25</span><span class="p">,</span>   <span class="mf">1.74</span><span class="p">,</span>   <span class="mf">4.72</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">490.19</span><span class="p">,</span> <span class="mf">185.49</span><span class="p">,</span>  <span class="mf">95.67</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.84</span><span class="p">,</span>  <span class="mf">88.23</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">316.97</span><span class="p">,</span> <span class="mf">206.07</span><span class="p">,</span>  <span class="mf">90.87</span><span class="p">,</span>   <span class="mf">0.07</span><span class="p">,</span>  <span class="mf">80.45</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">366.07</span><span class="p">,</span> <span class="mf">140.05</span><span class="p">,</span> <span class="mf">161.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">47.01</span><span class="p">,</span>  <span class="mf">85.62</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="o">-</span><span class="mf">0.70098</span><span class="p">,</span>  <span class="mf">0.12273</span><span class="p">,</span>  <span class="mf">5.18734</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mf">0.12444</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.63474</span><span class="p">,</span> <span class="mf">14.13995</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mf">0.00004</span><span class="p">,</span>  <span class="mf">0.00025</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.64873</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr_sqrd</span> <span class="o">=</span> <span class="n">get_match_spatial_squared_error</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">fx2_to_fx1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fx2_to_xyerr_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fx2_to_xyerr</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">6.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">,</span>  <span class="mf">15.84</span><span class="p">,</span>   <span class="mf">4.66</span><span class="p">,</span>   <span class="mf">7.24</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">9.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>  <span class="mf">20.09</span><span class="p">,</span>   <span class="mf">5.76</span><span class="p">,</span>   <span class="mf">6.2</span> <span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">12.96</span><span class="p">,</span>   <span class="mf">1.73</span><span class="p">,</span>   <span class="mf">8.77</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">12.11</span><span class="p">,</span>   <span class="mf">0.38</span><span class="p">,</span>   <span class="mf">8.04</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">5.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">22.4</span> <span class="p">,</span>   <span class="mf">1.31</span><span class="p">,</span>   <span class="mf">5.04</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">6.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">19.25</span><span class="p">,</span>   <span class="mf">1.74</span><span class="p">,</span>   <span class="mf">4.72</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr_sqrd</span> <span class="o">=</span> <span class="n">get_match_spatial_squared_error</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">fx2_to_fx1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fx2_to_xyerr_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">fx2_to_xyerr</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_no_symbol">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_no_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'symbol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(100,</span> <span class="pre">100)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_no_symbol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_no_symbol" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>errorimg</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-get_no_symbol –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">errorimg</span> <span class="o">=</span> <span class="n">get_no_symbol</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">errorimg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_normalized_affine_inliers">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_normalized_affine_inliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aff_inliers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_normalized_affine_inliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_normalized_affine_inliers" title="Permalink to this definition"></a></dt>
<dd><p>returns xy-inliers that are normalized to have a mean of 0 and std of 1 as
well as the transformations so the inverse can be taken</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_num_channels">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_num_channels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_num_channels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_num_channels" title="Permalink to this definition"></a></dt>
<dd><p>Returns the number of color channels</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_ori_mats">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_ori_mats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_ori_mats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_ori_mats" title="Permalink to this definition"></a></dt>
<dd><p>Returns keypoint orientation matrixes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_ori_strs">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_ori_strs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_ori_strs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_ori_strs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_orientation">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_orientation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exif_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'warn'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_orientation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_orientation" title="Permalink to this definition"></a></dt>
<dd><p>Returns the image orientation, if available, from the provided
exif_data2 (obtained through exif_data2 above)</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.exif –test-get_orientation</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://wildbookiarepository.azureedge.net/models/orientation.zip&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">images_path</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_zipped_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">image_filename</span> <span class="o">=</span> <span class="s1">&#39;orientation_</span><span class="si">%05d</span><span class="s1">.JPG&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">images_path</span><span class="p">,</span> <span class="n">image_filename</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">exif_dict</span> <span class="o">=</span> <span class="n">get_exif_dict</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">orient</span> <span class="o">=</span> <span class="n">get_orientation</span><span class="p">(</span><span class="n">exif_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pil_img</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">orient</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1, 6, 8]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_orientation_histogram">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_orientation_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gori_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">36</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DEBUG_ROTINVAR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_orientation_histogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_orientation_histogram" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gori</strong> – </p></li>
<li><p><strong>gori_weights</strong> – </p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(hist, centers)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-get_orientation_histogram</p>
</dd>
<dt>Ignore:</dt><dd><p>print(vt.kpts_docrepr(gori, ‘gori = ‘))
print(vt.kpts_docrepr(gori_weights, ‘gori_weights = ‘))</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gori</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">4.71</span><span class="p">,</span>  <span class="mf">6.15</span><span class="p">,</span>  <span class="mf">3.13</span><span class="p">,</span>  <span class="mf">3.24</span><span class="p">,</span>  <span class="mf">4.71</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">4.71</span><span class="p">,</span>  <span class="mf">4.61</span><span class="p">,</span>  <span class="mf">0.5</span> <span class="p">,</span>  <span class="mf">4.85</span><span class="p">,</span>  <span class="mf">4.71</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">1.57</span><span class="p">,</span>  <span class="mf">6.28</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">1.57</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gori_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.19</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.21</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.16</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.11</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.17</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.19</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_orientation_histogram</span><span class="p">(</span><span class="n">gori</span><span class="p">,</span> <span class="n">gori_weights</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_orientation_str">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_orientation_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exif_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_orientation_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_orientation_str" title="Permalink to this definition"></a></dt>
<dd><p>Returns the image orientation strings, if available, from the provided
exif_data2 (obtained through exif_data2 above)</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.exif –test-get_orientation_str</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://wildbookiarepository.azureedge.net/models/orientation.zip&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">images_path</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_zipped_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">image_filename</span> <span class="o">=</span> <span class="s1">&#39;orientation_</span><span class="si">%05d</span><span class="s1">.JPG&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">images_path</span><span class="p">,</span> <span class="n">image_filename</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">exif_dict</span> <span class="o">=</span> <span class="n">get_exif_dict</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">orient_str</span> <span class="o">=</span> <span class="n">get_orientation_str</span><span class="p">(</span><span class="n">exif_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pil_img</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">orient_str</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[&#39;Normal&#39;, &#39;90 Clockwise&#39;, &#39;90 Counter-Clockwise&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_oris">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_oris</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_oris"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_oris" title="Permalink to this definition"></a></dt>
<dd><p>Extracts keypoint orientations for kpts array</p>
<p>(in isotropic guassian space relative to the gravity vector)
(in simpler words: the orientation is is taken from keypoints warped to the unit circle)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpts</strong> (<em>ndarray</em>) – (N x 6) [x, y, a, c, d, theta]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(ndarray) theta</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_pixel_dist">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_pixel_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_pixel_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_pixel_dist" title="Permalink to this definition"></a></dt>
<dd><p>pixel = fillval
isfill = mask2d</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_pointset_extent_wh">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_pointset_extent_wh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#get_pointset_extent_wh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_pointset_extent_wh" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_pointset_extents">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_pointset_extents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#get_pointset_extents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_pointset_extents" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_right_area">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_right_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#get_right_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_right_area" title="Permalink to this definition"></a></dt>
<dd><p>area to the right of each index point</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_round_scaled_dsize">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_round_scaled_dsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_round_scaled_dsize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_round_scaled_dsize" title="Permalink to this definition"></a></dt>
<dd><p>Returns an integer size and scale that best approximates
the floating point scale on the original size</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – original width height</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – desired floating point scale factor</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_scale_factor">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_scale_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_scale_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_scale_factor" title="Permalink to this definition"></a></dt>
<dd><p>returns scale factor from one image to the next</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_scaled_size_with_dlen">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_scaled_size_with_dlen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dlen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#get_scaled_size_with_dlen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_scaled_size_with_dlen" title="Permalink to this definition"></a></dt>
<dd><p>returns new_size which scales (w, h) as close to target_dlen as possible
and maintains aspect ratio</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_scales">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_scales</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_scales"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_scales" title="Permalink to this definition"></a></dt>
<dd><p>Gets average scale (does not take into account elliptical shape</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_shape_strs">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_shape_strs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_shape_strs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_shape_strs" title="Permalink to this definition"></a></dt>
<dd><p>strings debugging and output</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_size">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_size" title="Permalink to this definition"></a></dt>
<dd><p>Returns the image size in (width, height)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_sqrd_scales">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_sqrd_scales</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_sqrd_scales"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_sqrd_scales" title="Permalink to this definition"></a></dt>
<dd><p>gets average squared scale (does not take into account elliptical shape</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_scales_sqrd</span> <span class="o">=</span> <span class="n">get_sqrd_scales</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_scales_sqrd</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_scales_sqrd</span> <span class="o">=</span> <span class="n">get_sqrd_scales</span><span class="p">([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_scales_sqrd</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_star2_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_star2_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_star2_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_star2_patch" title="Permalink to this definition"></a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_star_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_star_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_star_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_star_patch" title="Permalink to this definition"></a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_stripe_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_stripe_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_stripe_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_stripe_patch" title="Permalink to this definition"></a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_test_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_test_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'star'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_test_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_test_patch" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – </p></li>
<li><p><strong>jitter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>patch</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-get_test_patch –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;star2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jitter</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">get_test_patch</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">jitter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">patch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_testdata_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_testdata_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_vecs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#get_testdata_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_testdata_kpts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_transforms_from_patch_image_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_transforms_from_patch_image_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_transforms_from_patch_image_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_transforms_from_patch_image_kpts" title="Permalink to this definition"></a></dt>
<dd><p>Given some patch (like a gaussian patch) transforms a patch to be overlayed
on top of each keypoint in the image (adjusted for a scale factor)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>patch_shape</strong> – </p></li>
<li><p><strong>scale_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of 3x3 tranformation matricies for each keypoint</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>M_list</p>
</dd>
</dl>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_factor</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M_list</span> <span class="o">=</span> <span class="n">get_transforms_from_patch_image_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">patch_shape</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">M_list</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_uncovered_mask">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_uncovered_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covered_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covering_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_uncovered_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_uncovered_mask" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>covered_array</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>covering_array</strong> (<em>ndarray</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>flags</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-get_uncovered_mask</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covering_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">get_uncovered_mask</span><span class="p">(</span><span class="n">covered_array</span><span class="p">,</span> <span class="n">covering_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ True False  True False False]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covering_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">get_uncovered_mask</span><span class="p">(</span><span class="n">covered_array</span><span class="p">,</span> <span class="n">covering_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ True  True  True  True  True]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
<span class="gp">... </span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covering_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">get_uncovered_mask</span><span class="p">(</span><span class="n">covered_array</span><span class="p">,</span> <span class="n">covering_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flags</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[ True, False,  True],</span>
<span class="go">          [False, False,  True],</span>
<span class="go">          [ True,  True,  True]], dtype=np.bool)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Ignore:</dt><dd><p>covering_array = [1, 2, 3, 4, 5, 6, 7]
%timeit get_uncovered_mask(covered_array, covering_array)
100000 loops, best of 3: 18.6 µs per loop
%timeit get_uncovered_mask2(covered_array, covering_array)
100000 loops, best of 3: 16.9 µs per loop</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_undirected_edge_ids">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_undirected_edge_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directed_edges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_undirected_edge_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_undirected_edge_ids" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>directed_edges</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>edgeid_list</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –exec-get_undirected_edge_ids</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">directed_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edgeid_list</span> <span class="o">=</span> <span class="n">get_undirected_edge_ids</span><span class="p">(</span><span class="n">directed_edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;edgeid_list = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">edgeid_list</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">edgeid_list = [0 0 1 2 3 1 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_uneven_point_sample">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_uneven_point_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_uneven_point_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_uneven_point_sample" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>for each keypoint returns an uneven sample of points along the ellipical</dt><dd><p>boundries.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p>
</dd>
</dl>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>pyhesaff.tests.test_ellipse
python -m pyhesaff.tests.test_ellipse –test-in_depth_ellipse –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ellipse_pts1</span> <span class="o">=</span> <span class="n">get_uneven_point_sample</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">ellipse_pts1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;uneven sample points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_unixtime">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_unixtime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exif_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_unixtime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_unixtime" title="Permalink to this definition"></a></dt>
<dd><p>TODO: Exif.Image.TimeZoneOffset</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exif_dict</span> <span class="o">=</span> <span class="n">get_exif_dict</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pil_img</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_unixtime_gps">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_unixtime_gps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exif_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_unixtime_gps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_unixtime_gps" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_unwarped_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_unwarped_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gray</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_unwarped_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_unwarped_patch" title="Permalink to this definition"></a></dt>
<dd><p>Returns unwarped warped patch around a keypoint</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em>) – array representing an image</p></li>
<li><p><strong>kpt</strong> (<em>ndarray</em>) – keypoint ndarray in [x, y, a, c, d, theta] format</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(wpatch, wkp) the normalized 41x41 patches from the img corresonding to the keypoint</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_unwarped_patches">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_unwarped_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_unwarped_patches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_unwarped_patches" title="Permalink to this definition"></a></dt>
<dd><p>Returns cropped unwarped (keypoint is still elliptical) patch around a
keypoint</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em>) – array representing an image</p></li>
<li><p><strong>kpts</strong> (<em>ndarrays</em>) – keypoint ndarrays in [x, y, a, c, d, theta] format</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(patches, subkpts) - the unnormalized patches from the img</dt><dd><p>corresonding to the keypoint</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_warped_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_warped_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gray</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borderMode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">41</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_warped_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_warped_patch" title="Permalink to this definition"></a></dt>
<dd><p>Returns warped (into a unit circle) patch around a keypoint</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em>) – array representing an image</p></li>
<li><p><strong>kpt</strong> (<em>ndarray</em>) – keypoint ndarray in [x, y, a, c, d, theta] format</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(wpatch, wkp) the normalized 41x41 patches from</dt><dd><p>the img corresonding to the keypoint</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(ndarray, ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_warped_patches">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_warped_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borderMode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">41</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cpp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_warped_patches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_warped_patches" title="Permalink to this definition"></a></dt>
<dd><p>Returns warped (into a unit circle) patch around a keypoint</p>
<dl class="simple">
<dt>FIXME:</dt><dd><p>there is a slight translation difference in the way Python extracts
patches and the way C++ extracts patches. C++ should be correct.
TODO: have C++ able to extract color.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – array representing an image</p></li>
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – list of keypoint ndarrays in
[[x, y, a, c, d, theta]] format</p></li>
<li><p><strong>flags</strong> (<em>long</em>) – cv2 interpolation flags</p></li>
<li><p><strong>borderMode</strong> (<em>long</em>) – cv2 border flags</p></li>
<li><p><strong>patch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – resolution of resulting image patch</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(warped_patches, warped_subkpts) the normalized 41x41</dt><dd><p>patches from the img corresonding to the keypoint</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a>)</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-get_warped_patches –show –use_cpp
python -m vtool.patch –test-get_warped_patches –show –use_python</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cpp</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--use_cpp&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">desc</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">INTER_LANCZOS4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">borderMode</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_REPLICATE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">warped_patches</span><span class="p">,</span> <span class="n">warped_subkpts</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_warped_patches</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">kpts</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">borderMode</span><span class="p">,</span> <span class="n">use_cpp</span><span class="o">=</span><span class="n">use_cpp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">warped_patches</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">warped_subkpts</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">warped_patches</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_kpts2(warped_subkpts, pts=True, rect=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;use_cpp = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">use_cpp</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_xy_strs">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_xy_strs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_xy_strs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_xy_strs" title="Permalink to this definition"></a></dt>
<dd><p>strings debugging and output</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.get_xys">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">get_xys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_xys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.get_xys" title="Permalink to this definition"></a></dt>
<dd><p>Keypoint locations in chip space</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.grab_webcam_image">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">grab_webcam_image</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#grab_webcam_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.grab_webcam_image" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_gui/py_video_display/py_video_display.html">http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_gui/py_video_display/py_video_display.html</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-grab_webcam_image –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">grab_webcam_image</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s1">&#39;webcap.jpg&#39;</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.gradient_fill">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">gradient_fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gradient_fill"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.gradient_fill" title="Permalink to this definition"></a></dt>
<dd><p>FIXME: angle does not work properly</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch gradient_fill –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#style = &#39;linear&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;step&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">gradient_fill</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_uint8</span><span class="p">(</span><span class="n">patch</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.gradient_magnitude">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">gradient_magnitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#gradient_magnitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.gradient_magnitude" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.greedy_setcover">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">greedy_setcover</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">universe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#greedy_setcover"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.greedy_setcover" title="Permalink to this definition"></a></dt>
<dd><p>Copied implmentation of greedy set cover from stack overflow. Needs work.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/7942312/of-greedy-set-cover-faster">http://stackoverflow.com/questions/7942312/of-greedy-set-cover-faster</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">universe</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subsets</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="nb">set</span><span class="p">([</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chosen</span><span class="p">,</span> <span class="n">costs</span> <span class="o">=</span> <span class="n">greedy_setcover</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">subsets</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cover: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">chosen</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total Cost: </span><span class="si">%r</span><span class="s1">=sum(</span><span class="si">%r</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">costs</span><span class="p">),</span> <span class="n">costs</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.gridsearch_addWeighted">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">gridsearch_addWeighted</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#gridsearch_addWeighted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.gridsearch_addWeighted" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/blend.py gridsearch_addWeighted</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.gridsearch_chipextract">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">gridsearch_chipextract</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#gridsearch_chipextract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.gridsearch_chipextract" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/chip.py gridsearch_chipextract –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_chipextract</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.gridsearch_image_function">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">gridsearch_image_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#gridsearch_image_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.gridsearch_image_function" title="Permalink to this definition"></a></dt>
<dd><p>gridsearch for a function that produces a single image</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.group_consecutive">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">group_consecutive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#group_consecutive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.group_consecutive" title="Permalink to this definition"></a></dt>
<dd><p>Returns lists of consecutive values</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/7352684/how-to-find-the-groups-of-consecutive-elements-from-an-array-in-numpy">http://stackoverflow.com/questions/7352684/how-to-find-the-groups-of-consecutive-elements-from-an-array-in-numpy</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>ndarray</em>) – must be integral and unique</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>arr -</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –exec-group_consecutive</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groups</span> <span class="o">=</span> <span class="n">group_consecutive</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;groups = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">groups</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">groups = [array([1, 2, 3]), array([ 5,  6,  7,  8,  9, 10]), array([15]), array([ 99, 100, 101])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.group_indices">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">group_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx2_groupid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#group_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.group_indices" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>idx2_groupid</strong> (<em>ndarray</em>) – numpy array of group ids (must be numeric)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(keys, groupxs)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a> (ndarray, list of ndarrays)</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/clustering2.py group_indices
xdoctest -m ~/code/vtool/vtool/clustering2.py group_indices:0
xdoctest -m ~/code/vtool/vtool/clustering2.py group_indices:1</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([1, 2, 3], dtype=np.int64),</span>
<span class="go">[</span>
<span class="go">    np.array([1, 3, 5], dtype=np.int64),</span>
<span class="go">    np.array([0, 2, 4, 6], dtype=np.int64),</span>
<span class="go">    np.array([ 7,  8,  9, 10], dtype=np.int64),</span>
<span class="go">],</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mi">24</span><span class="p">],</span> <span class="p">[</span> <span class="mi">129</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">24</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span><span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">822</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span><span class="mi">24</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2d arrays must be flattened before coming into this function so</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># information is on the last axis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([ 24, 129, 659, 822], dtype=np.int64),</span>
<span class="go">[</span>
<span class="go">    np.array([ 0,  4, 10], dtype=np.int64),</span>
<span class="go">    np.array([1], dtype=np.int64),</span>
<span class="go">    np.array([2, 3, 5, 6, 8, 9], dtype=np.int64),</span>
<span class="go">    np.array([7], dtype=np.int64),</span>
<span class="go">],</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([False,  True], dtype=np.bool),</span>
<span class="go">[</span>
<span class="go">    np.array([2, 4, 5], dtype=np.int64),</span>
<span class="go">    np.array([0, 1, 3, 6], dtype=np.int64),</span>
<span class="go">],</span>
</pre></div>
</div>
<dl>
<dt>Time:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">extract_timeit_setup</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">group_indices</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;groupxs =&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">setup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="go">        [sortx[lx:rx] for lx, rx in ut.itertwo(idxs)]</span>
<span class="go">        [sortx[lx:rx] for lx, rx in zip(idxs, idxs[1:])]</span>
<span class="go">        #[sortx[lx:rx] for lx, rx in ut.iter_window(idxs)]</span>
<span class="go">        #[sortx[slice(*_)] for _ in ut.itertwo(idxs)]</span>
<span class="go">        #[sortx[slice(lr, lx)] for lr, lx in ut.itertwo(idxs)]</span>
<span class="go">        #np.split(sortx, idxs[1:-1])</span>
<span class="go">        #np.hsplit(sortx, idxs[1:-1])</span>
<span class="go">        np.array_split(sortx, idxs[1:-1])</span>
<span class="go">        &#39;&#39;&#39;).split(&#39;\n&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stmt_list</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">passed</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="go">        np.diff(groupids_sorted)</span>
<span class="go">        np.ediff1d(groupids_sorted)</span>
<span class="go">        np.subtract(groupids_sorted[1:], groupids_sorted[:-1])</span>
<span class="go">        &#39;&#39;&#39;).split(&#39;\n&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stmt_list</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">passed</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Ignore:</dt><dd><p>import numba
group_indices_numba = numba.jit(group_indices)
group_indices_numba(idx2_groupid)</p>
</dd>
<dt>SeeAlso:</dt><dd><p>apply_grouping</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4651683/">http://stackoverflow.com/questions/4651683/</a>
numpy-grouping-using-itertools-groupby-performance</p>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<p>Look into np.split
<a class="reference external" href="http://stackoverflow.com/questions/21888406/">http://stackoverflow.com/questions/21888406/</a>
getting-the-indexes-to-the-duplicate-columns-of-a-numpy-array</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.groupby">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">groupby</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx2_groupid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupby"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.groupby" title="Permalink to this definition"></a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">items</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span> <span class="o">=</span> <span class="n">idx2_groupid</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.groupby_dict">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">groupby_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx2_groupid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupby_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.groupby_dict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.groupby_gen">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">groupby_gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx2_groupid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupby_gen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.groupby_gen" title="Permalink to this definition"></a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">items</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.groupedzip">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">groupedzip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datas_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupedzip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.groupedzip" title="Permalink to this definition"></a></dt>
<dd><p>Function for grouping multiple lists of data (stored in <code class="docutils literal notranslate"><span class="pre">datas_list</span></code>)
using <code class="docutils literal notranslate"><span class="pre">id_list</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>datas_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>_iter</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>iterator</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.clustering2 –test-groupedzip</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">id_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datas_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupxs</span><span class="p">,</span> <span class="n">grouped_iter</span> <span class="o">=</span> <span class="n">groupedzip</span><span class="p">(</span><span class="n">id_list</span><span class="p">,</span> <span class="n">datas_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_tuples</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">grouped_iter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">groupxs</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">grouped_tuples</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[</span>
<span class="go">    ([&#39;a&#39;, &#39;c&#39;, &#39;e&#39;], [&#39;A&#39;, &#39;C&#39;, &#39;E&#39;]),</span>
<span class="go">    ([&#39;b&#39;, &#39;d&#39;, &#39;f&#39;], [&#39;B&#39;, &#39;D&#39;, &#39;F&#39;]),</span>
<span class="go">    ([&#39;g&#39;], [&#39;G&#39;]),</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.haversine">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">haversine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latlon1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latlon2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#haversine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.haversine" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the great circle distance between two points
on the earth (specified in decimal degrees)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latlon1</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>latlon2</strong> (<em>ndarray</em>) – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>en.wikipedia.org/wiki/Haversine_formula
gis.stackexchange.com/questions/81551/matching-gps-tracks
stackoverflow.com/questions/4913349/haversine-distance-gps-points</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –exec-haversine</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.spatial.distance</span> <span class="k">as</span> <span class="nn">spdist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">functools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gpsarr_track_list_</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="o">-</span><span class="mf">80.21895315</span><span class="p">,</span> <span class="o">-</span><span class="mf">158.81099213</span><span class="p">],</span>
<span class="gp">... </span>             <span class="p">[</span> <span class="o">-</span><span class="mf">12.08338926</span><span class="p">,</span>   <span class="mf">67.50368014</span><span class="p">],</span>
<span class="gp">... </span>             <span class="p">[</span> <span class="o">-</span><span class="mf">11.08338926</span><span class="p">,</span>   <span class="mf">67.50368014</span><span class="p">],</span>
<span class="gp">... </span>             <span class="p">[</span> <span class="o">-</span><span class="mf">11.08338926</span><span class="p">,</span>   <span class="mf">67.50368014</span><span class="p">],]</span>
<span class="gp">... </span>   <span class="p">),</span>
<span class="gp">... </span>   <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>   <span class="mf">9.77816711</span><span class="p">,</span>  <span class="o">-</span><span class="mf">17.27471498</span><span class="p">],</span>
<span class="gp">... </span>             <span class="p">[</span> <span class="o">-</span><span class="mf">51.67678814</span><span class="p">,</span> <span class="o">-</span><span class="mf">158.91065495</span><span class="p">],])</span>
<span class="gp">... </span>   <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latlon1</span> <span class="o">=</span> <span class="n">gpsarr_track_list_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latlon2</span> <span class="o">=</span> <span class="n">gpsarr_track_list_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kilometers</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">haversine</span><span class="p">(</span><span class="n">latlon1</span><span class="p">,</span> <span class="n">latlon2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">haversin_pdist</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">spdist</span><span class="o">.</span><span class="n">pdist</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">vt</span><span class="o">.</span><span class="n">haversine</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_vector_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">haversin_pdist</span><span class="p">,</span> <span class="n">gpsarr_track_list_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_matrix_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">spdist</span><span class="o">.</span><span class="n">squareform</span><span class="p">,</span> <span class="n">dist_vector_list</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.hist_argmaxima">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">hist_argmaxima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxima_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#hist_argmaxima"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.hist_argmaxima" title="Permalink to this definition"></a></dt>
<dd><p>must take positive only values</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.histogram hist_argmaxima</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>    <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_x</span><span class="p">,</span> <span class="n">maxima_y</span><span class="p">,</span> <span class="n">argmaxima</span> <span class="o">=</span> <span class="n">hist_argmaxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">maxima_x</span><span class="p">,</span> <span class="n">maxima_y</span><span class="p">,</span> <span class="n">argmaxima</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.hist_argmaxima2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">hist_argmaxima2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxima_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#hist_argmaxima2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.hist_argmaxima2" title="Permalink to this definition"></a></dt>
<dd><p>must take positive only values</p>
<dl>
<dt>Setup:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
</pre></div>
</div>
</dd>
<dt>GridSearch:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argmaxima</span> <span class="o">=</span> <span class="n">hist_argmaxima2</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">argmaxima</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.hist_edges_to_centers">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">hist_edges_to_centers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#hist_edges_to_centers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.hist_edges_to_centers" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.79</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">1.57</span><span class="p">,</span> <span class="mf">2.36</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.93</span><span class="p">,</span> <span class="mf">4.71</span><span class="p">,</span> <span class="mf">5.50</span><span class="p">,</span> <span class="mf">6.28</span><span class="p">,</span> <span class="mf">7.07</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">hist_edges_to_centers</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[-0.395  0.395  1.18   1.965  2.75   3.535  4.32   5.105  5.89   6.675]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.hist_isect">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">hist_isect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#hist_isect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.hist_isect" title="Permalink to this definition"></a></dt>
<dd><p>returns histogram intersection distance between two histograms</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.homogenous_circle_pts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">homogenous_circle_pts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nSamples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#homogenous_circle_pts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.homogenous_circle_pts" title="Permalink to this definition"></a></dt>
<dd><p>Make a list of homogenous circle points</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.iceil">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">iceil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.int32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#iceil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.iceil" title="Permalink to this definition"></a></dt>
<dd><p>Integer ceiling. (because numpy doesn’t seem to have it!)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>num</strong> (<em>ndarray</em><em> or </em><em>scalar</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray or scalar</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –test-iceil</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">iceil</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">iceil</span><span class="p">(</span><span class="n">num</span><span class="p">),</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([2, 3], dtype=np.int32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.imread">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">imread</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grayscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_pil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_if_corrupted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imread"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.imread" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper around the opencv imread function. Handles remote uris.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_fpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – file path string</p></li>
<li><p><strong>grayscale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
<li><p><strong>orient</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
<li><p><strong>flags</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – opencv flags (default = None)</p></li>
<li><p><strong>force_pil</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = None)</p></li>
<li><p><strong>delete_if_corrupted</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>imgBGR</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-imread
python -m vtool.image –test-imread:1
python -m vtool.image –test-imread:2</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/core/doc/utility_and_system_functions_and_macros.html#error">http://docs.opencv.org/modules/core/doc/utility_and_system_functions_and_macros.html#error</a>
<a class="reference external" href="http://stackoverflow.com/questions/23572241/cv2-threshold-error-210">http://stackoverflow.com/questions/23572241/cv2-threshold-error-210</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR1</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR2</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR3</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">imgBGR1</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">imgBGR2</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># assert np.all(imgBGR1 == imgBGR3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR3</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_url</span> <span class="o">=</span> <span class="s1">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="n">img_url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR1</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR2</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#imgBGR2 = imread(img_fpath, force_pil=False, flags=cv2.IMREAD_UNCHANGED)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;imgBGR.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">imgBGR1</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;imgBGR2.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">imgBGR2</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">imgBGR1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff_pxls</span> <span class="o">=</span> <span class="n">imgBGR1</span> <span class="o">!=</span> <span class="n">imgBGR2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_diff_pxls</span> <span class="o">=</span> <span class="n">diff_pxls</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;num_diff_pxls=</span><span class="si">%r</span><span class="s1">/</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">num_diff_pxls</span><span class="p">,</span> <span class="n">diff_pxls</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">num_diff_pxls</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diffMag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">imgBGR2</span> <span class="o">/</span> <span class="mf">255.</span> <span class="o">-</span> <span class="n">imgBGR1</span> <span class="o">/</span> <span class="mf">255.</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">diffMag</span> <span class="o">/</span> <span class="n">diffMag</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">(2736, 3648, 3)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://www.sherv.net/cm/emo/funny/2/big-dancing-banana-smiley-emoticon.gif&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_if_corrupted</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grayscale</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="n">grayscale</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.imread_remote_s3">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">imread_remote_s3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imread_remote_s3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.imread_remote_s3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.imread_remote_url">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">imread_remote_url</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_url</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imread_remote_url"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.imread_remote_url" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.imwrite">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">imwrite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fallback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imwrite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.imwrite" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/highgui/doc/reading_and_writing_images_and_video.html">http://docs.opencv.org/modules/highgui/doc/reading_and_writing_images_and_video.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_fpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – file path string</p></li>
<li><p><strong>imgBGR</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data in opencv format (blue, green, red)</p></li>
<li><p><strong>fallback</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –exec-imwrite</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;zebra.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_dpath</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">ensure_app_cache_dir</span><span class="p">(</span><span class="s1">&#39;vtool&#39;</span><span class="p">,</span> <span class="s1">&#39;testwrite&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">unixjoin</span><span class="p">(</span><span class="n">img_dpath</span><span class="p">,</span> <span class="s1">&#39;zebra.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fallback</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imwrite</span><span class="p">(</span><span class="n">img_fpath2</span><span class="p">,</span> <span class="n">imgBGR</span><span class="p">,</span> <span class="n">fallback</span><span class="o">=</span><span class="n">fallback</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">imgBGR2</span> <span class="o">==</span> <span class="n">imgBGR</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.imwrite_fallback">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">imwrite_fallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imwrite_fallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.imwrite_fallback" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.inbounds">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">inbounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#inbounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inbounds" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num</strong> (<em>scalar</em><em> or </em><em>ndarray</em>) – </p></li>
<li><p><strong>low</strong> (<em>scalar</em><em> or </em><em>ndarray</em>) – </p></li>
<li><p><strong>high</strong> (<em>scalar</em><em> or </em><em>ndarray</em>) – </p></li>
<li><p><strong>eq</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>is_inbounds</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>scalar or ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/other.py inbounds</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>   <span class="p">,</span>  <span class="mf">0.431</span><span class="p">,</span>  <span class="mf">0.279</span><span class="p">],</span>
<span class="gp">... </span>                <span class="p">[</span> <span class="mf">0.204</span><span class="p">,</span>  <span class="mf">0.352</span><span class="p">,</span>  <span class="mf">0.08</span> <span class="p">],</span>
<span class="gp">... </span>                <span class="p">[</span> <span class="mf">0.107</span><span class="p">,</span>  <span class="mf">0.325</span><span class="p">,</span>  <span class="mf">0.179</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">low</span>  <span class="o">=</span> <span class="mf">.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">high</span> <span class="o">=</span> <span class="mf">.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_inbounds</span> <span class="o">=</span> <span class="n">inbounds</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">eq</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">is_inbounds</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.index_partition">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">index_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part1_items</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#index_partition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.index_partition" title="Permalink to this definition"></a></dt>
<dd><p>returns two lists. The first are the indecies of items in item_list that
are in part1_items. the second is the indices in item_list that are not
in part1_items. items in part1_items that are not in item_list are
ignored</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dist&#39;</span><span class="p">,</span> <span class="s1">&#39;fg&#39;</span><span class="p">,</span> <span class="s1">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fg&#39;</span><span class="p">,</span> <span class="s1">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_indexes</span><span class="p">,</span> <span class="n">part2_indexes</span> <span class="o">=</span> <span class="n">index_partition</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part1_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">part1_indexes</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">part2_indexes</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.index_to_boolmask">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">index_to_boolmask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isflat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#index_to_boolmask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.index_to_boolmask" title="Permalink to this definition"></a></dt>
<dd><p>transforms a list of indicies into a boolean mask</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index_list</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>maxval</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>maxval</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>mask</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_numpy index_to_boolmask</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_numpy</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxval</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">index_to_boolmask</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="n">maxval</span><span class="p">,</span> <span class="n">isflat</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mask =</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[1 0 0]</span>
<span class="go"> [0 1 0]</span>
<span class="go"> [0 1 0]]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_numpy</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxval</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">index_to_boolmask</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="n">maxval</span><span class="p">,</span> <span class="n">isflat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mask = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">mask = [1 1 0 0 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.infer_vert">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">infer_vert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vert</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#infer_vert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.infer_vert" title="Permalink to this definition"></a></dt>
<dd><p>which is the better stack dimension</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.inspect_pdfs">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">inspect_pdfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tn_support</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp_support</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_tp_given_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_tn_given_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_score_given_tp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_score_given_tn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_roc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_precision_recall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_hist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_stems</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part_attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr_callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_prebayes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_postbayes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#inspect_pdfs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inspect_pdfs" title="Permalink to this definition"></a></dt>
<dd><p>Shows plots of learned thresholds</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –test-ScoreNormalizer –show
python -m vtool.score_normalization –exec-ScoreNormalizer.visualize –show</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.interact_roc_factory">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">interact_roc_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">confusions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_tpr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_operating_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#interact_roc_factory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.interact_roc_factory" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>confusions</strong> (<em>Confusions</em>) – </p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.confusion –exec-interact_roc_factory –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;scores = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">make_csv_table</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="p">[</span><span class="n">confusions</span><span class="o">.</span><span class="n">fpr</span><span class="p">,</span> <span class="n">confusions</span><span class="o">.</span><span class="n">tpr</span><span class="p">,</span> <span class="n">confusions</span><span class="o">.</span><span class="n">thresholds</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="p">[</span><span class="s1">&#39;fpr&#39;</span><span class="p">,</span> <span class="s1">&#39;tpr&#39;</span><span class="p">,</span> <span class="s1">&#39;thresh&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ROCInteraction</span> <span class="o">=</span> <span class="n">interact_roc_factory</span><span class="p">(</span><span class="n">confusions</span><span class="p">,</span> <span class="n">target_tpr</span><span class="o">=</span><span class="mf">.4</span><span class="p">,</span> <span class="n">show_operating_point</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">ROCInteraction</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span><span class="o">.</span><span class="n">show_page</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.intern_warp_single_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">intern_warp_single_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borderMode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#intern_warp_single_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.intern_warp_single_patch" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori</span> <span class="o">=</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">patch_size</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y a c d S&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">half_patch_size</span> <span class="o">=</span> <span class="n">patch_size</span> <span class="o">/</span> <span class="mi">2</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">sympy_rotation_mat3x3</span><span class="p">(</span><span class="n">radians</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># TODO: handle array impouts</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">sin_</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cos_</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(((</span><span class="n">cos_</span><span class="p">,</span> <span class="o">-</span><span class="n">sin_</span><span class="p">,</span>  <span class="mi">0</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">(</span><span class="n">sin_</span><span class="p">,</span>  <span class="n">cos_</span><span class="p">,</span>  <span class="mi">0</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                  <span class="p">(</span>   <span class="mi">0</span><span class="p">,</span>     <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">ori</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kp</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_invV_mats</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">with_trans</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">kp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ss</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">patch_size</span><span class="p">)</span> <span class="o">*</span> <span class="mf">3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ltool</span><span class="o">.</span><span class="n">translation_mat3x3</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>  <span class="c1"># Center the patch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">sympy_rotation_mat3x3</span><span class="p">(</span><span class="o">-</span><span class="n">ori</span><span class="p">)</span>  <span class="c1"># Rotate the centered unit circle patch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ltool</span><span class="o">.</span><span class="n">scale_mat3x3</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>  <span class="c1"># scale from unit circle to the patch size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ltool</span><span class="o">.</span><span class="n">translation_mat3x3</span><span class="p">(</span><span class="n">half_patch_size</span><span class="p">,</span> <span class="n">half_patch_size</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>  <span class="c1"># Translate back to patch-image coordinates</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy</span><span class="o">.</span><span class="n">MatMul</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">add_matmul_hold_prop</span><span class="p">(</span><span class="n">mat</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1">#import functools</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">matmul_hold</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">new</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">MatMul</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="n">hold</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">return</span> <span class="n">new</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1">#matmul_hold = functools.partial(sympy.MatMul, mat, hold=True)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">setattr</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="s1">&#39;matmul_hold&#39;</span><span class="p">,</span> <span class="n">matmul_hold</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_matmul_hold_prop</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">matmul_hold</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">.</span><span class="n">matmul_hold</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">.</span><span class="n">matmul_hold</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">.</span><span class="n">matmul_hold</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#M = X.multiply(S).multiply(R).multiply(V).multiply(T)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V_full</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">V_full</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">T</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">R</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">invV</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;^{-1}&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.interpolate_between">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">interpolate_between</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peak_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nScales</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_between"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.interpolate_between" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.interpolate_maxima">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">interpolate_maxima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scalar_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_maxima"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.interpolate_maxima" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.interpolate_nans">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">interpolate_nans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#interpolate_nans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.interpolate_nans" title="Permalink to this definition"></a></dt>
<dd><p>replaces nans with interpolated values or 0</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>ndarray</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new_arr</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –exec-interpolate_nans</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_arr</span> <span class="o">=</span> <span class="n">interpolate_nans</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;new_arr = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">new_arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">new_arr = [ 0.  0.  0.  0.]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_arr</span> <span class="o">=</span> <span class="n">interpolate_nans</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;new_arr = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">new_arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">new_arr = [  1.    1.    2.8   4.6   6.4   8.2  10.    7.5   5. ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.interpolate_peaks">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">interpolate_peaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_data_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_data_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_peaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.interpolate_peaks" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.interpolate_peaks2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">interpolate_peaks2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_data_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_data_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_peaks2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.interpolate_peaks2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.interpolate_precision_recall">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">interpolate_precision_recall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">precision</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#interpolate_precision_recall"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.interpolate_precision_recall" title="Permalink to this definition"></a></dt>
<dd><p>Interpolates precision as a function of recall p_{interp}(r)</p>
<p>Reduce wiggles in average precision curve by taking interpolated values
along a uniform sample.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Information_retrieval#Average_precision">http://en.wikipedia.org/wiki/Information_retrieval#Average_precision</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Information_retrieval#Mean_Average_precision">http://en.wikipedia.org/wiki/Information_retrieval#Mean_Average_precision</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.confusion –test-interpolate_precision_recall –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nSamples</span> <span class="o">=</span> <span class="mi">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">precision</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">precision</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recall</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">recall</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recall_domain</span><span class="p">,</span> <span class="n">p_interp</span> <span class="o">=</span> <span class="n">interpolate_precision_recall</span><span class="p">(</span><span class="n">confusions</span><span class="o">.</span><span class="n">precision</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">nSamples</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">p_interp</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_precision_recall_curve</span><span class="p">(</span><span class="n">recall_domain</span><span class="p">,</span> <span class="n">p_interp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([ 1. ,  1. ,  1. ,  1. ,  1. ,  1. ,  1. ,  0.9,  0.9,  0.8,  0.6], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.interpolate_replbounds">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">interpolate_replbounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#interpolate_replbounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.interpolate_replbounds" title="Permalink to this definition"></a></dt>
<dd><p>xdata = np.array([.1, .2, .3, .4, .5])
ydata = np.array([.1, .2, .3, .4, .5])
pt = .35</p>
<dl class="simple">
<dt>FIXME:</dt><dd><p>if duplicate xdata is given bad things happen.</p>
</dd>
<dt>BUG:</dt><dd><p>in scipy.interpolate.interp1d
If there is a duplicate xdata, then assume_sorted=False will
sort ydata by xdata, but xdata should retain its initial ordering
in places of ambuguity. Currently it does not.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xdata</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>ydata</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>pt</strong> (<em>ndarray</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>interp_vals</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.confusion –exec-interpolate_replbounds</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ConfusionMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tpr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#xdata = self.fpr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#ydata = self.thresholds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt = 0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="n">interpolate_replbounds</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">maximize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;thresh = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">thresh</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="n">interpolate_replbounds</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">maximize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;thresh = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">thresh</span><span class="p">,))</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.7</span><span class="p">,</span>  <span class="mf">0.8</span><span class="p">,</span>  <span class="mf">0.8</span><span class="p">,</span>  <span class="mf">0.9</span><span class="p">,</span>  <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">34</span><span class="p">,</span>    <span class="mi">26</span><span class="p">,</span>   <span class="mi">23</span><span class="p">,</span>   <span class="mi">22</span><span class="p">,</span>   <span class="mi">19</span><span class="p">,</span>  <span class="mi">17</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.85</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interp_vals</span> <span class="o">=</span> <span class="n">interpolate_replbounds</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;interp_vals = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">interp_vals</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">interp_vals = [ 22.5  17.   34. ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.interpolate_submaxima">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">interpolate_submaxima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argmaxima</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#interpolate_submaxima"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.interpolate_submaxima" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>argmaxima</strong> (<em>ndarray</em>) – indicies into ydata / centers that are argmaxima</p></li>
<li><p><strong>hist_</strong> (<em>ndarray</em>) – ydata, histogram frequencies</p></li>
<li><p><strong>centers</strong> (<em>ndarray</em>) – xdata, histogram labels</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>FIXME:</dt><dd><p>what happens when argmaxima[i] == len(hist_)</p>
</dd>
<dt>CommandLine:</dt><dd><p>python -m vtool.histogram –test-interpolate_submaxima –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argmaxima</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>    <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span> <span class="o">=</span> <span class="n">interpolate_submaxima</span><span class="p">(</span><span class="n">argmaxima</span><span class="p">,</span> <span class="n">hist_</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">interpolate_submaxima</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                           <span class="n">key_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x123&#39;</span><span class="p">,</span> <span class="s1">&#39;y123&#39;</span><span class="p">,</span> <span class="s1">&#39;coeff_list&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x123</span><span class="p">,</span> <span class="n">y123</span><span class="p">,</span> <span class="n">coeff_list</span> <span class="o">=</span> <span class="n">locals_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ensure_fnum</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">hist_</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">centers</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="n">hist_</span><span class="p">[</span><span class="n">argmaxima</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;argmaxima&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;interp maxima&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Extract parabola points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x123</span><span class="p">,</span> <span class="n">y123</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;maxima neighbors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xpoints</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">)</span> <span class="ow">in</span> <span class="n">x123</span><span class="o">.</span><span class="n">T</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ypoints</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">x_pts</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_pts</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">coeff_list</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw Submax Parabola</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x_pts</span><span class="p">,</span> <span class="n">y_pts</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">ypoints</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_pts</span><span class="p">,</span> <span class="n">y_pts</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([ 0.15,  3.03,  5.11], dtype=np.float64),</span>
<span class="go">np.array([  9.2 ,  37.19,   0.  ], dtype=np.float64),</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argmaxima</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.interpolated_histogram">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">interpolated_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_wrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#interpolated_histogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.interpolated_histogram" title="Permalink to this definition"></a></dt>
<dd><p>Follows np.histogram, but does interpolation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>weights</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – range from 0 to 1</p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
<li><p><strong>interpolation_wrap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = True)</p></li>
<li><p><strong>_debug</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.histogram –test-interpolated_histogram</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">3.5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">range_</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interpolation_wrap</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">interpolated_histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">range_</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">interpolation_wrap</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">hist</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">1E-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">hist</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">edges</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_histinfo_str</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">3.5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">range_</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interpolation_wrap</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">interpolated_histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">range_</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">interpolation_wrap</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">hist</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">1E-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">hist</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">edges</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_histinfo_str</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.intersect1d_reduce">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">intersect1d_reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_unique</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect1d_reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.intersect1d_reduce" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.intersect2d_flags">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">intersect2d_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.intersect2d_flags" title="Permalink to this definition"></a></dt>
<dd><p>Checks intersection of rows of A against rows of B</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </p></li>
<li><p><strong>B</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(flag_list1, flag_list2)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-intersect2d_flags</p>
</dd>
<dt>SeeAlso:</dt><dd><p>np.in1d - the one dimensional version</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">609</span><span class="p">,</span> <span class="mi">307</span><span class="p">],</span> <span class="p">[</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">344</span><span class="p">],</span> <span class="p">[</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">690</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">422</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">422</span><span class="p">,</span>  <span class="mi">968</span><span class="p">],</span> <span class="p">[</span> <span class="mi">481</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">1132</span><span class="p">],</span> <span class="p">[</span> <span class="mi">759</span><span class="p">,</span>  <span class="mi">159</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">flag_list1</span><span class="p">,</span> <span class="n">flag_list2</span><span class="p">)</span> <span class="o">=</span> <span class="n">intersect2d_flags</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">flag_list1</span><span class="p">,</span> <span class="n">flag_list2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.intersect2d_indices">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">intersect2d_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.intersect2d_indices" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </p></li>
<li><p><strong>B</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(ax_list, bx_list)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-intersect2d_indices</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">158</span><span class="p">,</span>  <span class="mi">171</span><span class="p">],</span> <span class="p">[</span> <span class="mi">542</span><span class="p">,</span>  <span class="mi">297</span><span class="p">],</span> <span class="p">[</span> <span class="mi">955</span><span class="p">,</span> <span class="mi">1113</span><span class="p">],</span> <span class="p">[</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1254</span><span class="p">],</span> <span class="p">[</span> <span class="mi">976</span><span class="p">,</span> <span class="mi">1255</span><span class="p">],</span> <span class="p">[</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">1265</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">117</span><span class="p">,</span>  <span class="mi">211</span><span class="p">],</span> <span class="p">[</span> <span class="mi">158</span><span class="p">,</span>  <span class="mi">171</span><span class="p">],</span> <span class="p">[</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1254</span><span class="p">],</span> <span class="p">[</span> <span class="mi">309</span><span class="p">,</span>  <span class="mi">328</span><span class="p">],</span> <span class="p">[</span> <span class="mi">447</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">750</span><span class="p">,</span>  <span class="mi">357</span><span class="p">],</span> <span class="p">[</span> <span class="mi">976</span><span class="p">,</span> <span class="mi">1255</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">ax_list</span><span class="p">,</span> <span class="n">bx_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">intersect2d_indices</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">ax_list</span><span class="p">,</span> <span class="n">bx_list</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.intersect2d_numpy">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">intersect2d_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_unique</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.intersect2d_numpy" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays/8317155#8317155">http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays/8317155#8317155</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </p></li>
<li><p><strong>B</strong> (<em>ndarray</em><em>[</em><em>ndims=2</em><em>]</em>) – </p></li>
<li><p><strong>assume_unique</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>C</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[ndims=2]</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-intersect2d_numpy</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">78</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span> <span class="mi">283</span><span class="p">,</span> <span class="mi">396</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">403</span><span class="p">,</span> <span class="mi">412</span><span class="p">,</span> <span class="mi">535</span><span class="p">,</span> <span class="mi">552</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">152</span><span class="p">,</span>  <span class="mi">98</span><span class="p">,</span>  <span class="mi">32</span><span class="p">,</span> <span class="mi">260</span><span class="p">,</span> <span class="mi">387</span><span class="p">,</span> <span class="mi">285</span><span class="p">,</span>  <span class="mi">22</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span>  <span class="mi">55</span><span class="p">,</span> <span class="mi">261</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">403</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span> <span class="mi">412</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span> <span class="mi">815</span><span class="p">,</span> <span class="mi">463</span><span class="p">,</span> <span class="mi">613</span><span class="p">,</span> <span class="mi">552</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span> <span class="mi">22</span><span class="p">,</span>  <span class="mi">32</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">199</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">254</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assume_unique</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span> <span class="o">=</span> <span class="n">intersect2d_numpy</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">C</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([[ 85, 403, 412],</span>
<span class="go">       [ 32,  22, 103]]), array([2, 6, 7]), array([0, 1, 2]))</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span> <span class="o">=</span> <span class="n">intersect2d_numpy</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">C</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([[1, 2, 3]]), array([0]), array([0]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.intersect2d_structured_numpy">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">intersect2d_structured_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_unique</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_structured_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.intersect2d_structured_numpy" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr1</strong> – unstructured 2d array</p></li>
<li><p><strong>arr2</strong> – unstructured 2d array</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A_, B_, C_ - structured versions of arr1, and arr2, and their structured intersection</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array">http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array</a>
<a class="reference external" href="http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays">http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.inv_ltri">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">inv_ltri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ltri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#inv_ltri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inv_ltri" title="Permalink to this definition"></a></dt>
<dd><p>Lower triangular inverse</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.invert_apply_grouping">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">invert_apply_grouping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grouped_items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupxs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#invert_apply_grouping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.invert_apply_grouping" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grouped_items</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – of lists</p></li>
<li><p><strong>groupxs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – of lists</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>items</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.clustering2 –test-invert_apply_grouping</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_items</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span> <span class="o">=</span> <span class="n">invert_apply_grouping</span><span class="p">(</span><span class="n">grouped_items</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">items</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1, 8, 5, 5, 8, 6, 7, 5, 3, 0, 9]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_items</span><span class="p">,</span> <span class="n">groupxs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">invert_apply_grouping</span><span class="p">(</span><span class="n">grouped_items</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.invert_apply_grouping2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">invert_apply_grouping2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grouped_items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#invert_apply_grouping2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.invert_apply_grouping2" title="Permalink to this definition"></a></dt>
<dd><p>use only when ungrouping will be complete</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.invert_apply_grouping3">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">invert_apply_grouping3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grouped_items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxval</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#invert_apply_grouping3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.invert_apply_grouping3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.invert_invV_mats">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">invert_invV_mats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">invV_mats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#invert_invV_mats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.invert_invV_mats" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>invV_mats</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=3</em><em>]</em>) – keypoint shapes (possibly translation)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>V_mats</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float32_t, ndim=3]</p>
</dd>
</dl>
<p># Ignore:
#     &gt;&gt;&gt; from vtool.keypoint import *
#     &gt;&gt;&gt; invV_mats  = np.array([[[ 18.00372824,   1.86434161,  32.        ],
#     &gt;&gt;&gt;                         [ -0.61356842,  16.02202028,  27.2       ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]],
#     &gt;&gt;&gt; #
#     &gt;&gt;&gt;                         [[ 17.41989015,   2.51145917,  61.        ],
#     &gt;&gt;&gt;                         [ -2.94649591,  24.02540959,  22.9       ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]],
#     &gt;&gt;&gt; #
#     &gt;&gt;&gt;                         [[ 20.38098025,   0.88070646,  93.1       ],
#     &gt;&gt;&gt;                         [ -0.93778675,  24.78261982,  23.6       ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]],
#     &gt;&gt;&gt; #
#     &gt;&gt;&gt;                         [[ 16.25114793,  -5.93213207, 120.        ],
#     &gt;&gt;&gt;                         [  4.71295477,  21.80597527,  29.5       ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]],
#     &gt;&gt;&gt; #
#     &gt;&gt;&gt;                         [[ 19.60863253, -11.43641248, 147.        ],
#     &gt;&gt;&gt;                         [  8.45128003,  10.69925072,  42.        ],
#     &gt;&gt;&gt;                         [  0.        ,   0.        ,   1.        ]]])
#     &gt;&gt;&gt; ut.hash_data(invV_mats)
#     hcnoknyxgeecfyfrygblbvdeezmiulws
#     &gt;&gt;&gt; V_mats = npl.inv(invV_mats)
#     &gt;&gt;&gt; ut.hash_data(V_mats)
#     yooneahjgcifojzpovddeyhtkkyypldd</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_mats</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_invVR_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V_mats</span> <span class="o">=</span> <span class="n">invert_invV_mats</span><span class="p">(</span><span class="n">invV_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">invV_mats</span><span class="p">,</span> <span class="n">V_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This should give us identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.inverted_sift_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">inverted_sift_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#inverted_sift_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.inverted_sift_patch" title="Permalink to this definition"></a></dt>
<dd><p>Idea for inverted sift visualization</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch test_sift_viz –show –name=star
python -m vtool.patch test_sift_viz –show –name=star2
python -m vtool.patch test_sift_viz –show –name=cross
python -m vtool.patch test_sift_viz –show –name=stripe</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_test_patch</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--name&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;star&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sift</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">extract_feature_from_patch</span><span class="p">(</span><span class="n">patch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">siftimg</span> <span class="o">=</span> <span class="n">test_sift_viz</span><span class="p">(</span><span class="n">sift</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Need to do some image blending</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">mpl_sift</span><span class="o">.</span><span class="n">draw_sift_on_patch</span><span class="p">(</span><span class="n">siftimg</span><span class="p">,</span> <span class="n">sift</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch2</span> <span class="o">=</span> <span class="n">patch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_uint8</span><span class="p">(</span><span class="n">patch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_square</span><span class="p">(</span><span class="n">patch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">mpl_sift</span><span class="o">.</span><span class="n">draw_sift_on_patch</span><span class="p">(</span><span class="n">patch2</span><span class="p">,</span> <span class="n">sift</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.invertible_stack">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">invertible_stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vecs_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#invertible_stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.invertible_stack" title="Permalink to this definition"></a></dt>
<dd><p>Stacks descriptors into a flat structure and returns inverse mapping from
flat database descriptor indexes (dx) to annotation ids (label) and feature
indexes (fx). Feature indexes are w.r.t. annotation indexes.</p>
<dl class="simple">
<dt>Output:</dt><dd><p>idx2_desc - flat descriptor stack
idx2_label  - inverted index into annotations
idx2_fx   - inverted index into features</p>
</dd>
</dl>
<p># Example with 2D Descriptors</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DESC_TYPE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label_list</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_vec</span><span class="p">,</span> <span class="n">idx2_label</span><span class="p">,</span> <span class="n">idx2_fx</span> <span class="o">=</span> <span class="n">invertible_stack</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">,</span> <span class="n">label_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">idx2_vec</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
<span class="go">array([[ 0,  0,  5,  2,  1,  5,  2,  1,  3, 42,  2],</span>
<span class="go">       [ 0,  1,  3, 30,  1,  3, 30,  1,  3, 42,  6]], dtype=uint8)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">idx2_label</span><span class="p">))</span>
<span class="go">array([1, 1, 2, 2, 2, 4, 4, 4, 5, 5, 5])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">idx2_fx</span><span class="p">))</span>
<span class="go">array([0, 1, 0, 1, 2, 0, 1, 2, 0, 1, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.invsum">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">invsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#invsum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.invsum" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.iround">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">iround</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.int32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#iround"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.iround" title="Permalink to this definition"></a></dt>
<dd><p>Integer round. (because numpy doesn’t seem to have it!)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.iter_reduce_ufunc">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">iter_reduce_ufunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ufunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#iter_reduce_ufunc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.iter_reduce_ufunc" title="Permalink to this definition"></a></dt>
<dd><p>constant memory iteration and reduction</p>
<p>applys ufunc from left to right over the input arrays</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">memory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen_memory</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">arr_gen</span><span class="p">(</span><span class="n">arr_list</span><span class="p">,</span> <span class="n">gen_memory</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arr_list</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">gen_memory</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">arr</span>
<span class="gp">... </span>        <span class="k">yield</span> <span class="n">gen_memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gen_memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gen_memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ufunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res1</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">arr_list</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res2</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">arr_list</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res3</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">arr_gen</span><span class="p">(</span><span class="n">arr_list</span><span class="p">,</span> <span class="n">gen_memory</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res1       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res1</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res2       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res2</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;res3       = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;memory     = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gen_memory = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gen_memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">res1</span> <span class="o">==</span> <span class="n">res2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">res2</span> <span class="o">==</span> <span class="n">res3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.jagged_group">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">jagged_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">groupids_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#jagged_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.jagged_group" title="Permalink to this definition"></a></dt>
<dd><p>flattens and returns group indexes into the flattened list</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.kp_cpp_infostr">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">kp_cpp_infostr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#kp_cpp_infostr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.kp_cpp_infostr" title="Permalink to this definition"></a></dt>
<dd><p>mirrors c++ debug code</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.kpts_docrepr">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">kpts_docrepr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'arr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#kpts_docrepr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.kpts_docrepr" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_docrepr</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.kpts_matrices">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">kpts_matrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#kpts_matrices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.kpts_matrices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.kpts_repr">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">kpts_repr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_small</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linebreak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#kpts_repr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.kpts_repr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.learn_score_normalization">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">learn_score_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tp_support</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_support</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monotonize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.6180339887499997</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_tp_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eq'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#learn_score_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.learn_score_normalization" title="Permalink to this definition"></a></dt>
<dd><p>Takes collected data and applys parzen window density estimation and bayes rule.</p>
<p>#True positive scores must be larger than true negative scores.
FIXME: might be an issue with pdfs summing to 1 here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tp_support</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>tn_support</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>gridsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – default 512</p></li>
<li><p><strong>adjust</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – default 8</p></li>
<li><p><strong>return_all</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – default False</p></li>
<li><p><strong>monotonize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – default True</p></li>
<li><p><strong>clip_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – default phi ** 2</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(score_domain, p_tp_given_score, p_tn_given_score, p_score_given_tp, p_score_given_tn, p_score)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –test-learn_score_normalization</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsize</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adjust</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_all</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">monotonize</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clip_factor</span> <span class="o">=</span> <span class="mf">2.6180339887499997</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">score_domain</span><span class="p">,</span> <span class="n">p_tp_given_score</span><span class="p">)</span> <span class="o">=</span> <span class="n">learn_score_normalization</span><span class="p">(</span><span class="n">tp_support</span><span class="p">,</span> <span class="n">tn_support</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">p_tp_given_score</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">0.99</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.linear_interpolation">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">linear_interpolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subindices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#linear_interpolation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.linear_interpolation" title="Permalink to this definition"></a></dt>
<dd><p>Does linear interpolation to lookup subindex values</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subindices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subvalues</span> <span class="o">=</span> <span class="n">linear_interpolation</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">subindices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">subindices</span><span class="p">,</span> <span class="n">subvalues</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="mf">2.3</span><span class="p">,</span> <span class="n">linear_interpolation</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.list_compress_">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">list_compress_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#list_compress_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.list_compress_" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.list_take_">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">list_take_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#list_take_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.list_take_" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.logistic_01">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">logistic_01</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#logistic_01"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.logistic_01" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – </p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.util_math –exec-logistic_01 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.util_math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">logistic_01</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.logit">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">logit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#logit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.logit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.make_channels_comparable">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">make_channels_comparable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#make_channels_comparable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.make_channels_comparable" title="Permalink to this definition"></a></dt>
<dd><p>Broadcasts image arrays so they can have elementwise operations applied</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image make_channels_comparable</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_basis</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">wh_basis</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">shape_basis</span> <span class="o">=</span> <span class="p">[(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Test all permutations of shap inputs</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">shape1</span><span class="p">,</span> <span class="n">shape2</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">shape_basis</span><span class="p">,</span> <span class="n">shape_basis</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*    input shapes: </span><span class="si">%r</span><span class="s1">, </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">shape1</span><span class="p">,</span> <span class="n">shape2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">img1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">img2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">make_channels_comparable</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;... output shapes: </span><span class="si">%r</span><span class="s1">, </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">img2</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">elem</span> <span class="o">=</span> <span class="p">(</span><span class="n">img1</span> <span class="o">+</span> <span class="n">img2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;... elem(+) shape: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">assert</span> <span class="n">elem</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">img1</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="s1">&#39;outputs should have same size&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">assert</span> <span class="n">img1</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">img2</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="s1">&#39;new imgs should have same size&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.make_dummy_fm">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">make_dummy_fm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nKpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#make_dummy_fm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.make_dummy_fm" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.make_exif_dict_human_readable">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">make_exif_dict_human_readable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exif_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#make_exif_dict_human_readable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.make_exif_dict_human_readable" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.make_test_image_keypoints">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">make_test_image_keypoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skew</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#make_test_image_keypoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.make_test_image_keypoints" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.make_video">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">make_video</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outvid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'XVID'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#make_video"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.make_video" title="Permalink to this definition"></a></dt>
<dd><p>Create a video from a list of images.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://www.xavierdupre.fr/blog/2016-03-30_nojs.html">http://www.xavierdupre.fr/blog/2016-03-30_nojs.html</a>
<a class="reference external" href="http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_gui/py_video_display/py_video_display.html">http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_gui/py_video_display/py_video_display.html</a></p>
<p>&#64;param      outvid      output video
&#64;param      images      list of images to use in the video
&#64;param      fps         frame per second
&#64;param      size        size of each frame
&#64;param      is_color    color
&#64;param      format      see <a class="reference external" href="http://www.fourcc.org/codecs.php">http://www.fourcc.org/codecs.php</a></p>
<p>The function relies on <a class="reference external" href="http://opencv-python-tutroals.readthedocs.org/en/latest/">http://opencv-python-tutroals.readthedocs.org/en/latest/</a>.
By default, the video will have the size of the first image.
It will resize every image to this size before adding them to the video.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.make_video2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">make_video2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#make_video2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.make_video2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.make_white_transparent">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">make_white_transparent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#make_white_transparent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.make_white_transparent" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>imgBGR</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data (blue, green, red)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>imgBGRA</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image make_white_transparent –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fpath&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGRA</span> <span class="o">=</span> <span class="n">make_white_transparent</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;imgBGRA = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">imgBGRA</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.maxima_neighbors">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">maxima_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argmaxima</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#maxima_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.maxima_neighbors" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.maximum_parabola_point">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">maximum_parabola_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#maximum_parabola_point"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.maximum_parabola_point" title="Permalink to this definition"></a></dt>
<dd><p>Maximum x point is where the derivative is 0</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.median_abs_dev">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">median_abs_dev</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_list</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#median_abs_dev"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.median_abs_dev" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Median_absolute_deviation">https://en.wikipedia.org/wiki/Median_absolute_deviation</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.montage">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">montage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng=&lt;module</span> <span class="pre">'numpy.random'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/numpy/random/__init__.py'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method='random'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_debug=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#montage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.montage" title="Permalink to this definition"></a></dt>
<dd><p>Creates a montage / collage from a set of images</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –exec-montage:0 –show
python -m vtool.image –exec-montage:1</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list0</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list1</span> <span class="o">=</span> <span class="p">[</span><span class="n">resize_to_maxdims</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">img_list0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">flatten</span><span class="p">([</span><span class="n">img_list1</span><span class="p">]</span> <span class="o">*</span> <span class="n">num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="mi">700</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;unused&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#method = &#39;random&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dst</span><span class="p">,</span> <span class="n">debug_info</span> <span class="o">=</span> <span class="n">montage</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">dsize</span><span class="p">,</span> <span class="n">rng</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="n">return_debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">place_img</span> <span class="o">=</span> <span class="n">debug_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;place_img_&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">place_img</span> <span class="o">/</span> <span class="n">place_img</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span><span class="p">,</span> <span class="n">expanduser</span><span class="p">,</span> <span class="n">abspath</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s1">&#39;GZC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gid_list0</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_gids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6000</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">try</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">gid</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">gid_list0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">image</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_images</span><span class="p">(</span><span class="n">gid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">image</span> <span class="o">=</span> <span class="n">resize_to_maxdims</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">img_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">19200</span><span class="p">,</span> <span class="mi">10800</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dst</span> <span class="o">=</span> <span class="n">montage</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">dsize</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filepath</span> <span class="o">=</span> <span class="n">abspath</span><span class="p">(</span><span class="n">expanduser</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">,</span> <span class="s1">&#39;Desktop&#39;</span><span class="p">,</span> <span class="s1">&#39;montage.jpg&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Writing to: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imwrite</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.mult_lists">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">mult_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#mult_lists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.mult_lists" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.multiaxis_reduce">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">multiaxis_reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ufunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startaxis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#multiaxis_reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.multiaxis_reduce" title="Permalink to this definition"></a></dt>
<dd><p>used to get max/min over all axes after &lt;startaxis&gt;</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.numpy_utils –test-multiaxis_reduce</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ufunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">startaxis</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_</span> <span class="o">=</span> <span class="n">multiaxis_reduce</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">startaxis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">out_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[182 245 236 249]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.multigroup_lookup">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">multigroup_lookup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lazydict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subkeys_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#multigroup_lookup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.multigroup_lookup" title="Permalink to this definition"></a></dt>
<dd><p>Efficiently calls custom_func for each item in zip(keys_list, subkeys_list)
by grouping subkeys to minimize the number of calls to custom_func.</p>
<p>We are given multiple lists of keys, and subvals.
The goal is to group the subvals by keys and apply the subval lookups
(a call to a function) to the key only once and at the same time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lazydict</strong> (<em>dict of utool.LazyDict</em>) – </p></li>
<li><p><strong>keys_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>subkeys_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>custom_func</strong> (<em>func</em>) – must have signature custom_func(lazydict, key, subkeys)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>vt.multigroup_lookup_naive - unoptomized version, but simple to read</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpath_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">util_grabdata</span><span class="o">.</span><span class="n">get_valid_test_imgkeys</span><span class="p">()]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lazydict</span> <span class="o">=</span> <span class="p">{</span><span class="n">count</span><span class="p">:</span> <span class="n">vt</span><span class="o">.</span><span class="n">testdata_annot_metadata</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span> <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">fpath</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fpath_list</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aids_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fms</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">keys_list</span> <span class="o">=</span> <span class="n">aids_list</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subkeys_list</span> <span class="o">=</span> <span class="n">fms</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">custom_func</span><span class="p">(</span><span class="n">lazydict</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">subkeys</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">annot</span> <span class="o">=</span> <span class="n">lazydict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">kpts</span> <span class="o">=</span> <span class="n">annot</span><span class="p">[</span><span class="s1">&#39;kpts&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">rchip</span> <span class="o">=</span> <span class="n">annot</span><span class="p">[</span><span class="s1">&#39;rchip&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">kpts_m</span> <span class="o">=</span> <span class="n">kpts</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">subkeys</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">warped_patches</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_warped_patches</span><span class="p">(</span><span class="n">rchip</span><span class="p">,</span> <span class="n">kpts_m</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">warped_patches</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_lists1</span> <span class="o">=</span> <span class="n">multigroup_lookup</span><span class="p">(</span><span class="n">lazydict</span><span class="p">,</span> <span class="n">keys_list</span><span class="p">,</span> <span class="n">subkeys_list</span><span class="p">,</span> <span class="n">custom_func</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_lists2</span> <span class="o">=</span> <span class="n">multigroup_lookup_naive</span><span class="p">(</span><span class="n">lazydict</span><span class="p">,</span> <span class="n">keys_list</span><span class="p">,</span> <span class="n">subkeys_list</span><span class="p">,</span> <span class="n">custom_func</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">sver_c_wrapper</span><span class="o">.</span><span class="n">asserteq</span><span class="p">(</span><span class="n">data_lists1</span><span class="p">,</span> <span class="n">data_lists2</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">keys_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subkeys_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.multigroup_lookup_naive">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">multigroup_lookup_naive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lazydict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subkeys_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#multigroup_lookup_naive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.multigroup_lookup_naive" title="Permalink to this definition"></a></dt>
<dd><p>Slow version of multigroup_lookup. Makes a call to custom_func for each
item in zip(keys_list, subkeys_list).</p>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>vt.multigroup_lookup</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.nan_to_num">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">nan_to_num</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#nan_to_num"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nan_to_num" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.nearest_point">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">nearest_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#nearest_point"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nearest_point" title="Permalink to this definition"></a></dt>
<dd><p>finds the nearest point(s) in pts to (x, y)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.non_decreasing">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">non_decreasing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#non_decreasing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.non_decreasing" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.non_increasing">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">non_increasing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#non_increasing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.non_increasing" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.nonunique_row_flags">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">nonunique_row_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#nonunique_row_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nonunique_row_flags" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.nonunique_row_indexes">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">nonunique_row_indexes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#nonunique_row_indexes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.nonunique_row_indexes" title="Permalink to this definition"></a></dt>
<dd><p>rows that are not unique (does not include the first instance of each pattern)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>ndarray</em>) – 2d array</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>nonunique_rowx</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>unique_row_indexes
nonunique_row_flags</p>
</dd>
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-unique_row_indexes</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">.534</span><span class="p">,</span> <span class="mf">.432</span><span class="p">],</span> <span class="p">[</span><span class="mf">.534</span><span class="p">,</span> <span class="mf">.432</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nonunique_rowx</span> <span class="o">=</span> <span class="n">unique_row_indexes</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;nonunique_rowx = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">nonunique_rowx</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">nonunique_rowx = np.array([4, 6, 7, 8], dtype=np.int64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.norm01">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">norm01</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#norm01"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.norm01" title="Permalink to this definition"></a></dt>
<dd><p>normalizes a numpy array from 0 to 1 based in its extent</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dim</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_norm</span> <span class="o">=</span> <span class="n">norm01</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">array_norm</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.normalize">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.normalize" title="Permalink to this definition"></a></dt>
<dd><p>Returns all row vectors normalized by their magnitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>ndarray</em>) – row vectors to normalize</p></li>
<li><p><strong>ord</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – type of norm to use (defaults to 2-norm)
{non-zero int, inf, -inf}</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – axis to normalize</p></li>
<li><p><strong>out</strong> (<em>ndarray</em>) – preallocated output</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>np.linalg.norm</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_normed</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;arr_normed = &#39;</span><span class="p">,</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_normed</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="n">arr_normed</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.6</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_normed</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;arr_normed = &#39;</span><span class="p">,</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">arr_normed</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="n">arr_normed</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ord_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.6</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normed</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">ord</span><span class="p">,</span> <span class="n">normalize</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="nb">ord</span><span class="p">))</span> <span class="k">for</span> <span class="nb">ord</span> <span class="ow">in</span> <span class="n">ord_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">normed</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.normalize_rows">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">normalize_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#normalize_rows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.normalize_rows" title="Permalink to this definition"></a></dt>
<dd><p>DEPRICATE</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.normalize_scores">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">normalize_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">score_domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_tp_given_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#normalize_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.normalize_scores" title="Permalink to this definition"></a></dt>
<dd><p>Adjusts a raw scores to a probabilities based on a learned normalizer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>score_domain</strong> (<em>ndarray</em>) – input score domain</p></li>
<li><p><strong>p_tp_given_score</strong> (<em>ndarray</em>) – learned probability mapping</p></li>
<li><p><strong>scores</strong> (<em>ndarray</em>) – raw scores</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>probabilities</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –test-normalize_scores</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_tp_given_score</span> <span class="o">=</span> <span class="p">(</span><span class="n">score_domain</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">score_domain</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">9.99</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">11.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prob</span> <span class="o">=</span> <span class="n">normalize_scores</span><span class="p">(</span><span class="n">score_domain</span><span class="p">,</span> <span class="n">p_tp_given_score</span><span class="p">,</span> <span class="n">scores</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#np.set_printoptions(suppress=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress_small</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">score_domain</span><span class="p">,</span> <span class="n">p_tp_given_score</span><span class="p">,</span> <span class="s1">&#39;r-x&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;learned probability&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="s1">&#39;yo&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Normalized scores&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;query points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([ 0.  ,  0.  ,  0.  ,  0.05,  0.64,  1.  ,  1.  ,  1.  ,  1.  ], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.normalized_nearest_neighbors">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">normalized_nearest_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flann1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vecs2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#normalized_nearest_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.normalized_nearest_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>Computes matches from vecs2 to flann1.</p>
<p>uses flann index to return nearest neighbors with distances normalized
between 0 and 1 using sifts uint8 trick</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.offset_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">offset_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#offset_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.offset_kpts" title="Permalink to this definition"></a></dt>
<dd><p>Transfoms keypoints by a scale factor and a translation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – </p></li>
<li><p><strong>scale_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>kpts -  keypoints</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float32_t, ndim=2]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_factor</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts_</span> <span class="o">=</span> <span class="n">offset_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results (hack + 0. to fix negative 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">((</span><span class="n">kpts</span><span class="p">,</span> <span class="n">kpts_</span> <span class="o">+</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ORANGE</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts_</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">LIGHT_BLUE</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">union_extents</span><span class="p">([</span><span class="n">extent1</span><span class="p">,</span> <span class="n">extent2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_axis_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([[20.  , 25.  ,  5.22, -5.11, 24.15,  0.  ],</span>
<span class="go">          [29.  , 25.  ,  2.36, -5.11, 24.15,  0.  ],</span>
<span class="go">          [30.  , 30.  , 12.22, 12.02, 10.53,  0.  ],</span>
<span class="go">          [31.  , 29.  , 13.36, 17.63, 14.1 ,  0.  ],</span>
<span class="go">          [32.  , 31.  , 16.05,  3.41, 11.74,  0.  ]], dtype=np.float64),</span>
<span class="go">np.array([[30.  , 12.5 ,  7.82, -2.56, 12.07,  0.  ],</span>
<span class="go">          [43.5 , 12.5 ,  3.53, -2.56, 12.07,  0.  ],</span>
<span class="go">          [45.  , 15.  , 18.32,  6.01,  5.26,  0.  ],</span>
<span class="go">          [46.5 , 14.5 , 20.03,  8.82,  7.05,  0.  ],</span>
<span class="go">          [48.  , 15.5 , 24.08,  1.7 ,  5.87,  0.  ]], dtype=np.float64),</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.open_image_size">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">open_image_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#open_image_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.open_image_size" title="Permalink to this definition"></a></dt>
<dd><p>Gets image size from an image on disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>image_fpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>size (width, height)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-open_image_size</p>
</dd>
<dt>Doctest:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;patsy.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="n">open_image_size</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;size = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">size = (800, 441)</span>
</pre></div>
</div>
</dd>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Confirm that Image.open is a lazy load</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">timeit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="sd">&#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sd">    from PIL import Image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sd">    import utool as ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sd">    import vtool as vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sd">    image_fpath = ut.grab_test_imgpath(&#39;patsy.jpg&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sd">    &#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;Image.open(image_fpath)&#39;</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;Image.open(image_fpath).size&#39;</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;vt.open_image_size(image_fpath)&#39;</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t4</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;vt.imread(image_fpath).shape&#39;</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t5</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;Image.open(image_fpath).getdata()&#39;</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1 = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t1</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t2 = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t2</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t3 = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t4 = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t4</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t5 = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t5</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">t2</span> <span class="o">&lt;</span> <span class="n">t5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">t3</span> <span class="o">&lt;</span> <span class="n">t4</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.open_pil_image">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">open_pil_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_shared.html#open_pil_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.open_pil_image" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.or_lists">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">or_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#or_lists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.or_lists" title="Permalink to this definition"></a></dt>
<dd><p>Like np.logical_and, but can take more than 2 arguments</p>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>and_lists</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ori_distance">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ori_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ori1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#ori_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ori_distance" title="Permalink to this definition"></a></dt>
<dd><p>Returns the unsigned distance between two angles</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/1878907/the-smallest-difference-between-2-angles">http://stackoverflow.com/questions/1878907/the-smallest-difference-between-2-angles</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –test-ori_distance</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori1</span> <span class="o">=</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">TAU</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori2</span> <span class="o">=</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">TAU</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_</span> <span class="o">=</span> <span class="n">ori_distance</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">ori2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">ori2</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">dist_</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori1</span> <span class="o">=</span> <span class="mf">.3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori2</span> <span class="o">=</span> <span class="mf">6.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_</span> <span class="o">=</span> <span class="n">ori_distance</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">ori2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">dist_</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.overlay_alpha_images">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">overlay_alpha_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#overlay_alpha_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.overlay_alpha_images" title="Permalink to this definition"></a></dt>
<dd><p>places img1 on top of img2 respecting alpha channels</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/25182421/overlay-numpy-alpha">http://stackoverflow.com/questions/25182421/overlay-numpy-alpha</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.pad_image">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">pad_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borderType</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#pad_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.pad_image" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.pad_image_ondisk">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">pad_image_ondisk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borderType</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#pad_image_ondisk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.pad_image_ondisk" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>out_fpath -  file path string</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image pad_image_ondisk</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fpath&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pad_</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">borderType</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath</span> <span class="o">=</span> <span class="n">pad_image_ondisk</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">pad_</span><span class="p">,</span> <span class="n">out_fpath</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">borderType</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;out_fpath = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">out_fpath</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.pad_vstack">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">pad_vstack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#pad_vstack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.pad_vstack" title="Permalink to this definition"></a></dt>
<dd><p>Stacks values and pads arrays with different lengths with zeros</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.padded_resize">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">padded_resize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(64,</span> <span class="pre">64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#padded_resize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.padded_resize" title="Permalink to this definition"></a></dt>
<dd><p>makes the image resize to the target size and pads the rest of the area with a fill value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>target_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-padded_resize –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgA</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;ada.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgC</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">),</span> <span class="n">grayscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#target_size = (64, 64)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img3_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">padded_resize</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">target_size</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="p">[</span><span class="n">imgA</span><span class="p">,</span> <span class="n">imgB</span><span class="p">,</span> <span class="n">imgC</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">ut</span><span class="o">.</span><span class="n">allsame</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img3</span><span class="p">)</span> <span class="k">for</span> <span class="n">img3</span> <span class="ow">in</span> <span class="n">img3_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pnum_</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">make_pnum_nextgen</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.parse_exif_unixtime">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">parse_exif_unixtime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#parse_exif_unixtime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.parse_exif_unixtime" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>image_fpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>unixtime</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.exif –test-parse_exif_unixtime</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s1">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unixtime</span> <span class="o">=</span> <span class="n">parse_exif_unixtime</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">unixtime</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.parse_exif_unixtime_gps">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">parse_exif_unixtime_gps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#parse_exif_unixtime_gps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.parse_exif_unixtime_gps" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.partition_scores">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">partition_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#partition_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.partition_scores" title="Permalink to this definition"></a></dt>
<dd><p>convinience helper to translate partitioned to unpartitioned data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tp_scores</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>tn_scores</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>attrs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – (default = None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(scores, labels, attrs)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –test-partition_scores</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;qaid&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">21</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">])}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">partition_scores</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resdict</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">odict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="s1">&#39;tp_scores&#39;</span><span class="p">,</span> <span class="s1">&#39;tn_scores&#39;</span><span class="p">,</span> <span class="s1">&#39;part_attrs&#39;</span><span class="p">],</span> <span class="n">tup</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">resdict</span><span class="p">,</span> <span class="n">nobraces</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="n">explicit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">tp_scores=np.array([5, 6, 6, 7]),</span>
<span class="go">tn_scores=np.array([1, 2, 2]),</span>
<span class="go">part_attrs=False: &#39;qaid&#39;: np.array([11, 14, 15]),</span>
<span class="go">           True: &#39;qaid&#39;: np.array([21, 24, 25, 26]),,</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch_gaussian_weighted_average_intensities">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">patch_gaussian_weighted_average_intensities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">probchip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_gaussian_weighted_average_intensities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch_gaussian_weighted_average_intensities" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch_gradient">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">patch_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch_gradient" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch_mag">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">patch_mag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gradx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grady</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_mag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch_mag" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.patch_ori">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">patch_ori</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gradx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grady</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_ori"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.patch_ori" title="Permalink to this definition"></a></dt>
<dd><p>returns patch orientation relative to the x-axis</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.pdist_argsort">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">pdist_argsort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#pdist_argsort"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.pdist_argsort" title="Permalink to this definition"></a></dt>
<dd><p>Sorts 2d indicies by their distnace matrix output from scipy.spatial.distance
x = np.array([  3.05555556e-03,   1.47619797e+04,   1.47619828e+04])</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>ndarray</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sortx_2d</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –test-pdist_argsort</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">21695.78</span><span class="p">,</span> <span class="mf">10943.76</span><span class="p">,</span> <span class="mf">10941.44</span><span class="p">,</span> <span class="mf">25867.64</span><span class="p">,</span> <span class="mf">10752.03</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="mf">10754.35</span><span class="p">,</span> <span class="mf">4171.86</span><span class="p">,</span> <span class="mf">2.32</span><span class="p">,</span> <span class="mf">14923.89</span><span class="p">,</span> <span class="mf">14926.2</span> <span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>             <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sortx_2d</span> <span class="o">=</span> <span class="n">pdist_argsort</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;sortx_2d = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sortx_2d</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">sortx_2d = [(2, 3), (1, 4), (1, 2), (1, 3), (0, 3), (0, 2), (2, 4), (3, 4), (0, 1), (0, 4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.pdist_indicies">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">pdist_indicies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#pdist_indicies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.pdist_indicies" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.perlin_noise">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">perlin_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale=32.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng=&lt;module</span> <span class="pre">'numpy.random'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/numpy/random/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#perlin_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.perlin_noise" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://www.siafoo.net/snippet/229">http://www.siafoo.net/snippet/229</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image perlin_noise –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#size = (64, 64)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#scale = 32.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span> <span class="o">=</span> <span class="mf">64.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">perlin_noise</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.perterb_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">perterb_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invV_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#perterb_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.perterb_kpts" title="Permalink to this definition"></a></dt>
<dd><p>Adds normally distributed pertibations to keypoints</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.perterbed_grid_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">perterbed_grid_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#perterbed_grid_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.perterbed_grid_kpts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.plot_centroids">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">plot_centroids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centroids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_pca_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whiten</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'centroids'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#plot_centroids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.plot_centroids" title="Permalink to this definition"></a></dt>
<dd><p>Plots centroids and datapoints. Plots accurately up to 3 dimensions.
If there are more than 3 dimensions, PCA is used to recude the dimenionality
to the &lt;num_pca_dims&gt; principal components</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.plot_postbayes_pdf">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">plot_postbayes_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">score_domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_tn_given_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_tp_given_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#plot_postbayes_pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.plot_postbayes_pdf" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.plot_prebayes_pdf">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">plot_prebayes_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">score_domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_score_given_tn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_score_given_tp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#plot_prebayes_pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.plot_prebayes_pdf" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.point_inside_bbox">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">point_inside_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#point_inside_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.point_inside_bbox" title="Permalink to this definition"></a></dt>
<dd><p>Flags points that are strictly inside a bounding box.
Points on the boundary are not considered inside.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point</strong> (<em>ndarray</em>) – one or more points to test (2xN)</p></li>
<li><p><strong>bbox</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – a bounding box in  (x, y, w, h) format</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if the point is in the bbox</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a> or ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.geometry point_inside_bbox –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flag</span> <span class="o">=</span> <span class="n">point_inside_bbox</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flag</span> <span class="o">=</span> <span class="n">flag</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;flag = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">flag</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">verts_from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">verts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">flag</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">flag</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">~</span><span class="n">flag</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">~</span><span class="n">flag</span><span class="p">],</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="n">pt</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">flag = np.array([0, 0, 0, 0, 0, 0, 0, 0, 1, 0])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.print_image_checks">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">print_image_checks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_shared.html#print_image_checks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.print_image_checks" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.random_affine_args">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">random_affine_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zoom_pdf=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tx_pdf=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ty_pdf=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shear_pdf=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_pdf=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_flip=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_stretch=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_distribution='uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalar_anchor='reflect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">txy_pdf=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng=&lt;module</span> <span class="pre">'numpy.random'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/numpy/random/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#random_affine_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.random_affine_args" title="Permalink to this definition"></a></dt>
<dd><p>TODO: allow for a pdf of ranges for each dimension</p>
<p>If pdfs are tuples it is interpreted as a default (uniform) distribution between the
two points. A single scalar is a default distribution between -scalar and
scalar.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zoom_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – (default = (1.0, 1.0))</p></li>
<li><p><strong>tx_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – (default = (0.0, 0.0))</p></li>
<li><p><strong>ty_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – (default = (0.0, 0.0))</p></li>
<li><p><strong>shear_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – (default = (0, 0))</p></li>
<li><p><strong>theta_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – (default = (0, 0))</p></li>
<li><p><strong>enable_flip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
<li><p><strong>enable_stretch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
<li><p><strong>rng</strong> (<em>module</em>) – random number generator(default = numpy.random)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>affine_args</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/linalg.py random_affine_args</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zoom_range</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.9090909090909091</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_pdf</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ty_pdf</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shear_pdf</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_pdf</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enable_flip</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enable_stretch</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">affine_args</span> <span class="o">=</span> <span class="n">random_affine_args</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">zoom_range</span><span class="p">,</span> <span class="n">tx_pdf</span><span class="p">,</span> <span class="n">ty_pdf</span><span class="p">,</span> <span class="n">shear_pdf</span><span class="p">,</span> <span class="n">theta_pdf</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">enable_flip</span><span class="p">,</span> <span class="n">enable_stretch</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;affine_args = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">affine_args</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">)</span> <span class="o">=</span> <span class="n">affine_args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">affine_mat3x3</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">Aff</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[ 1.009, -0.   ,  1.695],</span>
<span class="go">          [ 0.   ,  1.042,  2.584],</span>
<span class="go">          [ 0.   ,  0.   ,  1.   ]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.random_affine_transform">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">random_affine_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#random_affine_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.random_affine_transform" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.read_all_exif_tags">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">read_all_exif_tags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pil_img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_all_exif_tags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.read_all_exif_tags" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.read_exif">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">read_exif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_exif"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.read_exif" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.read_exif_tags">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">read_exif_tags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pil_img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exif_tagid_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_exif_tags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.read_exif_tags" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.read_one_exif_tag">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">read_one_exif_tag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pil_img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_one_exif_tag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.read_one_exif_tag" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.rebuild_partition">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">rebuild_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">part1_vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part2_vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part1_indexes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part2_indexes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#rebuild_partition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.rebuild_partition" title="Permalink to this definition"></a></dt>
<dd><p>Inverts work done by index_partition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>part1_vals</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>part2_vals</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>part1_indexes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – </p></li>
<li><p><strong>part2_indexes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-rebuild_partition</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dist&#39;</span><span class="p">,</span> <span class="s1">&#39;fg&#39;</span><span class="p">,</span> <span class="s1">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fg&#39;</span><span class="p">,</span> <span class="s1">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_indexes</span><span class="p">,</span> <span class="n">part2_indexes</span> <span class="o">=</span> <span class="n">index_partition</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part1_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_vals</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part1_indexes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part2_vals</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part2_indexes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val_list</span> <span class="o">=</span> <span class="n">rebuild_partition</span><span class="p">(</span><span class="n">part1_vals</span><span class="p">,</span> <span class="n">part2_vals</span><span class="p">,</span> <span class="n">part1_indexes</span><span class="p">,</span> <span class="n">part2_indexes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">val_list</span> <span class="o">==</span> <span class="n">item_list</span><span class="p">,</span> <span class="s1">&#39;incorrect inversin&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">val_list</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.rectify_invV_mats_are_up">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">rectify_invV_mats_are_up</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">invVR_mats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#rectify_invV_mats_are_up"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.rectify_invV_mats_are_up" title="Permalink to this definition"></a></dt>
<dd><p>Useful if invVR_mats is no longer lower triangular
rotates affine shape matrixes into downward (lower triangular) position</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.keypoint –exec-rectify_invV_mats_are_up –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Shrink x and y scales a bit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">3</span>  <span class="c1"># increase skew</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set random orientation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.2</span><span class="p">,</span> <span class="mf">.6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">get_invVR_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats2</span><span class="p">,</span> <span class="n">oris</span> <span class="o">=</span> <span class="n">rectify_invV_mats_are_up</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span> <span class="o">=</span> <span class="n">flatten_invV_mats_to_kpts</span><span class="p">(</span><span class="n">invVR_mats2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Scale down in y a bit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_kpts</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">kpts</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">]),</span> <span class="n">ori</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">eig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>             <span class="n">ori_color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Redraw oriented to show difference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="n">eig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ori_color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p>pt.figure(doclf=True, fnum=pt.ensure_fnum(None))
ax = pt.gca()
#ax.invert_yaxis()
#pt.draw_kpts2(kpts, color=’blue’, ell_linewidth=3, ori=1, eig=True, ori_color=’green’, rect=True)
pt.draw_kpts2(kpts2, color=’red’, ell_linewidth=2, ori=1, eig=True, ori_color=’green’, rect=True)
extents = np.array(vt.get_kpts_image_extent(np.vstack([kpts, kpts2])))
pt.set_axis_extent(extent, ax)
pt.dark_background()
ut.show_if_requested()</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">rectify_invV_mats_are_up</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
<span class="go">oxvrkuiaffukpyalgxyhqikxgbuesutz</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><p>_invRs_2x2 = invVR_mats[:, 0:2, 0:2][0:1]
A = _invRs_2x2[0]
Q, R = np.linalg.qr(A)</p>
<p>invVR_mats2, oris = rectify_invV_mats_are_up(_invRs_2x2[0:1])
L2, ori2 = invVR_mats2[0], oris[0]
Q2 = vt.rotation_mat2x2(ori2)</p>
<p>np.linalg.det(Q)</p>
<p>vecs = np.random.rand(2, 4)
Q2.dot(vecs)
Q.dot(vecs)</p>
<p>np.linalg.cholesky(_invR_2x2)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.rectify_to_float01">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">rectify_to_float01</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rectify_to_float01"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.rectify_to_float01" title="Permalink to this definition"></a></dt>
<dd><p>Ensure that an image is encoded using a float properly</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.rectify_to_square">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">rectify_to_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extreme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rectify_to_square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.rectify_to_square" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.rectify_to_uint8">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">rectify_to_uint8</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rectify_to_uint8"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.rectify_to_uint8" title="Permalink to this definition"></a></dt>
<dd><p>Ensure that an image is encoded in uint8 properly</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.refine_inliers">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">refine_inliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aff_inliers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.57</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_homog_checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'homog'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#refine_inliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.refine_inliers" title="Permalink to this definition"></a></dt>
<dd><p>Given a set of hypothesis inliers, computes a homography and refines inliers
returned homography maps image1 space into image2 space</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.spatial_verification –test-refine_inliers
python -m vtool.spatial_verification –test-refine_inliers:0
python -m vtool.spatial_verification –test-refine_inliers:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">make_dummy_fm</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_inliers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="mf">.01</span> <span class="o">*</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_kpts_dlen_sqrd</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homogtup</span> <span class="o">=</span> <span class="n">refine_inliers</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refined_inliers</span><span class="p">,</span> <span class="n">refined_errors</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">homogtup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">homogtup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_small</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="k">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup1</span> <span class="o">=</span> <span class="n">refine_inliers</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">homog_tup1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">homog_tup1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">show_sv</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">homog_tup</span><span class="o">=</span><span class="n">homog_tup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.remove_homogenous_coordinate">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">remove_homogenous_coordinate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">_xyzs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#remove_homogenous_coordinate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.remove_homogenous_coordinate" title="Permalink to this definition"></a></dt>
<dd><p>normalizes 3d homogonous coordinates into 2d coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>_xyzs</strong> (<em>ndarray</em>) – of shape (3, N)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>_xys of shape (2, N)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.linalg –test-remove_homogenous_coordinate</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xyzs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">2.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">2.</span><span class="p">,</span>   <span class="mf">2.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">1.2</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xys</span> <span class="o">=</span> <span class="n">remove_homogenous_coordinate</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_xys</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xyzs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">140.</span><span class="p">,</span>  <span class="mf">167.</span><span class="p">,</span>  <span class="mf">185.</span><span class="p">,</span>  <span class="mf">185.</span><span class="p">,</span>  <span class="mf">194.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">121.</span><span class="p">,</span>  <span class="mf">139.</span><span class="p">,</span>  <span class="mf">156.</span><span class="p">,</span>  <span class="mf">155.</span><span class="p">,</span>  <span class="mf">163.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">47.</span><span class="p">,</span>   <span class="mf">56.</span><span class="p">,</span>   <span class="mf">62.</span><span class="p">,</span>   <span class="mf">62.</span><span class="p">,</span>   <span class="mf">65.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xys</span> <span class="o">=</span> <span class="n">remove_homogenous_coordinate</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">_xys</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.resize">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">resize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.resize" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.resize_image_by_scale">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">resize_image_by_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_image_by_scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.resize_image_by_scale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.resize_mask">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">resize_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.resize_mask" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.resize_thumb">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">resize_thumb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(64,</span> <span class="pre">64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_thumb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.resize_thumb" title="Permalink to this definition"></a></dt>
<dd><p>Resize an image such that its max width or height is:</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-resize_thumb –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">resize_thumb</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;img.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;img2.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img2</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.resize_to_maxdims">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">resize_to_maxdims</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(64,</span> <span class="pre">64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_to_maxdims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.resize_to_maxdims" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>max_dsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – </p></li>
<li><p><strong>interpolation</strong> (<em>long</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-resize_to_maxdims –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">resize_to_maxdims</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;img.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;img2.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img2</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.resize_to_maxdims_ondisk">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">resize_to_maxdims_ondisk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_to_maxdims_ondisk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.resize_to_maxdims_ondisk" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_fpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – file path string</p></li>
<li><p><strong>max_dsize</strong> – </p></li>
<li><p><strong>out_fpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – file path string(default = None)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormA.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormB.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormC.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormD.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormE.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormF.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormG.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormH.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormI.png –dsize=417,None
python -m vtool.image resize_to_maxdims_ondisk –fpath ~/latex/crall-candidacy-2015/figures3/knormJ.png –dsize=417,None</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fpath&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--dsize&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resize_to_maxdims_ondisk</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">,</span> <span class="n">out_fpath</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.resized_clamped_thumb_dims">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">resized_clamped_thumb_dims</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dsize</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resized_clamped_thumb_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.resized_clamped_thumb_dims" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.resized_dims_and_ratio">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">resized_dims_and_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dsize</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resized_dims_and_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.resized_dims_and_ratio" title="Permalink to this definition"></a></dt>
<dd><p>returns resized dimensions to get <code class="docutils literal notranslate"><span class="pre">img_size</span></code> to fit into <code class="docutils literal notranslate"><span class="pre">max_dsize</span></code></p>
<dl class="simple">
<dt>FIXME:</dt><dd><p>Should specifying a None force the use of the original dim?</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – </p></li>
<li><p><strong>max_dsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(dsize, ratio)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image resized_dims_and_ratio –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">=</span> <span class="n">resized_dims_and_ratio</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(dsize, ratio) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(dsize, ratio) = ((150, 75), 0.75)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">=</span> <span class="n">resized_dims_and_ratio</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(dsize, ratio) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(dsize, ratio) = ((2000, 1000), 10.0)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">=</span> <span class="n">resized_dims_and_ratio</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(dsize, ratio) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(dsize, ratio) = ((200, 100), 1.0)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">=</span> <span class="n">resized_dims_and_ratio</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(dsize, ratio) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">dsize</span><span class="p">,</span> <span class="n">ratio</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(dsize, ratio) = ((200, 100), 1.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.rotate_image">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">rotate_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">border_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rotate_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.rotate_image" title="Permalink to this definition"></a></dt>
<dd><p>Rotates an image around its center</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>theta</strong> – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-rotate_image</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_test_patch</span><span class="p">(</span><span class="s1">&#39;star2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">16.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR</span> <span class="o">=</span> <span class="n">rotate_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--show&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ut</span><span class="o">.</span><span class="n">inIPython</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span>  <span class="o">*</span> <span class="mi">255</span><span class="p">,</span>  <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.rotate_image_ondisk">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">rotate_image_ondisk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rotate_image_ondisk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.rotate_image_ondisk" title="Permalink to this definition"></a></dt>
<dd><p>Rotates an image on disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_fpath</strong> – </p></li>
<li><p><strong>theta</strong> – </p></li>
<li><p><strong>out_fpath</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-rotate_image_ondisk</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;star.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath_</span> <span class="o">=</span> <span class="n">rotate_image_ondisk</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">out_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">out_fpath_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--show&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ut</span><span class="o">.</span><span class="n">inIPython</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">out_fpath_</span><span class="p">,</span>  <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.rotation_around_bbox_mat3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">rotation_around_bbox_mat3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_around_bbox_mat3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.rotation_around_bbox_mat3x3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.rotation_around_mat3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">rotation_around_mat3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_around_mat3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.rotation_around_mat3x3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.rotation_mat2x2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">rotation_mat2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_mat2x2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.rotation_mat2x2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.rotation_mat3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">rotation_mat3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radians</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sin=&lt;ufunc</span> <span class="pre">'sin'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cos=&lt;ufunc</span> <span class="pre">'cos'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_mat3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.rotation_mat3x3" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Rotation_matrix">https://en.wikipedia.org/wiki/Rotation_matrix</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.rowwise_operation">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">rowwise_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#rowwise_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.rowwise_operation" title="Permalink to this definition"></a></dt>
<dd><p>DEPRICATE THIS IS POSSIBLE WITH STRICTLY BROADCASTING AND
USING np.newaxis</p>
<p>DEPRICATE, numpy has better ways of doing this.
Is the rowwise name correct? Should it be colwise?</p>
<p>performs an operation between an
(N x A x B … x Z) array with an
(N x 1) array</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.safe_argmax">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">safe_argmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_argmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.safe_argmax" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>Doctest:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">safe_argmax</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">safe_argmax</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">safe_argmax</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">safe_argmax</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">safe_argmax</span><span class="p">([]))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.safe_cat">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">safe_cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_shape=(0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_cat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.safe_cat" title="Permalink to this definition"></a></dt>
<dd><p>stacks a tuple even if it is empty
Also deals with numpy bug where cat fails if an element in sequence is empty</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">safe_cat</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">safe_cat</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;s = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="p">)]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">safe_cat</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;s = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="p">)]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># test3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">safe_cat</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;s = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="p">)]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.safe_div">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">safe_div</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_div"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.safe_div" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.safe_extreme">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">safe_extreme</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_extreme"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.safe_extreme" title="Permalink to this definition"></a></dt>
<dd><p>Applies an exterme operation to an 1d array (typically max/min) but ensures
a value is always returned even in operations without identities. The
default identity must be specified using the <cite>fill</cite> argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>ndarray</em>) – 1d array to take extreme of</p></li>
<li><p><strong>op</strong> (<em>func</em>) – vectorized operation like np.max to apply to array</p></li>
<li><p><strong>fill</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – return type if arr has no elements (default = nan)</p></li>
<li><p><strong>finite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if True ignores non-finite values (default = False)</p></li>
<li><p><strong>nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if False ignores nans (default = True)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.safe_max">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">safe_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.safe_max" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>ndarray</em>) – 1d array to take max of</p></li>
<li><p><strong>fill</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – return type if arr has no elements (default = nan)</p></li>
<li><p><strong>finite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if True ignores non-finite values (default = False)</p></li>
<li><p><strong>nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if False ignores nans (default = True)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other safe_max –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results1</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_max</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results2</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_max</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results3</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_max</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results4</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_max</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">results1</span><span class="p">,</span> <span class="n">results2</span><span class="p">,</span> <span class="n">results3</span><span class="p">,</span> <span class="n">results4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;results = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">results = [</span>
<span class="go">    [float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;inf&#39;), float(&#39;inf&#39;), 1],</span>
<span class="go">    [float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), 1.0, 1],</span>
<span class="go">    [float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), 1.0, 1],</span>
<span class="go">    [float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;inf&#39;), float(&#39;inf&#39;), float(&#39;inf&#39;), 1],</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.safe_min">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">safe_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.safe_min" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results1</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_min</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results2</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_min</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results3</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_min</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results4</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_min</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">results1</span><span class="p">,</span> <span class="n">results2</span><span class="p">,</span> <span class="n">results3</span><span class="p">,</span> <span class="n">results4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;results = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">results = [</span>
<span class="go">    [float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;inf&#39;), 1.0, 0],</span>
<span class="go">    [float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), 1.0, 0],</span>
<span class="go">    [float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;nan&#39;), 1.0, 0],</span>
<span class="go">    [float(&#39;nan&#39;), float(&#39;nan&#39;), float(&#39;-inf&#39;), float(&#39;inf&#39;), 1.0, 0],</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.safe_pdist">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">safe_pdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#safe_pdist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.safe_pdist" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Kwargs:</dt><dd><p>metric = ut.absdiff</p>
</dd>
<dt>SeeAlso:</dt><dd><p>scipy.spatial.distance.pdist</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.safe_vstack">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">safe_vstack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_shape=(0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_vstack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.safe_vstack" title="Permalink to this definition"></a></dt>
<dd><p>stacks a tuple even if it is empty</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.sample_ell_border_pts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">sample_ell_border_pts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expanded_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#sample_ell_border_pts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.sample_ell_border_pts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.sample_ell_border_vals">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">sample_ell_border_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expanded_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nKp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nScales</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#sample_ell_border_vals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.sample_ell_border_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.sample_uniform">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">sample_uniform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#sample_uniform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.sample_uniform" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>SeeAlso:</dt><dd><p>python -m pyhesaff.tests.test_ellipse –test-in_depth_ellipse –show</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.scale_around_mat3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">scale_around_mat3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#scale_around_mat3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.scale_around_mat3x3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.scale_bbox">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">scale_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#scale_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.scale_bbox" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.scale_extents">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">scale_extents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extents</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#scale_extents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.scale_extents" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>extent</strong> (<em>ndarray</em>) – tl_x, br_x, tl_y, br_y</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.scale_mat3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">scale_mat3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float64'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#scale_mat3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.scale_mat3x3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.scaled_verts_from_bbox">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">scaled_verts_from_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#scaled_verts_from_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.scaled_verts_from_bbox" title="Permalink to this definition"></a></dt>
<dd><p>Helps with drawing scaled bbounding boxes on thumbnails</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.scaled_verts_from_bbox_gen">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">scaled_verts_from_bbox_gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#scaled_verts_from_bbox_gen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.scaled_verts_from_bbox_gen" title="Permalink to this definition"></a></dt>
<dd><p>Helps with drawing scaled bbounding boxes on thumbnails</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bbox_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – bboxes in x,y,w,h format</p></li>
<li><p><strong>theta_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – rotation of bounding boxes</p></li>
<li><p><strong>sx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – x scale factor</p></li>
<li><p><strong>sy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – y scale factor</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Yeilds:</dt><dd><p>new_verts - vertices of scaled bounding box for every input</p>
</dd>
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-scaled_verts_from_bbox_gen</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span> <span class="o">=</span> <span class="mf">.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sy</span> <span class="o">=</span> <span class="mf">.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_verts_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scaled_verts_from_bbox_gen</span><span class="p">(</span><span class="n">bbox_list</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_verts_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[[5, 5], [55, 5], [55, 55], [5, 55], [5, 5]]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.shear">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">shear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_shear</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_shear</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#shear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.shear" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>x_shear</strong> – </p></li>
<li><p><strong>y_shear</strong> – </p></li>
<li><p><strong>dsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – width, height</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-shear –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_shear</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_shear</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgSh</span> <span class="o">=</span> <span class="n">shear</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">x_shear</span><span class="p">,</span> <span class="n">y_shear</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgSh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.shear_mat3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">shear_mat3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shear_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shear_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float64'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#shear_mat3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.shear_mat3x3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.show_gaussian_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">show_gaussian_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#show_gaussian_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.show_gaussian_patch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.show_hist_submaxima">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">show_hist_submaxima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxima_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#show_hist_submaxima"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.show_hist_submaxima" title="Permalink to this definition"></a></dt>
<dd><p>For C++ to show data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist</strong> – </p></li>
<li><p><strong>edges</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – </p></li>
<li><p><strong>centers</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.histogram –test-show_hist_submaxima –show
python -m pyhesaff._pyhesaff –test-test_rot_invar –show
python -m vtool.histogram –test-show_hist_submaxima –dpath figures –save ~/latex/crall-candidacy-2015/figures/show_hist_submaxima.jpg</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:wbia)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--hist&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--edges&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--maxima_thresh&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_hist_submaxima</span><span class="p">(</span><span class="n">hist_</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.show_ori_image">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">show_ori_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grady</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gauss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#show_ori_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.show_ori_image" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m pyhesaff._pyhesaff –test-test_rot_invar –show –nocpp</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.show_ori_image_ondisk">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">show_ori_image_ondisk</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#show_ori_image_ondisk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.show_ori_image_ondisk" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.histogram –test-show_ori_image_ondisk –show</p>
<p>python -m vtool.histogram –test-show_ori_image_ondisk –show –patch_img_fpath patches/KP_0_PATCH.png –ori_img_fpath patches/KP_0_orientations01.png –weights_img_fpath patches/KP_0_WEIGHTS.png –grady_img_fpath patches/KP_0_ygradient.png –gradx_img_fpath patches/KP_0_xgradient.png –title cpp_show_ori_ondisk</p>
<p>python -m pyhesaff._pyhesaff –test-test_rot_invar –show –rebuild-hesaff –no-rmbuild</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">show_ori_image_ondisk</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.show_patch_orientation_estimation">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">show_patch_orientation_estimation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgBGR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grady</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gori_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#show_patch_orientation_estimation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.show_patch_orientation_estimation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.signed_cyclic_distance">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">signed_cyclic_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modulo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#signed_cyclic_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.signed_cyclic_distance" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.signed_ori_distance">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">signed_ori_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ori1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#signed_ori_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.signed_ori_distance" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ori1</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>ori2</strong> (<em>ndarray</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ori_dist</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –exec-signed_ori_distance</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="mf">.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_dist</span> <span class="o">=</span> <span class="n">signed_ori_distance</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">ori2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;ori_dist = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">ori_dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">),))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.significant_shape">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">significant_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#significant_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.significant_shape" title="Permalink to this definition"></a></dt>
<dd><p>find the shape without trailing 1’s</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.sorted_indices_ranges">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">sorted_indices_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">groupids_sorted</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#sorted_indices_ranges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.sorted_indices_ranges" title="Permalink to this definition"></a></dt>
<dd><p>Like group sorted indices but returns a list of slices</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.spatially_verify_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">spatially_verify_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5707963267948966</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dlen_sqrd2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_nInliers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnAff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_homog_checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'homog'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_nInliers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#spatially_verify_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.spatially_verify_kpts" title="Permalink to this definition"></a></dt>
<dd><p>Driver function
Spatially validates feature matches</p>
<p>FIXME: there is a non-determenism here</p>
<p>Returned homography maps image1 space into image2 space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts1</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – all keypoints in image 1</p></li>
<li><p><strong>kpts2</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – all keypoints in image 2</p></li>
<li><p><strong>fm</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – matching keypoint indexes […, (kp1x, kp2x), …]</p></li>
<li><p><strong>xy_thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – spatial distance threshold under affine transform to
be considered a match</p></li>
<li><p><strong>scale_thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
<li><p><strong>ori_thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
<li><p><strong>dlen_sqrd2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – diagonal length squared of image/chip 2</p></li>
<li><p><strong>min_nInliers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – default=4</p></li>
<li><p><strong>returnAff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – returns best affine hypothesis as well</p></li>
<li><p><strong>max_nInliers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – homog is not considered after this threshold</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(refined_inliers, refined_errors, H, aff_inliers, aff_errors, Aff) if success else None</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m xdoctest vtool.spatial_verification spatially_verify_kpts:0 –show
python -m xdoctest vtool.spatial_verification spatially_verify_kpts:0 –show –refine-method=’affine’
python -m xdoctest vtool.spatial_verification spatially_verify_kpts:0 –dpath figures –show –save ~/latex/crall-candidacy-2015/figures/sver_kpts.jpg  # NOQA
python -m xdoctest vtool.spatial_verification spatially_verify_kpts:0</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname1&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname2&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;easy2.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_extract_features_default_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span><span class="p">[</span><span class="s1">&#39;ratio_thresh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">.625</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">argparse_dict</span><span class="p">(</span><span class="n">default_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">)</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">testdata_ratio_matches</span><span class="p">(</span><span class="n">fname1</span><span class="p">,</span> <span class="n">fname2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_thresh</span> <span class="o">=</span> <span class="mf">.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dlen_sqrd2</span> <span class="o">=</span> <span class="mf">447271.015</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_thresh</span> <span class="o">=</span> <span class="mf">1.57</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_nInliers</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">returnAff</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refine_method</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--refine-method&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;homog&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svtup</span> <span class="o">=</span> <span class="n">spatially_verify_kpts</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">xy_thresh</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span><span class="p">,</span> <span class="n">dlen_sqrd2</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">min_nInliers</span><span class="p">,</span> <span class="n">match_weights</span><span class="p">,</span> <span class="n">returnAff</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">refine_method</span><span class="o">=</span><span class="n">refine_method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">svtup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">svtup</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;sver failed&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refined_inliers</span><span class="p">,</span> <span class="n">refined_errors</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">svtup</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_inliers</span><span class="p">,</span> <span class="n">aff_errors</span><span class="p">,</span> <span class="n">Aff</span> <span class="o">=</span> <span class="n">svtup</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print(&#39;aff_errors = %r&#39; % (aff_errors,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;aff_inliers = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">aff_inliers</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;refined_inliers = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">refined_inliers</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print(&#39;refined_errors = %r&#39; % (refined_errors,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_type_profile</span><span class="p">(</span><span class="n">svtup</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#result = ub.repr2(svtup, precision=3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">refined_inliers</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">aff_inliers</span><span class="p">,</span> <span class="n">Aff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">show_sv</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_tup</span><span class="o">=</span><span class="n">aff_tup</span><span class="p">,</span> <span class="n">homog_tup</span><span class="o">=</span><span class="n">homog_tup</span><span class="p">,</span> <span class="n">refine_method</span><span class="o">=</span><span class="n">refine_method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">tuple(numpy.ndarray, tuple(numpy.ndarray*3), numpy.ndarray, numpy.ndarray, tuple(numpy.ndarray*3), numpy.ndarray)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.stack_image_list">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">stack_image_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_image_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.stack_image_list" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-stack_image_list –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_offset</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modifysize</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_sf</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">modifysize</span><span class="o">=</span><span class="n">modifysize</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="n">vert</span><span class="p">,</span> <span class="n">use_larger</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span><span class="p">,</span> <span class="n">offset_list</span><span class="p">,</span> <span class="n">sf_list</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">return_offset</span><span class="o">=</span><span class="n">return_offset</span><span class="p">,</span> <span class="n">return_sf</span><span class="o">=</span><span class="n">return_sf</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">offset_list</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">img_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list_</span> <span class="o">=</span> <span class="n">wh_list</span> <span class="o">*</span> <span class="n">sf_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">offset</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">offset_list</span><span class="p">,</span> <span class="n">wh_list_</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">distinct_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">offset_list</span><span class="p">))):</span>
<span class="gp">... </span>   <span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#wh1 = img1.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#wh2 = img2.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_bbox((0, 0) + wh1, bbox_color=(1, 0, 0))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_bbox((woff, hoff) + wh2, bbox_color=(0, 1, 0))</span>
<span class="go">np.array([[   0.  ,   76.96,  141.08,  181.87,  246.  ],</span>
<span class="go">          [   0.  ,    0.  ,    0.  ,    0.  ,    0.  ]], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.stack_image_list_special">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">stack_image_list_special</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_larger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_sf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_image_list_special"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.stack_image_list_special" title="Permalink to this definition"></a></dt>
<dd><p># TODO: add initial scale down factor?</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-stack_image_list_special –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list_</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">img_list_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="n">img_list_</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_offset</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_larger</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_bot</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_sf</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_sf</span> <span class="o">=</span> <span class="mf">.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span><span class="p">,</span> <span class="n">offset_list</span><span class="p">,</span> <span class="n">sf_list</span> <span class="o">=</span> <span class="n">stack_image_list_special</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img_list</span><span class="p">,</span> <span class="n">num_bot</span><span class="p">,</span> <span class="n">vert</span><span class="p">,</span> <span class="n">use_larger</span><span class="p">,</span> <span class="n">initial_sf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img1</span><span class="p">)]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">,</span> <span class="n">img_list</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list_</span> <span class="o">=</span> <span class="n">wh_list</span> <span class="o">*</span> <span class="n">sf_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;imgB.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">imgB</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">offset</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">offset_list</span><span class="p">,</span> <span class="n">wh_list_</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">distinct_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">offset_list</span><span class="p">))):</span>
<span class="gp">... </span>   <span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.stack_image_recurse">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">stack_image_recurse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_list1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_list2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modifysize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_image_recurse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.stack_image_recurse" title="Permalink to this definition"></a></dt>
<dd><p>TODO: return offsets as well</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_list1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>img_list2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>vert</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-stack_image_recurse –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;astro.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img3</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;ada.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img4</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;jeff.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img5</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;star.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list1</span> <span class="o">=</span> <span class="p">[</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">img3</span><span class="p">,</span> <span class="n">img4</span><span class="p">,</span> <span class="n">img5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list2</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">stack_image_recurse</span><span class="p">(</span><span class="n">img_list1</span><span class="p">,</span> <span class="n">img_list2</span><span class="p">,</span> <span class="n">vert</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#wh1 = img1.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#wh2 = img2.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_bbox((0, 0) + wh1, bbox_color=(1, 0, 0))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_bbox((woff, hoff) + wh2, bbox_color=(0, 1, 0))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.stack_images">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">stack_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modifysize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_larger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">white_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.stack_images" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img1</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>img2</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-stack_images –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;astro.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modifysize</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_sf</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#(imgB, woff, hoff) = stack_images(img1, img2, vert, modifysize, return_sf=return_sf)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">overlap</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span><span class="p">,</span> <span class="n">offset2</span><span class="p">,</span> <span class="n">sf_tup</span> <span class="o">=</span> <span class="n">stack_images</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">vert</span><span class="p">,</span> <span class="n">modifysize</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">return_sf</span><span class="o">=</span><span class="n">return_sf</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span> <span class="o">=</span> <span class="n">offset2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">imgB</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img1</span><span class="p">),</span> <span class="n">sf_tup</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img2</span><span class="p">),</span> <span class="n">sf_tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wh1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh1</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">woff</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">hoff</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh2</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">((662, 512, 3), (0.0, 0.0), (0, 150))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.stack_multi_images">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">stack_multi_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_list1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sf_list1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_list2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sf_list2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_larger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modifysize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_multi_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.stack_multi_images" title="Permalink to this definition"></a></dt>
<dd><p>combines images that are already stacked</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.stack_multi_images2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">stack_multi_images2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multiimg_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsets_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfs_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modifysize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_multi_images2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.stack_multi_images2" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>multiimg_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>offset_lists</strong> – </p></li>
<li><p><strong>sfs_list</strong> – </p></li>
<li><p><strong>vert</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(stacked_img, stacked_img, stacked_sfs)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-stack_multi_images2 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_stack1</span><span class="p">,</span> <span class="n">offset_list1</span><span class="p">,</span> <span class="n">sf_list1</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">vert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">modifysize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_stack2</span><span class="p">,</span> <span class="n">offset_list2</span><span class="p">,</span> <span class="n">sf_list2</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">modifysize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_stack3</span><span class="p">,</span> <span class="n">offset_list3</span><span class="p">,</span> <span class="n">sf_list3</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">modifysize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multiimg_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">img_stack1</span><span class="p">,</span> <span class="n">img_stack2</span><span class="p">,</span> <span class="n">img_stack3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offsets_list</span>  <span class="o">=</span> <span class="p">[</span><span class="n">offset_list1</span><span class="p">,</span> <span class="n">offset_list2</span><span class="p">,</span> <span class="n">offset_list3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sfs_list</span>      <span class="o">=</span> <span class="p">[</span><span class="n">sf_list1</span><span class="p">,</span> <span class="n">sf_list2</span><span class="p">,</span> <span class="n">sf_list3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">stack_multi_images2</span><span class="p">(</span><span class="n">multiimg_list</span><span class="p">,</span> <span class="n">offsets_list</span><span class="p">,</span> <span class="n">sfs_list</span><span class="p">,</span> <span class="n">vert</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">stacked_img</span><span class="p">,</span> <span class="n">stacked_offsets</span><span class="p">,</span> <span class="n">stacked_sfs</span><span class="p">)</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">remove_doublspaces</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">stacked_offsets</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">10000</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; ,&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">stacked_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">img_list</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">img_list</span> <span class="o">+</span> <span class="n">img_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list_</span> <span class="o">=</span> <span class="n">wh_list</span> <span class="o">*</span> <span class="n">stacked_sfs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">offset</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">stacked_offsets</span><span class="p">,</span> <span class="n">wh_list_</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">distinct_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stacked_offsets</span><span class="p">))):</span>
<span class="gp">... </span>   <span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([[ 0., 0., 0., 0., 0., 512., 512., 512., 512., 512., 1024., 1024., 1024., 1024., 1024. ],</span>
<span class="go"> [ 0., 512.12, 1024.25, 1827., 2339., 0., 427., 939., 1742., 2254., 0., 373.18, 1137.45, 2073.38, 2670.47]], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.stack_square_images">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">stack_square_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_square_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.stack_square_images" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>img_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-stack_square_images</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">stack_square_images</span><span class="p">(</span><span class="n">img_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.strictly_decreasing">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">strictly_decreasing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#strictly_decreasing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.strictly_decreasing" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.strictly_increasing">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">strictly_increasing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#strictly_increasing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.strictly_increasing" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.structure_rows">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">structure_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arrs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#structure_rows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.structure_rows" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other structure_rows</p>
</dd>
<dt>SeeAlso:</dt><dd><p>unstructure_rows</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">609</span><span class="p">,</span> <span class="mi">307</span><span class="p">],</span> <span class="p">[</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">344</span><span class="p">],</span> <span class="p">[</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">690</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">422</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">422</span><span class="p">,</span>  <span class="mi">968</span><span class="p">],</span> <span class="p">[</span> <span class="mi">481</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">1132</span><span class="p">],</span> <span class="p">[</span> <span class="mi">759</span><span class="p">,</span>  <span class="mi">159</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrs</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structured_arrs</span> <span class="o">=</span> <span class="n">structure_rows</span><span class="p">(</span><span class="o">*</span><span class="n">arrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unstructured_arrs</span> <span class="o">=</span> <span class="n">unstructure_rows</span><span class="p">(</span><span class="o">*</span><span class="n">structured_arrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">unstructured_arrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">arrs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">unstructured_arrs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">arrs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">union_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">union1d</span><span class="p">(</span><span class="o">*</span><span class="n">structured_arrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">union</span><span class="p">,</span> <span class="o">=</span> <span class="n">unstructure_rows</span><span class="p">(</span><span class="n">union_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">union</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.subbin_bounds">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">subbin_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#subbin_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.subbin_bounds" title="Permalink to this definition"></a></dt>
<dd><p>Gets quantized bounds of a sub-bin/pixel point and a radius.
Useful for cropping using subpixel points</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – center of a circle a 1d pixel array</p></li>
<li><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – radius of the circle</p></li>
<li><p><strong>low</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – minimum index of 1d pixel array</p></li>
<li><p><strong>high</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – maximum index of 1d pixel array</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(iz1, iz2, z_offst) - quantized_bounds and subbin_offset</dt><dd><p>iz1 - low radius endpoint
iz2 - high radius endpoint
z_offst - subpixel offset
#Returns: quantized_bounds=(iz1, iz2), subbin_offset</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.histogram –test-subbin_bounds</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius</span> <span class="o">=</span> <span class="mf">5.666</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">low</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">high</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">iz1</span><span class="p">,</span> <span class="n">iz2</span><span class="p">,</span> <span class="n">z_offst</span><span class="p">)</span> <span class="o">=</span> <span class="n">subbin_bounds</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">iz1</span><span class="p">,</span> <span class="n">iz2</span><span class="p">,</span> <span class="n">z_offst</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(0, 7, 1.5)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.subpixel_values">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">subpixel_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#subpixel_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.subpixel_values" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p>stackoverflow.com/uestions/12729228/simple-efficient-binlinear-interpolation-of-images-in-numpy-and-python</p>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>cv2.getRectSubPix(image, patchSize, center[, patch[, patchType]])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.subscale_peaks">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">subscale_peaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">border_vals_sum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nScales</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#subscale_peaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.subscale_peaks" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.svd">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">svd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#svd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.svd" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>M</strong> (<em>ndarray</em>) – must be either float32 or float64</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(U, s, Vt)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.linalg –test-svd</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">20.5812</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.615</span><span class="p">,</span> <span class="mf">17.1295</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vt</span><span class="p">)</span> <span class="o">=</span> <span class="n">svd</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Ignore:</dt><dd><p>flags = cv2.SVD_FULL_UV
%timeit cv2.SVDecomp(M, flags=flags)
%timeit npl.svd(M)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.symbolic_randcheck">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">symbolic_randcheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#symbolic_randcheck"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.symbolic_randcheck" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.symmetric_correspondence">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">symmetric_correspondence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annot1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annot2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Knorm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_shrink</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#symmetric_correspondence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.symmetric_correspondence" title="Permalink to this definition"></a></dt>
<dd><p>Find symmetric feature corresopndences</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.sympy_latex_repr">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">sympy_latex_repr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#sympy_latex_repr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.sympy_latex_repr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.sympy_mat">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">sympy_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#sympy_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.sympy_mat" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.sympy_numpy_repr">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">sympy_numpy_repr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#sympy_numpy_repr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.sympy_numpy_repr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.take2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">take2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#take2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.take2" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper around numpy compress that makes the signature more similar to take</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.take_col_per_row">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">take_col_per_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colx_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#take_col_per_row"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.take_col_per_row" title="Permalink to this definition"></a></dt>
<dd><p>takes a column from each row</p>
<dl>
<dt>Ignore:</dt><dd><p>num_rows = 1000
num_cols = 4</p>
<p>arr = np.arange(10 * 4).reshape(10, 4)
colx_list = (np.random.rand(10) * 4).astype(np.int)</p>
<p>%timeit np.array([row[cx] for (row, cx) in zip(arr, colx_list)])
%timeit arr.ravel().take(np.ravel_multi_index((np.arange(len(colx_list)), colx_list), arr.shape))
%timeit arr.ravel().take(colx_list + np.arange(arr.shape[0]) * arr.shape[1])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.test_affine_errors">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">test_affine_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_thresh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#test_affine_errors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.test_affine_errors" title="Permalink to this definition"></a></dt>
<dd><p>used for refinement as opposed to initial estimation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.test_annoy">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">test_annoy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#test_annoy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.test_annoy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.test_cv2_flann">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">test_cv2_flann</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#test_cv2_flann"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.test_cv2_flann" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>Ignore:</dt><dd><p>[name for name in dir(cv2) if ‘create’ in name.lower()]
[name for name in dir(cv2) if ‘stereo’ in name.lower()]</p>
<p>ut.grab_zipped_url(’<a class="reference external" href="https://priithon.googlecode.com/archive/a6117f5e81ec00abcfb037f0f9da2937bb2ea47f.tar.gz">https://priithon.googlecode.com/archive/a6117f5e81ec00abcfb037f0f9da2937bb2ea47f.tar.gz</a>’, download_dir=’.’)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.test_homog_errors">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">test_homog_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_thresh_sqrd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_homog_checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#test_homog_errors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.test_homog_errors" title="Permalink to this definition"></a></dt>
<dd><p>Test to see which keypoints the homography correctly maps</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>H</strong> (<em>ndarray</em><em>[</em><em>float64_t</em><em>, </em><em>ndim=2</em><em>]</em>) – homography/perspective matrix</p></li>
<li><p><strong>kpts1</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>kpts2</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>fm</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of feature matches as tuples (qfx, dfx)</p></li>
<li><p><strong>xy_thresh_sqrd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
<li><p><strong>scale_thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
<li><p><strong>ori_thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – angle in radians</p></li>
<li><p><strong>full_homog_checks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>homog_tup1</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.spatial_verification –test-test_homog_errors:0 –show
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –rotation_invariance
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –rotation_invariance –no-affine-invariance –xy-thresh=.001
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –rotation_invariance –no-affine-invariance –xy-thresh=.001 –no-full-homog-checks
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –no-full-homog-checks
# ————–
# Shows (sorta) how inliers are computed
python -m vtool.spatial_verification –test-test_homog_errors:1 –show
python -m vtool.spatial_verification –test-test_homog_errors:1 –show –rotation_invariance
python -m vtool.spatial_verification –test-test_homog_errors:1 –show –rotation_invariance –no-affine-invariance –xy-thresh=.001
python -m vtool.spatial_verification –test-test_homog_errors:1 –show –rotation_invariance –xy-thresh=.001
python -m vtool.spatial_verification –test-test_homog_errors:0 –show –rotation_invariance –xy-thresh=.001</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">estimate_refined_transform</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.57</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">full_homog_checks</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--no-full-homog-checks&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup1</span> <span class="o">=</span> <span class="n">test_homog_errors</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">,</span> <span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span><span class="p">,</span> <span class="n">full_homog_checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">homog_tup1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">homog_tup1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">show_sv</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">homog_tup</span><span class="o">=</span><span class="n">homog_tup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm_</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">estimate_refined_transform</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm_</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.57</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">full_homog_checks</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--no-full-homog-checks&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ----------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Take subset of feature matches</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">fm_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_err</span><span class="p">,</span> <span class="n">xy_err</span><span class="p">,</span> <span class="n">ori_err</span> <span class="o">=</span> \
<span class="gp">... </span>    <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">test_homog_errors</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="s1">&#39;scale_err, xy_err, ori_err&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># we only care about checking out scale and orientation here. ignore bad xy points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_inliers_flag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">less</span><span class="p">(</span><span class="n">xy_err</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_err</span><span class="p">[</span><span class="o">~</span><span class="n">xy_inliers_flag</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">fm_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scale_err</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="mi">10</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">fm_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scale_err</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="mi">10</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Exec sourcecode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1_m</span><span class="p">,</span> <span class="n">kpts2_m</span><span class="p">,</span> <span class="n">off_xy1_m</span><span class="p">,</span> <span class="n">off_xy1_mt</span><span class="p">,</span> <span class="n">dxy1_m</span><span class="p">,</span> <span class="n">dxy1_mt</span><span class="p">,</span> <span class="n">xy2_m</span><span class="p">,</span> <span class="n">xy1_m</span><span class="p">,</span> <span class="n">xy1_mt</span><span class="p">,</span> <span class="n">scale_err</span><span class="p">,</span> <span class="n">xy_err</span><span class="p">,</span> <span class="n">ori_err</span> <span class="o">=</span> \
<span class="gp">... </span>    <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">test_homog_errors</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="s1">&#39;kpts1_m, kpts2_m, off_xy1_m, off_xy1_mt, dxy1_m, dxy1_mt, xy2_m, xy1_m, xy1_mt, scale_err, xy_err, ori_err&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;orig points and offset point&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy1_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">off_xy1_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">LIGHT_BLUE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;transformed points and matching points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># first have to make corresponding offset points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use reference point for scale and orientation tests</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oris2_m</span>   <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_oris</span><span class="p">(</span><span class="n">kpts2_m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scales2_m</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_scales</span><span class="p">(</span><span class="n">kpts2_m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dxy2_m</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">oris2_m</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">oris2_m</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaled_dxy2_m</span> <span class="o">=</span> <span class="n">dxy2_m</span> <span class="o">*</span> <span class="n">scales2_m</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">off_xy2_m</span> <span class="o">=</span> <span class="n">xy2_m</span> <span class="o">+</span> <span class="n">scaled_dxy2_m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw transformed semgents</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy2_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">off_xy2_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">GREEN</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw corresponding matches semgents</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy1_mt</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">off_xy1_mt</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw matches between correspondences</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy1_mt</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">xy2_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ORANGE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#vt.get _xy_axis_extents(kpts1_m)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.draw_sv.show_sv(rchip1, rchip2, kpts1, kpts2, fm, homog_tup=homog_tup)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.test_language_modulus">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">test_language_modulus</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/util_math.html#test_language_modulus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.test_language_modulus" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Modulo_operation">http://en.wikipedia.org/wiki/Modulo_operation</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.test_mser">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">test_mser</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#test_mser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.test_mser" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.test_ondisk_find_patch_fpath_dominant_orientations">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">test_ondisk_find_patch_fpath_dominant_orientations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">36</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxima_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DEBUG_ROTINVAR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#test_ondisk_find_patch_fpath_dominant_orientations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.test_ondisk_find_patch_fpath_dominant_orientations" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patch_fpath</strong> – </p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
<li><p><strong>maxima_thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-test_ondisk_find_patch_fpath_dominant_orientations</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--patch-fpath&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;star.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_ondisk_find_patch_fpath_dominant_orientations</span><span class="p">(</span><span class="n">patch_fpath</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.test_score_normalization">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">test_score_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tp_support</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_support</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_roc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_precision_recall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normkw_varydict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#test_score_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.test_score_normalization" title="Permalink to this definition"></a></dt>
<dd><p>Gives an overview of how well threshold can be learned from raw scores.</p>
<p>DEPRICATE</p>
<dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.score_normalization –test-test_score_normalization –show</p>
</dd>
<dt>CommandLine:</dt><dd><p>xdoctest -m ~/code/vtool/vtool/score_normalization.py test_score_normalization</p>
</dd>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># GUI_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Shows how score normalization works with gaussian noise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">randstate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get a training sample</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_support</span> <span class="o">=</span> <span class="n">randstate</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">6.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">256</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_support</span> <span class="o">=</span> <span class="n">randstate</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">256</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:plottool)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_score_normalization</span><span class="p">(</span><span class="n">tp_support</span><span class="p">,</span> <span class="n">tn_support</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.test_show_gaussian_patches">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">test_show_gaussian_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(19,</span> <span class="pre">19)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#test_show_gaussian_patches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.test_show_gaussian_patches" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-test_show_gaussian_patches –show
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=7,7
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=17,17
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=41,41
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=29,29
python -m vtool.patch –test-test_show_gaussian_patches –show –shape=41,7</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://matplotlib.org/examples/mplot3d/surface3d_demo.html">http://matplotlib.org/examples/mplot3d/surface3d_demo.html</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">((</span><span class="s1">&#39;--shape&#39;</span><span class="p">,),</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_show_gaussian_patches</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.test_show_gaussian_patches2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">test_show_gaussian_patches2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(19,</span> <span class="pre">19)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#test_show_gaussian_patches2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.test_show_gaussian_patches2" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.patch –test-test_show_gaussian_patches2 –show
python -m vtool.patch –test-test_show_gaussian_patches2 –show –shape=7,7
python -m vtool.patch –test-test_show_gaussian_patches2 –show –shape=19,19
python -m vtool.patch –test-test_show_gaussian_patches2 –show –shape=41,41
python -m vtool.patch –test-test_show_gaussian_patches2 –show –shape=41,7</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://matplotlib.org/examples/mplot3d/surface3d_demo.html">http://matplotlib.org/examples/mplot3d/surface3d_demo.html</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">((</span><span class="s1">&#39;--shape&#39;</span><span class="p">,),</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_show_gaussian_patches2</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.testdata_annot_metadata">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">testdata_annot_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rchip_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfgdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#testdata_annot_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.testdata_annot_metadata" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.testdata_binary_scores">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">testdata_binary_scores</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_binary_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.testdata_binary_scores" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.testdata_blend">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">testdata_blend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#testdata_blend"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.testdata_blend" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.testdata_dummy_matches">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">testdata_dummy_matches</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_dummy_matches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.testdata_dummy_matches" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>matches_testtup</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.demodata –test-testdata_dummy_matches –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matches_testtup</span> <span class="o">=</span> <span class="n">testdata_dummy_matches</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">)</span> <span class="o">=</span> <span class="n">matches_testtup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_chipmatch2</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_figtitle</span><span class="p">(</span><span class="s1">&#39;Dummy matches&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.testdata_dummy_sift">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">testdata_dummy_sift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nPts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_dummy_sift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.testdata_dummy_sift" title="Permalink to this definition"></a></dt>
<dd><p>Makes a demodata sift descriptor that has the uint8 * 512 hack
like hesaff returns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nPts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – (default = 10)</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.demodata –test-testdata_dummy_sift</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nPts</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sift</span> <span class="o">=</span> <span class="n">testdata_dummy_sift</span><span class="p">(</span><span class="n">nPts</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">vt</span><span class="o">.</span><span class="n">check_sift_validity</span><span class="p">(</span><span class="n">sift</span><span class="p">),</span> <span class="s1">&#39;bad SIFT properties&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#assert np.allclose(((sift / 512) ** 2).sum(axis=1), 1, rtol=.01), &#39;bad SIFT property&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#assert np.all(sift / 512 &lt; .2), &#39;bad SIFT property&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.testdata_hist">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">testdata_hist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#testdata_hist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.testdata_hist" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.testdata_imglist">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">testdata_imglist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#testdata_imglist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.testdata_imglist" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.testdata_matching_affine_inliers">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">testdata_matching_affine_inliers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#testdata_matching_affine_inliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.testdata_matching_affine_inliers" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.testdata_matching_affine_inliers_normalized">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">testdata_matching_affine_inliers_normalized</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#testdata_matching_affine_inliers_normalized"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.testdata_matching_affine_inliers_normalized" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.testdata_nonmonotonic">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">testdata_nonmonotonic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_nonmonotonic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.testdata_nonmonotonic" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.testdata_patch">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">testdata_patch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#testdata_patch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.testdata_patch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.testdata_ratio_matches">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">testdata_ratio_matches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'easy1.png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'easy2.png'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/demodata.html#testdata_ratio_matches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.testdata_ratio_matches" title="Permalink to this definition"></a></dt>
<dd><p>Runs simple ratio-test matching between two images.
Technically this is not demodata data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – </p></li>
<li><p><strong>fname2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>matches_testtup</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl>
<dt>CommandLine:</dt><dd><p>python -m vtool.demodata –test-testdata_ratio_matches
python -m vtool.demodata –test-testdata_ratio_matches –help
python -m vtool.demodata –test-testdata_ratio_matches –show
python -m vtool.demodata –test-testdata_ratio_matches –show –ratio_thresh=1.1 –rotation_invariance</p>
<p>python -m vtool.demodata –test-testdata_ratio_matches –show –ratio_thresh=.625 –rotation_invariance –fname1 easy1.png –fname2 easy3.png
python -m vtool.demodata –test-testdata_ratio_matches –show –ratio_thresh=.625 –no-rotation_invariance –fname1 easy1.png –fname2 easy3.png</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(module:pyhesaff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.demodata</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname1&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--fname2&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;easy2.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_extract_features_default_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span><span class="p">[</span><span class="s1">&#39;ratio_thresh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">.625</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">argparse_dict</span><span class="p">(</span><span class="n">default_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matches_testtup</span> <span class="o">=</span> <span class="n">testdata_ratio_matches</span><span class="p">(</span><span class="n">fname1</span><span class="p">,</span> <span class="n">fname2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm_RAT</span><span class="p">,</span> <span class="n">fs_RAT</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">)</span> <span class="o">=</span> <span class="n">matches_testtup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_chipmatch2</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm_RAT</span><span class="p">,</span> <span class="n">fs_RAT</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_matches</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fm_RAT</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">fs_RAT</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Simple matches using the Lowe</span><span class="se">\&#39;</span><span class="s1">s ratio test&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">title</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> num_matches=</span><span class="si">%r</span><span class="s1">, score_sum=</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">num_matches</span><span class="p">,</span> <span class="n">score_sum</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_figtitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.testdata_score_normalier">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">testdata_score_normalier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tp_bumps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[(6.5,</span> <span class="pre">256)]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_bumps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[(3.5,</span> <span class="pre">256)]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#testdata_score_normalier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.testdata_score_normalier" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.testdata_scores_labels">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">testdata_scores_labels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#testdata_scores_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.testdata_scores_labels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.testdata_sift2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">testdata_sift2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#testdata_sift2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.testdata_sift2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.testshow_extramargin_info">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">testshow_extramargin_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gfpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_gs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halfoffset_ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mbbox_gs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">margin_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#testshow_extramargin_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.testshow_extramargin_info" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.to_undirected_edges">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">to_undirected_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directed_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#to_undirected_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.to_undirected_edges" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.transform_around">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">transform_around</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#transform_around"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.transform_around" title="Permalink to this definition"></a></dt>
<dd><p>translates to origin, applies transform and then translates back</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.transform_kpts">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">transform_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#transform_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.transform_kpts" title="Permalink to this definition"></a></dt>
<dd><p>returns M.dot(kpts_mat)
Currently, only works if M is affine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>M</strong> (<em>ndarray</em>) – affine transform matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">transform_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-0. &#39;</span><span class="p">,</span> <span class="s1">&#39; 0. &#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.transform_kpts_to_imgspace">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">transform_kpts_to_imgspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chipsz</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#transform_kpts_to_imgspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.transform_kpts_to_imgspace" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Transforms keypoints so they are plotable in imagespace</dt><dd><p>kpts   - xyacdo keypoints
bbox   - chip bounding boxes in image space
theta  - chip rotationsinvC
chipsz - chip extent (in keypoint / chip space)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.transform_kpts_xys">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">transform_kpts_xys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#transform_kpts_xys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.transform_kpts_xys" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>ndarray</em><em>[</em><em>float32_t</em><em>, </em><em>ndim=2</em><em>]</em>) – keypoints</p></li>
<li><p><strong>H</strong> (<em>ndarray</em><em>[</em><em>float64_t</em><em>, </em><em>ndim=2</em><em>]</em>) – homography/perspective matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>xy_t</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">3.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>  <span class="mf">5.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>  <span class="mf">6.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_t</span> <span class="o">=</span> <span class="n">transform_kpts_xys</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.transform_points_with_homography">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">transform_points_with_homography</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_xys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#transform_points_with_homography"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.transform_points_with_homography" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>H</strong> (<em>ndarray</em><em>[</em><em>float64_t</em><em>, </em><em>ndim=2</em><em>]</em>) – homography/perspective matrix</p></li>
<li><p><strong>_xys</strong> (<em>ndarray</em><em>[</em><em>ndim=2</em><em>]</em>) – (2 x N) array</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.translation_mat3x3">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">translation_mat3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float64'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#translation_mat3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.translation_mat3x3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.try_svd">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">try_svd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#try_svd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.try_svd" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.spatial_verification try_svd</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">build_lstsqrs_Mx9</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">USV</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">compute_uv</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">USV</span> <span class="o">=</span> <span class="n">try_svd</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.demodata</span> <span class="k">as</span> <span class="nn">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">(</span><span class="n">wh_num</span><span class="o">=</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">build_lstsqrs_Mx9</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">USV</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">compute_uv</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">USV</span> <span class="o">=</span> <span class="n">try_svd</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.trytake">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">trytake</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#trytake"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.trytake" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.tune_flann">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">tune_flann</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#tune_flann"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.tune_flann" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_pami2014.pdf">http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_pami2014.pdf</a>
<a class="reference external" href="http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf">http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf</a>
<a class="reference external" href="http://docs.opencv.org/trunk/modules/flann/doc/flann_fast_approximate_nearest_neighbor_search.html">http://docs.opencv.org/trunk/modules/flann/doc/flann_fast_approximate_nearest_neighbor_search.html</a></p>
<dl>
<dt>Math:</dt><dd><p>cost of an algorithm is:</p>
<dl class="simple">
<dt>LaTeX:</dt><dd><dl class="simple">
<dt>cost = frac</dt><dd><p>{search + build_weight * build }
{ minoverparams( search + build_weight build)} +
memory_weight * memory</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dpts</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>target_precision</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – number between 0 and 1 representing desired
accuracy. Higher values are more accurate.</p></li>
<li><p><strong>build_weight</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – importance weight given to minimizing build time
relative to search time. This number can range from 0 to infinity.
typically because building is a more complex computation you want
to keep the number relatively low, (less than 1) otherwise you’ll
end up getting a linear search (no build time).</p></li>
<li><p><strong>memory_weight</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Importance of memory relative to total speed.
A value less than 1 gives more importance to the time spent and a
value greater than 1 gives more importance to the memory usage.</p></li>
<li><p><strong>sample_fraction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – number between 0 and 1 representing the
fraction of the input data to use in the optimization. A higher
number uses more data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuned_params</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.nearest_neighbors –test-tune_flann</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.tune_flann2">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">tune_flann2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#tune_flann2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.tune_flann2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.understanding_pseudomax_props">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">understanding_pseudomax_props</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#understanding_pseudomax_props"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.understanding_pseudomax_props" title="Permalink to this definition"></a></dt>
<dd><p>Function showing some properties of distances between normalized pseudomax vectors</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.distance –test-understanding_pseudomax_props</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;+---&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mode = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mode</span><span class="p">,))</span>
<span class="gp">... </span>    <span class="n">result</span> <span class="o">=</span> <span class="n">understanding_pseudomax_props</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;L___&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.uniform_sample_hypersphere">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">uniform_sample_hypersphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_quadrent_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#uniform_sample_hypersphere"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.uniform_sample_hypersphere" title="Permalink to this definition"></a></dt>
<dd><p>Not quite done yet</p>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Regular_polytope">https://en.wikipedia.org/wiki/Regular_polytope</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Platonic_solid#Higher_dimensions">https://en.wikipedia.org/wiki/Platonic_solid#Higher_dimensions</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Cross-polytope">https://en.wikipedia.org/wiki/Cross-polytope</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num</strong> – </p></li>
<li><p><strong>ndim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – (default = 2)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.clustering2 –test-uniform_sampe_hypersphere</p>
</dd>
<dt>Ignore:</dt><dd><p>#pip install polytope
sudo pip install cvxopt  –no-deps</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndim</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pts</span> <span class="o">=</span> <span class="n">uniform_sampe_hypersphere</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">ndim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;gx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">elif</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1">#pt.plot_surface3d(pts.T[0], pts.T[1], pts.T[2])</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fig</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">doclf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">docla</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">df2</span><span class="o">.</span><span class="n">dark_background</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.union_extents">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">union_extents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extents</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#union_extents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.union_extents" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.unique_row_indexes">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">unique_row_indexes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/numpy_utils.html#unique_row_indexes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.unique_row_indexes" title="Permalink to this definition"></a></dt>
<dd><p>np.unique on rows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>ndarray</em>) – 2d array</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>unique_rowx</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array">http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.numpy_utils –test-unique_row_indexes</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.numpy_utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">.534</span><span class="p">,</span> <span class="mf">.432</span><span class="p">],</span> <span class="p">[</span><span class="mf">.534</span><span class="p">,</span> <span class="mf">.432</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_rowx</span> <span class="o">=</span> <span class="n">unique_row_indexes</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;unique_rowx = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">unique_rowx</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">unique_rowx = np.array([0, 1, 2, 3, 5], dtype=np.int64)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Ignore:</dt><dd><p>%timeit unique_row_indexes(arr)
%timeit compute_unique_data_ids(arr)
%timeit compute_unique_integer_data_ids(arr)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.unique_rows">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">unique_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#unique_rows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.unique_rows" title="Permalink to this definition"></a></dt>
<dd><p>Order or columns does not matter if directed = False</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.unnormalize_transform">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">unnormalize_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M_prime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#unnormalize_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.unnormalize_transform" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.unstructure_rows">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">unstructure_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">structured_arrs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#unstructure_rows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.unstructure_rows" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>SeeAlso:</dt><dd><p>structure_rows</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.unsupervised_multicut_labeling">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">unsupervised_multicut_labeling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cost_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#unsupervised_multicut_labeling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.unsupervised_multicut_labeling" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Notes</p>
<p>requires CPLEX</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.clustering2 unsupervised_multicut_labeling –show</p>
</dd>
</dl>
<p>Ignore:</p>
<blockquote>
<div><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># synthetic data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#np.random.rand(size, size)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">45</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#size = 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">443284320</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encounter_lbls</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separation</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separation</span> <span class="o">=</span> <span class="mf">1.10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">encounter_lbls</span><span class="p">,</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_match</span> <span class="o">=</span> <span class="n">grid1</span><span class="o">.</span><span class="n">T</span> <span class="o">==</span> <span class="n">grid1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">good_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">is_match</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bad_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">s_match</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix_</span><span class="p">[</span><span class="n">good_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">good_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="n">separation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix_</span><span class="p">[</span><span class="n">bad_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bad_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">-</span> <span class="n">separation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">false_val</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">-</span> <span class="n">separation</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">true_val</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span> <span class="o">+</span> <span class="n">separation</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">diag_indices_from</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="p">)]</span> <span class="o">=</span> <span class="n">true_val</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#cost_matrix_[np.diag_indices_from(cost_matrix_)] = np.inf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix</span> <span class="o">=</span> <span class="p">(</span><span class="n">cost_matrix_</span> <span class="o">-</span> <span class="n">false_val</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">true_val</span> <span class="o">-</span> <span class="n">false_val</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">cost_matrix</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">unsupervised_multicut_labeling</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">find_group_differences</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">list</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">group_items</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">encounter_lbls</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">list</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">group_items</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;diff = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">diff</span><span class="p">,))</span>
</pre></div>
</div>
<p>#gm, = ut.exec_func_src(vt.unsupervised_multicut_labeling,
#key_list=[‘gm’], sentinal=’inf = opengm’)
#parameter = opengm.InfParam()
#%timeit opengm.inference.Multicut(gm, parameter=parameter).infer()</p>
</div></blockquote>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">443284320</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">ensureqt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">make_test_costmatrix</span><span class="p">(</span><span class="n">name_labels</span><span class="p">,</span> <span class="n">view_labels</span><span class="p">,</span> <span class="n">separation</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">is_same</span> <span class="o">=</span> <span class="n">name_labels</span> <span class="o">==</span> <span class="n">name_labels</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">is_comp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">view_labels</span> <span class="o">-</span> <span class="n">view_labels</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">good_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">is_same</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">bad_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">is_same</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">name_labels</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_labels</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span><span class="p">[</span><span class="n">good_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">good_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="n">separation</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span><span class="p">[</span><span class="n">bad_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bad_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">-</span> <span class="n">separation</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span> <span class="o">=</span> <span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">cost_matrix_</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">false_val</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">-</span> <span class="n">separation</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">true_val</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span> <span class="o">+</span> <span class="n">separation</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">diag_indices_from</span><span class="p">(</span><span class="n">cost_matrix_</span><span class="p">)]</span> <span class="o">=</span> <span class="n">true_val</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix</span> <span class="o">=</span> <span class="p">(</span><span class="n">cost_matrix_</span> <span class="o">-</span> <span class="n">false_val</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">true_val</span> <span class="o">-</span> <span class="n">false_val</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">cost_matrix</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cost_matrix</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">is_comp</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">cost_matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#cost_matrix = make_test_costmatrix(name_labels, view_labels, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost_matrix</span> <span class="o">=</span> <span class="n">make_test_costmatrix</span><span class="p">(</span><span class="n">name_labels</span><span class="p">,</span> <span class="n">view_labels</span><span class="p">,</span> <span class="mf">.9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">multicut_value</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">name_labels</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">grid1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">name_labels</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">name_labels</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">isdiff</span> <span class="o">=</span> <span class="n">grid1</span><span class="o">.</span><span class="n">T</span> <span class="o">!=</span> <span class="n">grid1</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">cut_value</span> <span class="o">=</span> <span class="n">cost_matrix</span><span class="p">[</span><span class="n">isdiff</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">cut_value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">name_labels</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">nx_from_matrix</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">floatfmt1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">map_vals</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;w=</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">floatfmt2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">map_vals</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;l=</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lens</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">map_vals</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">floatfmt1</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#labels = floatfmt2(lens)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span><span class="o">.</span><span class="n">set_edge_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#nx.set_edge_attributes(graph, name=&#39;len&#39;, values=lens)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;shape&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;ellipse&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encounter_lbls_str</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">name_labels</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node_name_lbls</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">encounter_lbls_str</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mcut_labels</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">unsupervised_multicut_labeling</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="n">vt</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">find_group_differences</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">list</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">group_items</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">name_labels</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">list</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">group_items</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">mcut_labels</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;diff = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">diff</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">node_name_lbls</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node_mcut_lbls</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">mcut_labels</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mcut_label&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">node_mcut_lbls</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mc_val(name) &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">multicut_value</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">name_labels</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mc_val(mcut) &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">multicut_value</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">mcut_labels</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">color_nodes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;mcut_label&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># remove noncomparable edges</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_comp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">view_labels</span> <span class="o">-</span> <span class="n">view_labels</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noncomp_edges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">is_comp</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="o">.</span><span class="n">remove_edges_from</span><span class="p">(</span><span class="n">noncomp_edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layoutkw</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;sep&#39;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;prog&#39;</span><span class="p">:</span> <span class="s1">&#39;neato&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;overlap&#39;</span><span class="p">:</span> <span class="s1">&#39;false&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;splines&#39;</span><span class="p">:</span> <span class="s1">&#39;spline&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_nx</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">layoutkw</span><span class="o">=</span><span class="n">layoutkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.verts_from_bbox">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">verts_from_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">close</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#verts_from_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.verts_from_bbox" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bbox</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – bounding box in the format (x, y, w, h)</p></li>
<li><p><strong>close</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>verts</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.geometry –test-verts_from_bbox</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">close</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="n">verts_from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">close</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;verts = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">verts</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">verts = ((10, 10), (60, 10), (60, 60), (10, 60))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.verts_list_from_bboxes_list">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">verts_list_from_bboxes_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bboxes_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#verts_list_from_bboxes_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.verts_list_from_bboxes_list" title="Permalink to this definition"></a></dt>
<dd><p>Create a four-vertex polygon from the bounding rectangle</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.warpAffine">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">warpAffine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Aff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_float01</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#warpAffine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.warpAffine" title="Permalink to this definition"></a></dt>
<dd><p>dsize = (width, height) of return image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>Aff</strong> (<em>ndarray</em>) – affine matrix</p></li>
<li><p><strong>dsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – width, height</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>warped_img</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.image –test-warpAffine –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rotation_mat3x3</span><span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warped_img</span> <span class="o">=</span> <span class="n">warpAffine</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">Aff</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xdoctest: +REQUIRES(--show)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">warped_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">skimage.transform</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">timeit</span> <span class="n">cv2</span><span class="o">.</span><span class="n">warpAffine</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">Aff</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dsize</span><span class="p">),</span> <span class="o">**</span><span class="n">CV2_WARP_KWARGS</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">100</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">7.95</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">skimage</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">AffineTransform</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tf</span> <span class="o">=</span> <span class="n">skimage</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">AffineTransform</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff_</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">params</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">skimage</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">_warps_cy</span><span class="o">.</span><span class="n">_warp_fast</span><span class="p">(</span><span class="n">img</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Aff_</span><span class="p">,</span> <span class="n">output_shape</span><span class="o">=</span><span class="n">dsize</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">timeit</span> <span class="n">skimage</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">_warps_cy</span><span class="o">.</span><span class="n">_warp_fast</span><span class="p">(</span><span class="n">img</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Aff_</span><span class="p">,</span> <span class="n">output_shape</span><span class="o">=</span><span class="n">dsize</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">100</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">5.74</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">timeit</span> <span class="n">cv2</span><span class="o">.</span><span class="n">warpAffine</span><span class="p">(</span><span class="n">img</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Aff</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dsize</span><span class="p">),</span> <span class="o">**</span><span class="n">CV2_WARP_KWARGS</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">100</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">5.13</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CONCLUSION</span><span class="p">,</span> <span class="n">cv2</span> <span class="n">transforms</span> <span class="n">are</span> <span class="n">better</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.warpHomog">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">warpHomog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Homog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_float01</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#warpHomog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.warpHomog" title="Permalink to this definition"></a></dt>
<dd><p>dsize = (width, height) of return image</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Homog</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warped_img</span> <span class="o">=</span> <span class="n">warpHomog</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">Homog</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.weighted_average_scoring">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">weighted_average_scoring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fsv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_filtxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonweight_filtxs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#weighted_average_scoring"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.weighted_average_scoring" title="Permalink to this definition"></a></dt>
<dd><p>does frac{sum_i w^f_i * w^d_i * r_i}{sum_i w^f_i, w^d_i}
to get a weighed average of ratio scores</p>
<p>If we normalize the weight part to add to 1 then we can get per-feature
scores.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Weighted_arithmetic_mean">http://en.wikipedia.org/wiki/Weighted_arithmetic_mean</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.82992172</span><span class="p">,</span>  <span class="mf">1.56136119</span><span class="p">,</span>  <span class="mf">0.66465378</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.8000412</span> <span class="p">,</span>  <span class="mf">2.14719748</span><span class="p">,</span>  <span class="mf">1.</span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.80848503</span><span class="p">,</span>  <span class="mf">2.6816361</span> <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.86761665</span><span class="p">,</span>  <span class="mf">2.70189977</span><span class="p">,</span>  <span class="mf">1.</span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.8004055</span> <span class="p">,</span>  <span class="mf">1.58753884</span><span class="p">,</span>  <span class="mf">0.92178345</span><span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weight_filtxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nonweight_filtxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_fs</span> <span class="o">=</span> <span class="n">weighted_average_scoring</span><span class="p">(</span><span class="n">fsv</span><span class="p">,</span> <span class="n">weight_filtxs</span><span class="p">,</span> <span class="n">nonweight_filtxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">new_fs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.weighted_geometic_mean">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">weighted_geometic_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#weighted_geometic_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.weighted_geometic_mean" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>list of ndarrays</em>) – </p></li>
<li><p><strong>weights</strong> (<em>ndarray</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –test-weighted_geometic_mean</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Weighted_geometric_mean">https://en.wikipedia.org/wiki/Weighted_geometric_mean</a></p>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>scipy.stats.mstats.gmean</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mf">.9</span><span class="p">,</span> <span class="mf">.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gmean_</span> <span class="o">=</span> <span class="n">weighted_geometic_mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;gmean_ = </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gmean_</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">gmean_ = 0.740</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gmean_</span> <span class="o">=</span> <span class="n">weighted_geometic_mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">hzcat</span><span class="p">([</span><span class="s1">&#39;gmean_ = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">gmean_</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Ignore:</dt><dd><p>res1 = ((img1 ** .5 * img2 ** .5)) ** 1
res2 = np.sqrt(img1 * img2)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.weighted_geometic_mean_unnormalized">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">weighted_geometic_mean_unnormalized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#weighted_geometic_mean_unnormalized"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.weighted_geometic_mean_unnormalized" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.whiten_xy_points">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">whiten_xy_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy_m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#whiten_xy_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.whiten_xy_points" title="Permalink to this definition"></a></dt>
<dd><p>whitens points to mean=0, stddev=1 and returns transformation</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool</span> <span class="kn">import</span> <span class="n">demodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_m</span> <span class="o">=</span> <span class="n">demodata</span><span class="o">.</span><span class="n">get_dummy_xy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">whiten_xy_points</span><span class="p">(</span><span class="n">xy_m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_norm</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">hash_data</span><span class="p">(</span><span class="n">tup</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.wrap_histogram">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">wrap_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#wrap_histogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.wrap_histogram" title="Permalink to this definition"></a></dt>
<dd><p>Simulates the first and last histogram bin being being adjacent to one another
by replicating those bins at the last and first positions respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>edges</strong> (<em>ndarray</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(hist_wrap, edge_wrap)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.histogram –test-wrap_histogram</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ubelt</span> <span class="k">as</span> <span class="nn">ub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">8.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">34.32</span><span class="p">,</span> <span class="mf">29.45</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.78539816</span><span class="p">,</span>  <span class="mf">1.57079633</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="mf">2.35619449</span><span class="p">,</span>  <span class="mf">3.14159265</span><span class="p">,</span>  <span class="mf">3.92699081</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="mf">4.71238898</span><span class="p">,</span>  <span class="mf">5.49778714</span><span class="p">,</span>  <span class="mf">6.2831853</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">hist_wrap</span><span class="p">,</span> <span class="n">edge_wrap</span><span class="p">)</span> <span class="o">=</span> <span class="n">wrap_histogram</span><span class="p">(</span><span class="n">hist_</span><span class="p">,</span> <span class="n">edges_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">hist_wrap</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">edge_wrap</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nobr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">6.73, 8.00, 0.00, 0.00, 34.32, 29.45, 0.00, 0.00, 6.73, 8.00,</span>
<span class="go">-0.79, 0.00, 0.79, 1.57, 2.36, 3.14, 3.93, 4.71, 5.50, 6.28, 7.07,</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.wrapped_distance">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">wrapped_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#wrapped_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.wrapped_distance" title="Permalink to this definition"></a></dt>
<dd><p>base = TAU corresponds to ori diff</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.zipcat">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">zipcat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#zipcat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.zipcat" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr1_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>arr2_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m vtool.other –exec-zipcat –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_list</span> <span class="o">=</span> <span class="n">zipcat</span><span class="p">(</span><span class="n">arr1_list</span><span class="p">,</span> <span class="n">arr2_list</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_list0</span> <span class="o">=</span> <span class="n">zipcat</span><span class="p">(</span><span class="n">arr1_list</span><span class="p">,</span> <span class="n">arr2_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_list1</span> <span class="o">=</span> <span class="n">zipcat</span><span class="p">(</span><span class="n">arr1_list</span><span class="p">,</span> <span class="n">arr2_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3_list2</span> <span class="o">=</span> <span class="n">zipcat</span><span class="p">(</span><span class="n">arr1_list</span><span class="p">,</span> <span class="n">arr2_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr3_list = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">(</span><span class="n">arr3_list</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr3_list0 = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">(</span><span class="n">arr3_list0</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arr3_list2 = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">(</span><span class="n">arr3_list2</span><span class="p">),))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.zipcompress">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">zipcompress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#zipcompress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.zipcompress" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.zipcompress_safe">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">zipcompress_safe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#zipcompress_safe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.zipcompress_safe" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.ziptake">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">ziptake</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#ziptake"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.ziptake" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtool.zstar_value">
<span class="sig-prename descclassname"><span class="pre">vtool.</span></span><span class="sig-name descname"><span class="pre">zstar_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#zstar_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtool.zstar_value" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/28242593/correct-way-to-obtain-confidence-interval-with-scipy">http://stackoverflow.com/questions/28242593/correct-way-to-obtain-confidence-interval-with-scipy</a></p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to vtool’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Wild Me.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>